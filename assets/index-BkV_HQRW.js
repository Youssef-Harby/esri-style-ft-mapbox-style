function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/IdentityManager-4z1KdEVF.js","assets/substitute-Dai5t2o-.js","assets/layersCreator-Bx-Ezijl.js","assets/portalLayers-By9oDEHZ.js","assets/associatedFeatureServiceUtils-B02onw5c.js","assets/lazyLayerLoader-CRcCBg1t.js","assets/styleUtils-Dgg1TvHy.js","assets/arcgisLayers-DakH7aKX.js","assets/fetchService-D9VhoJAg.js","assets/statsWorker-Cpf17qXQ.js","assets/utils-CIOOSvdR.js","assets/quantizationUtils-BZR9dsjG.js","assets/heatmapUtils-Boe_BMue.js","assets/utils-Csy0oCiW.js","assets/utils-3uNPT2qh.js","assets/ClassBreaksDefinition-ZG1m3GKq.js","assets/geometryEngineWorker-BhdkastR.js","assets/geometryEngineJSON-CVITF8fC.js","assets/geometryEngineBase-DWTWNtQK.js","assets/json-Wa8cmqdu.js","assets/CSVSourceWorker-CUcWqyCB.js","assets/date-M6n_RqpC.js","assets/OptimizedGeometry-CQuTPb9g.js","assets/FeatureStore-CvNp9fYM.js","assets/featureConversionUtils-jeRwLEAM.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/BoundsStore-DmDCZrnQ.js","assets/PooledRBush-Baiz_l8t.js","assets/timeSupport-BwlkveNa.js","assets/QueryEngine-odgaMPfh.js","assets/WhereClause-BX2Ta_r9.js","assets/TimeOnly-CZS1xv20.js","assets/UnknownTimeZone-BDVMG-HM.js","assets/QueryEngineCapabilities-CTDe3LlQ.js","assets/FieldsIndex-BkqA5HyZ.js","assets/RenderState-DaVlEYWY.js","assets/number-z6z3pZGn.js","assets/clientSideDefaults-BS6EMIXn.js","assets/defaultsJSON-CHAaurhX.js","assets/EdgeProcessingWorker-B8Wgb69R.js","assets/InterleavedLayout-BhpMbogL.js","assets/BufferView-DDRq7chS.js","assets/types-D0PSWh4d.js","assets/Util-0ur975fw.js","assets/edgeProcessing-qrzn3rXy.js","assets/deduplicate-ZnY3XWxP.js","assets/Indices-Dq84VKxn.js","assets/VertexAttribute-BlT9lbVY.js","assets/ElevationSamplerWorker-BiqPnVWi.js","assets/meshVertexSpaceUtils-DqgsFLGX.js","assets/MeshLocalVertexSpace-B8tsELpv.js","assets/vec3-fd6w1Mqr.js","assets/georeference-pIcYudaQ.js","assets/mat3f64-q3fE-ZOt.js","assets/mat4f64-CSKppSlJ.js","assets/computeTranslationToOriginAndRotation-B5ZEYZCX.js","assets/DoubleArray-EkviQusg.js","assets/quat-CLZysMiA.js","assets/quatf64-Bdb9ZJJK.js","assets/FeatureServiceSnappingSourceWorker-yGYoVuCA.js","assets/pbfQueryUtils-DpjkTcrV.js","assets/pbf-BPHYF6O6.js","assets/query-Cs8YeGbX.js","assets/queryZScale-D-3ejjzj.js","assets/GeoJSONSourceWorker-BH0rDQiP.js","assets/geojson-X14OxEG8.js","assets/sourceUtils-CRlm_TqW.js","assets/MemorySourceWorker-KgEBDOWH.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-xPqhWuo5.js","assets/FeaturePipelineWorker-BvhW_xfa.js","assets/diffUtils-fgzpxQR1.js","assets/AttributeStore-DhqrvGbO.js","assets/LabelMetric-C4_ysO8O.js","assets/Texture-DASi2tqQ.js","assets/Program-yzZLKfuT.js","assets/UpdateTracking2D-CTu1VHIP.js","assets/TurboLine-B33w_8gn.js","assets/earcut-BE_nt83B.js","assets/utils-D-suRMNY.js","assets/Rect-CUzevAry.js","assets/labelUtils-Bn5USrAa.js","assets/BindType-BmZEZMMh.js","assets/highlightReasons-BgVs7lRw.js","assets/constants-D5zmR9t2.js","assets/tileUtils-B7X19rIS.js","assets/geohashUtils-1usQc00_.js","assets/ogcFeatureUtils-DUnUgu7m.js","assets/CircularArray-DfLrgW_-.js","assets/createConnection-BC6dg2CS.js","assets/PointCloudWorker-fvUFFPrU.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-BpEEy17g.js","assets/ColorStop-kmOxYXoo.js","assets/I3SBinaryReader-6JvuPN_5.js","assets/orientedBoundingBox-DeKDZA8-.js","assets/plane-DCNYBJz2.js","assets/RasterWorker-BpLUQKL7.js","assets/dataUtils-AKBkC5Nh.js","assets/RasterSymbolizer-Dp9C4Z22.js","assets/utils-CvfrnSWY.js","assets/colorRamps-DhJcdkfR.js","assets/rasterProjectionHelper-CZQW3Ukf.js","assets/SceneLayerSnappingSourceWorker-BZ5COJN8.js","assets/lineSegment-DExdOtwV.js","assets/ObjectStack-DOwPphvH.js","assets/sphere-B2cX4EXN.js","assets/SceneLayerWorker-DUoc0SDc.js","assets/I3SUtil-BWwUuQM2.js","assets/symbolColorUtils-4nNIjaUf.js","assets/WFSSourceWorker-CYWkEHWV.js","assets/wfsUtils-BJFvngrZ.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-yI6tWdvc.js","assets/config-MDUrh2eL.js","assets/SourceLayerData-B4NM1afl.js","assets/Popup-DTYUVOhB.js","assets/AttachmentInfo-DHAjsneo.js","assets/AttachmentQuery-BwdO7QlU.js","assets/utils-CgPRRJBl.js","assets/jsonUtils-BDNoECDQ.js","assets/UniqueValueRenderer-Db9sUOyZ.js","assets/sizeVariableUtils-Cmcuvw-4.js","assets/visualVariableUtils-DDjNLysZ.js","assets/jsonUtils-Bjth_OpO.js","assets/styleUtils-SCppMNco.js","assets/Version-CdqhQSrt.js","assets/OverrideHelper-B5dmSQUK.js","assets/executeQueryJSON-DbHm6NQh.js","assets/FeatureSet-0biTOVdJ.js","assets/RelationshipQuery-qrnuPRdI.js","assets/TopFeaturesQuery-C_sN1XFP.js","assets/FeatureLayer-BH3vZrqL.js","assets/FormTemplate-C9-JwQbm.js","assets/editsZScale-D04apJz7.js","assets/EditBusLayer-sRDxpFC_.js","assets/FeatureEffectLayer-U4nk06V-.js","assets/FeatureEffect-DqDNQrx3.js","assets/FeatureLayerBase-CV9q5jlM.js","assets/featureLayerUtils-BIEwX0G9.js","assets/LayerFloorInfo-hL9b5Wl-.js","assets/serviceCapabilitiesUtils-9LrjFd34.js","assets/FeatureReductionLayer-CjhR-Bgm.js","assets/FeatureReductionSelection-BxMrH1xb.js","assets/LabelClass-cqu0JSwS.js","assets/MD5-C9MwAd2G.js","assets/OrderedLayer-FpP5WV_E.js","assets/OrderByInfo-Clk5ERKI.js","assets/RefreshableLayer-DTeG04wQ.js","assets/TemporalLayer-D7h2Uxh4.js","assets/TimeInfo-D1gQEk4K.js","assets/FeatureTemplate-CFX0WQg9.js","assets/FeatureType-D-TJvk96.js","assets/fieldProperties-bs9C4id8.js","assets/labelingInfo-C5MDYU6p.js","assets/versionUtils-BVbEQHzW.js","assets/popupUtils-DZKKwbMJ.js","assets/interfaces-CL2NbQte.js","assets/arcadeUtils-DMrFbmdl.js","assets/ImmutableArray-BlMso3qf.js","assets/webStyleSymbolUtils-1gcc6uYW.js","assets/devEnvironmentUtils-Blrp8lZ5.js","assets/geometryServiceUtils-DynSZflB.js","assets/project-CBAV1mNV.js","assets/webglDeps-DM1GBXs_.js","assets/NestedMap-DgiGbX8E.js","assets/ProgramTemplate-B4AaAlzo.js","assets/mapViewDeps-ChYiU5J0.js","assets/SDFHelper-DnJbe5pE.js","assets/floatRGBA-Ct_AMu3S.js","assets/Container-Dhv7DQhg.js","assets/WGLContainer-CRqPiawA.js","assets/MagnifierPrograms-RM1FMOlY.js","assets/testSVGPremultipliedAlpha-CB6kchyE.js","assets/RenderingContext-DF2bYn_c.js","assets/OrderIndependentTransparency-BUi8VGkl.js","assets/basicInterfaces-GbxEOYtk.js","assets/doublePrecisionUtils-B0owpBza.js","assets/imageUtils-CSJA67SQ.js","assets/rasterizingUtils-kJSy5UdR.js","assets/utils-BD_PFGZI.js","assets/FeatureCommandQueue-D6apjyMF.js","assets/GraphicsView2D-6ywA_gdd.js","assets/normalizeUtilsSync-Dq3l-SUn.js","assets/GraphicContainer-CyHXxEmQ.js","assets/AGraphicContainer-DanNnUbj.js","assets/TechniqueInstance-BUDIR5l_.js","assets/TileContainer-DjBM2GPe.js","assets/requestImageUtils-DI1qEbhc.js","assets/TileLayerView2D-DJ6Rypzj.js","assets/imageUtils-CBxKdZgN.js","assets/Bitmap-C4RjNtnl.js","assets/LayerView-B_829eEs.js","assets/scaleUtils-DsCdpSn1.js","assets/HighlightGraphicContainer-DdA_gRus.js","assets/RefreshableLayerView-zxY1HG8t.js","assets/drapedUtils-DyKBpCL6.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/sublayerUtils-B5Nb7E8P.js","assets/popupUtils-7m2OXfKA.js","assets/FeatureLayerView2D-BoiUVKcw.js","assets/HighlightCounter-BGAQgnuC.js","assets/BaseDynamicLayerView2D-B_XLh1jP.js","assets/BitmapContainer-BtRxxCVd.js","assets/ExportStrategy-BJSHxvkn.js","assets/CatalogLayerView2D-DoTxRGOR.js","assets/CatalogDynamicGroupLayerView2D-BU3bk_9-.js","assets/CatalogFootprintLayerView2D-BZQR95V6.js","assets/GeoRSSLayerView2D-Ctuffmjc.js","assets/GraphicsLayerView2D-Co8l_XgP.js","assets/GroupLayerView2D-n0y23QYl.js","assets/ImageryLayerView2D-x7cFwFOL.js","assets/RasterVFDisplayObject-B4HxGQOP.js","assets/ImageryTileLayerView2D-BawVA14J.js","assets/multidimensionalUtils-fyg222vf.js","assets/rasterUtils-Cq6gODF9.js","assets/RawBlockCache-wfXAk26U.js","assets/KMLLayerView2D-DC5lMTou.js","assets/kmlUtils-COlkBm4d.js","assets/KnowledgeGraphLayerView2D-CzKHXsfS.js","assets/MapImageLayerView2D-B2lmoKCZ.js","assets/ExportImageParameters-Dc-rxns1.js","assets/MapNotesLayerView2D-CUb7TNIv.js","assets/MediaLayerView2D-6-EEL1H4.js","assets/perspectiveUtils-CrTA7nZG.js","assets/OGCFeatureLayerView2D-DWMV6LhB.js","assets/RouteLayerView2D-D1IPiUON.js","assets/Stop-Ce-KElUd.js","assets/StreamLayerView2D-BMC1PqzZ.js","assets/SubtypeGroupLayerView2D-BHccqcGi.js","assets/VectorTileLayerView2D-BqM7G4-c.js","assets/VideoLayerView2D-9hPOZs0X.js","assets/GraphicsLayer-DIMhbxLQ.js","assets/WMSLayerView2D-viidgZbE.js","assets/ExportWMSImageParameters-BKM5O7Hp.js","assets/WMTSLayerView2D-BnsRV5hS.js","assets/calcite-button-BA7HVptJ.js","assets/form-BJ01g2zt.js","assets/dom-DPsTWDAQ.js","assets/guid-DQtJl1SZ.js","assets/interactive-CeFRTDVH.js","assets/label2-BT0TPJM3.js","assets/component-WqEOSVCt.js","assets/loadable-DNOb16g5.js","assets/t9n-B6vy87TJ.js","assets/observers-lRYnhwYN.js","assets/icon-O2bQTY41.js","assets/loader-BE3lkRGl.js","assets/calcite-icon-CXYzQYRv.js","assets/layersLoader-yL6SG8Ib.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
var HV=Object.defineProperty;var WV=(e,t,i)=>t in e?HV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var aS=(e,t,i)=>(WV(e,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();function Dn(){}function ZV(e,t){for(const i in t)e[i]=t[i];return e}function u5(e){return e()}function VC(){return Object.create(null)}function Tp(e){e.forEach(u5)}function GM(e){return typeof e=="function"}function Ka(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function YV(e){return Object.keys(e).length===0}function h5(e,...t){if(e==null){for(const r of t)r(void 0);return Dn}const i=e.subscribe(...t);return i.unsubscribe?()=>i.unsubscribe():i}function zb(e){let t;return h5(e,i=>t=i)(),t}function Fc(e,t,i){e.$$.on_destroy.push(h5(t,i))}function JV(e,t,i,r){if(e){const s=d5(e,t,i,r);return e[0](s)}}function d5(e,t,i,r){return e[1]&&r?ZV(i.ctx.slice(),e[1](r(t))):i.ctx}function KV(e,t,i,r){if(e[2]&&r){const s=e[2](r(i));if(t.dirty===void 0)return s;if(typeof s=="object"){const n=[],c=Math.max(t.dirty.length,s.length);for(let o=0;o<c;o+=1)n[o]=t.dirty[o]|s[o];return n}return t.dirty|s}return t.dirty}function XV(e,t,i,r,s,n){if(s){const c=d5(t,i,r,n);e.p(c,s)}}function QV(e){if(e.ctx.length>32){const t=[],i=e.ctx.length/32;for(let r=0;r<i;r++)t[r]=-1;return t}return-1}function GC(e){return e??""}function lS(e,t,i){return e.set(i),t}function e7(e){return e&&GM(e.destroy)?e.destroy:Dn}const t7=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function xs(e,t){e.appendChild(t)}function Xo(e,t,i){e.insertBefore(t,i||null)}function vo(e){e.parentNode&&e.parentNode.removeChild(e)}function Pn(e){return document.createElement(e)}function i7(e){return document.createTextNode(e)}function $n(){return i7(" ")}function bT(e,t,i,r){return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i,r)}function os(e,t,i){i==null?e.removeAttribute(t):e.getAttribute(t)!==i&&e.setAttribute(t,i)}function r7(e){return Array.from(e.childNodes)}function qC(e,t){e.value=t??""}function HC(e,t,i){e.classList.toggle(t,!!i)}function s7(e,t,{bubbles:i=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:i,cancelable:r})}let R0;function l0(e){R0=e}function a_(){if(!R0)throw new Error("Function called outside component initialization");return R0}function qM(e){a_().$$.on_mount.push(e)}function Fm(e){a_().$$.on_destroy.push(e)}function n7(){const e=a_();return(t,i,{cancelable:r=!1}={})=>{const s=e.$$.callbacks[t];if(s){const n=s7(t,i,{cancelable:r});return s.slice().forEach(c=>{c.call(e,n)}),!n.defaultPrevented}return!0}}function o7(e,t){return a_().$$.context.set(e,t),t}function a7(e){return a_().$$.context.get(e)}const Pf=[],wm=[];let am=[];const wT=[],l7=Promise.resolve();let xT=!1;function c7(){xT||(xT=!0,l7.then(p5))}function ST(e){am.push(e)}function TT(e){wT.push(e)}const cS=new Set;let vf=0;function p5(){if(vf!==0)return;const e=R0;do{try{for(;vf<Pf.length;){const t=Pf[vf];vf++,l0(t),u7(t.$$)}}catch(t){throw Pf.length=0,vf=0,t}for(l0(null),Pf.length=0,vf=0;wm.length;)wm.pop()();for(let t=0;t<am.length;t+=1){const i=am[t];cS.has(i)||(cS.add(i),i())}am.length=0}while(Pf.length);for(;wT.length;)wT.pop()();xT=!1,cS.clear(),l0(e)}function u7(e){if(e.fragment!==null){e.update(),Tp(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ST)}}function h7(e){const t=[],i=[];am.forEach(r=>e.indexOf(r)===-1?t.push(r):i.push(r)),i.forEach(r=>r()),am=t}const Dv=new Set;let qd;function f5(){qd={r:0,c:[],p:qd}}function m5(){qd.r||Tp(qd.c),qd=qd.p}function Dr(e,t){e&&e.i&&(Dv.delete(e),e.i(t))}function ds(e,t,i,r){if(e&&e.o){if(Dv.has(e))return;Dv.add(e),qd.c.push(()=>{Dv.delete(e),r&&(i&&e.d(1),r())}),e.o(t)}else r&&r()}function ET(e,t,i){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=i,i(e.$$.ctx[r]))}function Kn(e){e&&e.c()}function Rn(e,t,i){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,i),ST(()=>{const n=e.$$.on_mount.map(u5).filter(GM);e.$$.on_destroy?e.$$.on_destroy.push(...n):Tp(n),e.$$.on_mount=[]}),s.forEach(ST)}function On(e,t){const i=e.$$;i.fragment!==null&&(h7(i.after_update),Tp(i.on_destroy),i.fragment&&i.fragment.d(t),i.on_destroy=i.fragment=null,i.ctx=[])}function d7(e,t){e.$$.dirty[0]===-1&&(Pf.push(e),c7(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Fl(e,t,i,r,s,n,c=null,o=[-1]){const p=R0;l0(e);const g=e.$$={fragment:null,ctx:[],props:n,update:Dn,not_equal:s,bound:VC(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(p?p.$$.context:[])),callbacks:VC(),dirty:o,skip_bound:!1,root:t.target||p.$$.root};c&&c(g.root);let S=!1;if(g.ctx=i?i(e,t.props||{},(M,A,...O)=>{const z=O.length?O[0]:A;return g.ctx&&s(g.ctx[M],g.ctx[M]=z)&&(!g.skip_bound&&g.bound[M]&&g.bound[M](z),S&&d7(e,M)),A}):[],g.update(),S=!0,Tp(g.before_update),g.fragment=r?r(g.ctx):!1,t.target){if(t.hydrate){const M=r7(t.target);g.fragment&&g.fragment.l(M),M.forEach(vo)}else g.fragment&&g.fragment.c();t.intro&&Dr(e.$$.fragment),Rn(e,t.target,t.anchor),p5()}l0(p)}class Bl{constructor(){aS(this,"$$");aS(this,"$$set")}$destroy(){On(this,1),this.$destroy=Dn}$on(t,i){if(!GM(i))return Dn;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(i),()=>{const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!YV(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const p7="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(p7);const bf=[];function uS(e,t){return{subscribe:Jo(e,t).subscribe}}function Jo(e,t=Dn){let i;const r=new Set;function s(o){if(Ka(e,o)&&(e=o,i)){const p=!bf.length;for(const g of r)g[1](),bf.push(g,e);if(p){for(let g=0;g<bf.length;g+=2)bf[g][0](bf[g+1]);bf.length=0}}}function n(o){s(o(e))}function c(o,p=Dn){const g=[o,p];return r.add(g),r.size===1&&(i=t(s,n)||Dn),o(e),()=>{r.delete(g),r.size===0&&i&&(i(),i=null)}}return{set:s,update:n,subscribe:c}}const lm=Jo({center:[-118.805,34.027],zoom:13}),IT=Jo("https://basemaps.arcgis.com/arcgis/rest/services/World_Basemap_v2/VectorTileServer"),f7=Jo("https://basemaps.cartocdn.com/gl/positron-gl-style/style.json");function v(e,t,i,r){var s,n=arguments.length,c=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(c=(n<3?s(c):n>3?s(t,i,c):s(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c}function Ime(e,t){return function(i,r){t(i,r,e)}}function Mme(e,t,i,r){function s(n){return n instanceof i?n:new i(function(c){c(n)})}return new(i||(i=Promise))(function(n,c){function o(S){try{g(r.next(S))}catch(M){c(M)}}function p(S){try{g(r.throw(S))}catch(M){c(M)}}function g(S){S.done?n(S.value):s(S.value).then(o,p)}g((r=r.apply(e,t||[])).next())})}const m7="modulepreload",y7=function(e){return"/esri-style-ft-mapbox-style/"+e},WC={},ht=function(t,i,r){let s=Promise.resolve();if(i&&i.length>0){const n=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),o=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=Promise.all(i.map(p=>{if(p=y7(p),p in WC)return;WC[p]=!0;const g=p.endsWith(".css"),S=g?'[rel="stylesheet"]':"";if(!!r)for(let O=n.length-1;O>=0;O--){const z=n[O];if(z.href===p&&(!g||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${S}`))return;const A=document.createElement("link");if(A.rel=g?"stylesheet":m7,g||(A.as="script",A.crossOrigin=""),A.href=p,o&&A.setAttribute("nonce",o),document.head.appendChild(A),g)return new Promise((O,z)=>{A.addEventListener("load",O),A.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${p}`)))})}))}return s.then(()=>t()).catch(n=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n})};let rh;function Le(e){return typeof rh[e]=="function"?rh[e]=rh[e](globalThis):rh[e]}var i5,r5,s5,n5;rh=(i5=globalThis.dojoConfig)!=null&&i5.has||(r5=globalThis.esriConfig)!=null&&r5.has?{...(s5=globalThis.dojoConfig)==null?void 0:s5.has,...(n5=globalThis.esriConfig)==null?void 0:n5.has}:{},Le.add=(e,t,i,r)=>((r||rh[e]===void 0)&&(rh[e]=t),i&&Le(e)),Le.cache=rh,Le.add("big-integer-warning-enabled",!0),Le.add("esri-deprecation-warnings",!0),Le.add("esri-tests-disable-screenshots",!1),Le.add("esri-tests-use-full-window",!1),Le.add("esri-tests-post-to-influx",!0),(()=>{var t;Le.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const e=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(Le.add("host-browser",e),Le.add("host-node",typeof globalThis.process=="object"&&((t=globalThis.process.versions)==null?void 0:t.node)&&globalThis.process.versions.v8),Le.add("dom",e),Le("host-browser")){const i=navigator,r=i.userAgent,s=i.appVersion,n=parseFloat(s);if(Le.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),Le.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),Le.add("khtml",s.includes("Konqueror")?n:void 0),Le.add("edge",parseFloat(r.split("Edge/")[1])||void 0),Le.add("opr",parseFloat(r.split("OPR/")[1])||void 0),Le.add("webkit",!Le("wp")&&!Le("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),Le.add("chrome",!Le("edge")&&!Le("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),Le.add("android",!Le("wp")&&parseFloat(r.split("Android ")[1])||void 0),Le.add("safari",!s.includes("Safari")||Le("wp")||Le("chrome")||Le("android")||Le("edge")||Le("opr")?void 0:parseFloat(s.split("Version/")[1])),Le.add("mac",s.includes("Macintosh")),!Le("wp")&&/(iPhone|iPod|iPad)/.test(r)){const c=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",p=parseFloat(o.replace(/_/,".").replaceAll("_",""));Le.add(c,p),Le.add("ios",p)}Le("webkit")||(!r.includes("Gecko")||Le("wp")||Le("khtml")||Le("edge")||Le.add("mozilla",n),Le("mozilla")&&Le.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e),i=/iPhone/i.test(e);t&&Le.add("esri-mobile",t),i&&Le.add("esri-iPhone",i),Le.add("esri-geolocation",!!navigator.geolocation)}Le.add("esri-wasm","WebAssembly"in globalThis),Le.add("esri-performance-mode-frames-between-render",20),Le.add("esri-force-performance-mode",!1),Le.add("esri-shared-array-buffer",()=>{const e="SharedArrayBuffer"in globalThis,t=globalThis.crossOriginIsolated===!1;return e&&!t}),Le.add("wasm-simd",()=>{const e=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(e))}),Le.add("esri-atomics","Atomics"in globalThis),Le.add("esri-workers","Worker"in globalThis),Le.add("web-feat:cache","caches"in globalThis),Le.add("esri-workers-arraybuffer-transfer",!Le("safari")||Number(Le("safari"))>=12),Le.add("workers-pool-size",8),Le.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),Le.add("featurelayer-simplify-payload-size-factors",[1,1,4]),Le.add("featurelayer-fast-triangulation-enabled",!0),Le.add("featurelayer-animation-enabled",!0),Le.add("featurelayer-snapshot-enabled",!0),Le.add("featurelayer-snapshot-point-min-threshold",8e4),Le.add("featurelayer-snapshot-point-max-threshold",4e5),Le.add("featurelayer-snapshot-point-coverage",.1),Le.add("featurelayer-query-max-depth",4),Le.add("featurelayer-query-pausing-enabled",!1),Le.add("hittest-2d-mobile-tolerance",3),Le.add("hittest-2d-desktop-tolerance",1),Le.add("hittest-2d-small-symbol-tolerance",3),Le.add("hittest-2d-small-symbol-tolerance-threshold",3),Le.add("featurelayer-advanced-symbols",!1),Le.add("featurelayer-pbf",!0),Le.add("featurelayer-pbf-statistics",!1),Le.add("feature-layers-workers",!0),Le.add("feature-polyline-generalization-factor",1),Le.add("mapview-transitions-duration",200),Le.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),Le.add("mapserver-pbf-version-support",10.81),Le.add("mapservice-popup-identify-max-tolerance",20),Le("host-webworker")||Le("host-browser")&&(Le.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),Le.add("esri-image-decode",()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then(()=>{Le.add("esri-image-decode",!0,!0,!0)}).catch(()=>{Le.add("esri-image-decode",!1,!0,!0)})}return!1}),Le.add("esri-url-encodes-apostrophe",()=>{const e=window.document.createElement("a");return e.href="?'",e.href.includes("?%27")}))})();let hS=class ad{constructor(t=1){this._seed=t}set seed(t){this._seed=t??Math.random()*ad._m}getInt(){return this._seed=(ad._a*this._seed+ad._c)%ad._m,this._seed}getFloat(){return this.getInt()/(ad._m-1)}getIntRange(t,i){return Math.round(this.getFloatRange(t,i))}getFloatRange(t,i){const r=i-t;return t+this.getInt()/ad._m*r}};hS._m=2147483647,hS._a=48271,hS._c=0;function Ame(e,t){for(let i=e.length-1;i>=0;i--){const r=e[i];if(t(r))return r}}function Pme(e,t){return t?e.filter((i,r,s)=>s.findIndex(t.bind(null,i))===r):Array.from(new Set(e))}function Qw(e,t,i){if(e==null&&t==null)return!0;if(e==null||t==null||e.length!==t.length)return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Cme(e,t){let i=e.length!==t.length;i&&(e.length=t.length);for(let r=0;r<t.length;++r)e[r]!==t[r]&&(e[r]=t[r],i=!0);return i}function ZC(e,t,i){let r,s;return i?(r=t.filter(n=>!e.some(c=>i(c,n))),s=e.filter(n=>!t.some(c=>i(c,n)))):(r=t.filter(n=>!e.includes(n)),s=e.filter(n=>!t.includes(n))),{added:r,removed:s}}function $me(e){return e&&typeof e.length=="number"}const g7=!!Array.prototype.fill;function _7(e,t){if(g7)return new Array(e).fill(t);const i=new Array(e);for(let r=0;r<e;r++)i[r]=t;return i}function kme(e,t){t===void 0&&(t=e,e=0);const i=new Array(t-e);for(let r=e;r<t;r++)i[r-e]=r;return i}let y5=class{constructor(){this.last=0}};const g5=new y5;function MT(e,t,i,r){r=r||g5;const s=Math.max(0,r.last-10);for(let c=s;c<i;++c)if(e[c]===t)return r.last=c,c;const n=Math.min(s,i);for(let c=0;c<n;++c)if(e[c]===t)return r.last=c,c;return-1}function v7(e,t,i,r){const s=i??e.length,n=MT(e,t,s,r);if(n!==-1)return e[n]=e[s-1],i==null&&e.pop(),t}const va=new Set;function b7(e,t,i=e.length,r=t.length,s,n){if(r===0||i===0)return i;va.clear();for(let o=0;o<r;++o)va.add(t[o]);s=s||g5;const c=Math.max(0,s.last-10);for(let o=c;o<i;++o)if(va.has(e[o])&&(n==null||n.push(e[o]),va.delete(e[o]),e[o]=e[i-1],--i,--o,va.size===0||i===0))return va.clear(),i;for(let o=0;o<c;++o)if(va.has(e[o])&&(n==null||n.push(e[o]),va.delete(e[o]),e[o]=e[i-1],--i,--o,va.size===0||i===0))return va.clear(),i;return va.clear(),i}function w7(e,t){const i=e.indexOf(t);return i!==-1?(e.splice(i,1),t):null}function O0(e,t){return e!=null}function _5(e){return 32+e.length}function HM(){return 16}function Ome(e){if(!e)return 0;let t=b5;for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];switch(typeof r){case"string":t+=_5(r);break;case"number":t+=HM();break;case"boolean":t+=4}}return t}function x7(e){if(!e)return 0;if(Array.isArray(e))return S7(e);let t=b5;for(const i in e)e.hasOwnProperty(i)&&(t+=v5(e[i]));return t}function S7(e){const t=e.length;if(t===0||typeof e[0]=="number")return 32+8*t;let i=w5;for(let r=0;r<t;r++)i+=v5(e[r]);return i}function v5(e){switch(typeof e){case"object":return x7(e);case"string":return _5(e);case"number":return HM();case"boolean":return 4;default:return 8}}function T7(e,t){return w5+e.length*t}const b5=32,w5=16;function E7(e){return e instanceof ArrayBuffer}function WM(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Int8Array"}function x5(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Uint8Array"}function ZM(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Uint8ClampedArray"}function YM(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Int16Array"}function S5(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Uint16Array"}function JM(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Int32Array"}function T5(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Uint32Array"}function ex(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Float32Array"}function tx(e){var t;return((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="Float64Array"}function I7(e){return!("buffer"in e)}function M7(...e){return e.reduce((t,i)=>t+(i?I7(i)?T7(i,HM()):i.byteLength+A7:0),0)}const A7=145,P7=1024;function Lme(e){return tx(e)||ex(e)||JM(e)||YM(e)||WM(e)}function Dme(e){return tx(e)||ex(e)}function Nme(e){return tx(e)?179769e303:ex(e)?3402823e32:T5(e)?4294967295:S5(e)?65535:x5(e)||ZM(e)?255:JM(e)?2147483647:YM(e)?32767:WM(e)?127:256}function E5(e,t){let i;if(t)for(i in e)e.hasOwnProperty(i)&&(e[i]===void 0?delete e[i]:e[i]instanceof Object&&E5(e[i],!0));else for(i in e)e.hasOwnProperty(i)&&e[i]===void 0&&delete e[i];return e}function He(e){if(!e||typeof e!="object"||typeof e=="function")return e;const t=A5(e);if(t!=null)return t;if(Fb(e))return e.clone();if(I5(e))return e.map(He);if(M5(e))return e.clone();const i={};for(const r of Object.getOwnPropertyNames(e))i[r]=He(e[r]);return i}function AT(e){if(!e||typeof e!="object"||typeof e=="function"||"HTMLElement"in globalThis&&e instanceof HTMLElement)return e;const t=A5(e);if(t!=null)return t;if(I5(e)){let i=!0;const r=e.map(s=>{const n=AT(s);return s!=null&&n==null&&(i=!1),n});return i?r:null}if(Fb(e))return e.clone();if(e instanceof File||e instanceof Blob)return e;if(!M5(e)){const i=new(Object.getPrototypeOf(e)).constructor;for(const r of Object.getOwnPropertyNames(e)){const s=e[r],n=AT(s);if(s!=null&&n==null)return null;i[r]=n}return i}return null}function Fb(e){return typeof e.clone=="function"}function I5(e){return typeof e.map=="function"&&typeof e.forEach=="function"}function M5(e){return typeof e.notifyChange=="function"&&typeof e.watch=="function"}function YC(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function A5(e){if(WM(e)||x5(e)||ZM(e)||YM(e)||S5(e)||JM(e)||T5(e)||ex(e)||tx(e))return e.slice();if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;for(const[i,r]of e)t.set(i,He(r));return t}if(e instanceof Set){const t=new Set;for(const i of e)t.add(He(i));return t}return null}function KM(e,t){return e===t||typeof e=="number"&&isNaN(e)&&typeof t=="number"&&isNaN(t)||typeof(e==null?void 0:e.getTime)=="function"&&typeof(t==null?void 0:t.getTime)=="function"&&e.getTime()===t.getTime()||!1}function P5(e,t){return e===t||(e==null||typeof e=="string"?e===t:typeof e=="number"?e===t||typeof t=="number"&&isNaN(e)&&isNaN(t):e instanceof Date?t instanceof Date&&e.getTime()===t.getTime():Array.isArray(e)?Array.isArray(t)&&Qw(e,t):e instanceof Set?t instanceof Set&&$7(e,t):e instanceof Map?t instanceof Map&&k7(e,t):!!YC(e)&&YC(t)&&C7(e,t))}function C7(e,t){if(e===null||t===null)return!1;const i=Object.keys(e);if(t===null||Object.keys(t).length!==i.length)return!1;for(const r of i)if(e[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1;return!0}function $7(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function k7(e,t){if(e.size!==t.size)return!1;for(const[i,r]of e){const s=t.get(i);if(s!==r||s===void 0&&!t.has(i))return!1}return!0}function R7(e,t,i=!1){return $5(e,t,i)}function ix(e,t){if(t!=null)return t[e]||C5(e.split("."),!1,t)}function Ep(e,t,i){const r=e.split("."),s=r.pop(),n=C5(r,!0,i);n&&s&&(n[s]=t)}function C5(e,t,i){let r=i;for(const s of e){if(r==null)return;if(!(s in r)){if(!t)return;r[s]={}}r=r[s]}return r}function $5(e,t,i){return t?Object.keys(t).reduce((r,s)=>{let n=r[s],c=t[s];return n===c?r:n===void 0?(r[s]=He(c),r):(Array.isArray(c)||Array.isArray(r)?(n=n?Array.isArray(n)?r[s]=n.concat():r[s]=[n]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),i?c.forEach(o=>{n.includes(o)||n.push(o)}):r[s]=c.concat())):c&&typeof c=="object"?r[s]=$5(n,c,i):r.hasOwnProperty(s)&&!t.hasOwnProperty(s)||(r[s]=c),r)},e||{}):e}var o5;const Pi={apiKey:void 0,applicationName:"",applicationUrl:(o5=globalThis.location)==null?void 0:o5.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(R7(Pi,globalThis.esriConfig,!0),delete Pi.has),!Pi.assetsPath){{const e="4.29";Pi.assetsPath=`https://js.arcgis.com/${e}/@arcgis/core/assets`}Pi.defaultAssetsPath=Pi.assetsPath}const O7=/\{([^\}]+)\}/g;function JC(e){return e??""}function k5(e,t){return t?e.replaceAll(O7,typeof t=="object"?(i,r)=>JC(ix(r,t)):(i,r)=>JC(t(r))):e}function zme(e,t){return e.replaceAll(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,i=>t&&t.includes(i)?i:`\\${i}`)}function R5(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}function Fme(e){return new DOMParser().parseFromString(e||"","text/html").body.innerText||""}function Bme(e,t){return new RegExp(`{${t}}`,"ig").test(e)}const KC={info:0,warn:1,error:2,none:3};let _t=class an{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},t.level!=null&&(this.level=t.level),t.writer!=null&&(this.writer=t.writer),this._module=t.module,an._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=an.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(t=new Map){const i=an._loggers;return an._loggers=t,i},set throttlingDisabled(t){an._throttlingDisabled=t}}}static getLogger(t){return t=typeof t!="string"?t.declaredClass:t,an._loggers.get(t)||new an({module:t})}_log(t,i,...r){if(this._matchLevel(t)){if(i!=="always"&&!an._throttlingDisabled){const s=this._argsToKey(r),n=this._loggedMessages[t].get(s);if(i==="once"&&n!=null||i==="oncePerTick"&&n&&n>=an._tickCounter)return;this._loggedMessages[t].set(s,an._tickCounter),an._scheduleTickCounterIncrement()}for(const s of Pi.log.interceptors)if(s(t,this.module,...r))return;this._inheritedWriter()(t,this.module,...r)}}_parentWithMember(t,i){let r=this;for(;r!=null;){const s=r[t];if(s!=null)return s;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,i,...r){console[t](`[${i}]`,...r)}_matchLevel(t){const i=Pi.log.level||"warn";return KC[this._parentWithMember("level",i)]<=KC[t]}_argsToKey(...t){return R5(JSON.stringify(t,(r,s)=>typeof s!="object"||Array.isArray(s)?s:"[Object]"))}static _scheduleTickCounterIncrement(){an._tickCounterScheduled||(an._tickCounterScheduled=!0,Promise.resolve().then(()=>{an._tickCounter++,an._tickCounterScheduled=!1}))}};_t._loggers=new Map,_t._tickCounter=0,_t._tickCounterScheduled=!1,_t._throttlingDisabled=!1;function L7(e,t){return e.replaceAll(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(i,r)=>r===""?"$":(ix(r,t)??"").toString())}let O5=class{constructor(t,i,r){this.name=t,this.details=r,this.message=(i&&L7(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},Je=class L5 extends O5{constructor(t,i,r){super(t,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(t,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return He(i)}catch{return"[object]"}}))}}catch(t){throw _t.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new L5(t.name,t.message,t.details)}};Je.prototype.type="error";const XC=new WeakMap;function D7(e,t,i=!1){const r=`🛑 DEPRECATED - ${t}`;if(!i)return void e.warn(r);let s=XC.get(e);s||(s=new Set,XC.set(e,s)),s.has(t)||(s.add(t),e.warn(r))}function D5(e,t,i={}){if(Le("esri-deprecation-warnings")){const{moduleName:r}=i;xm(e,`Function: ${(r?r+"::":"")+t+"()"}`,i)}}function jme(e,t,i={}){if(Le("esri-deprecation-warnings")){const{moduleName:r}=i;xm(e,`Property: ${(r?r+"::":"")+t}`,i)}}function xm(e,t,i={}){if(Le("esri-deprecation-warnings")){const{replacement:r,version:s,see:n,warnOnce:c}=i;let o=t;r&&(o+=`
	🛠️ Replacement: ${r}`),s&&(o+=`
	⚙️ Version: ${s}`),n&&(o+=`
	🔗 See ${n} for more details.`),D7(e,o,c)}}function Vme(e){const t=[];return function*(){yield*t;for(const i of e)t.push(i),yield i}}function N7(e,t){for(const i of e)if(i!=null&&t(i))return i}function Bb(e){return e!=null&&typeof e[Symbol.iterator]=="function"}let XM=class PT{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach(i=>{t+=i.length}),t}add(t,i){if(Bb(t)){const r=this._getOrCreateGroup(i);for(const s of t)this._isHandle(s)&&r.push(s)}else this._isHandle(t)&&this._getOrCreateGroup(i).push(t);return this}forEach(t,i){if(typeof t=="function")this._groups.forEach(r=>r.forEach(t));else{const r=this._getGroup(t);r&&i&&r.forEach(i)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(typeof t!="string"&&Bb(t)){for(const i of t)this.remove(i);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach(t=>this._removeAllFromGroup(t)),this._groups.clear(),this}_isHandle(t){return t&&(!!t.remove||t instanceof PT)}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const i=[];return this._groups.set(this._ensureGroupKey(t),i),i}_getGroup(t){return this._groups.get(this._ensureGroupKey(t))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){for(const i of t)i instanceof PT?i.removeAll():i.remove()}};function N5(e,t){if(e==null)throw new Error(t??"value is None")}function nr(e){return e==null||e.destroy(),null}function Gme(e){return e==null||e.dispose(),null}function gr(e){return e==null||e.remove(),null}function L0(e){return e==null||e.abort(),null}function qme(e){return e==null||e.release(),null}function z7(e,t,i){return e!=null&&t!=null?i!=null?i(e,t):e.equals(t):e===t}function F7(e,t){let i;return e.some((r,s)=>(i=t(r,s),i!=null)),i??void 0}const z5=Symbol("Accessor-beforeDestroy"),B7={remove:()=>{}};function Qi(e){return e?{remove(){e&&(e(),e=void 0)}}:B7}function U7(e){e.forEach(t=>t==null?void 0:t.remove())}function l_(e){return Qi(()=>U7(e))}function So(e){return e.__accessor__??null}function j7(e,t){var i;return((i=e==null?void 0:e.metadata)==null?void 0:i[t])!=null}function Nv(e,t,i){return i?Ub(e,t,{policy:i,path:""}):Ub(e,t,null)}function Ub(e,t,i){return t?Object.keys(t).reduce((r,s)=>{const n=s;let c=null,o="merge";if(i&&(c=i.path?`${i.path}.${s}`:s,o=i.policy(c)),o==="replace"||o==="replace-arrays"&&Array.isArray(r[n]))return r[n]=t[n],r;if(r[n]===void 0)return r[n]=He(t[n]),r;let p=r[n],g=t[n];if(p===g)return r;if(Array.isArray(g)||Array.isArray(r))p=p?Array.isArray(p)?r[n]=p.concat():r[n]=[p]:r[n]=[],g&&(Array.isArray(g)||(g=[g]),g.forEach(S=>{p.includes(S)||p.push(S)}));else if(g&&typeof g=="object")if(i){const S=i.path;i.path=c,r[n]=Ub(p,g,i),i.path=S}else r[n]=Ub(p,g,null);else r.hasOwnProperty(s)&&!t.hasOwnProperty(s)||(r[n]=g);return r},e||{}):e}function F5(e){return Array.isArray(e)?e:e.split(".")}function QC(e){return e.includes(",")?e.split(",").map(t=>t.trim()):[e.trim()]}function V7(e){if(Array.isArray(e)){const t=[];for(const i of e)t.push(...QC(i));return t}return QC(e)}function B5(e,t,i,r){const s=V7(t);if(s.length!==1){const n=s.map(c=>r(e,c,i));return l_(n)}return r(e,s[0],i)}function U5(e,t){const i=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(i,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const r=So(t);return j7(r,i)?r.get(i):t[i]}function j5(e,t,i){if(e==null)return e;const r=U5(t[i],e);return!r&&i<t.length-1?void 0:i===t.length-1?r:j5(r,t,i+1)}function c_(e,t,i=0){return typeof t!="string"||t.includes(".")?j5(e,F5(t),i):U5(t,e)}function Va(e,t){return c_(e,t)}function e$(e,t){return c_(t,e)!==void 0}var Yn;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED",e[e.DESTROYED=3]="DESTROYED"})(Yn||(Yn={}));function u_(e){let t=e.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!i){t=Object.create(t);for(const r in t)t[r]=He(t[r]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function rx(e,t){const i=u_(e);let r=i[t];return r||(r=i[t]={}),r}function G7(e,t){return Nv(e,t,H7)}const q7=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function H7(e){return q7.test(e)?"replace":"merge"}function W7(e){return(e==null?void 0:e.release)&&typeof e.release=="function"}function Z7(e){return(e==null?void 0:e.acquire)&&typeof e.acquire=="function"}let Ip=class CT{constructor(t,i,r,s=1,n=0){if(this._ctor=t,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n,this._ctor)for(let c=0;c<n;c++)this._pool[c]=new this._ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...t){let i;if(CT.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let s=0;s<r;s++)this._pool[s]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...t):Z7(i)&&i.acquire(...t),i}release(t){t&&!CT.test.disabled&&(this._releaseFunction?this._releaseFunction(t):W7(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let i=t;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}};Ip.test={disabled:!1};let Y7=class{constructor(t,i){this._observers=t,this._observer=i}remove(){w7(this._observers,this._observer)}},V5=class{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return J7;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,s=!1;const n=i.length;for(let c=0;c<n;++c){const o=i[c];if(o.destroyed)s=!0;else if(o===t){r=!0;break}}return r||(i.push(t),s&&this._removeDestroyedObservers()),new Y7(i,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||t.length===0)return;const i=t.length;let r=0;for(let s=0;s<i;++s){for(;s+r<i&&t[s+r].destroyed;)++r;if(r>0){if(!(s+r<i))break;t[s]=t[s+r]}}t.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(t!=null){for(const i of t)i.onCommitted();this._observers=null}}};const J7=Qi();var pi;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.LINK_CHART=6]="LINK_CHART",e[e.USER=7]="USER"})(pi||(pi={}));const $T=pi.USER+1;function sh(e){switch(e){case"defaults":return pi.DEFAULTS;case"service":return pi.SERVICE;case"portal-item":return pi.PORTAL_ITEM;case"web-scene":return pi.WEB_SCENE;case"web-map":return pi.WEB_MAP;case"link-chart":return pi.LINK_CHART;case"user":return pi.USER;default:return null}}function jb(e){switch(e){case pi.DEFAULTS:return"defaults";case pi.SERVICE:return"service";case pi.PORTAL_ITEM:return"portal-item";case pi.WEB_SCENE:return"web-scene";case pi.WEB_MAP:return"web-map";case pi.LINK_CHART:return"link-chart";case pi.USER:return"user"}}function K7(e){return jb(e)}var Fi;(function(e){e[e.Dirty=1]="Dirty",e[e.Overridden=2]="Overridden",e[e.Computing=4]="Computing",e[e.NonNullable=8]="NonNullable",e[e.HasDefaultValue=16]="HasDefaultValue",e[e.DepTrackingInitialized=32]="DepTrackingInitialized",e[e.AutoTracked=64]="AutoTracked",e[e.ExplicitlyTracking=128]="ExplicitlyTracking"})(Fi||(Fi={}));const Vb={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},xg=[];let c0=Vb;function Ot(e){c0.onObservableAccessed(e)}let zv=!1,Fv=!1;function Bc(e,t,i){if(zv)return QM(e,t,i);G5(e);const r=t.call(i);return q5(),r}function X7(e,t){return Bc(Vb,e,t)}function QM(e,t,i){const r=zv;zv=!0,G5(e);let s=null;try{s=t.call(i)}catch(n){Fv&&_t.getLogger("esri.core.accessorSupport.tracking").error(n)}return q5(),zv=r,s}function G5(e){c0=e,xg.push(e)}function q5(){const e=xg.length;if(e>1){const t=xg.pop();c0=xg[e-2],t.onTrackingEnd()}else if(e===1){const t=xg.pop();c0=Vb,t.onTrackingEnd()}else c0=Vb}function H5(e,t){if(t.flags&Fi.DepTrackingInitialized)return;const i=Fv;Fv=!1,t.flags&Fi.AutoTracked?QM(t,t.metadata.get,e):W5(e,t),Fv=i}const Q7=[];function W5(e,t){t.flags&Fi.ExplicitlyTracking||(t.flags|=Fi.ExplicitlyTracking,QM(t,()=>{const i=t.metadata.dependsOn||Q7;for(const r of i)if(typeof r!="string"||r.includes(".")){const s=F5(r);for(let n=0,c=e;n<s.length&&c!=null&&typeof c=="object";++n)c=t$(c,s[n],n!==s.length-1)}else t$(e,r,!1)}),t.flags&=~Fi.ExplicitlyTracking)}function t$(e,t,i){const r=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(r,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const s=So(e);if(s){const n=s.propertiesByName.get(r);n&&(Ot(n),H5(e,n))}return i?e[r]:void 0}let i$=class extends V5{constructor(t,i){super(),this.propertyName=t,this.metadata=i,this._accessed=null,this._handles=null,this.flags=0,this.flags=Fi.Dirty|(i.nonNullable?Fi.NonNullable:0)|(i.hasOwnProperty("value")?Fi.HasDefaultValue:0)|(i.get===void 0?Fi.DepTrackingInitialized:0)|(i.dependsOn===void 0?Fi.AutoTracked:0)}destroy(){this.flags&Fi.Dirty&&this.onCommitted(),super.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(t){Ot(this);const i=t.store,r=this.propertyName,s=this.flags,n=i.get(r);if(s&Fi.Computing||~s&Fi.Dirty&&i.has(r))return n;this.flags|=Fi.Computing;const c=t.host;let o;s&Fi.AutoTracked?o=Bc(this,this.metadata.get,c):(W5(c,this),o=this.metadata.get.call(c)),i.set(r,o,pi.COMPUTED);const p=i.get(r);return p===n?this.flags&=~Fi.Dirty:X7(this.commit,this),this.flags&=~Fi.Computing,p}onObservableAccessed(t){if(t===this)return;let i=this._accessed;if(i==null)i=[],this._accessed=i;else if(i.includes(t))return;i.push(t)}onTrackingEnd(){this._clearObservationHandles(),this.flags|=Fi.DepTrackingInitialized;const t=this._accessed;if(t==null||t.length===0)return;let i=this._handles;i==null&&(i=[],this._handles=i);for(let r=0;r<t.length;++r)i.push(t[r].observe(this));t.length=0}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~Fi.Dirty,this.onCommitted()}_clearObservationHandles(){const t=this._handles;if(t!==null){for(let i=0;i<t.length;++i)t[i].remove();t.length=0}}onInvalidated(){~this.flags&Fi.Overridden&&(this.flags|=Fi.Dirty);const t=this._observers;if(t&&t.length>0)for(const i of t)i.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const i=t.slice();for(const r of i)r.onCommitted()}}},eG=class Z5{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new Z5;return this._values.forEach((r,s)=>{t&&t.has(s)||i.set(s,He(r))}),i}get(t){return this._values.get(t)}originOf(){return pi.USER}keys(){return[...this._values.keys()]}set(t,i){this._values.set(t,i)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}};function j1(e,t,i){return e!==void 0}function r$(e,t,i,r){return e!==void 0&&(!(i==null&&e.flags&Fi.NonNullable)||(r.lifecycle,Yn.INITIALIZING,!1))}let tG=class{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Yn.INITIALIZING,this.store=new eG,this._origin=pi.USER;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const s=new i$(r,i[r]);this.propertiesByName.set(r,s)}this.metadata=i}initialize(){this.lifecycle=Yn.CONSTRUCTING}constructed(){this.lifecycle=Yn.CONSTRUCTED}destroy(){this.lifecycle=Yn.DESTROYED,this.propertiesByName.forEach(t=>t.destroy())}get initialized(){return this.lifecycle!==Yn.INITIALIZING}get(t){const i=this.propertiesByName.get(t);if(i.metadata.get)return i.getComputed(this);Ot(i);const r=this.store;return r.has(t)?r.get(t):i.metadata.value}originOf(t){const i=this.store.originOf(t);if(i===void 0){const r=this.propertiesByName.get(t);if(r!==void 0&&r.flags&Fi.HasDefaultValue)return"defaults"}return jb(i)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const i=this.propertiesByName.get(t);if(j1(i))return this.store.has(t)?this.store.get(t):i.metadata.value}internalSet(t,i){const r=this.propertiesByName.get(t);j1(r)&&this._internalSet(r,i)}getDependsInfo(t,i,r){const s=this.propertiesByName.get(i);if(!j1(s))return"";const n=new Set,c=Bc({onObservableAccessed:p=>n.add(p),onTrackingEnd:()=>{}},()=>{var p;return(p=s.metadata.get)==null?void 0:p.call(t)});let o=`${r}${t.declaredClass.split(".").pop()}.${i}: ${c}
`;if(n.size===0)return o;r+="  ";for(const p of n)p instanceof i$&&(o+=`${r}${p.propertyName}: undefined
`);return o}setAtOrigin(t,i,r){const s=this.propertiesByName.get(t);if(j1(s))return this._setAtOrigin(s,i,r)}isOverridden(t){const i=this.propertiesByName.get(t);return i!==void 0&&!!(i.flags&Fi.Overridden)}clearOverride(t){const i=this.propertiesByName.get(t);i&&i.flags&Fi.Overridden&&(i.flags&=~Fi.Overridden,i.notifyChange())}override(t,i){const r=this.propertiesByName.get(t);if(!r$(r,t,i,this))return;const s=r.metadata.cast;if(s){const n=this._cast(s,i),{valid:c,value:o}=n;if(dS.release(n),!c)return;i=o}r.flags|=Fi.Overridden,this._internalSet(r,i)}set(t,i){const r=this.propertiesByName.get(t);if(!r$(r,t,i,this))return;const s=r.metadata.cast;if(s){const c=this._cast(s,i),{valid:o,value:p}=c;if(dS.release(c),!o)return;i=p}const n=r.metadata.set;n?n.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(t){this._origin=sh(t)}getDefaultOrigin(){return jb(this._origin)}notifyChange(t){const i=this.propertiesByName.get(t);i!==void 0&&i.notifyChange()}invalidate(t){const i=this.propertiesByName.get(t);i!==void 0&&i.invalidate()}commit(t){const i=this.propertiesByName.get(t);i!==void 0&&i.commit()}_internalSet(t,i){const r=this.lifecycle!==Yn.INITIALIZING?this._origin:pi.DEFAULTS;this._setAtOrigin(t,i,r)}_setAtOrigin(t,i,r){const s=this.store,n=t.propertyName;s.has(n,r)&&KM(i,s.get(n))&&~t.flags&Fi.Overridden&&r===s.originOf(n)||(t.invalidate(),s.set(n,i,r),t.commit(),H5(this.host,t))}_cast(t,i){const r=dS.acquire();return r.valid=!0,r.value=i,t&&(r.value=t.call(this.host,i,r)),r}},iG=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const dS=new Ip(iG);function Gb(e,t,i){if(e&&t)if(typeof t=="object")for(const r of Object.getOwnPropertyNames(t))Gb(e,r,t[r]);else{if(t.includes(".")){const s=t.split("."),n=s.splice(-1,1)[0];return void Gb(Va(e,s),n,i)}const r=e.__accessor__;r!=null&&rG(t,r),e[t]=i}}function rG(e,t){if(Le("esri-unknown-property-errors")&&!sG(e,t))throw new Je("set:unknown-property",nG(e,t))}function sG(e,t){return t.metadata[e]!=null}function nG(e,t){return"setting unknown property '"+e+"' on instance of "+t.host.declaredClass}let oG;function aG(){return oG}var s$;(function(e){e[e.Ignore=0]="Ignore",e[e.Destroy=1]="Destroy",e[e.ThrowError=2]="ThrowError"})(s$||(s$={}));function lG(e){e.length=0}let kn=class{constructor(t=50,i=50){this._pool=new Ip(Array,void 0,lG,i,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return pS.acquire()}static release(t){return pS.release(t)}static prune(){pS.prune()}};const pS=new kn(100);let Y5=class extends Ip{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const i=super.acquire(...t);return this._set.delete(i),i}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const V1=[];function qb(e){V1.push(e),V1.length===1&&queueMicrotask(()=>{const t=V1.slice();V1.length=0;for(const i of t)i()})}let J5=class{constructor(t,i=30){this.name=t,this._counter=0,this._samples=new Array(i)}record(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,i)=>t-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,i)=>t+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var kT;(function(e){const t=(n,c,o,p)=>{let g=c,S=c;const M=o>>>1,A=n[g-1];for(;S<=M;){S=g<<1,S<o&&p(n[S-1],n[S])<0&&++S;const O=n[S-1];if(p(O,A)<=0)break;n[g-1]=O,g=S}n[g-1]=A},i=(n,c)=>n<c?-1:n>c?1:0;function r(n,c,o,p){c===void 0&&(c=0),o===void 0&&(o=n.length),p===void 0&&(p=i);for(let S=o>>>1;S>c;S--)t(n,S,o,p);const g=c+1;for(let S=o-1;S>c;S--){const M=n[c];n[c]=n[S],n[S]=M,t(n,g,S,p)}}function*s(n,c,o,p){c===void 0&&(c=0),o===void 0&&(o=n.length),p===void 0&&(p=i);for(let S=o>>>1;S>c;S--)t(n,S,o,p),yield;const g=c+1;for(let S=o-1;S>c;S--){const M=n[c];n[c]=n[S],n[S]=M,t(n,g,S,p),yield}}e.sort=r,e.iterableSort=s})(kT||(kT={}));const n$=kT,cG=1.5,uG=1.1;let D0=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new y5,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>o$(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const i=new Array;for(let r=0;r<this._length;r++){const s=this.data[r];t(s)&&i.push(s)}return i}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,i){const r=this.data.indexOf(t,i);return r!==-1&&r<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let i=t;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,i=t.length){for(let r=0;r<i;r++)this.data[this._length++]=t[r]}fill(t,i){for(let r=0;r<i;r++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,o$(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const i=MT(this.data,t,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(MT(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,i=t.length,r){this.length=b7(this.data,t,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,i){if(t>=this.length||i>=this.length||t===i)return;const r=this.data[t];this.data[t]=this.data[i],this.data[i]=r}sort(t){n$.sort(this.data,0,this.length,t)}iterableSort(t){return n$.iterableSort(this.data,0,this.length,t)}some(t,i){for(let r=0;r<this.length;++r)if(t.call(i,this.data[r],r,this.data))return!0;return!1}find(t,i){for(let r=0;r<this.length;++r){const s=this.data[r];if(t.call(i,s,r))return s}}filterInPlace(t,i){let r=0;for(let s=0;s<this._length;++s){const n=this.data[s];t.call(i,n,s,this.data)&&(this.data[s]=this.data[r],this.data[r]=n,r++)}if(this._deallocator)for(let s=r;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=r,this._shrink(),this}forAll(t,i){const{data:r,length:s}=this;for(let n=0;n<s;++n)t.call(i,r[n],n,r)}forEach(t,i){this.data.slice(0,this.length).forEach(t,i)}map(t,i){const r=new Array(this.length);for(let s=0;s<this.length;++s)r[s]=t.call(i,this.data[s],s,this.data);return r}reduce(t,i){let r=i;for(let s=0;s<this.length;++s)r=t(r,this.data[s],s,this.data);return r}has(t){const i=this.length,r=this.data;for(let s=0;s<i;++s)if(r[s]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function o$(e){e.data.length>cG*e.length&&(e.data.length=Math.floor(e.length*uG))}function hG(e){return{setTimeout:(t,i)=>{const r=e.setTimeout(t,i);return Qi(()=>e.clearTimeout(r))}}}const Bm=hG(globalThis);function sx(e){return dG(e)||K5(e)}function dG(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function K5(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function h_(e,t,i){if(!sx(e))throw new TypeError("target is not a Evented or EventTarget object");return K5(e)?pG(e,t,i):e.on(t,i)}function pG(e,t,i,r){if(Array.isArray(t)){const s=t.slice();for(const n of s)e.addEventListener(n,i,r);return Qi(()=>{for(const n of s)e.removeEventListener(n,i,r)})}return e.addEventListener(t,i,r),Qi(()=>e.removeEventListener(t,i,r))}function X5(e,t,i){if(!sx(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,i);const r=h_(e,t,s=>{r.remove(),i.call(e,s)});return r}function Nr(e="Aborted"){return new Je("AbortError",e)}function dr(e,t="Aborted"){if(ra(e))throw Nr(t)}function nx(e){return e instanceof AbortSignal?e:e==null?void 0:e.signal}function ra(e){const t=nx(e);return t!=null&&t.aborted}function Na(e){if(qs(e))throw e}function a$(e){if(!qs(e))throw e}function eo(e,t){const i=nx(e);if(i!=null){if(!i.aborted)return X5(i,"abort",()=>t());t()}}function eA(e,t){const i=nx(e);if(i!=null)return dr(i),X5(i,"abort",()=>t(Nr()))}function fG(e,t){return nx(t)==null?e:new Promise((i,r)=>{let s=eo(t,()=>r(Nr()));const n=()=>{s=gr(s)};e.then(n,n),e.then(i,r)})}function qs(e){return(e==null?void 0:e.name)==="AbortError"}async function l$(e){try{return await e}catch(t){if(!qs(t))throw t;return}}async function tA(e){if(!e)return;if(typeof e.forEach!="function"){const i=Object.keys(e),r=i.map(c=>e[c]),s=await tA(r),n={};return i.map((c,o)=>n[c]=s[o]),n}const t=e;return Promise.allSettled(t).then(i=>Array.from(t,(r,s)=>{const n=i[s];return n.status==="fulfilled"?{promise:r,value:n.value}:{promise:r,error:n.reason}}))}async function mG(e){return(await Promise.allSettled(e)).filter(t=>t.status==="fulfilled").map(t=>t.value)}async function tye(e){return(await Promise.allSettled(e)).filter(t=>t.status==="rejected").map(t=>t.reason)}function Q5(e,t=void 0,i){const r=new AbortController;return eo(i,()=>r.abort()),new Promise((s,n)=>{let c=setTimeout(()=>{c=0,s(t)},e);eo(r,()=>{c&&(clearTimeout(c),n(Nr()))})})}function yG(e,t){const i=new AbortController,r=setTimeout(()=>i.abort(),t);return eo(e,()=>{i.abort(),clearTimeout(r)}),{...e,signal:i.signal}}function wh(e){return e&&typeof e.then=="function"}function c$(e){return wh(e)?e:Promise.resolve(e)}function gG(e,t=-1){let i,r,s,n,c=null;const o=(...p)=>{if(i){r=p,n&&n.reject(Nr()),n=sa();const A=n.promise;if(c){const O=c;c=null,O.abort()}return A}if(s=n||sa(),n=null,t>0){const A=new AbortController;i=c$(e(...p,A.signal));const O=i;Q5(t).then(()=>{i===O&&(n?A.abort():c=A)})}else i=1,i=c$(e(...p));const g=()=>{const A=r;r=s=i=c=null,A!=null&&o(...A)},S=i,M=s;return S.then(g,g),S.then(M.resolve,M.reject),M.promise};return o}function sa(){let e,t;const i=new Promise((s,n)=>{e=s,t=n}),r=s=>{e(s)};return r.resolve=s=>e(s),r.reject=s=>t(s),r.timeout=(s,n)=>Bm.setTimeout(()=>r.reject(n),s),r.promise=i,r}async function Hb(e){await Promise.resolve(),dr(e)}function iye(e){return e}function rye(e){return 1e3*e}function sye(e){return e}let _G=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},vG=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},RT=0;const sg={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},OT=["prepare","preRender","render","postRender","update","finish"],LT=[],cp=new D0;let bG=class{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};function wG(){ip!=null&&(cancelAnimationFrame(ip),ip=requestAnimationFrame(iA))}const Wb={frameTasks:cp,willDispatch:!1,clearFrameTasks:xG,dispatch:t4,executeFrameTasks:SG,reschedule:wG};function d_(e){const t=new vG(e);return LT.push(t),Wb.willDispatch||(Wb.willDispatch=!0,qb(t4)),t}function Sm(e){const t=new _G(e);return cp.push(t),ip==null&&(RT=performance.now(),ip=requestAnimationFrame(iA)),new bG(t)}let ip=null;function xG(e=!1){cp.forAll(t=>{t.removed=!0}),e&&e4()}function iA(){const e=performance.now();ip=null,ip=cp.length>0?requestAnimationFrame(iA):null,Wb.executeFrameTasks(e)}function SG(e){const t=e-RT;RT=e;const i=1e3/60,r=Math.max(0,t-i);sg.time=e,sg.frameDuration=i-r;for(let s=0;s<OT.length;s++){const n=performance.now(),c=OT[s];cp.forAll(o=>{var p;o.paused||o.removed||(s===0&&o.ticks++,o.phases[c]&&(sg.elapsedFrameTime=performance.now()-e,sg.deltaTime=o.ticks===0?0:t,(p=o.phases[c])==null||p.call(o,sg)))}),EG[s].record(performance.now()-n)}e4(),IG.record(performance.now()-e)}const G1=new D0;function e4(){cp.forAll(e=>{e.removed&&G1.push(e)}),cp.removeUnorderedMany(G1.data,G1.length),G1.clear()}function t4(){for(;LT.length;){const e=LT.shift();e.isActive&&e.callback()}Wb.willDispatch=!1}function TG(e=1,t){const i=sa(),r=()=>{ra(t)?i.reject(Nr()):e===0?i():(--e,qb(()=>r()))};return r(),i.promise}const EG=OT.map(e=>new J5(e)),IG=new J5("total");function MG(e,t){for(const i of e.entries())if(t(i[0]))return!0;return!1}function u$(e,t){if(!t)return e;for(const i of t)e.add(i);return e}function i4(e,t){const i=new Set;return u$(i,e),u$(i,t),i}function AG(e,t){const i=new Set;for(const r of t)e.has(r)&&i.add(r);return i}function lye(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const i of e)if(!t.has(i))return!1;return!0}function cye(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function PG(e,t){const i=new Set(e);for(const r of t)i.delete(r);return i}function CG(e,t){return PG(i4(e,t),AG(e,t))}let $G=0;function u0(){return++$G}let ox=class{constructor(t){this._accessed=[],this._handles=[],this._observerObject=new kG(t),h$.register(this,new WeakRef(this._observerObject),this)}destroy(){var t;h$.unregister(this._observerObject),this._accessed.length=0,(t=this._observerObject)==null||t.destroy(),this.clear()}onObservableAccessed(t){const i=this._accessed;i.includes(t)||i.push(t)}onTrackingEnd(){const t=this._handles,i=this._accessed,r=this._observerObject;for(let s=0;s<i.length;++s)t.push(i[s].observe(r));i.length=0}clear(){const t=this._handles;for(let i=0;i<t.length;++i)t[i].remove();t.length=0}},kG=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=RG}};const h$=new FinalizationRegistry(e=>{var t;(t=e.deref())==null||t.destroy()});function RG(){}let cm=!1;const Zb=[];function r4(e,t){let i=new ox(n),r=null,s=!1;function n(){if(!i||s)return;if(cm)return void n4(n);const o=r;i.clear(),cm=!0,s=!0,r=Bc(i,e),s=!1,cm=!1,t(r,o),o4()}function c(){i&&(i.destroy(),i=null,r=null)}return s=!0,r=Bc(i,e),s=!1,Qi(c)}function s4(e,t){let i=new ox(s),r=null;function s(){t(r,c)}function n(){i&&(i.destroy(),i=null),r=null}function c(){return i?(i.clear(),r=Bc(i,e),r):null}return c(),Qi(n)}function OG(e){let t=new ox(r),i=!1;function r(){t&&!i&&(cm?n4(r):(t.clear(),cm=!0,i=!0,Bc(t,e),i=!1,cm=!1,o4()))}function s(){t&&(t.destroy(),t=null)}return i=!0,Bc(t,e),i=!1,Qi(s)}function n4(e){Zb.includes(e)||Zb.unshift(e)}function o4(){for(;Zb.length;)Zb.pop()()}var h0;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(h0||(h0={}));let N0=class{constructor(){this.uid=u0(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,i,r,s,n){return this.pool.acquire(h0.Untracked,t,i,r,s,n,KM)}static acquireTracked(t,i,r,s){return this.pool.acquire(h0.Tracked,t,i,r,null,null,s)}notify(t,i){this.type===h0.Untracked?this.callback.call(this.target,t,i,this.path,this.target):this.callback.call(null,t,i,void 0,void 0)}acquire(t,i,r,s,n,c,o){this.uid=u0(),this.removed=!1,this.type=t,this.oldValue=i,this.callback=r,this.getValue=s,this.target=n,this.path=c,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=u0(),this.removed=!0}};N0.pool=new Y5(N0);const Bv=new kn,Lc=new Set;let Yb;function Jb(e){Lc.delete(e),Lc.add(e),Yb||(Yb=d_(NG))}function LG(e){if(e.removed)return;const t=e.oldValue,i=e.getValue();e.equals(t,i)||(e.oldValue=i,e.notify(i,t))}function DG(e){for(const t of Lc.values())t.target===e&&(t.removed=!0)}function NG(){let e=10;for(;Yb&&e--;){Yb=null;const t=zG(),i=Bv.acquire();for(const r of t){const s=r.uid;LG(r),s===r.uid&&r.removed&&i.push(r)}for(const r of Lc)r.removed&&(i.push(r),Lc.delete(r));for(const r of i)N0.pool.release(r);Bv.release(i),Bv.release(t),DT.forEach(r=>r())}}function zG(){const e=Bv.acquire();e.length=Lc.size;let t=0;for(const i of Lc)e[t]=i,++t;return Lc.clear(),e}const DT=new Set;function FG(e){return DT.add(e),Qi(()=>DT.delete(e))}function BG(e,t,i){let r=B5(e,t,i,(s,n,c)=>{let o,p,g=s4(()=>c_(s,n),(S,M)=>{var A;((A=s.__accessor__)==null?void 0:A.lifecycle)===Yn.DESTROYED||o&&o.uid!==p?r.remove():(o||(o=N0.acquireUntracked(S,c,M,s,n),p=o.uid),Jb(o))});return Qi(()=>{g.remove(),o&&(o.uid!==p||o.removed||(o.removed=!0,Jb(o)),o=null),r=g=null})});return r}function UG(e,t,i){const r=B5(e,t,i,(s,n,c)=>{let o=!1;return r4(()=>c_(s,n),(p,g)=>{s.__accessor__.lifecycle!==Yn.DESTROYED?o||(o=!0,KM(g,p)||c.call(s,p,g,n,s),o=!1):r.remove()})});return r}function jG(e,t,i,r=!1){return e.__accessor__&&e.__accessor__.lifecycle!==Yn.DESTROYED?r?UG(e,t,i):BG(e,t,i):Qi()}function VG(e,t,i){let r,s,n=s4(e,(c,o)=>{r&&r.uid!==s?n.remove():(r||(r=N0.acquireTracked(c,t,o,i),s=r.uid),Jb(r))});return Qi(()=>{n.remove(),r&&(r.uid!==s||r.removed||(r.removed=!0,Jb(r)),r=null),n=null})}function GG(e,t,i){let r=!1;return r4(e,(s,n)=>{r||(r=!0,i(n,s)||t(s,n),r=!1)})}function qG(e,t,i=!1,r=P5){return i?GG(e,t,r):VG(e,t,r)}function d$(e){return MG(Lc,t=>t.oldValue===e)}function ax(e,t){for(const[i,r]of e)if(t(r,i))return!0;return!1}function rA(e,t,i){const r=e.get(t);if(r!==void 0)return r;const s=i();return e.set(t,s),s}function pye(e){const t=new Map;return i=>(t.has(i)||t.set(i,e(i)),t.get(i))}const um=()=>_t.getLogger("esri.core.accessorSupport.ensureTypes");function HG(e){return e==null?e:new Date(e)}function WG(e){return e==null?e:!!e}function ZG(e){return e==null?e:e.toString()}function za(e){return e==null?e:(e=parseFloat(e),isNaN(e)?0:e)}function sA(e){return e==null?e:Math.round(parseFloat(e))}function a4(e){return(e==null?void 0:e.constructor)&&e.constructor.__accessorMetadata__!==void 0}function Kb(e,t){return t!=null&&e&&!(t instanceof e)}function l4(e){return e&&"isCollection"in e}function p$(e){return e!=null&&e.Type?typeof e.Type=="function"?e.Type:e.Type.base:null}function YG(e,t){if(!(t!=null&&t.constructor)||!l4(t.constructor))return NT(e,t)?t:new e(t);const i=p$(e.prototype.itemType),r=p$(t.constructor.prototype.itemType);return i?r?i===r?t:i.prototype.isPrototypeOf(r.prototype)?new e(t):(NT(e,t),t):new e(t):t}function NT(e,t){return!!a4(t)&&(um().error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+cx(e)+"'"),!0)}function lx(e,t){return t==null?t:l4(e)?YG(e,t):Kb(e,t)?NT(e,t)?t:new e(t):t}function cx(e){var t;return((t=e==null?void 0:e.prototype)==null?void 0:t.declaredClass)||"unknown"}const JG=new WeakMap;function KG(e){switch(e){case Number:return za;case Er:return sA;case Boolean:return WG;case String:return ZG;case Date:return HG;default:return rA(JG,e,()=>lx.bind(null,e))}}function zn(e,t){const i=KG(e);return arguments.length===1?i:i(t)}function z0(e,t,i){return arguments.length===1?z0.bind(null,e):t&&(Array.isArray(t)?t.map(r=>e(r,i)):[e(t,i)])}function XG(e,t){return arguments.length===1?z0(i=>zn(e,i)):z0(i=>zn(e,i),t)}function c4(e,t,i){return t!==0&&Array.isArray(i)?i.map(r=>c4(e,t-1,r)):e(i)}function Xb(e,t,i){if(arguments.length===2)return n=>Xb(e,t,n);if(!i)return i;i=c4(e,t,i);let r=t,s=i;for(;r>0&&Array.isArray(s);)r--,s=s[0];if(s!==void 0)for(let n=0;n<r;n++)i=[i];return i}function QG(e,t,i){return arguments.length===2?Xb(r=>zn(e,r),t):Xb(r=>zn(e,r),t,i)}function u4(e){return!!Array.isArray(e)&&!e.some(t=>{const i=typeof t;return!(i==="string"||i==="number"||i==="function"&&e.length>1)})}function zT(e,t){if(arguments.length===2)return zT(e).call(null,t);const i=new Set,r=e.filter(o=>typeof o!="function"),s=e.filter(o=>typeof o=="function");for(const o of e)typeof o!="string"&&typeof o!="number"||i.add(o);let n=null,c=null;return(o,p)=>{if(o==null)return o;const g=typeof o,S=g==="string"||g==="number";return S&&(i.has(o)||s.some(M=>g==="string"&&M===String||g==="number"&&M===Number))||g==="object"&&s.some(M=>!Kb(o,M))?o:(S&&r.length?(n||(n=r.map(M=>typeof M=="string"?`'${M}'`:`${M}`).join(", ")),um().error("Accessor#set",`'${o}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof o=="object"&&s.length?(c||(c=s.map(M=>cx(M)).join(", ")),um().error("Accessor#set",`'${o}' is not a valid value for this property, value must be one of ${c}`)):um().error("Accessor#set",`'${o}' is not a valid value for this property`),p&&(p.valid=!1),null)}}function Uc(e,t){if(arguments.length===2)return Uc(e).call(null,t);const i={},r=[],s=[];for(const p in e.typeMap){const g=e.typeMap[p];i[p]=zn(g),r.push(cx(g)),s.push(p)}const n=()=>`'${r.join("', '")}'`,c=()=>`'${s.join("', '")}'`,o=typeof e.key=="string"?p=>p[e.key]:e.key;return p=>{if(e.base&&!Kb(e.base,p)||p==null)return p;const g=o(p)||e.defaultKeyValue,S=i[g];if(!S)return um().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${c()})`),null;if(!Kb(e.typeMap[g],p))return p;if(typeof e.key=="string"&&!a4(p)){const M={};for(const A in p)A!==e.key&&(M[A]=p[A]);return S(M)}return S(p)}}let Er=class{};const mye={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function eq(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function h4(e){switch(e.type){case"native":return zn(e.value);case"array":return z0(h4(e.value));case"one-of":return tq(e);default:return null}}function tq(e){let t=null;return(i,r)=>BT(i,e)?i:(t==null&&(t=FT(e)),um().error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),r&&(r.valid=!1),null)}function FT(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Er:return"integer";case Date:return"date";default:return cx(e.value)}case"array":return`array of ${FT(e.value)}`;case"one-of":{const t=e.values.map(i=>FT(i));return`one of ${t.slice(0,-1)} or ${t[t.length-1]}`}}return"unknown"}function BT(e,t){if(e==null)return!0;switch(t.type){case"native":switch(t.value){case Number:case Er:return typeof e=="number";case Boolean:return typeof e=="boolean";case String:return typeof e=="string"}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some(i=>!BT(i,t.value));case"one-of":return t.values.some(i=>BT(e,i))}}function I(e={}){return(t,i)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(t,i),s=rx(t,i);r&&(r.get||r.set?(s.get=r.get||s.get,s.set=r.set||s.set):"value"in r&&("value"in e&&_t.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${t.constructor.name}" already defined in the metadata`,e),s.value=e.value=r.value)),e.readOnly!=null&&(s.readOnly=e.readOnly);const n=e.aliasOf;if(n){const p=typeof n=="string"?n:n.source,g=typeof n=="string"?null:n.overridable===!0;let S;s.dependsOn=[p],s.get=function(){let M=Va(this,p);if(typeof M=="function"){S||(S=p.split(".").slice(0,-1).join("."));const A=Va(this,S);A&&(M=M.bind(A))}return M},s.readOnly||(s.set=g?function(M){this._override(i,M)}:function(M){Gb(this,p,M)})}const c=e.type,o=e.types;s.cast||(c?s.cast=iq(c):o&&(Array.isArray(o)?s.cast=z0(Uc(o[0])):s.cast=Uc(o))),G7(s,e),e.range&&(s.cast=rq(s.cast,e.range))}}function d4(e,t,i){const r=rx(e,i);r.json||(r.json={});let s=r.json;return t!==void 0&&(s.origins||(s.origins={}),s.origins[t]||(s.origins[t]={}),s=s.origins[t]),s}function iq(e){let t=0,i=e;if(eq(e))return h4(e);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],t++;const r=i;if(u4(r))return t===0?zT(r):Xb(zT(r),t);if(t===1)return XG(r);if(t>1)return QG(r,t);const s=e;return s.from?s.from:zn(s)}function rq(e,t){return i=>{let r=+e(i);return t.step!=null&&(r=Math.round(r/t.step)*t.step),t.min!=null&&(r=Math.max(t.min,r)),t.max!=null&&(r=Math.min(t.max,r)),r}}function sq(e){if(e.json&&e.json.origins){const t=e.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(t[r]){const s=t[r];i[r].forEach(n=>{t[n]=s}),delete t[r]}}}let jc=class extends O5{constructor(t,i,r){super(t,i,r)}};jc.prototype.type="warning";function p4(e){var t;return!!e&&((t=e.prototype)==null?void 0:t.declaredClass)&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}const UT=()=>_t.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function f$(e,t,i){var r,s;e&&(!i&&!t.read||(r=t.read)!=null&&r.reader||((s=t.read)==null?void 0:s.enabled)===!1||aq(e)&&Ep("read.reader",nA(e),t))}function nA(e){var i,r;const t=e.ndimArray??0;if(t>1)return oq(e);if(t===1)return m$(e);if("type"in e&&m4(e.type)){const s=(r=(i=e.type.prototype)==null?void 0:i.itemType)==null?void 0:r.Type,n=m$(typeof s=="function"?{type:s}:{types:s});return(c,o,p)=>{const g=n(c,o,p);return g&&new e.type(g)}}return oA(e)}function oA(e){return"type"in e?nq(e.type):lq(e.types)}function nq(e){return e.prototype.read?(t,i,r)=>{if(t==null)return t;const s=typeof t;if(s!=="object")return void UT().error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${s}'`);const n=new e;return n.read(t,r),n}:e.fromJSON}function f4(e,t,i,r){return r!==0&&Array.isArray(t)?t.map(s=>f4(e,s,i,r-1)):e(t,void 0,i)}function oq(e){const t=oA(e),i=f4.bind(null,t),r=e.ndimArray??0;return(s,n,c)=>{if(s==null)return s;s=i(s,c,r);let o=r,p=s;for(;o>0&&Array.isArray(p);)o--,p=p[0];if(p!==void 0)for(let g=0;g<o;g++)s=[s];return s}}function m$(e){const t=oA(e);return(i,r,s)=>{if(i==null)return i;if(Array.isArray(i)){const c=[];for(const o of i){const p=t(o,void 0,s);p!==void 0&&c.push(p)}return c}const n=t(i,void 0,s);return n!==void 0?[n]:void 0}}function m4(e){if(!p4(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?aA(t.Type):y4(t.Type))}function aq(e){return"types"in e?y4(e.types):aA(e.type)}function aA(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||m4(e))}function y4(e){for(const t in e.typeMap)if(!aA(e.typeMap[t]))return!1;return!0}function lq(e){let t=null;const i=e.errorContext??"type",r=e.validate;return(s,n,c)=>{if(s==null)return s;const o=typeof s;if(o!=="object")return void UT().error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);t||(t=cq(e));const p=e.key;if(typeof p!="string")return;const g=s[p],S=g?t[g]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!S){const A=`Type '${g||"unknown"}' is not supported`;return c!=null&&c.messages&&s&&c.messages.push(new jc(`${i}:unsupported`,A,{definition:s,context:c})),void UT().error(A)}const M=new S;return M.read(s,c),r?r(M):M}}function cq(e){var i,r;const t={};for(const s in e.typeMap){const n=e.typeMap[s],c=u_(n.prototype);if(typeof e.key=="function")continue;const o=c[e.key];if(!o)continue;(i=o.json)!=null&&i.type&&Array.isArray(o.json.type)&&o.json.type.length===1&&typeof o.json.type[0]=="string"&&(t[o.json.type[0]]=n);const p=(r=o.json)==null?void 0:r.write;if(!(p!=null&&p.writer)){t[s]=n;continue}const g=p.target,S=typeof g=="string"?g:e.key,M={};p.writer(s,M,S),M[S]&&(t[M[S]]=n)}return t}function uq(e){if(e.json||(e.json={}),g$(e.json),_$(e.json),y$(e.json),e.json.origins)for(const t in e.json.origins)g$(e.json.origins[t]),_$(e.json.origins[t]),y$(e.json.origins[t]);return!0}function y$(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function g$(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function _$(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function v$(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;const i=(e==null?void 0:e.ndimArray)??0;e&&(i===1||"type"in e&&p4(e.type))?t.write.writer=pq:i>1?t.write.writer=fq(i):t.types?Array.isArray(t.types)?t.write.writer=dq(t.types[0]):t.write.writer=hq(t.types):t.write.writer=F0}function hq(e){return(t,i,r,s)=>t?g4(t,e,s)?F0(t,i,r,s):void 0:F0(t,i,r,s)}function g4(e,t,i){for(const r in t.typeMap)if(e instanceof t.typeMap[r])return!0;if(i!=null&&i.messages){const r=t.errorContext??"type",s=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&e&&i.messages.push(new Je(`${r}:unsupported`,s,{definition:e,context:i})),_t.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function dq(e){return(t,i,r,s)=>!t||!Array.isArray(t)?F0(t,i,r,s):F0(t.filter(n=>g4(n,e,s)),i,r,s)}function F0(e,t,i,r){Ep(i,Qb(e,r),t)}function Qb(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?ew(e):e}function ew(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function pq(e,t,i,r){let s;e===null?s=null:e&&typeof e.map=="function"?(s=e.map(n=>Qb(n,r)),typeof s.toArray=="function"&&(s=s.toArray())):s=[Qb(e,r)],Ep(i,s,t)}function _4(e,t,i){return i!==0&&Array.isArray(e)?e.map(r=>_4(r,t,i-1)):Qb(e,t)}function fq(e){return(t,i,r,s)=>{let n;if(t===null)n=null;else{n=_4(t,s,e);let c=e,o=n;for(;c>0&&Array.isArray(o);)c--,o=o[0];if(o!==void 0)for(let p=0;p<c;p++)n=[n]}Ep(r,n,i)}}function mq(e,t){return lA(e,"any",t==null?void 0:t.origin)}function jT(e,t){return lA(e,"read",t==null?void 0:t.origin)}function v4(e,t){return lA(e,"write",t==null?void 0:t.origin)}function lA(e,t,i){let r=e==null?void 0:e.json;if(r!=null&&r.origins&&i){let s;s=i==="link-chart"?r.origins[i]&&(t==="any"||t in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],s&&(t==="any"||t in s)&&(r=s)}return r}function yq(e){const t=gq(e);if(e.json.origins)for(const i in e.json.origins){const r=e.json.origins[i],s=r.types?_q(r):t;f$(s,r,!1),r.types&&!r.write&&e.json.write&&e.json.write.enabled&&(r.write={...e.json.write}),v$(s,r)}f$(t,e.json,!0),v$(t,e.json)}function gq(e){return e.json.types?VT(e.json):e.type?b4(e):VT(e)}function _q(e){return e.type?b4(e):VT(e)}function b4(e){if(!e.type)return;let t=0,i=e.type;for(;Array.isArray(i)&&!u4(i);)i=i[0],t++;return{type:i,ndimArray:t}}function VT(e){if(!e.types)return;let t=0,i=e.types;for(;Array.isArray(i);)i=i[0],t++;return{types:i,ndimArray:t}}function vq(e){uq(e)&&(sq(e),yq(e))}const fS=new Set,mS=new Set;function me(e){return t=>{e??(e="esri.core.Accessor"),t.prototype.declaredClass=e,wq(t);const i=[],r=[];let s=t.prototype;for(;s;)s.hasOwnProperty("initialize")&&!fS.has(s.initialize)&&(fS.add(s.initialize),i.push(s.initialize)),s.hasOwnProperty("destroy")&&!mS.has(s.destroy)&&(mS.add(s.destroy),r.push(s.destroy)),s=Object.getPrototypeOf(s);fS.clear(),mS.clear();const n=class extends t{constructor(...o){if(super(...o),this.constructor===n&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let p=i.length-1;p>=0;p--)i[p].call(this)}}),r.length){let p=!1;const g=this[z5];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!p){p=!0,g.call(this);for(let S=0;S<r.length;S++)r[S].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript(...o)}}};n.__accessorMetadata__=u_(t.prototype),n.prototype.declaredClass=e;const c=(e||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:c,configurable:!0}),n}}function bq(e,t){return t.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(e);if(r===void 0)return;Ot(r);const s=i.store;return s.has(e)?s.get(e):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(e);if(r!==void 0)return r.getComputed(i)}}function wq(e){const t=e.prototype,i=u_(t),r={};for(const s of Object.getOwnPropertyNames(i)){const n=i[s];vq(n),r[s]={enumerable:!0,configurable:!0,get:bq(s,n),set(c){const o=this.__accessor__;if(o!==void 0){if(!Object.isFrozen(this)){if(o.initialized&&n.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${s}' of ${this.declaredClass}`);if(o.lifecycle===Yn.CONSTRUCTED&&n.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${s}' of ${this.declaredClass}`);o.set(s,c)}}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:c})}}}Object.defineProperties(e.prototype,r)}var w4,x4;function xq(e){var t;if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return(t=e.constructor)!=null&&t.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const Eu=Symbol("Accessor-Handles"),GT=Symbol("Accessor-Initialized");let zt=class S4{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:s}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const n=this;class c extends n{constructor(...p){super(...p),this.inherited=null,s&&s.apply(this,p)}}u_(c.prototype);for(const o in t){const p=t[o];c.prototype[o]=typeof p=="function"?function(...g){const S=this.inherited;let M;this.inherited=function(...A){if(n.prototype[o])return n.prototype[o].apply(this,A)};try{M=p.apply(this,g)}catch(A){throw this.inherited=S,A}return this.inherited=S,M}:t[o]}for(const o in i){const p=xq(i[o]);I(p)(c.prototype,o)}return me(r)(c)}constructor(...t){if(this[w4]=null,this[x4]=!1,this.constructor===S4)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new tG(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),t.length>0&&this.normalizeCtorArgs&&(i.ctorArgs=this.normalizeCtorArgs.apply(this,t))}postscript(t){const i=this.__accessor__,r=i.ctorArgs||t;i.initialize(),r&&(this.set(r),i.ctorArgs=null),i.constructed(),this.initialize(),this[GT]=!0}initialize(){}[z5](){this[Eu]=nr(this[Eu])}destroy(){var t;this.destroyed||(DG(this),this.__accessor__.destroy(),(t=aG())==null||t.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[GT]}get destroyed(){var t;return((t=this.__accessor__)==null?void 0:t.lifecycle)===Yn.DESTROYED||!1}commitProperty(t){Va(this,t)}get(t){return D5(_t.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),Va(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,i){return Gb(this,t,i),this}watch(t,i,r){return jG(this,t,i,r)}addHandles(t,i){if(this.destroyed){const s=Array.isArray(t)?t:[t];for(const n of s)n.remove();return}let r=this[Eu];r==null&&(r=this[Eu]=new XM),r.add(t,i)}removeHandles(t){const i=this[Eu];i!=null&&i.remove(t)}removeAllHandles(){const t=this[Eu];t!=null&&t.removeAll()}hasHandles(t){const i=this[Eu];return i!=null&&i.has(t)}_override(t,i){i===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,i){i==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,i){return this.__accessor__.internalSet(t,i),this}};w4=Eu,x4=GT;let Sq=class T4{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new T4;return this._values.forEach((r,s)=>{t&&t.has(s)||i.set(s,He(r.value),r.origin)}),i}get(t,i){i=this._normalizeOrigin(i);const r=this._values.get(t);return i==null||(r==null?void 0:r.origin)===i?r==null?void 0:r.value:void 0}originOf(t){var i;return((i=this._values.get(t))==null?void 0:i.origin)??pi.USER}keys(t){t=this._normalizeOrigin(t);const i=[...this._values.keys()];return t==null?i:i.filter(r=>{var s;return((s=this._values.get(r))==null?void 0:s.origin)===t})}set(t,i,r){if((r=this._normalizeOrigin(r))===pi.DEFAULTS){const s=this._values.get(t);if((s==null?void 0:s.origin)!=null&&s.origin>r)return}this._values.set(t,new Tq(i,r))}delete(t,i){var r;(i=this._normalizeOrigin(i))!=null&&((r=this._values.get(t))==null?void 0:r.origin)!==i||this._values.delete(t)}has(t,i){var r;return(i=this._normalizeOrigin(i))!=null?((r=this._values.get(t))==null?void 0:r.origin)===i:this._values.has(t)}forEach(t){this._values.forEach(({value:i},r)=>t(i,r))}_normalizeOrigin(t){if(t!=null)return t===pi.DEFAULTS?t:pi.USER}},Tq=class{constructor(t,i){this.value=t,this.origin=i}};function E4(e,t,i){t.keys().forEach(s=>{i.set(s,t.get(s),pi.DEFAULTS)});const r=e.metadata;Object.keys(r).forEach(s=>{e.internalGet(s)&&i.set(s,e.internalGet(s),pi.DEFAULTS)})}function Eq(e,t,i){if(!(e!=null&&e.read)||e.read.enabled===!1||!e.read.source)return!1;const r=e.read.source;if(typeof r=="string"){if(r===t||r.includes(".")&&r.indexOf(t)===0&&e$(r,i))return!0}else for(const s of r)if(s===t||s.includes(".")&&s.indexOf(t)===0&&e$(s,i))return!0;return!1}function Iq(e){return e&&(!e.read||e.read.enabled!==!1&&!e.read.source)}function Mq(e,t,i,r,s){let n=jT(t[i],s);Iq(n)&&(e[i]=!0);for(const c of Object.getOwnPropertyNames(t))n=jT(t[c],s),Eq(n,i,r)&&(e[c]=!0)}function Aq(e,t,i,r){const s=i.metadata,n=mq(s[t],r),c=n==null?void 0:n.default;if(c===void 0)return;const o=typeof c=="function"?c.call(e,t,r):c;o!==void 0&&i.set(t,o)}const I4={origin:"service"};function M4(e,t,i=I4){if(!t||typeof t!="object")return;const r=So(e),s=r.metadata,n={};for(const c of Object.getOwnPropertyNames(t))Mq(n,s,c,t,i);r.setDefaultOrigin(i.origin);for(const c of Object.getOwnPropertyNames(n)){const o=jT(s[c],i).read,p=o==null?void 0:o.source;let g;g=p&&typeof p=="string"?c_(t,p):t[c],o!=null&&o.reader&&(g=o.reader.call(e,g,t,i)),g!==void 0&&r.set(c,g)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const c of Object.getOwnPropertyNames(s))n[c]||Aq(e,c,r,i)}r.setDefaultOrigin("user")}function Pq(e,t,i,r=I4){var n;const s={...r,messages:[]};i(s),(n=s.messages)==null||n.forEach(c=>{c.type!=="warning"||e.loaded?r!=null&&r.messages&&r.messages.push(c):e.loadWarnings.push(c)})}function Cq(e,t,i,r,s){var c,o;const n={};return(o=(c=t.write)==null?void 0:c.writer)==null||o.call(e,r,n,i,s),n}function A4(e,t,i,r,s,n){if(!(r!=null&&r.write))return!1;const c=Va(e,i);if(!s&&r.write.overridePolicy){const o=r.write.overridePolicy.call(e,c,i,n??void 0);o!==void 0&&(s=o)}if(s||(s=r.write),!s||s.enabled===!1||s.layerContainerTypes&&(n!=null&&n.layerContainerType)&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((c===null&&!s.allowNull&&!s.writerEnsuresNonNull||c===void 0)&&s.isRequired){const o=new Je("web-document-write:property-required",`Missing value for required property '${i}' on '${e.declaredClass}'`,{propertyName:i,target:e});return o&&(n!=null&&n.messages)?n.messages.push(o):o&&!n&&_t.getLogger("esri.core.accessorSupport.write").error(o.name,o.message),!1}return!(c===void 0||c===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!t.store.multipleOriginsSupported||t.store.originOf(i)===pi.DEFAULTS)&&$q(e,i,n,r,c)||!s.ignoreOrigin&&(n!=null&&n.origin)&&t.store.multipleOriginsSupported&&t.store.originOf(i)<sh(n.origin))}function $q(e,t,i,r,s){const n=r.default;if(n===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const c=n.call(e,t,i??void 0);return Qw(c,s)}return!1}return n===s}function kq(e,t,i,r){const s=So(e),n=s.metadata,c=v4(n[t],r);return!!c&&A4(e,s,t,c,i,r)}function P4(e,t,i){var n,c;if(e&&typeof e.toJSON=="function"&&(!e.toJSON.isDefaultToJSON||!e.write))return Nv(t,e.toJSON(i));const r=So(e),s=r.metadata;for(const o in s){const p=v4(s[o],i);if(!A4(e,r,o,p,void 0,i))continue;const g=Va(e,o),S=Cq(e,p,p.write&&typeof p.write.target=="string"?p.write.target:o,g,i);Object.keys(S).length>0&&(t=Nv(t,S),(c=(n=i==null?void 0:i.resources)==null?void 0:n.pendingOperations)!=null&&c.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>Nv(t,S,()=>"replace-arrays"))),i!=null&&i.writtenProperties&&i.writtenProperties.push({target:e,propName:o,oldOrigin:K7(r.store.originOf(o)),newOrigin:i.origin}))}return t}const p_=e=>{let t=class extends e{constructor(...i){super(...i);const r=So(this),s=r.store,n=new Sq;r.store=n,E4(r,s,n)}read(i,r){M4(this,i,r)}write(i,r){return P4(this,i??{},r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return Rq.call(this,i,r)}};return t=v([me("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function Rq(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(e,t),i}function qT(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}let At=class extends p_(zt){};At=v([me("esri.core.JSONSupport")],At);const Oq=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Lq={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function HT(e){const t=e==null?void 0:e.match(Oq);if(!t)return null;const[,i,r,s]=t;if(!i)return null;let n=null,c=null,o=null;const{devext:p,qaext:g,www:S}=Lq;if(r)if(n=i,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:c,portalHostname:o}=p);break;case"qa":({customBaseUrl:c,portalHostname:o}=g);break;default:return null}else({customBaseUrl:c,portalHostname:o}=S);else switch(i.toLowerCase()){case"devext":({customBaseUrl:c,portalHostname:o}=p);break;case"qaext":({customBaseUrl:c,portalHostname:o}=g);break;case"www":({customBaseUrl:c,portalHostname:o}=S);break;default:return null}return{customBaseUrl:c,isPortal:!1,portalHostname:o,urlKey:n}}function Dq(e){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e)}function Nq(e){const t=atob(e),i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i.buffer}function zq(e){const t=new Uint8Array(e);let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return btoa(i)}const Fq=()=>_t.getLogger("esri.core.urlUtils"),Um=Pi.request,b$="esri/config: esriConfig.request.proxyUrl is not set.",C4=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,$4=/^\s*http:/i,Bq=/^\s*https:/i,Uq=/^\s*file:/i,jq=/:\d+$/,Vq=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Gq=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),qq=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");let hm=class{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(Gq);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(qq),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const q1={},Hq=new hm(Pi.applicationUrl);let dn=Hq;const Wq=Zq();let cA=Wq;const uA=()=>dn,k4=()=>cA;function Zq(){const e=dn.path,t=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return`${`${dn.scheme}://${dn.host}${dn.port!=null?`:${dn.port}`:""}`}${t}`}function Mr(e){if(!e)return null;const t={path:null,query:null},i=new hm(e),r=e.indexOf("?");return i.query===null?t.path=e:(t.path=e.substring(0,r),t.query=hA(i.query)),i.fragment&&(t.hash=i.fragment,i.query===null&&(t.path=t.path.substring(0,t.path.length-(i.fragment.length+1)))),t}function hA(e){const t=e.split("&"),i={};for(const r of t){if(!r)continue;const s=r.indexOf("=");let n,c;s<0?(n=decodeURIComponent(r),c=""):(n=decodeURIComponent(r.slice(0,s)),c=decodeURIComponent(r.slice(s+1)));let o=i[n];typeof o=="string"&&(o=i[n]=[o]),Array.isArray(o)?o.push(c):i[n]=c}return i}function up(e,t){return e?t&&typeof t=="function"?Object.keys(e).map(i=>encodeURIComponent(i)+"="+encodeURIComponent(t(i,e[i]))).join("&"):Object.keys(e).map(i=>{const r=e[i];if(r==null)return"";const s=encodeURIComponent(i)+"=",n=t==null?void 0:t[i];return n?s+encodeURIComponent(n(r)):Array.isArray(r)?r.map(c=>qT(c)?s+encodeURIComponent(JSON.stringify(c)):s+encodeURIComponent(c)).join("&"):qT(r)?s+encodeURIComponent(JSON.stringify(r)):s+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function Yq(e=!1){let t,i=Um.proxyUrl;if(typeof e=="string"){t=iH(e);const r=ux(e);r&&(i=r.proxyUrl)}else t=!!e;if(!i)throw Fq().warn(b$),new Je("urlUtils:proxy-not-set",b$);return t&&WT()&&(i=yA(i)),Mr(i)}function bye(e){const t=ux(e);let i,r;if(t){const s=dA(t.proxyUrl);i=s.path,r=s.query?hA(s.query):null}if(i){const s=Mr(e);e=i+"?"+s.path;const n=up({...r,...s.query});n&&(e=`${e}?${n}`)}return e}const ng={path:"",query:""};function dA(e){const t=e.indexOf("?");return t!==-1?(ng.path=e.slice(0,t),ng.query=e.slice(t+1)):(ng.path=e,ng.query=null),ng}function R4(e){return e=(e=iw(e=lH(e=dA(e).path),!0)).toLowerCase()}function Jq(e){const t={proxyUrl:e.proxyUrl,urlPrefix:R4(e.urlPrefix)},i=Um.proxyRules,r=t.urlPrefix;let s=i.length;for(let n=0;n<i.length;n++){const c=i[n].urlPrefix;if(r.indexOf(c)===0){if(r.length===c.length)return-1;s=n;break}c.indexOf(r)===0&&(s=n+1)}return i.splice(s,0,t),s}function ux(e){const t=Um.proxyRules,i=R4(e);for(let r=0;r<t.length;r++)if(i.indexOf(t[r].urlPrefix)===0)return t[r]}function Kq(e,t){if(!e||!t)return!1;e=tw(e),t=tw(t);const i=HT(e),r=HT(t);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&Tm(e,t,!0)}function O4(e,t){return e=tw(e),t=tw(t),iw(e)===iw(t)}function tw(e){const t=(e=ta(e)).indexOf("/sharing");return t>0?e.substring(0,t):e.replace(/\/+$/,"")}function L4(e){const t=r=>r==null||r instanceof RegExp&&r.test(e)||typeof r=="string"&&e.startsWith(r),i=Um.interceptors;if(i){for(const r of i)if(Array.isArray(r.urls)){if(r.urls.some(t))return r}else if(t(r.urls))return r}return null}function Tm(e,t,i=!1){if(!e||!t)return!1;const r=YT(e),s=YT(t);return!(!i&&r.scheme!==s.scheme)&&r.host!=null&&s.host!=null&&r.host.toLowerCase()===s.host.toLowerCase()&&r.port===s.port}function pA(e){if(typeof e=="string"){if(!Nn(e))return!0;e=YT(e)}if(Tm(e,dn))return!0;const t=Um.trustedServers||[];for(let i=0;i<t.length;i++){const r=Xq(t[i]);for(let s=0;s<r.length;s++)if(Tm(e,r[s]))return!0}return!1}function Xq(e){return q1[e]||(mA(e)||na(e)?q1[e]=[new hm(Ko(e))]:q1[e]=[new hm(`http://${e}`),new hm(`https://${e}`)]),q1[e]}function Ko(e,t=cA,i){return na(e)?i&&i.preserveProtocolRelative?e:dn.scheme==="http"&&dn.authority===Ga(e).slice(2)?`http:${e}`:`https:${e}`:mA(e)?e:hp(e[0]==="/"?oH(t):t,e)}function fA(e,t=cA,i){if(e==null||!Nn(e))return e;const r=ta(e),s=r.toLowerCase(),n=ta(t).toLowerCase().replace(/\/+$/,""),c=i?ta(i).toLowerCase().replace(/\/+$/,""):null;if(c&&n.indexOf(c)!==0)return e;const o=(M,A,O)=>(O=M.indexOf(A,O))===-1?M.length:O;let p=o(s,"/",s.indexOf("//")+2),g=-1;for(;s.slice(0,p+1)===n.slice(0,p)+"/"&&(g=p+1,p!==s.length);)p=o(s,"/",p+1);if(g===-1||c&&g<c.length)return e;e=r.slice(g);const S=n.slice(g-1).replaceAll(/[^/]+/g,"").length;if(S>0)for(let M=0;M<S;M++)e=`../${e}`;else e=`./${e}`;return e}function ta(e){return e=hH(e=uH(e=cH(e=Ko(e=e.trim()))))}function hp(...e){const t=e.filter(O0);if(!(t!=null&&t.length))return;const i=[];if(Nn(t[0])){const s=t[0],n=s.indexOf("//");n!==-1&&(i.push(s.slice(0,n+1)),sH(t[0])&&(i[0]+="/"),t[0]=s.slice(n+2))}else t[0][0]==="/"&&i.push("");const r=t.reduce((s,n)=>n?s.concat(n.split("/")):s,[]);for(let s=0;s<r.length;s++){const n=r[s];n===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!n&&s===r.length-1||n&&(n!=="."||i.length===0))&&i.push(n)}return i.join("/")}function Ga(e,t=!1){if(e==null||hx(e)||Mp(e))return null;let i=e.indexOf("://");if(i===-1&&na(e))i=2;else{if(i===-1)return null;i+=3}const r=e.indexOf("/",i);return r!==-1&&(e=e.slice(0,r)),t&&(e=iw(e,!0)),e}function Nn(e){return na(e)||mA(e)}function hx(e){return e!=null&&e.slice(0,5)==="blob:"}function Mp(e){return e!=null&&e.slice(0,5)==="data:"}function Qq(e){const t=B0(e);return t&&t.isBase64?Nq(t.data):null}function wye(e){return zq(e).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const eH=/^data:(.*?)(;base64)?,(.*)$/;function B0(e){const t=e.match(eH);if(!t)return null;const[,i,r,s]=t;return{mediaType:i,isBase64:!!r,data:s}}function D4(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}async function xye(e){return(await fetch(e)).blob()}function Sye(e){const t=Qq(e);if(!t)return null;const i=B0(e);return new Blob([t],{type:i.mediaType})}function Tye(e,t){tH(e,t)}function tH(e,t){if(!e)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const r=URL.createObjectURL(e);return i.download=t,i.href=r,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),!0}function na(e){return e!=null&&e[0]==="/"&&e[1]==="/"}function mA(e){return e!=null&&C4.test(e)}function iH(e){return e!=null&&Bq.test(e)||dn.scheme==="https"&&na(e)}function rH(e){return e!=null&&$4.test(e)||dn.scheme==="http"&&na(e)}function sH(e){return e!=null&&Uq.test(e)}function yA(e){return na(e)?`https:${e}`:e.replace($4,"https:")}function nH(){return dn.scheme==="http"}function WT(){return dn.scheme==="https"}function iw(e,t=!1){return na(e)?e.slice(2):(e=e.replace(C4,""),t&&e.length>1&&e[0]==="/"&&e[1]==="/"&&(e=e.slice(2)),e)}function oH(e){const t=e.indexOf("//"),i=e.indexOf("/",t+2);return i===-1?e:e.slice(0,i)}function aH(e){let t=0;if(Nn(e)){const r=e.indexOf("//");r!==-1&&(t=r+2)}const i=e.lastIndexOf("/");return i<t?e:e.slice(0,i+1)}function Eye(e,t){if(!e)return"";const i=Mr(e).path.replace(/\/+$/,""),r=i.substring(i.lastIndexOf("/")+1);if(!(t!=null&&t.length))return r;const s=new RegExp(`.(${t.join("|")})$`,"ig");return r.replace(s,"")}function lH(e){return e.endsWith("/")?e:`${e}/`}function dx(e){return e.replace(/\/+$/,"")}function cH(e){if(/^https?:\/\//i.test(e)){const t=dA(e);e=(e=t.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+=`?${t.query}`)}return e}function uH(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function hH(e){const t=Um.httpsDomains;if(!rH(e))return e;const i=e.indexOf("/",7);let r;if(r=i===-1?e:e.slice(0,i),r=r.toLowerCase().slice(7),jq.test(r)){if(!r.endsWith(":80"))return e;r=r.slice(0,-3),e=e.replace(":80","")}return nH()&&r===dn.authority&&!Vq.test(e)||(WT()&&r===dn.authority||t&&t.some(s=>r===s||r.endsWith(`.${s}`))||WT()&&!ux(e))&&(e=yA(e)),e}function ZT(e,t,i){if(!(t&&i&&e&&Nn(e)))return e;const r=e.indexOf("//"),s=e.indexOf("/",r+2),n=e.indexOf(":",r+2),c=Math.min(s<0?e.length:s,n<0?e.length:n);return e.slice(r+2,c).toLowerCase()!==t.toLowerCase()?e:`${e.slice(0,r+2)}${i}${e.slice(c)}`}function YT(e){return typeof e=="string"?new hm(Ko(e)):(e.scheme||(e.scheme=dn.scheme),e)}function Iye(e){return pH.test(e)}function N4(e,t){const i=Mr(e),r=Object.keys(i.query||{});return r.length>0&&t&&t.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function dH(e,t,i){const r=Mr(e),s=r.query||{};return s[t]=String(i),`${r.path}?${up(s)}`}function Al(e,t){if(!t)return e;const i=Mr(e),r=i.query||{};for(const[n,c]of Object.entries(t))c!=null&&(r[n]=c);const s=up(r);return s?`${i.path}?${s}`:i.path}function Mye(e){if(e==null)return null;const t=e.match(z4);return t?t[2]:null}function w$(e){if(e==null)return null;const t=e.match(z4);return t?{path:t[1],extension:t[2]}:{path:e,extension:null}}async function Aye(e){return typeof e=="string"?B0(e)??{data:e}:new Promise((t,i)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(B0(r.result)),r.onerror=s=>i(s)})}const z4=/([^.]*)\.([^\/]*)$/,pH=/(^data:image\/svg|\.svg$)/i,F4="20240321",B4="9cf5a4b8555fda94595b625a40b922e012baf071";Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const fH="4.29";let _i,gA=fH;gA="4.29.10";function Pye(e){_i=e}function Cye(e){const t=_i==null?void 0:_i.findCredential(e);return t!=null&&t.token?dH(e,"token",t.token):e}Le("host-webworker");const mH=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function U4(e){const t=Ga(e,!0);return!!t&&t.endsWith(".arcgis.com")&&!mH.has(t)&&!e.endsWith("/sharing/rest/generateToken")}function yH(e,t,i=!1,r){return new Promise((s,n)=>{if(ra(r))return void n(x$());let c=()=>{g(),n(new Error(`Unable to load ${t}`))},o=()=>{const S=e;g(),s(S)},p=()=>{if(!e)return;const S=e;g(),S.src="",n(x$())};const g=()=>{Le("esri-image-decode")||(e.removeEventListener("error",c),e.removeEventListener("load",o)),c=null,o=null,e=null,r!=null&&r.removeEventListener("abort",p),p=null,i&&URL.revokeObjectURL(t)};r!=null&&r.addEventListener("abort",p),Le("esri-image-decode")?e.decode().then(o,c):(e.addEventListener("error",c),e.addEventListener("load",o))})}function x$(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}const gH="Timeout exceeded";function _H(){return new Error(gH)}function vH(e){Pi.request.crossOriginNoCorsDomains||(Pi.request.crossOriginNoCorsDomains={});const t=Pi.request.crossOriginNoCorsDomains;for(let i of e)i=i.toLowerCase(),/^https?:\/\//.test(i)?t[Ga(i)??""]=0:(t[Ga("http://"+i)??""]=0,t[Ga("https://"+i)??""]=0)}function bH(e){const t=Pi.request.crossOriginNoCorsDomains;if(t){let i=Ga(e);if(i)return i=i.toLowerCase(),!Tm(i,uA())&&t[i]<Date.now()-36e5}return!1}async function wH(e){var s;const t=Pi.request.crossOriginNoCorsDomains,i=Ga(e);t&&i&&(t[i.toLowerCase()]=Date.now());const r=Mr(e);e=r.path,((s=r.query)==null?void 0:s.f)==="json"&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}}async function Xi(e,t){var g;e instanceof URL&&(e=e.toString()),(t==null?void 0:t.query)instanceof URLSearchParams&&(t.query=hA(t.query.toString().replaceAll("+"," ")));const i=Mp(e),r=hx(e);r||i||(e=ta(e));const s={url:e,requestOptions:{...t}};let n=L4(e);if(n){const S=await PH(n,s);if(S!=null)return{data:S,getAllHeaders:Em,getHeader:Em,httpStatus:200,requestOptions:s.requestOptions,url:s.url};n.after||n.error||(n=null)}if(e=s.url,(t=s.requestOptions).responseType==="image"&&(Le("host-webworker")||Le("host-node")))throw Pl("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(t.method==="head"){if(t.body)throw Pl("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(i||r)throw Pl("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await IH(),rw)return rw.execute(e,t);const c=new AbortController;eo(t,()=>c.abort());const o={controller:c,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:n,params:s,redoRequest:!1,useIdentity:Oa.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},p=await $H(o);return(g=n==null?void 0:n.after)==null||g.call(n,p),p}let rw;const Oa=Pi.request,j4="FormData"in globalThis,xH=new Set([499,498,403,401]),SH=new Set(["COM_0056","COM_0057","SB_0008"]),TH=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Em=()=>null,sw=Symbol();function EH(e){const t=Ga(e);t&&!Xi._corsServers.includes(t)&&Xi._corsServers.push(t)}function S$(e){const t=Ga(e);return!t||t.endsWith(".arcgis.com")||Xi._corsServers.includes(t)||pA(t)}function Pl(e,t,i,r){let s="Error";const n={url:i.url,requestOptions:i.requestOptions,getAllHeaders:Em,getHeader:Em,ssl:!1};if(t instanceof Je)return t.details?(t.details=He(t.details),t.details.url=i.url,t.details.requestOptions=i.requestOptions):t.details=n,t;if(t){const c=r&&(()=>Array.from(r.headers)),o=r&&(S=>r.headers.get(S)),p=r==null?void 0:r.status,g=t.message;g&&(s=g),c&&o&&(n.getAllHeaders=c,n.getHeader=o),n.httpStatus=(t.httpCode!=null?t.httpCode:t.code)||p||0,n.subCode=t.subcode,n.messageCode=t.messageCode,typeof t.details=="string"?n.messages=[t.details]:n.messages=t.details,n.raw=sw in t?t[sw]:t}return qs(t)?Nr():new Je(e,s,n)}async function IH(){Le("host-webworker")&&!rw&&(rw=await ht(()=>import("./request-BEniwPX4.js"),[]))}async function JT(){_i||await ht(()=>import("./IdentityManager-4z1KdEVF.js"),__vite__mapDeps([0,1]))}async function MH(e){var o;const t=e.params.url,i=e.params.requestOptions,r=e.controller.signal,s=i.body;let n=null,c=null;if(j4&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(c=s),e.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Oa.priority,redirect:"follow",signal:r},(n||c)&&(e.fetchOptions.body=n||c),i.authMode==="anonymous"&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||(o=i.query)!=null&&o.token||n!=null&&n.get("token")),!e.hasToken&&Pi.apiKey&&U4(t)&&(i.query||(i.query={}),i.query.token=Pi.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!V4(t)&&!ra(r)){let p;i.authMode==="immediate"?(await JT(),p=await _i.getCredential(t,{signal:r}),e.credential=p):i.authMode==="no-prompt"?(await JT(),p=await _i.getCredential(t,{prompt:!1,signal:r}).catch(()=>{}),e.credential=p):_i&&(p=_i.findCredential(t)),p&&(e.credentialToken=p.token,e.useSSL=!!p.ssl)}}function V4(e){return TH.some(t=>t.test(e))}async function AH(e){let t=e.params.url;const i=e.params.requestOptions,r=e.fetchOptions??{},s=hx(t)||Mp(t),n=i.responseType||"json",c=s?0:i.timeout!=null?i.timeout:Oa.timeout;let o=!1;if(!s){e.useSSL&&(t=yA(t));let A={...i.query};e.credentialToken&&(A.token=e.credentialToken);let O=up(A);Le("esri-url-encodes-apostrophe")&&(O=O.replaceAll("'","%27"));const z=t.length+1+O.length;let V;o=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||z>Oa.maxUrlLength;const W=i.useProxy||!!ux(t);if(W){const ie=Yq(t);V=ie.path,!o&&V.length+1+z>Oa.maxUrlLength&&(o=!0),ie.query&&(A={...ie.query,...A})}if(r.method==="HEAD"&&(o||W)){if(o)throw z>Oa.maxUrlLength?Pl("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params):Pl("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params);if(W)throw Pl("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(o?(r.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?t=Al(t,A):(r.body=up(A),r.headers||(r.headers={}),r.headers["Content-Type"]="application/x-www-form-urlencoded")):t=Al(t,A),W&&(e.useProxy=!0,t=`${V}?${t}`),A.token&&j4&&r.body instanceof FormData&&!Dq(t)&&r.body.set("token",A.token),i.hasOwnProperty("withCredentials"))e.withCredentials=i.withCredentials;else if(!Tm(t,uA())){if(pA(t))e.withCredentials=!0;else if(_i){const ie=_i.findServerInfo(t);ie!=null&&ie.webTierAuth&&(e.withCredentials=!0)}}e.withCredentials&&(r.credentials="include",bH(t)&&await wH(o?Al(t,A):t))}let p,g,S=0,M=!1;c>0&&(S=setTimeout(()=>{M=!0,e.controller.abort()},c));try{if(i.responseType==="native-request-init")g=r,g.url=t;else if(i.responseType!=="image"||r.cache!=="default"||r.method!=="GET"||o||CH(i.headers)||!s&&!e.useProxy&&Oa.proxyUrl&&!S$(t)){if(Xi._beforeFetch&&await Xi._beforeFetch(t,r),p=await fetch(t,r),Xi._afterFetch&&await Xi._afterFetch(p),e.useProxy||EH(t),i.responseType==="native")g=p;else if(r.method!=="HEAD")if(p.ok){switch(n){case"array-buffer":g=await p.arrayBuffer();break;case"blob":case"image":g=await p.blob();break;default:g=await p.text()}if(S&&(clearTimeout(S),S=0),n==="json"||n==="xml"||n==="document")if(g)switch(n){case"json":g=JSON.parse(g);break;case"xml":g=T$(g,"application/xml");break;case"document":g=T$(g,"text/html")}else g=null;if(g){if(n==="array-buffer"||n==="blob"){const A=p.headers.get("Content-Type");if(A&&/application\/json|text\/plain/i.test(A)&&g[n==="blob"?"size":"byteLength"]<=750)try{const O=await new Response(g).json();O.error&&(g=O)}catch{}}n==="image"&&g instanceof Blob&&(g=await E$(URL.createObjectURL(g),e,!0))}}else{g=await p.text();try{g=JSON.parse(g)}catch{}}}else g=await E$(t,e)}catch(A){if(A.name==="AbortError")throw M?_H():Nr("Request canceled");if(!(!p&&A instanceof TypeError&&Oa.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||e.useProxy||S$(t))throw A;e.redoRequest=!0,Jq({proxyUrl:Oa.proxyUrl,urlPrefix:Ga(t)??""})}finally{S&&clearTimeout(S)}return[p,g]}async function PH(e,t){if(e.responseData!=null)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let i,r;try{r=await e.before(t)}catch(s){i=Pl("request:interceptor",s,t)}if((r instanceof Error||r instanceof Je)&&(i=Pl("request:interceptor",r,t)),i)throw e.error&&e.error(i),i;return r}}function CH(e){if(e){for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0}return!1}function T$(e,t){let i;try{i=new DOMParser().parseFromString(e,t)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function $H(e){var n,c;let t,i;await MH(e);try{do[t,i]=await AH(e);while(!await kH(e,t,i))}catch(o){const p=Pl("request:server",o,e.params,t);throw p.details.ssl=e.useSSL,(n=e.interceptor)!=null&&n.error&&e.interceptor.error(p),p}const r=e.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!e.hasToken&&!e.credentialToken&&((c=i.user)!=null&&c.username)&&!pA(r)){const o=Ga(r,!0);o&&Oa.trustedServers.push(o)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&vH(i.authorizedCrossOriginNoCorsDomains)}const s=e.credential;if(s&&_i){const o=_i.findServerInfo(s.server);let p=o==null?void 0:o.owningSystemUrl;if(p){p=p.replace(/\/?$/,"/sharing");const g=_i.findCredential(p,s.userId);g&&_i._getIdenticalSvcIdx(p,g)===-1&&g.resources.unshift(p)}}return{data:i,getAllHeaders:t?()=>Array.from(t.headers):Em,getHeader:t?o=>t.headers.get(o):Em,httpStatus:(t==null?void 0:t.status)??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function kH(e,t,i){var g;if(e.redoRequest)return e.redoRequest=!1,!1;const r=e.params.requestOptions;if(!t||r.responseType==="native"||r.responseType==="native-request-init")return!0;let s,n;if(i&&(i.error?s=i.error:i.status==="error"&&Array.isArray(i.messages)&&(s={...i},s[sw]=i,s.details=i.messages)),!s&&!t.ok)throw s=new Error(`Unable to load ${t.url} status: ${t.status}`),s[sw]=i,s;let c,o=null;s&&(n=Number(s.code),o=s.hasOwnProperty("subcode")?Number(s.subcode):null,c=s.messageCode,c=c==null?void 0:c.toUpperCase());const p=r.authMode;if(n===403&&(o===4||(g=s.message)!=null&&g.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(p!=="no-prompt"||n===498)&&n!==void 0&&xH.has(n)&&!V4(e.params.url)&&(n!==403||(!c||!SH.has(c))&&(o==null||o===2&&e.credentialToken))){await JT();try{const S=await _i.getCredential(e.params.url,{error:Pl("request:server",s,e.params),prompt:p!=="no-prompt",signal:e.controller.signal,token:e.credentialToken});return e.credential=S,e.credentialToken=S.token,e.useSSL=e.useSSL||S.ssl,!1}catch(S){if(p==="no-prompt")return e.credential=void 0,e.credentialToken=void 0,!1;s=S}}if(s)throw s;return!0}function E$(e,t,i=!1){const r=t.controller.signal,s=new Image;return t.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=Oa.priority,s.src=e,yH(s,e,i,r)}Xi._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Xi._beforeFetch=void 0,Xi._afterFetch=void 0;let Uv=class G4{constructor(){this._emitter=new G4.EventEmitter(this)}emit(t,i){return this._emitter.emit(t,i)}on(t,i){return this._emitter.on(t,i)}once(t,i){return this._emitter.once(t,i)}hasEventListener(t){return this._emitter.hasEventListener(t)}};(function(e){class t{constructor(s=null){this._target=s,this._listenersMap=null}clear(){var s;(s=this._listenersMap)==null||s.clear(),this._listenersMap=null}destroy(){this.clear()}emit(s,n){var g;let c=(g=this._listenersMap)==null?void 0:g.get(s);if(!c)return!1;const o=this._target||this;let p=!1;for(const S of c.slice()){const M="deref"in S?S.deref():S;M?M==null||M.call(o,n):p=!0}return p&&(c=c.filter(S=>!("deref"in S)||S.deref()!=null),this._listenersMap.set(s,c)),c.length>0}on(s,n){if(Array.isArray(s)){const o=s.map(p=>this.on(p,n));return l_(o)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const c=this._listenersMap.get(s)||[];return c.push(n),this._listenersMap.set(s,c),Qi(()=>{var g;const o=(g=this._listenersMap)==null?void 0:g.get(s),p=(o==null?void 0:o.indexOf(n))??-1;p>=0&&o.splice(p,1)})}once(s,n){const c=this.on(s,o=>{c.remove();const p="deref"in n?n.deref():n;p==null||p.call(null,o)});return c}hasEventListener(s){var c;const n=(c=this._listenersMap)==null?void 0:c.get(s);return n!=null&&n.length>0}}e.EventEmitter=t,e.EventedMixin=r=>{let s=class extends r{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(n,c){return this._emitter.emit(n,c)}on(n,c){return this._emitter.on(n,c)}once(n,c){return this._emitter.once(n,c)}hasEventListener(n){return this._emitter.hasEventListener(n)}};return s=v([me("esri.core.Evented")],s),s};let i=class extends zt{constructor(){super(...arguments),this._emitter=new Uv.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,s){return this._emitter.emit(r,s)}on(r,s){return this._emitter.on(r,s)}once(r,s){return this._emitter.once(r,s)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=v([me("esri.core.Evented")],i),e.EventedAccessor=i})(Uv||(Uv={}));const xh=Uv;var Ci;(function(e){e[e.ADD=1]="ADD",e[e.REMOVE=2]="REMOVE",e[e.MOVE=4]="MOVE"})(Ci||(Ci={}));function q4(e){return(t,i)=>{t[i]=e}}let f_=class extends V5{notify(){const t=this._observers;if(t&&t.length>0){const i=t.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}};var Cc;let RH=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},OH=class{constructor(t,i,r,s,n){this.target=t,this.added=i,this.removed=r,this.start=s,this.deleteCount=n}};const zo=new Ip(RH,void 0,e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1});function yS(e){return e?e instanceof Mc?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function gS(e){if(e!=null&&e.length)return e[0]}function LH(e,t,i,r){const s=Math.min(e.length-i,t.length-r);let n=0;for(;n<s&&e[i+n]===t[r+n];)n++;return n}function H4(e,t,i,r){t&&t.forEach((s,n,c)=>{e.push(s),H4(e,i.call(r,s,n,c),i,r)})}const yu=new Set,gu=new Set,_u=new Set,_S=new Map;let DH=0,Mc=Cc=class extends xh.EventedAccessor{static isCollection(e){return e!=null&&e instanceof Cc}constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new f_,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:DH++})}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof Cc?{items:e}:e:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return Ot(this._observable),this._items}set items(e){this._emitBeforeChanges(Ci.ADD)||(this._splice(0,this.length,yS(e)),this._emitAfterChanges(Ci.ADD))}hasEventListener(e){return e==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if(e==="change"){const i=this._chgListeners,r={removed:!1,callback:t};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),Qi(()=>{r.removed=!0,i.splice(i.indexOf(r),1)})}return this._emitter.on(e,t)}once(e,t){const i="deref"in t?()=>t.deref():()=>t,r=this.on(e,s=>{var n;(n=i())==null||n.call(null,s),r.remove()});return r}add(e,t){if(Ot(this._observable),this._emitBeforeChanges(Ci.ADD))return this;const i=this.getNextIndex(t??null);return this._splice(i,0,[e]),this._emitAfterChanges(Ci.ADD),this}addMany(e,t=this._items.length){if(Ot(this._observable),!(e!=null&&e.length))return this;if(this._emitBeforeChanges(Ci.ADD))return this;const i=this.getNextIndex(t);return this._splice(i,0,yS(e)),this._emitAfterChanges(Ci.ADD),this}at(e){if(Ot(this._observable),(e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this._items[e]}removeAll(){if(Ot(this._observable),!this.length||this._emitBeforeChanges(Ci.REMOVE))return[];const e=this._removeAllRaw();return this._emitAfterChanges(Ci.REMOVE),e}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return Ot(this._observable),this._createNewInstance({items:this._items.map(He)})}concat(...e){Ot(this._observable);const t=e.map(yS);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if(Ot(this._observable),!this.length||this._emitBeforeChanges(Ci.REMOVE))return;const i=this._splice(0,this.length),r=i.length;for(let s=0;s<r;s++)e.call(t,i[s],s,i);this._emitAfterChanges(Ci.REMOVE)}every(e,t){return Ot(this._observable),this._items.every(e,t)}filter(e,t){let i;return Ot(this._observable),i=arguments.length===2?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:i})}find(e,t){return Ot(this._observable),this._items.find(e,t)}findIndex(e,t){return Ot(this._observable),this._items.findIndex(e,t)}flatten(e,t){Ot(this._observable);const i=[];return H4(i,this,e,t),new Cc(i)}forEach(e,t){return Ot(this._observable),this._items.forEach(e,t)}getItemAt(e){return Ot(this._observable),this._items[e]}getNextIndex(e){Ot(this._observable);const t=this.length;return(e=e??t)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return Ot(this._observable),this._items.includes(e,t)}indexOf(e,t=0){return Ot(this._observable),this._items.indexOf(e,t)}join(e=","){return Ot(this._observable),this._items.join(e)}lastIndexOf(e,t=this.length-1){return Ot(this._observable),this._items.lastIndexOf(e,t)}map(e,t){Ot(this._observable);const i=this._items.map(e,t);return new Cc({items:i})}reorder(e,t=this.length-1){Ot(this._observable);const i=this.indexOf(e);if(i!==-1){if(t<0?t=0:t>=this.length&&(t=this.length-1),i!==t){if(this._emitBeforeChanges(Ci.MOVE))return e;this._splice(i,1),this._splice(t,0,[e]),this._emitAfterChanges(Ci.MOVE)}return e}}pop(){if(Ot(this._observable),!this.length||this._emitBeforeChanges(Ci.REMOVE))return;const e=gS(this._splice(this.length-1,1));return this._emitAfterChanges(Ci.REMOVE),e}push(...e){return Ot(this._observable),this._emitBeforeChanges(Ci.ADD)||(this._splice(this.length,0,e),this._emitAfterChanges(Ci.ADD)),this.length}reduce(e,t){Ot(this._observable);const i=this._items;return arguments.length===2?i.reduce(e,t):i.reduce(e)}reduceRight(e,t){Ot(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(e,t):i.reduceRight(e)}remove(e){return Ot(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if(Ot(this._observable),e<0||e>=this.length||this._emitBeforeChanges(Ci.REMOVE))return;const t=gS(this._splice(e,1));return this._emitAfterChanges(Ci.REMOVE),t}removeMany(e){if(Ot(this._observable),!(e!=null&&e.length)||this._emitBeforeChanges(Ci.REMOVE))return[];const t=e instanceof Cc?e.toArray():e,i=this._items,r=[],s=t.length;for(let n=0;n<s;n++){const c=t[n],o=i.indexOf(c);if(o>-1){const p=1+LH(t,i,n+1,o+1),g=this._splice(o,p);g&&g.length>0&&r.push.apply(r,g),n+=p-1}}return this._emitAfterChanges(Ci.REMOVE),r}reverse(){if(Ot(this._observable),this._emitBeforeChanges(Ci.MOVE))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,e)),this._emitAfterChanges(Ci.MOVE),this}shift(){if(Ot(this._observable),!this.length||this._emitBeforeChanges(Ci.REMOVE))return;const e=gS(this._splice(0,1));return this._emitAfterChanges(Ci.REMOVE),e}slice(e=0,t=this.length){return Ot(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return Ot(this._observable),this._items.some(e,t)}sort(e){if(Ot(this._observable),!this.length||this._emitBeforeChanges(Ci.MOVE))return this;const t=this._splice(0,this.length);return arguments.length?t.sort(e):t.sort(),this._splice(0,0,t),this._emitAfterChanges(Ci.MOVE),this}splice(e,t,...i){Ot(this._observable);const r=(t?Ci.REMOVE:0)|(i.length?Ci.ADD:0);if(this._emitBeforeChanges(r))return[];const s=this._splice(e,t,i)||[];return this._emitAfterChanges(r),s}toArray(){return Ot(this._observable),this._items.slice()}toJSON(){return Ot(this._observable),this.toArray()}toLocaleString(){return Ot(this._observable),this._items.toLocaleString()}toString(){return Ot(this._observable),this._items.toString()}unshift(...e){return Ot(this._observable),!e.length||this._emitBeforeChanges(Ci.ADD)||(this._splice(0,0,e),this._emitAfterChanges(Ci.ADD)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,i){const r=this._items,s=this.itemType;let n,c;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=d_(()=>this._dispatchChange())),e<0&&(e+=this.length),t){if(c=r.splice(e,t),this.hasEventListener("before-remove")){const o=zo.acquire();o.target=this,o.cancellable=!0;for(let p=0,g=c.length;p<g;p++)n=c[p],o.reset(n),this.emit("before-remove",o),o.defaultPrevented&&(c.splice(p,1),r.splice(e,0,n),e+=1,p-=1,g-=1);zo.release(o)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const o=zo.acquire();o.target=this,o.cancellable=!1;const p=c.length;for(let g=0;g<p;g++)o.reset(c[g]),this.emit("after-remove",o);zo.release(o)}}if(i!=null&&i.length){if(s){const S=[];for(const M of i){const A=s.ensureType(M);A==null&&M!=null||S.push(A)}i=S}const o=this.hasEventListener("before-add"),p=this.hasEventListener("after-add"),g=e===this.length;if(o||p){const S=zo.acquire();S.target=this,S.cancellable=!0;const M=zo.acquire();M.target=this,M.cancellable=!1;for(const A of i)o?(S.reset(A),this.emit("before-add",S),S.defaultPrevented||(g?r.push(A):r.splice(e++,0,A),this._set("length",r.length),p&&(M.reset(A),this.emit("after-add",M)))):(g?r.push(A):r.splice(e++,0,A),this._set("length",r.length),M.reset(A),this.emit("after-add",M));zo.release(M),zo.release(S)}else{if(g)for(const S of i)r.push(S);else r.splice(e,0,...i);this._set("length",r.length)}}if((i!=null&&i.length||c!=null&&c.length)&&this._notifyChangeEvent(i,c),this.hasEventListener("after-splice")){const o=new OH(this,i,c,e,t);this.emit("after-splice",o)}return c}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const i=zo.acquire();i.target=this,i.cancellable=!0,i.type=e,this.emit("before-changes",i),t=i.defaultPrevented,zo.release(i)}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=zo.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),zo.release(t)}this._observable.notify()}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const i=t.changes;yu.clear(),gu.clear(),_u.clear();for(const{added:p,removed:g}of i){if(p)if(_u.size===0&&gu.size===0)for(const S of p)yu.add(S);else for(const S of p)gu.has(S)?(_u.add(S),gu.delete(S)):_u.has(S)||yu.add(S);if(g)if(_u.size===0&&yu.size===0)for(const S of g)gu.add(S);else for(const S of g)yu.has(S)?yu.delete(S):(_u.delete(S),gu.add(S))}const r=kn.acquire();yu.forEach(p=>{r.push(p)});const s=kn.acquire();gu.forEach(p=>{s.push(p)});const n=this._items,c=t.items,o=kn.acquire();if(_u.forEach(p=>{c.indexOf(p)!==n.indexOf(p)&&o.push(p)}),t.listeners&&(r.length||s.length||o.length)){const p={target:this,added:r,removed:s,moved:o},g=t.listeners.length;for(let S=0;S<g;S++){const M=t.listeners[S];M.removed||M.callback.call(this,p)}}kn.release(r),kn.release(s),kn.release(o)}yu.clear(),gu.clear(),_u.clear()}};Mc.ofType=e=>{if(!e)return Cc;if(_S.has(e))return _S.get(e);let t=null;if(typeof e=="function")t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(const r in e.typeMap){const s=e.typeMap[r].prototype.declaredClass;t?t+=` | ${s}`:t=s}let i=class extends Cc{};return v([q4({Type:e,ensureType:typeof e=="function"?zn(e):Uc(e)})],i.prototype,"itemType",void 0),i=v([me(`esri.core.Collection<${t}>`)],i),_S.set(e,i),i},v([I()],Mc.prototype,"_updating",void 0),v([I()],Mc.prototype,"length",void 0),v([I()],Mc.prototype,"items",null),v([I({readOnly:!0})],Mc.prototype,"updating",null),Mc=Cc=v([me("esri.core.Collection")],Mc);const Ut=Mc;function dp(e,t,i=Ut){return t||(t=new i),t===e||(t.removeAll(),NH(e)?t.addMany(e):e&&t.add(e)),t}function W4(e){return e}function NH(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}var Yu;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(Yu||(Yu={}));let zH=class{constructor(){this._resolver=sa(),this._status=Yu.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=Yu.RESOLVED,this._cleanUp()},()=>{this._status=Yu.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===Yu.RESOLVED}isRejected(){return this._status===Yu.REJECTED}isFulfilled(){return this._status!==Yu.PENDING}abort(){this._resolver.reject(Nr())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=sa(),i=[...this._resolvingPromises,t.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},s=>{this.isFulfilled()||this._allPromise!==r||qs(s)||this._resolver.reject(s)}),t.resolve()}};const _A=e=>{let t=class extends e{constructor(...i){super(...i),this._promiseProps=new zH,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return this._promiseProps.promise.then(()=>this).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return t=v([me("esri.core.Promise")],t),t};let nw=class extends _A(zt){};nw=v([me("esri.core.Promise")],nw);const FH="not-loaded",BH="loading",UH="failed",I$="loaded",Z4=e=>{let t=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(r=>{const s=this.load.bind(this);this.load=n=>{const c=new Promise((o,p)=>{const g=eA(n,p);this.destroyed&&p(new Je("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(o,p).finally(()=>{g&&g.remove()})});if(this.loadStatus===FH){this._set("loadStatus",BH);const o=this._loadController=new AbortController;s({signal:o.signal})}return r(),c}})),this.when(()=>{this._set("loadStatus",I$),this._loadController=null},r=>{this._set("loadStatus",UH),this._set("loadError",r),this._loadController=null})}destroy(){this._loadController&&(this._loadController=L0(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===I$}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new Je("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort(),this._promiseProps.abort()),this}};return v([I({readOnly:!0})],t.prototype,"loaded",null),v([I({readOnly:!0})],t.prototype,"loadError",void 0),v([I({clonable:!1})],t.prototype,"loadStatus",void 0),v([I({type:[jc],readOnly:!0})],t.prototype,"loadWarnings",null),t=v([me("esri.core.Loadable")],t),t};let Sg=class extends Z4(nw){};Sg=v([me("esri.core.Loadable")],Sg),function(e){function t(i){return!(!i||!i.load)}e.LoadableMixin=Z4,e.isLoadable=t}(Sg||(Sg={}));const hh=Sg;function Nye(e,t,i){return tA(e.map((r,s)=>t.apply(i,[r,s])))}async function jH(e,t,i){return(await tA(e.map((r,s)=>t.apply(i,[r,s])))).map(r=>r.value)}function vA(e){return{ok:!0,value:e}}function bA(e){return{ok:!1,error:e}}function VH(e){return e!=null&&e.ok===!0?e.value:null}function GH(e){return e!=null&&e.ok===!1?e.error:null}async function wA(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return vA(await e)}catch(t){return bA(t)}}async function zye(e){try{return vA(await e)}catch(t){return Na(t),bA(t)}}function px(e,t){return new Iu(e,t)}let Iu=class extends zt{get value(){return VH(this._result)}get error(){return GH(this._result)}get finished(){return this._result!=null}constructor(t,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=L0(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=t(r),this.promise.then(s=>{this._result=vA(s),this._cleanup()},s=>{this._result=bA(s),this._cleanup()}),this._abortHandle=eo(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=gr(this._abortHandle),this._abortController=null}};v([I()],Iu.prototype,"value",null),v([I()],Iu.prototype,"error",null),v([I()],Iu.prototype,"finished",null),v([I()],Iu.prototype,"promise",void 0),v([I()],Iu.prototype,"_result",void 0),Iu=v([me("esri.core.asyncUtils.ReactiveTask")],Iu);async function Y4(e,t){return await e.load(),qH(e,t)}async function qH(e,t){const i=[],r=(...n)=>{for(const c of n)c!=null&&(Array.isArray(c)?r(...c):Ut.isCollection(c)?c.forEach(o=>r(o)):hh.isLoadable(c)&&i.push(c))};t(r);let s=null;if(await jH(i,async n=>{const c=await wA(HH(n)?n.loadAll():n.load());c.ok!==!1||s||(s=c)}),s)throw s.error;return e}function HH(e){return"loadAll"in e&&typeof e.loadAll=="function"}function ci(e,t,i){let r,s;return t===void 0?(s=e,r=[void 0]):typeof t!="string"?(s=e,r=[void 0],i=t):(s=t,r=Array.isArray(e)?e:[e]),(n,c)=>{const o=n.constructor.prototype;for(const p of r){const g=d4(n,p,s);g.write&&typeof g.write=="object"||(g.write={}),i&&(g.write.target=i),g.write.writer=o[c]}}}let Ms=class{constructor(t,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,s,n)=>{const c=this.toJSON(r);c!==void 0&&Ep(n,c,s)},this.write.isJSONMapWriter=!0}toJSON(t){if(t==null)return null;if(this._apiToJSON.hasOwnProperty(t)){const i=this._apiToJSON[t];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return t!=null&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const i={};for(const r in t)i[t[r]]=r;return i}_getKeysSorted(t){const i=[];for(const r in t)i.push(r);return i.sort(),i}};function Fn(){return function(e,t){return new Ms(e,{ignoreUnknown:!0,...t})}}let xA=class{constructor(t,i,r,s){this.semiMajorAxis=t,this.flattening=i,this.outerAtmosphereRimWidth=r;const n=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*n,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=s||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Ar=new xA(6378137,1/298.257223563,3e5,.006694379990137799),Cl=new xA(3396190,1/169.8944472236118,23e4),dh=new xA(1737400,0,0);function $i(e){if(!Pi.assetsPath)throw _t.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Je("assets:path-not-set","config.assetsPath is not set");return hp(Pi.assetsPath,e)}let vS,Ee=null;function SA(){return!!Ee}function WH(){return!!Le("esri-wasm")}function J4(){return vS||(vS=ht(()=>import("./pe-wasm-DylKfJeD.js"),[]).then(e=>e.p).then(({default:e})=>e({locateFile:t=>$i(`esri/geometry/support/${t}`)})).then(e=>{X4(e)}),vS)}var KT,hr,XT;(function(e){function t(n,c,o){Ee.ensureCache.prepare();const p=Ld(o),g=o===p,S=Ee.ensureFloat64(p),M=Ee._pe_geog_to_proj(Ee.getPointer(n),c,S);return M&&eh(o,c,S,g),M}function i(n,c,o,p){switch(p){case hr.PE_TRANSFORM_P_TO_G:return r(n,c,o);case hr.PE_TRANSFORM_G_TO_P:return t(n,c,o)}return 0}function r(n,c,o){return s(n,c,o,0)}function s(n,c,o,p){Ee.ensureCache.prepare();const g=Ld(o),S=o===g,M=Ee.ensureFloat64(g),A=Ee._pe_proj_to_geog_center(Ee.getPointer(n),c,M,p);return A&&eh(o,c,M,S),A}e.geogToProj=t,e.projGeog=i,e.projToGeog=r,e.projToGeogCenter=s})(KT||(KT={})),function(e){function t(){e.PE_BUFFER_MAX=Ee.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=Ee.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=Ee.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=Ee.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=Ee.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=Ee.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=Ee.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=Ee.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=Ee.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=Ee.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=Ee.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=Ee.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=Ee.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=Ee.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=Ee.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=Ee.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=Ee.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=Ee.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=Ee.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=Ee.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_STR_FMT_WKT=Ee.PeDefs.prototype.PE_STR_FMT_WKT,e.PE_STR_FMT_WKT2=Ee.PeDefs.prototype.PE_STR_FMT_WKT2,e.PE_PARM_X0=Ee.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=Ee.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=Ee.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=Ee.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=Ee.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=Ee.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=Ee.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=Ee.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=Ee.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=Ee.PeDefs.prototype.PE_HORIZON_DELTA}e.init=t}(hr||(hr={})),function(e){const t={},i={},r=O=>{if(O){const z=O.getType();switch(z){case hr.PE_TYPE_GEOGCS:O=Ee.castObject(O,Ee.PeGeogcs);break;case hr.PE_TYPE_PROJCS:O=Ee.castObject(O,Ee.PeProjcs);break;case hr.PE_TYPE_GEOGTRAN:O=Ee.castObject(O,Ee.PeGeogtran);break;default:z&hr.PE_TYPE_UNIT&&(O=Ee.castObject(O,Ee.PeUnit))}}return O};function s(){Ee.PeFactory.prototype.initialize(null)}function n(O){return c(hr.PE_TYPE_COORDSYS,O)}function c(O,z){let V=null,W=t[O];if(W||(W={},t[O]=W),W.hasOwnProperty(String(z)))V=W[z];else{const ie=Ee.PeFactory.prototype.factoryByType(O,z);Ee.compare(ie,Ee.NULL)||(V=ie,W[z]=V)}return V=r(V),V}function o(O,z){let V=null,W=i[O];if(W||(W={},i[O]=W),W.hasOwnProperty(z))V=W[z];else{const ie=Ee.PeFactory.prototype.fromString(O,z);Ee.compare(ie,Ee.NULL)||(V=ie,W[z]=V)}return V=r(V),V}function p(O){return c(hr.PE_TYPE_GEOGCS,O)}function g(O){return c(hr.PE_TYPE_GEOGTRAN,O)}function S(O){return Ee.PeFactory.prototype.getCode(O)}function M(O){return c(hr.PE_TYPE_PROJCS,O)}function A(O){return c(hr.PE_TYPE_UNIT,O)}e.initialize=s,e.coordsys=n,e.factoryByType=c,e.fromString=o,e.geogcs=p,e.geogtran=g,e.getCode=S,e.projcs=M,e.unit=A}(XT||(XT={}));let K4=null;var ow,QT,eE,tE,aw,iE,lw,cw,rE;function X4(e){function t(n,c,o){n[c]=o(n[c])}Ee=e,hr.init(),ow.init(),aw.init(),lw.init(),cw.init(),K4=class extends Ee.PeGCSExtent{destroy(){Ee.destroy(this)}};const i=[Ee.PeDatum,Ee.PeGeogcs,Ee.PeGeogtran,Ee.PeObject,Ee.PeParameter,Ee.PePrimem,Ee.PeProjcs,Ee.PeSpheroid,Ee.PeUnit];for(const n of i)t(n.prototype,"getName",c=>function(){return c.call(this,new Array(hr.PE_NAME_MAX))});for(const n of[Ee.PeGeogtran,Ee.PeProjcs])t(n.prototype,"getParameters",c=>function(){const o=new Array(hr.PE_PARM_MAX);let p=c.call(this);for(let g=0;g<o.length;g++){const S=Ee.getValue(p,"*");o[g]=S?Ee.wrapPointer(S,Ee.PeParameter):null,p+=Int32Array.BYTES_PER_ELEMENT}return o});t(Ee.PeHorizon.prototype,"getCoord",n=>function(){const c=this.getSize();if(!c)return null;const o=[];return eh(o,c,n.call(this)),o}),t(Ee.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const c=Ee._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const p=n.call(this);if(!Ee.compare(p,Ee.NULL)){o=[p];const g=this.getSteps();if(g>1){const S=Ee.getPointer(p);for(let M=1;M<g;M++)o.push(Ee.wrapPointer(S+c*M,Ee.PeGTlistExtendedGTs))}}return o}});const r=Ee._pe_getPeHorizonSize(),s=n=>function(){let c=this._cache;if(c||(c=new Map,this._cache=c),c.has(n))return c.get(n);let o=null;const p=n.call(this);if(!Ee.compare(p,Ee.NULL)){o=[p];const g=p.getNump();if(g>1){const S=Ee.getPointer(p);for(let M=1;M<g;M++)o.push(Ee.wrapPointer(S+r*M,Ee.PeHorizon))}}return c.set(n,o),o};t(Ee.PeProjcs.prototype,"horizonGcsGenerate",s),t(Ee.PeProjcs.prototype,"horizonPcsGenerate",s),Ee.PeObject.prototype.toString=function(n=hr.PE_STR_OPTS_NONE){Ee.ensureCache.prepare();const c=Ee.getPointer(this),o=Ee.ensureInt8(new Array(hr.PE_BUFFER_MAX));return Ee.UTF8ToString(Ee._pe_object_to_string_ext(c,n,o))}}function hc(e){if(!e)return;const t=Ee.getClass(e);if(!t)return;const i=Ee.getCache(t);if(!i)return;const r=Ee.getPointer(e);r&&delete i[r]}function H1(e,t){const i=[],r=new Array(t);for(let s=0;s<e;s++)i.push(Ee.ensureInt8(r));return i}function Ld(e){let t;return Array.isArray(e[0])?(t=[],e.forEach(i=>{t.push(i[0],i[1])})):t=e,t}function eh(e,t,i,r=!1){if(r)for(let s=0;s<2*t;s++)e[s]=Ee.getValue(i+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=e.length===0;for(let n=0;n<t;n++)s&&(e[n]=new Array(2)),e[n][0]=Ee.getValue(i,"double"),e[n][1]=Ee.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(e){let t;function i(){e.PE_GTLIST_OPTS_COMMON=Ee.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=Ee._pe_getPeGTlistExtendedEntrySize()}function r(s,n,c,o,p,g){let S=null;const M=new Ee.PeInteger(g);try{const A=Ee.PeGTlistExtended.prototype.getGTlist(s,n,c,o,p,M);if((g=M.val)&&(S=[A],g>1)){const O=Ee.getPointer(A);for(let z=1;z<g;z++)S.push(Ee.wrapPointer(O+t*z,Ee.PeGTlistExtendedEntry))}}finally{Ee.destroy(M)}return S}e.init=i,e.getGTlist=r})(ow||(ow={})),function(e){function t(i){if(i!=null&&i.length){for(const r of i)hc(r),r.getEntries().forEach(s=>{hc(s);const n=s.getGeogtran();hc(n),n.getParameters().forEach(hc),[n.getGeogcs1(),n.getGeogcs2()].forEach(c=>{hc(c);const o=c.getDatum();hc(o),hc(o.getSpheroid()),hc(c.getPrimem()),hc(c.getUnit())})});Ee.PeGTlistExtendedEntry.prototype.Delete(i[0])}}e.destroy=t}(QT||(QT={})),function(e){function t(i,r,s,n,c){Ee.ensureCache.prepare();const o=Ld(s),p=s===o,g=Ee.ensureFloat64(o);let S=0;n&&(S=Ee.ensureFloat64(n));const M=Ee._pe_geog_to_geog(Ee.getPointer(i),r,g,S,c);return M&&eh(s,r,g,p),M}e.geogToGeog=t}(eE||(eE={})),function(e){const t=(g,S,M,A,O,z)=>{let V,W;switch(Ee.ensureCache.prepare(),g){case"dd":V=Ee._pe_geog_to_dd,W=hr.PE_DD_MAX;break;case"ddm":V=Ee._pe_geog_to_ddm,W=hr.PE_DDM_MAX;break;case"dms":V=Ee._pe_geog_to_dms,W=hr.PE_DMS_MAX}let ie=0;S&&(ie=Ee.getPointer(S));const ve=Ld(A),pe=Ee.ensureFloat64(ve),_e=H1(M,W),Me=V(ie,M,pe,O,Ee.ensureInt32(_e));if(Me)for(let $e=0;$e<M;$e++)z[$e]=Ee.UTF8ToString(_e[$e]);return Me},i=(g,S,M,A,O)=>{let z;switch(Ee.ensureCache.prepare(),g){case"dd":z=Ee._pe_dd_to_geog;break;case"ddm":z=Ee._pe_ddm_to_geog;break;case"dms":z=Ee._pe_dms_to_geog}let V=0;S&&(V=Ee.getPointer(S));const W=A.map(_e=>Ee.ensureString(_e)),ie=Ee.ensureInt32(W),ve=Ee.ensureFloat64(new Array(2*M)),pe=z(V,M,ie,ve);return pe&&eh(O,M,ve),pe};function r(g,S,M,A,O){return t("dms",g,S,M,A,O)}function s(g,S,M,A){return i("dms",g,S,M,A)}function n(g,S,M,A,O){return t("ddm",g,S,M,A,O)}function c(g,S,M,A){return i("ddm",g,S,M,A)}function o(g,S,M,A,O){return t("dd",g,S,M,A,O)}function p(g,S,M,A){return i("dd",g,S,M,A)}e.geogToDms=r,e.dmsToGeog=s,e.geogToDdm=n,e.ddmToGeog=c,e.geogToDd=o,e.ddToGeog=p}(tE||(tE={})),function(e){function t(){e.PE_MGRS_STYLE_NEW=Ee.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=Ee.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=Ee.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=Ee.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=Ee.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(s,n,c,o,p,g,S){Ee.ensureCache.prepare();let M=0;s&&(M=Ee.getPointer(s));const A=Ld(c),O=Ee.ensureFloat64(A),z=H1(n,hr.PE_MGRS_MAX),V=Ee.ensureInt32(z),W=Ee._pe_geog_to_mgrs_extended(M,n,O,o,p,g,V);if(W)for(let ie=0;ie<n;ie++)S[ie]=Ee.UTF8ToString(z[ie]);return W}function r(s,n,c,o,p){Ee.ensureCache.prepare();let g=0;s&&(g=Ee.getPointer(s));const S=c.map(z=>Ee.ensureString(z)),M=Ee.ensureInt32(S),A=Ee.ensureFloat64(new Array(2*n)),O=Ee._pe_mgrs_to_geog_extended(g,n,M,o,A);return O&&eh(p,n,A),O}e.init=t,e.geogToMgrsExtended=i,e.mgrsToGeogExtended=r}(aw||(aw={})),function(e){function t(r,s,n,c,o,p,g){Ee.ensureCache.prepare();let S=0;r&&(S=Ee.getPointer(r));const M=Ld(n),A=Ee.ensureFloat64(M),O=H1(s,hr.PE_MGRS_MAX),z=Ee.ensureInt32(O),V=Ee._pe_geog_to_usng(S,s,A,c,o,p,z);if(V)for(let W=0;W<s;W++)g[W]=Ee.UTF8ToString(O[W]);return V}function i(r,s,n,c){Ee.ensureCache.prepare();let o=0;r&&(o=Ee.getPointer(r));const p=n.map(A=>Ee.ensureString(A)),g=Ee.ensureInt32(p),S=Ee.ensureFloat64(new Array(2*s)),M=Ee._pe_usng_to_geog(o,s,g,S);return M&&eh(c,s,S),M}e.geogToUsng=t,e.usngToGeog=i}(iE||(iE={})),function(e){function t(){e.PE_UTM_OPTS_NONE=Ee.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=Ee.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=Ee.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(s,n,c,o,p){Ee.ensureCache.prepare();let g=0;s&&(g=Ee.getPointer(s));const S=Ld(c),M=Ee.ensureFloat64(S),A=H1(n,hr.PE_UTM_MAX),O=Ee.ensureInt32(A),z=Ee._pe_geog_to_utm(g,n,M,o,O);if(z)for(let V=0;V<n;V++)p[V]=Ee.UTF8ToString(A[V]);return z}function r(s,n,c,o,p){Ee.ensureCache.prepare();let g=0;s&&(g=Ee.getPointer(s));const S=c.map(z=>Ee.ensureString(z)),M=Ee.ensureInt32(S),A=Ee.ensureFloat64(new Array(2*n)),O=Ee._pe_utm_to_geog(g,n,M,o,A);return O&&eh(p,n,A),O}e.init=t,e.geogToUtm=i,e.utmToGeog=r}(lw||(lw={})),function(e){const t=new Map;function i(){e.PE_PCSINFO_OPTION_NONE=Ee.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=Ee.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=Ee.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=Ee.PePCSInfo.prototype.PE_POLE_POINT}function r(s,n=e.PE_PCSINFO_OPTION_DOMAIN){let c=null,o=null;return t.has(s)&&(o=t.get(s),o[n]&&(c=o[n])),c||(c=Ee.PePCSInfo.prototype.generate(s,n),o||(o=[],t.set(s,o)),o[n]=c),c}e.init=i,e.generate=r}(cw||(cw={})),function(e){function t(){return Ee.PeVersion.prototype.version_string()}e.versionString=t}(rE||(rE={}));const ZH=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return KT},get PeDefs(){return hr},get PeFactory(){return XT},get PeGCSExtent(){return K4},get PeGTTransformations(){return eE},get PeGTlistExtended(){return ow},get PeGTlistExtendedEntry(){return QT},get PeNotationDms(){return tE},get PeNotationMgrs(){return aw},get PeNotationUsng(){return iE},get PeNotationUtm(){return lw},get PePCSInfo(){return cw},get PeVersion(){return rE},_init:X4,get _pe(){return Ee},isLoaded:SA,isSupported:WH,load:J4},Symbol.toStringTag,{value:"Module"}));var pp;(function(e){e[e.CGCS2000=4490]="CGCS2000",e[e.GCSMARS2000=104971]="GCSMARS2000",e[e.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",e[e.GCSMOON2000=104903]="GCSMOON2000"})(pp||(pp={}));let y;const q={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(y=2e3;y<=2045;y++)q[y]=0;for(y=2056;y<=2065;y++)q[y]=0;for(y=2067;y<=2135;y++)q[y]=0;for(y=2137;y<=2154;y++)q[y]=0;for(y=2161;y<=2170;y++)q[y]=0;for(y=2172;y<=2193;y++)q[y]=0;for(y=2195;y<=2198;y++)q[y]=0;for(y=2200;y<=2203;y++)q[y]=0;for(y=2205;y<=2217;y++)q[y]=0;for(y=2222;y<=2224;y++)q[y]=1;for(y=2225;y<=2250;y++)q[y]=2;for(y=2251;y<=2253;y++)q[y]=1;for(y=2257;y<=2264;y++)q[y]=2;for(y=2274;y<=2279;y++)q[y]=2;for(y=2280;y<=2282;y++)q[y]=1;for(y=2283;y<=2289;y++)q[y]=2;for(y=2290;y<=2292;y++)q[y]=0;for(y=2308;y<=2313;y++)q[y]=0;for(y=2315;y<=2491;y++)q[y]=0;for(y=2494;y<=2866;y++)q[y]=0;for(y=2867;y<=2869;y++)q[y]=1;for(y=2870;y<=2888;y++)q[y]=2;for(y=2891;y<=2895;y++)q[y]=2;for(y=2896;y<=2898;y++)q[y]=1;for(y=2902;y<=2908;y++)q[y]=2;for(y=2915;y<=2920;y++)q[y]=2;for(y=2921;y<=2923;y++)q[y]=1;for(y=2924;y<=2930;y++)q[y]=2;for(y=2931;y<=2962;y++)q[y]=0;for(y=2964;y<=2968;y++)q[y]=2;for(y=2969;y<=2973;y++)q[y]=0;for(y=2975;y<=2991;y++)q[y]=0;for(y=2995;y<=3051;y++)q[y]=0;for(y=3054;y<=3079;y++)q[y]=0;for(y=3081;y<=3088;y++)q[y]=0;for(y=3092;y<=3101;y++)q[y]=0;for(y=3106;y<=3138;y++)q[y]=0;for(y=3146;y<=3151;y++)q[y]=0;for(y=3153;y<=3166;y++)q[y]=0;for(y=3168;y<=3172;y++)q[y]=0;for(y=3174;y<=3203;y++)q[y]=0;for(y=3294;y<=3358;y++)q[y]=0;for(y=3367;y<=3403;y++)q[y]=0;for(y=3408;y<=3416;y++)q[y]=0;for(y=3417;y<=3438;y++)q[y]=2;for(y=3441;y<=3446;y++)q[y]=2;for(y=3447;y<=3450;y++)q[y]=0;for(y=3451;y<=3459;y++)q[y]=2;for(y=3460;y<=3478;y++)q[y]=0;for(y=3554;y<=3559;y++)q[y]=0;for(y=3560;y<=3570;y++)q[y]=2;for(y=3571;y<=3581;y++)q[y]=0;for(y=3594;y<=3597;y++)q[y]=0;for(y=3601;y<=3604;y++)q[y]=0;for(y=3637;y<=3639;y++)q[y]=0;for(y=3665;y<=3667;y++)q[y]=0;for(y=3693;y<=3695;y++)q[y]=0;for(y=3701;y<=3727;y++)q[y]=0;for(y=3728;y<=3739;y++)q[y]=2;for(y=3740;y<=3751;y++)q[y]=0;for(y=3753;y<=3760;y++)q[y]=2;for(y=3761;y<=3773;y++)q[y]=0;for(y=3775;y<=3777;y++)q[y]=0;for(y=3779;y<=3781;y++)q[y]=0;for(y=3783;y<=3785;y++)q[y]=0;for(y=3788;y<=3791;y++)q[y]=0;for(y=3797;y<=3802;y++)q[y]=0;for(y=3814;y<=3816;y++)q[y]=0;for(y=3825;y<=3829;y++)q[y]=0;for(y=3832;y<=3841;y++)q[y]=0;for(y=3844;y<=3852;y++)q[y]=0;for(y=3873;y<=3885;y++)q[y]=0;for(y=3890;y<=3893;y++)q[y]=0;for(y=3907;y<=3912;y++)q[y]=0;for(y=3942;y<=3950;y++)q[y]=0;for(y=3968;y<=3970;y++)q[y]=0;for(y=3973;y<=3976;y++)q[y]=0;for(y=3986;y<=3989;y++)q[y]=0;for(y=3994;y<=3997;y++)q[y]=0;for(y=4048;y<=4051;y++)q[y]=0;for(y=4056;y<=4063;y++)q[y]=0;for(y=4093;y<=4096;y++)q[y]=0;for(y=4390;y<=4398;y++)q[y]=0;for(y=4399;y<=4413;y++)q[y]=2;for(y=4418;y<=4433;y++)q[y]=2;for(y=4455;y<=4457;y++)q[y]=2;for(y=4484;y<=4489;y++)q[y]=0;for(y=4491;y<=4554;y++)q[y]=0;for(y=4568;y<=4589;y++)q[y]=0;for(y=4652;y<=4656;y++)q[y]=0;for(y=4766;y<=4800;y++)q[y]=0;for(y=5014;y<=5016;y++)q[y]=0;for(y=5069;y<=5072;y++)q[y]=0;for(y=5105;y<=5130;y++)q[y]=0;for(y=5167;y<=5188;y++)q[y]=0;for(y=5253;y<=5259;y++)q[y]=0;for(y=5269;y<=5275;y++)q[y]=0;for(y=5292;y<=5311;y++)q[y]=0;for(y=5329;y<=5331;y++)q[y]=0;for(y=5343;y<=5349;y++)q[y]=0;for(y=5355;y<=5357;y++)q[y]=0;for(y=5387;y<=5389;y++)q[y]=0;for(y=5459;y<=5463;y++)q[y]=0;for(y=5479;y<=5482;y++)q[y]=0;for(y=5518;y<=5520;y++)q[y]=0;for(y=5530;y<=5539;y++)q[y]=0;for(y=5550;y<=5552;y++)q[y]=0;for(y=5562;y<=5583;y++)q[y]=0;for(y=5623;y<=5625;y++)q[y]=2;for(y=5631;y<=5639;y++)q[y]=0;for(y=5649;y<=5653;y++)q[y]=0;for(y=5663;y<=5680;y++)q[y]=0;for(y=5682;y<=5685;y++)q[y]=0;for(y=5875;y<=5877;y++)q[y]=0;for(y=5896;y<=5899;y++)q[y]=0;for(y=5921;y<=5940;y++)q[y]=0;for(y=6050;y<=6125;y++)q[y]=0;for(y=6244;y<=6275;y++)q[y]=0;for(y=6328;y<=6348;y++)q[y]=0;for(y=6350;y<=6356;y++)q[y]=0;for(y=6366;y<=6372;y++)q[y]=0;for(y=6381;y<=6387;y++)q[y]=0;for(y=6393;y<=6404;y++)q[y]=0;for(y=6480;y<=6483;y++)q[y]=0;for(y=6511;y<=6514;y++)q[y]=0;for(y=6579;y<=6581;y++)q[y]=0;for(y=6619;y<=6624;y++)q[y]=0;for(y=6625;y<=6627;y++)q[y]=2;for(y=6628;y<=6632;y++)q[y]=0;for(y=6634;y<=6637;y++)q[y]=0;for(y=6669;y<=6692;y++)q[y]=0;for(y=6707;y<=6709;y++)q[y]=0;for(y=6720;y<=6723;y++)q[y]=0;for(y=6732;y<=6738;y++)q[y]=0;for(y=6931;y<=6933;y++)q[y]=0;for(y=6956;y<=6959;y++)q[y]=0;for(y=7005;y<=7007;y++)q[y]=0;for(y=7057;y<=7070;y++)q[y]=2;for(y=7074;y<=7082;y++)q[y]=0;for(y=7109;y<=7118;y++)q[y]=0;for(y=7119;y<=7127;y++)q[y]=1;for(y=7374;y<=7376;y++)q[y]=0;for(y=7528;y<=7586;y++)q[y]=0;for(y=7587;y<=7645;y++)q[y]=2;for(y=7692;y<=7696;y++)q[y]=0;for(y=7755;y<=7787;y++)q[y]=0;for(y=7791;y<=7795;y++)q[y]=0;for(y=7799;y<=7801;y++)q[y]=0;for(y=7803;y<=7805;y++)q[y]=0;for(y=7825;y<=7831;y++)q[y]=0;for(y=7845;y<=7859;y++)q[y]=0;for(y=8013;y<=8032;y++)q[y]=0;for(y=8065;y<=8068;y++)q[y]=1;for(y=8518;y<=8529;y++)q[y]=2;for(y=8533;y<=8536;y++)q[y]=2;for(y=8538;y<=8540;y++)q[y]=2;for(y=8677;y<=8679;y++)q[y]=0;for(y=8836;y<=8840;y++)q[y]=0;for(y=8857;y<=8859;y++)q[y]=0;for(y=8908;y<=8910;y++)q[y]=0;for(y=9154;y<=9159;y++)q[y]=0;for(y=9205;y<=9218;y++)q[y]=0;for(y=9271;y<=9273;y++)q[y]=0;for(y=9295;y<=9297;y++)q[y]=0;for(y=9356;y<=9360;y++)q[y]=0;for(y=9404;y<=9407;y++)q[y]=0;for(y=9476;y<=9482;y++)q[y]=0;for(y=9487;y<=9494;y++)q[y]=0;for(y=9697;y<=9699;y++)q[y]=0;for(y=9821;y<=9865;y++)q[y]=0;for(y=10285;y<=10291;y++)q[y]=0;for(y=10314;y<=10317;y++)q[y]=0;for(y=10448;y<=10465;y++)q[y]=0;for(y=11114;y<=11118;y++)q[y]=0;for(y=20004;y<=20032;y++)q[y]=0;for(y=20047;y<=20049;y++)q[y]=0;for(y=20062;y<=20092;y++)q[y]=0;for(y=20135;y<=20138;y++)q[y]=0;for(y=20248;y<=20258;y++)q[y]=0;for(y=20348;y<=20358;y++)q[y]=0;for(y=20436;y<=20440;y++)q[y]=0;for(y=20822;y<=20824;y++)q[y]=0;for(y=20904;y<=20932;y++)q[y]=0;for(y=20934;y<=20936;y++)q[y]=0;for(y=21004;y<=21032;y++)q[y]=0;for(y=21035;y<=21037;y++)q[y]=0;for(y=21095;y<=21097;y++)q[y]=0;for(y=21148;y<=21150;y++)q[y]=0;for(y=21207;y<=21264;y++)q[y]=0;for(y=21307;y<=21364;y++)q[y]=0;for(y=21413;y<=21423;y++)q[y]=0;for(y=21453;y<=21463;y++)q[y]=0;for(y=21473;y<=21483;y++)q[y]=0;for(y=21780;y<=21782;y++)q[y]=0;for(y=21891;y<=21894;y++)q[y]=0;for(y=21896;y<=21899;y++)q[y]=0;for(y=22171;y<=22177;y++)q[y]=0;for(y=22181;y<=22187;y++)q[y]=0;for(y=22191;y<=22197;y++)q[y]=0;for(y=22207;y<=22222;y++)q[y]=0;for(y=22229;y<=22232;y++)q[y]=0;for(y=22234;y<=22236;y++)q[y]=0;for(y=22243;y<=22250;y++)q[y]=0;for(y=22262;y<=22265;y++)q[y]=0;for(y=22307;y<=22322;y++)q[y]=0;for(y=22348;y<=22357;y++)q[y]=0;for(y=22407;y<=22422;y++)q[y]=0;for(y=22462;y<=22465;y++)q[y]=0;for(y=22521;y<=22525;y++)q[y]=0;for(y=22607;y<=22622;y++)q[y]=0;for(y=22641;y<=22646;y++)q[y]=0;for(y=22648;y<=22657;y++)q[y]=0;for(y=22707;y<=22722;y++)q[y]=0;for(y=22762;y<=22765;y++)q[y]=0;for(y=22807;y<=22822;y++)q[y]=0;for(y=22991;y<=22994;y++)q[y]=0;for(y=23028;y<=23038;y++)q[y]=0;for(y=23301;y<=23333;y++)q[y]=2;for(y=23830;y<=23853;y++)q[y]=0;for(y=23866;y<=23872;y++)q[y]=0;for(y=23877;y<=23884;y++)q[y]=0;for(y=23886;y<=23894;y++)q[y]=0;for(y=23946;y<=23948;y++)q[y]=0;for(y=24311;y<=24313;y++)q[y]=0;for(y=24342;y<=24347;y++)q[y]=0;for(y=24370;y<=24374;y++)q[y]=10;for(y=24375;y<=24381;y++)q[y]=0;for(y=24718;y<=24721;y++)q[y]=0;for(y=24817;y<=24821;y++)q[y]=0;for(y=24877;y<=24882;y++)q[y]=0;for(y=24891;y<=24893;y++)q[y]=0;for(y=25391;y<=25395;y++)q[y]=0;for(y=25828;y<=25838;y++)q[y]=0;for(y=26191;y<=26195;y++)q[y]=0;for(y=26391;y<=26393;y++)q[y]=0;for(y=26701;y<=26722;y++)q[y]=0;for(y=26729;y<=26799;y++)q[y]=2;for(y=26801;y<=26803;y++)q[y]=2;for(y=26811;y<=26813;y++)q[y]=2;for(y=26847;y<=26870;y++)q[y]=2;for(y=26891;y<=26899;y++)q[y]=0;for(y=26901;y<=26923;y++)q[y]=0;for(y=26929;y<=26946;y++)q[y]=0;for(y=26948;y<=26998;y++)q[y]=0;for(y=27037;y<=27040;y++)q[y]=0;for(y=27205;y<=27232;y++)q[y]=0;for(y=27258;y<=27260;y++)q[y]=0;for(y=27391;y<=27398;y++)q[y]=0;for(y=27561;y<=27564;y++)q[y]=0;for(y=27571;y<=27574;y++)q[y]=0;for(y=27581;y<=27584;y++)q[y]=0;for(y=27591;y<=27594;y++)q[y]=0;for(y=28191;y<=28193;y++)q[y]=0;for(y=28348;y<=28358;y++)q[y]=0;for(y=28402;y<=28432;y++)q[y]=0;for(y=28462;y<=28492;y++)q[y]=0;for(y=29118;y<=29122;y++)q[y]=0;for(y=29168;y<=29172;y++)q[y]=0;for(y=29177;y<=29185;y++)q[y]=0;for(y=29187;y<=29195;y++)q[y]=0;for(y=29900;y<=29903;y++)q[y]=0;for(y=30161;y<=30179;y++)q[y]=0;for(y=30491;y<=30494;y++)q[y]=0;for(y=30729;y<=30732;y++)q[y]=0;for(y=31251;y<=31259;y++)q[y]=0;for(y=31265;y<=31268;y++)q[y]=0;for(y=31275;y<=31279;y++)q[y]=0;for(y=31281;y<=31297;y++)q[y]=0;for(y=31461;y<=31469;y++)q[y]=0;for(y=31491;y<=31495;y++)q[y]=0;for(y=31917;y<=31922;y++)q[y]=0;for(y=31965;y<=32e3;y++)q[y]=0;for(y=32001;y<=32003;y++)q[y]=2;for(y=32005;y<=32031;y++)q[y]=2;for(y=32033;y<=32060;y++)q[y]=2;for(y=32064;y<=32067;y++)q[y]=2;for(y=32074;y<=32077;y++)q[y]=2;for(y=32081;y<=32086;y++)q[y]=0;for(y=32107;y<=32130;y++)q[y]=0;for(y=32133;y<=32159;y++)q[y]=0;for(y=32164;y<=32167;y++)q[y]=2;for(y=32180;y<=32199;y++)q[y]=0;for(y=32201;y<=32260;y++)q[y]=0;for(y=32301;y<=32360;y++)q[y]=0;for(y=32401;y<=32460;y++)q[y]=0;for(y=32501;y<=32560;y++)q[y]=0;for(y=32601;y<=32662;y++)q[y]=0;for(y=32664;y<=32667;y++)q[y]=2;for(y=32701;y<=32761;y++)q[y]=0;for(y=53001;y<=53004;y++)q[y]=0;for(y=53008;y<=53019;y++)q[y]=0;for(y=53021;y<=53032;y++)q[y]=0;for(y=53034;y<=53037;y++)q[y]=0;for(y=53042;y<=53046;y++)q[y]=0;for(y=53074;y<=53080;y++)q[y]=0;for(y=54001;y<=54004;y++)q[y]=0;for(y=54008;y<=54019;y++)q[y]=0;for(y=54021;y<=54032;y++)q[y]=0;for(y=54034;y<=54037;y++)q[y]=0;for(y=54042;y<=54046;y++)q[y]=0;for(y=54048;y<=54053;y++)q[y]=0;for(y=54074;y<=54080;y++)q[y]=0;for(y=54098;y<=54101;y++)q[y]=0;for(y=102001;y<=102040;y++)q[y]=0;for(y=102042;y<=102063;y++)q[y]=0;for(y=102065;y<=102067;y++)q[y]=0;for(y=102070;y<=102117;y++)q[y]=0;for(y=102122;y<=102216;y++)q[y]=0;for(y=102221;y<=102377;y++)q[y]=0;for(y=102382;y<=102388;y++)q[y]=0;for(y=102389;y<=102398;y++)q[y]=2;for(y=102399;y<=102444;y++)q[y]=0;for(y=102445;y<=102447;y++)q[y]=2;for(y=102448;y<=102458;y++)q[y]=0;for(y=102459;y<=102468;y++)q[y]=2;for(y=102469;y<=102499;y++)q[y]=0;for(y=102500;y<=102519;y++)q[y]=1;for(y=102520;y<=102524;y++)q[y]=0;for(y=102525;y<=102529;y++)q[y]=2;for(y=102530;y<=102588;y++)q[y]=0;for(y=102590;y<=102598;y++)q[y]=0;for(y=102601;y<=102603;y++)q[y]=0;for(y=102605;y<=102628;y++)q[y]=0;for(y=102629;y<=102646;y++)q[y]=2;for(y=102648;y<=102700;y++)q[y]=2;for(y=102701;y<=102703;y++)q[y]=0;for(y=102707;y<=102730;y++)q[y]=2;for(y=102733;y<=102758;y++)q[y]=2;for(y=102767;y<=102900;y++)q[y]=0;for(y=102901;y<=102933;y++)q[y]=2;for(y=102934;y<=102950;y++)q[y]=13;for(y=102951;y<=102955;y++)q[y]=0;for(y=102961;y<=102963;y++)q[y]=0;for(y=102965;y<=102969;y++)q[y]=0;for(y=102971;y<=102973;y++)q[y]=0;for(y=102975;y<=102989;y++)q[y]=0;for(y=102990;y<=102992;y++)q[y]=1;for(y=102997;y<=103002;y++)q[y]=0;for(y=103003;y<=103008;y++)q[y]=2;for(y=103009;y<=103011;y++)q[y]=0;for(y=103012;y<=103014;y++)q[y]=2;for(y=103019;y<=103021;y++)q[y]=0;for(y=103022;y<=103024;y++)q[y]=2;for(y=103029;y<=103031;y++)q[y]=0;for(y=103032;y<=103034;y++)q[y]=2;for(y=103065;y<=103068;y++)q[y]=0;for(y=103074;y<=103076;y++)q[y]=0;for(y=103077;y<=103079;y++)q[y]=1;for(y=103080;y<=103082;y++)q[y]=0;for(y=103083;y<=103085;y++)q[y]=2;for(y=103090;y<=103093;y++)q[y]=0;for(y=103097;y<=103099;y++)q[y]=0;for(y=103100;y<=103102;y++)q[y]=2;for(y=103107;y<=103109;y++)q[y]=0;for(y=103110;y<=103112;y++)q[y]=2;for(y=103113;y<=103116;y++)q[y]=0;for(y=103117;y<=103120;y++)q[y]=2;for(y=103153;y<=103157;y++)q[y]=0;for(y=103158;y<=103162;y++)q[y]=2;for(y=103163;y<=103165;y++)q[y]=0;for(y=103166;y<=103168;y++)q[y]=1;for(y=103169;y<=103171;y++)q[y]=2;for(y=103186;y<=103188;y++)q[y]=0;for(y=103189;y<=103191;y++)q[y]=2;for(y=103192;y<=103195;y++)q[y]=0;for(y=103196;y<=103199;y++)q[y]=2;for(y=103200;y<=103224;y++)q[y]=0;for(y=103225;y<=103227;y++)q[y]=1;for(y=103232;y<=103237;y++)q[y]=0;for(y=103238;y<=103243;y++)q[y]=2;for(y=103244;y<=103246;y++)q[y]=0;for(y=103247;y<=103249;y++)q[y]=2;for(y=103254;y<=103256;y++)q[y]=0;for(y=103257;y<=103259;y++)q[y]=2;for(y=103264;y<=103266;y++)q[y]=0;for(y=103267;y<=103269;y++)q[y]=2;for(y=103300;y<=103375;y++)q[y]=0;for(y=103381;y<=103383;y++)q[y]=0;for(y=103384;y<=103386;y++)q[y]=1;for(y=103387;y<=103389;y++)q[y]=0;for(y=103390;y<=103392;y++)q[y]=2;for(y=103397;y<=103399;y++)q[y]=0;for(y=103400;y<=103471;y++)q[y]=2;for(y=103476;y<=103478;y++)q[y]=0;for(y=103479;y<=103481;y++)q[y]=2;for(y=103486;y<=103488;y++)q[y]=0;for(y=103489;y<=103491;y++)q[y]=2;for(y=103492;y<=103495;y++)q[y]=0;for(y=103496;y<=103499;y++)q[y]=2;for(y=103528;y<=103543;y++)q[y]=0;for(y=103544;y<=103548;y++)q[y]=2;for(y=103549;y<=103551;y++)q[y]=0;for(y=103552;y<=103554;y++)q[y]=1;for(y=103555;y<=103557;y++)q[y]=2;for(y=103558;y<=103560;y++)q[y]=0;for(y=103571;y<=103573;y++)q[y]=0;for(y=103574;y<=103576;y++)q[y]=2;for(y=103577;y<=103580;y++)q[y]=0;for(y=103581;y<=103583;y++)q[y]=2;for(y=103595;y<=103694;y++)q[y]=0;for(y=103696;y<=103699;y++)q[y]=0;for(y=103700;y<=103793;y++)q[y]=2;for(y=103794;y<=103890;y++)q[y]=0;for(y=103891;y<=103896;y++)q[y]=2;for(y=103900;y<=103971;y++)q[y]=2;for(y=103972;y<=103977;y++)q[y]=0;for(y=112e3;y<=112101;y++)q[y]=0;const Q4=[102100,102113,3857,3785],YH=[104905,104971],JH=[4326,...Q4,...YH],M$='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',W1=[-20037508342788905e-9,20037508342788905e-9],Z1=[-20037508342787e-6,20037508342787e-6],eN={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:W1,origin:Z1,dx:1e-5},102100:{wkTemplate:M$,valid:W1,origin:Z1,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:W1,origin:Z1,dx:1e-5},3857:{wkTemplate:M$,valid:W1,origin:Z1,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Hs(e,t){if(e===t)return!0;if(e==null||t==null)return!1;const i=e.wkid,r=t.wkid;if(i!=null||r!=null){if(i===r||fp(e)&&fp(t))return!0;const c=e.latestWkid;if(c!=null&&r===c)return!0;const o=t.latestWkid;return o!=null&&i===o}let s,n;return e.wkt2&&t.wkt2?(s=e.wkt2,n=t.wkt2):e.wkt&&t.wkt&&(s=e.wkt,n=t.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function to(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&eN[t]||null}function tN(e){if(!e)return;const{wkid:t,vcsWkid:i}=e;if(t)return i?JSON.stringify({wkid:t,vcsWkid:i}):String(t);const r=e.wkt||e.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function TA(e){if(!Ba(e))return!1;const{wkid:t}=e;if(t)return q[t]==null;const i=e.wkt2||e.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function KH(e){return!(iN(e)||rN(e))}function U0(e){return(e==null?void 0:e.wkid)===4326}function jye(e){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(e)}function Vye(e){return(e==null?void 0:e.wkid)===pp.CGCS2000}function fp(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&Q4.includes(t)}function XH(e){return(e==null?void 0:e.wkid)===32662}function fx(e){return e===pp.GCSMARS2000||e===pp.GCSMARS2000_SPHERE}function iN(e){return fx(e==null?void 0:e.wkid)}function mx(e){return e===pp.GCSMOON2000}function rN(e){return mx(e==null?void 0:e.wkid)}function QH(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&JH.includes(t)}function Ba(e){if(e==null)return!1;const t=e.wkid;return t!=null&&t>=2e3||e.wkt2!=null||e.wkt!=null}const uw={wkid:4326,wkt:k5(eN[4326].wkTemplate,{Central_Meridian:"0.0"})},hw={wkid:102100,latestWkid:3857},eW={wkid:32662};function EA(e){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${e.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const tW=EA(Ar),IA=EA(Cl),MA=EA(dh),iW={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Ar.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},rW=IA.wkt.toUpperCase(),sW=MA.wkt.toUpperCase();function nW(e){if(e!=null&&Ba(e)){const t=e.wkid,i=e.wkt2??e.wkt;if(fx(t))return Cl;const r=i==null?void 0:i.toUpperCase();if(i&&r===rW)return Cl;if(mx(t)||r&&r===sW)return dh}return Ar}function Gye(e){return fx(e)?Cl:mx(e)?dh:Ar}function dw(e){return Hs(e,tW)}function ph(e){return dw(e)||Hs(e,IA)||Hs(e,MA)}const qye=39.37,oW=Ar.radius*Math.PI/200,sN=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,rp=q,nN=/UNIT\[([^\]]+)]/i,aW=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),lW=Fn()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),al=e=>e*e,vu=e=>e*e*e,j0={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:al(.001)},"square-centimeters":{inBaseUnits:al(.01)},"square-decimeters":{inBaseUnits:al(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:al(1e3)},"square-inches":{inBaseUnits:al(.0254)},"square-feet":{inBaseUnits:al(.3048)},"square-yards":{inBaseUnits:al(.9144)},"square-miles":{inBaseUnits:al(1609.344)},"square-us-feet":{inBaseUnits:al(1200/3937)},acres:{inBaseUnits:.0015625*al(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*vu(.001)},"cubic-centimeters":{inBaseUnits:1e3*vu(.01)},"cubic-decimeters":{inBaseUnits:1e3*vu(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*vu(1e3)},"cubic-inches":{inBaseUnits:1e3*vu(.0254)},"cubic-feet":{inBaseUnits:1e3*vu(.3048)},"cubic-yards":{inBaseUnits:1e3*vu(.9144)},"cubic-miles":{inBaseUnits:1e3*vu(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},cW=(()=>{const e={};for(const t in j0)for(const i in j0[t].units)e[i]=t;return e})();function uW(e,t,i){return e*j0[i].units[t].inBaseUnits}function hW(e,t,i){return e/j0[i].units[t].inBaseUnits}function sE(e){const t=cW[e];if(!t)throw new Error("unknown type");return t}function A$(e,t=null){return t=t||sE(e),j0[t].baseUnit===e}function Bo(e,t,i){if(t===i)return e;const r=sE(t);if(r!==sE(i))throw new Error("incompatible units");const s=A$(t,r)?e:uW(e,t,r);return A$(i,r)?s:hW(s,i,r)}function dW(e,t,i){return Bo(e,t,"meters")/(i*Math.PI/180)}function oN(e){return lW.fromJSON(e.toLowerCase())||null}function P$(e){if(e!=null&&!KH(e))return 1;const t=Ap(e);return t>1e5?1:t}function pW(e){return Ap(e)>=nW(e).metersPerDegree?"meters":lN(e)}function Ap(e,t=Ar.metersPerDegree){return fW(e,!0)??t}function fW(e,t=!1){const i=(e==null?void 0:e.wkid)??null,r=(e==null?void 0:e.wkt2)??(e==null?void 0:e.wkt)??null;let s=null;if(i){if(fx(i))return Cl.metersPerDegree;if(mx(i))return dh.metersPerDegree;s=rp.values[rp[i]],!s&&t&&aW.has(i)&&(s=oW)}else r&&(uN(r)?s=C$(sN.exec(r),s):cN(r)&&(s=C$(nN.exec(r),s)));return s}function Hye(e){return TA(e)?1:Ap(e)}function C$(e,t){return e!=null&&e[1]?aN(e[1]):t}function aN(e){return parseFloat(e.split(",")[1])}function lN(e){const t=(e==null?void 0:e.wkid)??null,i=(e==null?void 0:e.wkt2)??(e==null?void 0:e.wkt)??null;let r=null;if(t)r=rp.units[rp[t]];else if(i){const s=uN(i)?sN:cN(i)?nN:null;if(s){const n=s.exec(i);n!=null&&n[1]&&(r=yW(n[1]))}}return r!=null?oN(r):null}function cN(e){return/^GEOCCS/i.test(e)}function uN(e){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(e)}const mW=1e-7;function yW(e){const t=/[\\"']{1}([^\\"']+)/.exec(e);let i=t==null?void 0:t[1];if(!i||!rp.units.includes(i)){const r=aN(e);i=null;const s=rp.values;for(let n=0;n<s.length;++n)if(Math.abs(r-s[n])<mW){i=rp.units[n];break}}return i}const gW={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},_W={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},vW={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Wye=Fn()(gW),Zye=Fn()(_W),Yye=Fn()(vW);var ul;let Ii=ul=class extends At{static fromJSON(e){if(!e)return null;if(e.wkid){if(e.wkid===102100)return ul.WebMercator;if(e.wkid===4326)return ul.WGS84}const t=new ul;return t.read(e),t}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return U0(this)}get isWebMercator(){return fp(this)}get isGeographic(){return TA(this)}get isWrappable(){return QH(this)}get metersPerUnit(){return Ap(this)}get unit(){return lN(this)||(this.isGeographic?"degrees":null)}writeWkt(e,t){this.wkid||(t.wkt=e)}clone(){if(this===ul.WGS84)return new ul(uw);if(this===ul.WebMercator)return new ul(hw);const e=new ul;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=He(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:t,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:r}=e.imageCoordinateSystem,s=this.imageCoordinateSystem;return t==null||r?JSON.stringify(s)===JSON.stringify(e.imageCoordinateSystem):i?s.id===t&&s.referenceServiceName===i:s.id===t}return Hs(this,e)}toJSON(e){return this.write(void 0,e)}};Ii.GCS_NAD_1927=null,Ii.WGS84=null,Ii.WebMercator=null,Ii.PlateCarree=null,v([I({readOnly:!0})],Ii.prototype,"isWGS84",null),v([I({readOnly:!0})],Ii.prototype,"isWebMercator",null),v([I({readOnly:!0})],Ii.prototype,"isGeographic",null),v([I({readOnly:!0})],Ii.prototype,"isWrappable",null),v([I({type:Er,json:{write:!0}})],Ii.prototype,"latestWkid",void 0),v([I({readOnly:!0})],Ii.prototype,"metersPerUnit",null),v([I({readOnly:!0})],Ii.prototype,"unit",null),v([I({type:Er,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Ii.prototype,"wkid",void 0),v([I({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Ii.prototype,"wkt",void 0),v([ci("wkt"),ci("web-scene","wkt")],Ii.prototype,"writeWkt",null),v([I({type:String,json:{write:!1}})],Ii.prototype,"wkt2",void 0),v([I({type:Er,json:{write:!0}})],Ii.prototype,"vcsWkid",void 0),v([I({type:Er,json:{write:!0}})],Ii.prototype,"latestVcsWkid",void 0),v([I()],Ii.prototype,"imageCoordinateSystem",void 0),Ii=ul=v([me("esri.geometry.SpatialReference")],Ii),Ii.prototype.toJSON.isDefaultToJSON=!0,Ii.GCS_NAD_1927=new Ii({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),Ii.WGS84=new Ii(uw),Ii.WebMercator=new Ii(hw),Ii.PlateCarree=new Ii(eW),Object.freeze&&(Object.freeze(Ii.GCS_NAD_1927),Object.freeze(Ii.WGS84),Object.freeze(Ii.WebMercator),Object.freeze(Ii.PlateCarree));const mi=Ii;function fi(e,t,i){let r,s;return t===void 0||Array.isArray(t)?(s=e,i=t,r=[void 0]):(s=t,r=Array.isArray(e)?e:[e]),(n,c)=>{const o=n.constructor.prototype;r.forEach(p=>{const g=d4(n,p,s);g.read&&typeof g.read=="object"||(g.read={}),g.read.reader=o[c],i&&(g.read.source=(g.read.source||[]).concat(i))})}}let hl=class extends At{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=mi.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,i){if(t instanceof mi)return t;if(t!=null){const r=new mi;return r.read(t,i),r}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,i){this.cache[t]=i}};v([I()],hl.prototype,"type",void 0),v([I({readOnly:!0})],hl.prototype,"cache",null),v([I({readOnly:!0})],hl.prototype,"extent",null),v([I({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],hl.prototype,"hasM",void 0),v([I({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],hl.prototype,"hasZ",void 0),v([I({type:mi,json:{write:!0},value:mi.WGS84})],hl.prototype,"spatialReference",void 0),v([fi("spatialReference")],hl.prototype,"readSpatialReference",null),hl=v([me("esri.geometry.Geometry")],hl);const Sh=hl,bW=Object.prototype.toString;function wW(e){const t="__accessorMetadata__"in e?zn(e):e;return function(...i){if(i.push(t),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return xW.apply(this,i)}}function xW(e,t,i,r){rx(e,t).cast=r}function SW(e){return(t,i)=>{rx(t,e).cast=t[i]}}function As(...e){if(e.length!==3||typeof e[1]!="string")return e.length===1&&bW.call(e[0])==="[object Function]"?wW(e[0]):e.length===1&&typeof e[0]=="string"?SW(e[0]):void 0}function TW(e,t){const i=e.x-t.x,r=e.y-t.y,s=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(i*i+r*r+s*s)}const EW=57.29577951308232,IW=.017453292519943;function $$(e){return e*EW}function k$(e){return e*IW}function Kye(e){return Math.PI/2-2*Math.atan(Math.exp(-e/Ar.radius))}function nE(e){return e.wkid!=null||e.wkt!=null}const bS=[0,0];function pw(e,t,i,r,s){const n=e,c=s;if(c.spatialReference=i,"x"in n&&"x"in c)[c.x,c.y]=t(n.x,n.y,bS,r);else if("xmin"in n&&"xmin"in c)[c.xmin,c.ymin]=t(n.xmin,n.ymin,bS,r),[c.xmax,c.ymax]=t(n.xmax,n.ymax,bS,r);else if("paths"in n&&"paths"in c||"rings"in n&&"rings"in c){const o="paths"in n?n.paths:n.rings,p=[];let g;for(let S=0;S<o.length;S++){const M=o[S];g=[],p.push(g);for(let A=0;A<M.length;A++)g.push(t(M[A][0],M[A][1],[0,0],r)),M[A].length>2&&g[A].push(M[A][2]),M[A].length>3&&g[A].push(M[A][3])}"paths"in c?c.paths=p:c.rings=p}else if("points"in n&&"points"in c){const o=n.points,p=[];for(let g=0;g<o.length;g++)p[g]=t(o[g][0],o[g][1],[0,0],r),o[g].length>2&&p[g].push(o[g][2]),o[g].length>3&&p[g].push(o[g][3]);c.points=p}return s}function jv(e,t){const i=e&&(nE(e)?e:e.spatialReference),r=t&&(nE(t)?t:t.spatialReference);return!(e&&"type"in e&&e.type==="mesh"||t&&"type"in t&&t.type==="mesh"||!i||!r)&&(!!Hs(r,i)||fp(r)&&U0(i)||fp(i)&&U0(r))}function yx(e,t){if(e==null)return null;const i=e.spatialReference,r=t&&(nE(t)?t:t.spatialReference);return jv(i,r)?Hs(i,r)?He(e):fp(r)?pw(e,Xf,mi.WebMercator,!1,He(e)):U0(r)?pw(e,d0,mi.WGS84,!1,He(e)):null:null}function Xf(e,t,i=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const r=k$(t);return i[0]=k$(e)*Ar.radius,i[1]=Ar.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function d0(e,t,i=[0,0],r=!1){const s=$$(e/Ar.radius);return i[0]=r?s:s-360*Math.floor((s+180)/360),i[1]=$$(Math.PI/2-2*Math.atan(Math.exp(-t/Ar.radius))),i}function Dc(e,t=!1,i=He(e)){return pw(e,Xf,mi.WebMercator,t,i)}function Qf(e,t=!1,i=He(e)){return pw(e,d0,mi.WGS84,t,i)}var Vv;const og=[0,0];function R$(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let Tn=Vv=class extends Sh{static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const i=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(i)?i:i.clone())}constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(e,t,i,r,s){let n;if(Array.isArray(e))n=e,s=t,e=n[0],t=n[1],i=n[2],r=n[3];else if(e&&typeof e=="object"){if(n=e,e=n.x!=null?n.x:n.longitude,t=n.y!=null?n.y:n.latitude,i=n.z,r=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new mi(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)_t.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)_t.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s&&s.isWebMercator){const o=Xf(n.longitude,n.latitude,og);e=o[0],t=o[1]}}}else R$(i)?(s=i,i=null):R$(r)&&(s=r,r=null);const c={x:e,y:t};return c.x==null&&c.y!=null?_t.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):c.y==null&&c.x!=null&&_t.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(c.spatialReference=s),i!=null&&(c.z=i),r!=null&&(c.m=r),c}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(e){e!==(this._get("m")!==void 0)&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return this.z!==void 0}set hasZ(e){e!==(this._get("z")!==void 0)&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const{spatialReference:e,x:t,y:i}=this;if(e){if(e.isWebMercator)return d0(t,i,og)[1];if(e.isGeographic)return i}return null}set latitude(e){const{spatialReference:t,x:i}=this;e!=null&&t&&(t.isWebMercator?this._set("y",Xf(i,e,og)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const{x:e,y:t,spatialReference:i}=this;if(i){if(i.isWebMercator)return d0(e,t,og)[0];if(i.isGeographic)return e}return null}set longitude(e){const{y:t,spatialReference:i}=this;e!=null&&i&&(i.isWebMercator?this._set("x",Xf(e,t,og)[0]):i.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,i){t[i]=isNaN(e)?"NaN":e}readX(e){return typeof e=="string"?NaN:e}clone(){const e=new Vv;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return Vv.copy(e,this),this}equals(e){if(e==null)return!1;const{x:t,y:i,z:r,m:s,spatialReference:n}=this,{z:c,m:o}=e;let{x:p,y:g,spatialReference:S}=e;if(!n.equals(S))if(n.isWebMercator&&S.isWGS84)[p,g]=Xf(p,g),S=n;else{if(!n.isWGS84||!S.isWebMercator)return!1;[p,g]=d0(p,g),S=n}return t===p&&i===g&&r===c&&s===o&&n.wkid===S.wkid}offset(e,t,i){return this.x+=e,this.y+=t,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const e=to(this.spatialReference);if(!e)return this;let t=this.x;const[i,r]=e.valid,s=2*r;let n;return t>r?(n=Math.ceil(Math.abs(t-r)/s),t-=n*s):t<i&&(n=Math.ceil(Math.abs(t-i)/s),t+=n*s),this._set("x",t),this}distance(e){return TW(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write({},e)}};v([I({readOnly:!0})],Tn.prototype,"cache",null),v([I({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Tn.prototype,"hasM",null),v([I({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Tn.prototype,"hasZ",null),v([I({type:Number})],Tn.prototype,"latitude",null),v([I({type:Number})],Tn.prototype,"longitude",null),v([I({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),As(e=>isNaN(e)?e:za(e))],Tn.prototype,"x",void 0),v([ci("x")],Tn.prototype,"writeX",null),v([fi("x")],Tn.prototype,"readX",null),v([I({type:Number,json:{write:!0}})],Tn.prototype,"y",void 0),v([I({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Tn.prototype,"z",void 0),v([I({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Tn.prototype,"m",void 0),Tn=Vv=v([me("esri.geometry.Point")],Tn),Tn.prototype.toJSON.isDefaultToJSON=!0;const ri=Tn,wS=[0,0];function gx(e,t){return t!=null&&Cn(e,t.x,t.y,t.z)}function Xye(e,t){if(!t.points||t.points.length)return!1;for(const i of t.points)if(!Im(e,i))return!1;return!0}function MW(e,t){const{xmin:i,ymin:r,zmin:s,xmax:n,ymax:c,zmax:o}=t;return e.hasZ&&t.hasZ?Cn(e,i,r,s)&&Cn(e,i,c,s)&&Cn(e,n,c,s)&&Cn(e,n,r,s)&&Cn(e,i,r,o)&&Cn(e,i,c,o)&&Cn(e,n,c,o)&&Cn(e,n,r,o):Cn(e,i,r)&&Cn(e,i,c)&&Cn(e,n,c)&&Cn(e,n,r)}function Im(e,t){return Cn(e,t[0],t[1])}function AW(e,t){return Cn(e,t[0],t[1],t[2])}function Cn(e,t,i,r){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax&&(r==null||!e.hasZ||r>=e.zmin&&r<=e.zmax)}function hN(e,t){return wS[1]=t.y,wS[0]=t.x,PW(e,wS)}function PW(e,t){return dN(e.rings,t)}function dN(e,t){if(!e)return!1;if(CW(e))return O$(!1,e,t);let i=!1;for(let r=0,s=e.length;r<s;r++)i=O$(i,e[r],t);return i}function CW(e){return!Array.isArray(e[0][0])}function O$(e,t,i){const[r,s]=i;let n=e,c=0;for(let o=0,p=t.length;o<p;o++){c++,c===p&&(c=0);const[g,S]=t[o],[M,A]=t[c];(S<s&&A>=s||A<s&&S>=s)&&g+(s-S)/(A-S)*(M-g)<r&&(n=!n)}return n}function $W(e,t){return gx(e,t)}function kW(e,t){const i=e.hasZ&&t.hasZ;let r,s,n;if(e.xmin<=t.xmin){if(r=t.xmin,e.xmax<r)return!1}else if(r=e.xmin,t.xmax<r)return!1;if(e.ymin<=t.ymin){if(s=t.ymin,e.ymax<s)return!1}else if(s=e.ymin,t.ymax<s)return!1;if(i&&t.hasZ){if(e.zmin<=t.zmin){if(n=t.zmin,e.zmax<n)return!1}else if(n=e.zmin,t.zmax<n)return!1}return!0}function RW(e,t){const{points:i,hasZ:r}=t,s=r?AW:Im;for(const n of i)if(s(e,n))return!0;return!1}const mp=[0,0],yp=[0,0],gp=[0,0],_p=[0,0],OW=[mp,yp,gp,_p],pN=[[gp,mp],[mp,yp],[yp,_p],[_p,gp]];function LW(e,t){return DW(e,t.rings)}function DW(e,t){mp[0]=e.xmin,mp[1]=e.ymax,yp[0]=e.xmax,yp[1]=e.ymax,gp[0]=e.xmin,gp[1]=e.ymin,_p[0]=e.xmax,_p[1]=e.ymin;for(const i of OW)if(dN(t,i))return!0;for(const i of t){if(!i.length)continue;let r=i[0];if(Im(e,r))return!0;for(let s=1;s<i.length;s++){const n=i[s];if(Im(e,n)||fN(r,n,pN))return!0;r=n}}return!1}function NW(e,t){mp[0]=e.xmin,mp[1]=e.ymax,yp[0]=e.xmax,yp[1]=e.ymax,gp[0]=e.xmin,gp[1]=e.ymin,_p[0]=e.xmax,_p[1]=e.ymin;const i=t.paths;for(const r of i){if(!i.length)continue;let s=r[0];if(Im(e,s))return!0;for(let n=1;n<r.length;n++){const c=r[n];if(Im(e,c)||fN(s,c,pN))return!0;s=c}}return!1}const Ss=[0,0];function zW(e){for(let t=0;t<e.length;t++){const i=e[t];for(let s=0;s<i.length-1;s++){const n=i[s],c=i[s+1];for(let o=t+1;o<e.length;o++)for(let p=0;p<e[o].length-1;p++){const g=e[o][p],S=e[o][p+1];if(oE(n,c,g,S,Ss)&&!(Ss[0]===n[0]&&Ss[1]===n[1]||Ss[0]===g[0]&&Ss[1]===g[1]||Ss[0]===c[0]&&Ss[1]===c[1]||Ss[0]===S[0]&&Ss[1]===S[1]))return!0}}const r=i.length;if(!(r<=4))for(let s=0;s<r-3;s++){let n=r-1;s===0&&(n=r-2);const c=i[s],o=i[s+1];for(let p=s+2;p<n;p++){const g=i[p],S=i[p+1];if(oE(c,o,g,S,Ss)&&!(Ss[0]===c[0]&&Ss[1]===c[1]||Ss[0]===g[0]&&Ss[1]===g[1]||Ss[0]===o[0]&&Ss[1]===o[1]||Ss[0]===S[0]&&Ss[1]===S[1]))return!0}}}return!1}function fN(e,t,i){for(let r=0;r<i.length;r++)if(oE(e,t,i[r][0],i[r][1]))return!0;return!1}function oE(e,t,i,r,s){const[n,c]=e,[o,p]=t,[g,S]=i,[M,A]=r,O=M-g,z=n-g,V=o-n,W=A-S,ie=c-S,ve=p-c,pe=W*V-O*ve;if(pe===0)return!1;const _e=(O*ie-W*z)/pe,Me=(V*ie-ve*z)/pe;return _e>=0&&_e<=1&&Me>=0&&Me<=1&&(s&&(s[0]=n+_e*(o-n),s[1]=c+_e*(p-c)),!0)}function FW(e){switch(e){case"esriGeometryEnvelope":case"extent":return kW;case"esriGeometryMultipoint":case"multipoint":return RW;case"esriGeometryPoint":case"point":return $W;case"esriGeometryPolygon":case"polygon":return LW;case"esriGeometryPolyline":case"polyline":return NW}}var Uo;function BW(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}function bu(e,t,i){return t==null?i:i==null?t:e(t,i)}let cs=Uo=class extends Sh{constructor(...e){super(...e),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(e,t,i,r,s){return BW(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:typeof e=="object"?(e.spatialReference=e.spatialReference==null?mi.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:i,ymax:r,spatialReference:s??mi.WGS84}}static fromBounds(e,t){return new Uo({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}static fromPoint(e){return new Uo({xmin:e.x,ymin:e.y,zmin:e.z,xmax:e.x,ymax:e.y,zmax:e.z,spatialReference:e.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const e=new ri({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(e){const t=this.center;return e.z!=null&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}clone(){const e=new Uo;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,this.zmin!=null&&(e.zmin=this.zmin,e.zmax=this.zmax),this.mmin!=null&&(e.mmin=this.mmin,e.mmax=this.mmax),e}contains(e){if(!e)return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&jv(t,i)&&(e=t.isWebMercator?Dc(e):Qf(e,!0)),e.type==="point"?gx(this,e):e.type==="extent"&&MW(this,e)}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&jv(t,i)&&(e=t.isWebMercator?Dc(e):Qf(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}expand(e){const t=.5*(1-e),i=this.width*t,r=this.height*t;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const s=(this.zmax-this.zmin)*t;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*t;this.mmin+=s,this.mmax-=s}return this}intersects(e){if(e==null)return!1;e.type==="mesh"&&(e=e.extent);const t=this.spatialReference,i=e.spatialReference;return t&&i&&!Hs(t,i)&&jv(t,i)&&(e=t.isWebMercator?Dc(e):Qf(e,!0)),FW(e.type)(this,e)}normalize(){const e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}offset(e,t,i){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(e){return this===e||(this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=bu(Math.min,this.zmin,e.zmin),this.zmax=bu(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=bu(Math.min,this.mmin,e.mmin),this.mmax=bu(Math.max,this.mmax,e.mmax))),this}intersection(e){return this===e?this:e!=null&&this.intersects(e)?(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=bu(Math.max,this.zmin,e.zmin),this.zmax=bu(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=bu(Math.max,this.mmin,e.mmin),this.mmax=bu(Math.min,this.mmax,e.mmax)),this):null}toJSON(e){return this.write({},e)}_shiftCM(e=to(this.spatialReference)){if(!e||!this.spatialReference)return this;const t=this.spatialReference,i=this._getCM(e);if(i){const r=t.isWebMercator?Qf(i):i;this.xmin-=i.x,this.xmax-=i.x,t.isWebMercator||(r.x=this._normalizeX(r.x,e).x),this.spatialReference=new mi(k5((t.isWGS84?e.altTemplate:null)??e.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(e){let t=null;const[i,r]=e.valid,s=this.xmin,n=this.xmax;return s>=i&&s<=r&&n>=i&&n<=r||(t=this.center),t}_normalize(e,t,i){const r=this.spatialReference;if(!r)return this;const s=i??to(r);if(s==null)return this;const n=this._getParts(s).map(p=>p.extent);if(n.length<2)return n[0]||this;if(n.length>2)return e?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(e)return this._shiftCM(s);if(t)return n;let c=!0,o=!0;return n.forEach(p=>{p.hasZ||(c=!1),p.hasM||(o=!1)}),{rings:n.map(p=>{const g=[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]];if(c){const S=(p.zmax-p.zmin)/2;for(let M=0;M<g.length;M++)g[M].push(S)}if(o){const S=(p.mmax-p.mmin)/2;for(let M=0;M<g.length;M++)g[M].push(S)}return g}),hasZ:c,hasM:o,spatialReference:r}}_getParts(e){let t=this.cache._parts;if(!t){t=[];const{ymin:s,ymax:n,spatialReference:c}=this,o=this.width,p=this.xmin,g=this.xmax;let S;e=e||to(c);const[M,A]=e.valid;S=this._normalizeX(this.xmin,e);const O=S.x,z=S.frameId;S=this._normalizeX(this.xmax,e);const V=S.x,W=S.frameId,ie=O===V&&o>0;if(o>2*A){const ve=new Uo(p<g?O:V,s,A,n,c),pe=new Uo(M,s,p<g?V:O,n,c),_e=new Uo(0,s,A,n,c),Me=new Uo(M,s,0,n,c),$e=[],Fe=[];ve.contains(_e)&&$e.push(z),ve.contains(Me)&&Fe.push(z),pe.contains(_e)&&$e.push(W),pe.contains(Me)&&Fe.push(W);for(let Ge=z+1;Ge<W;Ge++)$e.push(Ge),Fe.push(Ge);t.push({extent:ve,frameIds:[z]},{extent:pe,frameIds:[W]},{extent:_e,frameIds:$e},{extent:Me,frameIds:Fe})}else O>V||ie?t.push({extent:new Uo(O,s,A,n,c),frameIds:[z]},{extent:new Uo(M,s,V,n,c),frameIds:[W]}):t.push({extent:new Uo(O,s,V,n,c),frameIds:[z]});this.cache._parts=t}const i=this.hasZ,r=this.hasM;if(i||r){const s={};i&&(s.zmin=this.zmin,s.zmax=this.zmax),r&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<t.length;n++)t[n].extent.set(s)}return t}_normalizeX(e,t){const[i,r]=t.valid,s=2*r;let n,c=0;return e>r?(n=Math.ceil(Math.abs(e-r)/s),e-=n*s,c=n):e<i&&(n=Math.ceil(Math.abs(e-i)/s),e+=n*s,c=-n),{x:e,frameId:c}}};v([I({readOnly:!0})],cs.prototype,"cache",null),v([I({readOnly:!0})],cs.prototype,"center",null),v([I({readOnly:!0})],cs.prototype,"extent",null),v([I({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],cs.prototype,"hasM",null),v([I({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],cs.prototype,"hasZ",null),v([I({readOnly:!0})],cs.prototype,"height",null),v([I({readOnly:!0})],cs.prototype,"width",null),v([I({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],cs.prototype,"xmin",void 0),v([I({type:Number,json:{write:!0}})],cs.prototype,"ymin",void 0),v([I({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],cs.prototype,"mmin",void 0),v([I({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],cs.prototype,"zmin",void 0),v([I({type:Number,json:{write:!0}})],cs.prototype,"xmax",void 0),v([I({type:Number,json:{write:!0}})],cs.prototype,"ymax",void 0),v([I({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],cs.prototype,"mmax",void 0),v([I({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],cs.prototype,"zmax",void 0),cs=Uo=v([me("esri.geometry.Extent")],cs),cs.prototype.toJSON.isDefaultToJSON=!0;const Bi=cs;let p0;var a5,l5;const UW=((a5=globalThis.esriConfig)==null?void 0:a5.locale)??((l5=globalThis.dojoConfig)==null?void 0:l5.locale);function mN(){var e;return UW??((e=globalThis.navigator)==null?void 0:e.language)??"en"}function bo(){return p0===void 0&&(p0=mN()),p0}function jW(e=bo()){const t=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(e);return t==null?void 0:t[1].toLowerCase()}const f0=[];function AA(e){return f0.push(e),Qi(()=>f0.splice(f0.indexOf(e),1))}const aE=[];function PA(e){return aE.push(e),Qi(()=>f0.splice(aE.indexOf(e),1))}function VW(){const e=mN();p0!==e&&(p0=e,[...aE].forEach(t=>{t.call(null,e)}),[...f0].forEach(t=>{t.call(null,e)}))}var c5;(c5=globalThis.addEventListener)==null||c5.call(globalThis,"languagechange",VW);let Y1;function GW(e){return Y1&&!Y1.destroyed||(Y1=e()),Y1}var lE;const qW=new Ms({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let jo=lE=class extends zt{constructor(e){super(e),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(e){e!=="asc"&&e!=="desc"||this._set("sortOrder",e)}clone(){return new lE({categories:this.categories?He(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(e,t){let i=[];this.categories&&(i=this.categories.map(c=>Array.isArray(c)?JSON.stringify(c):c));let r="";if(this.extent){const c=yx(this.extent,mi.WGS84);c!=null&&(r=`${c.xmin},${c.ymin},${c.xmax},${c.ymax}`)}let s=this.query;!this.disableExtraQuery&&e.extraQuery&&(s="("+s+")"+e.extraQuery);const n={categories:i,bbox:r,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map(c=>qW.toJSON(c.trim())).join(","),n.sortOrder=this.sortOrder),{query:{...t,...n}}}};v([I()],jo.prototype,"categories",void 0),v([I()],jo.prototype,"disableExtraQuery",void 0),v([I({type:Bi})],jo.prototype,"extent",void 0),v([I()],jo.prototype,"filter",void 0),v([I()],jo.prototype,"num",void 0),v([I()],jo.prototype,"query",void 0),v([I()],jo.prototype,"sortField",void 0),v([I()],jo.prototype,"sortOrder",null),v([I()],jo.prototype,"start",void 0),jo=lE=v([me("esri.portal.PortalQueryParams")],jo);const Oc=jo;var cE;let rs=cE=class extends At{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var i;const e=this.url,t=this.thumbnail;return e&&t&&this.portal?(i=this.portal)==null?void 0:i.normalizeUrl(`${e}/info/${t}?f=json`):null}get url(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return this.portal.request(this.url+"/categorySchema",e).then(t=>{const i=t.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",e):i})}fetchMembers(e){return this.portal.request(this.url+"/users",e)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}toJSON(){throw new Je("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new cE;return t.sourceJSON=e,t.read(e),t}queryItems(e,t){let i=zn(Oc,e);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Oc,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",t)):(i=i?i.clone():new Oc,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,t))}_fetchCategorySchemaSet(e,t){const i=this.portal;return i.fetchSelf(i.authMode,!0,t).then(r=>{const s=r.contentCategorySetsGroupQuery;if(s){const n=new Oc;return n.disableExtraQuery=!0,n.num=1,n.query=s,i.queryGroups(n,t)}throw new Je("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const s=r.results[0],n=new Oc;return n.num=1,n.query=`typekeywords:"${e}"`,s.queryItems(n,t)}throw new Je("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",t).then(s=>{const n=s==null?void 0:s.categorySchema;return n!=null&&n.length?n:[]}):[])}};v([I()],rs.prototype,"access",void 0),v([I({type:Date})],rs.prototype,"created",void 0),v([I()],rs.prototype,"description",void 0),v([I()],rs.prototype,"id",void 0),v([I()],rs.prototype,"isInvitationOnly",void 0),v([I({type:Date})],rs.prototype,"modified",void 0),v([I()],rs.prototype,"owner",void 0),v([I()],rs.prototype,"portal",void 0),v([I()],rs.prototype,"snippet",void 0),v([I()],rs.prototype,"sortField",void 0),v([I()],rs.prototype,"sortOrder",void 0),v([I()],rs.prototype,"sourceJSON",void 0),v([I()],rs.prototype,"tags",void 0),v([I()],rs.prototype,"thumbnail",void 0),v([I({readOnly:!0})],rs.prototype,"thumbnailUrl",null),v([I()],rs.prototype,"title",void 0),v([I({readOnly:!0})],rs.prototype,"url",null),rs=cE=v([me("esri.portal.PortalGroup")],rs);const uE=rs;let ld=class extends zt{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};v([I()],ld.prototype,"nextQueryParams",void 0),v([I()],ld.prototype,"queryParams",void 0),v([I()],ld.prototype,"results",void 0),v([I()],ld.prototype,"total",void 0),ld=v([me("esri.portal.PortalQueryResult")],ld);const HW=ld;let gc=class extends At{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var i;const t=(i=this.portal)==null?void 0:i.restUrl;return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Je("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};v([I({type:Date})],gc.prototype,"created",void 0),v([I()],gc.prototype,"id",void 0),v([I()],gc.prototype,"portal",void 0),v([I()],gc.prototype,"title",void 0),v([I({readOnly:!0})],gc.prototype,"url",null),v([I()],gc.prototype,"username",void 0),gc=v([me("esri.portal.PortalFolder")],gc);const WW=gc;var hE;let rr=hE=class extends At{constructor(...e){super(...e),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal.normalizeUrl(`${e}/info/${t}?f=json`):null}get userContentUrl(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?`${e}/content/users/${this.username}`:null}get url(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?`${e}/community/users/${this.username}`:null}addItem(e){const t=e&&e.item,i=e==null?void 0:e.data,r=e==null?void 0:e.folder,s={method:"post"};t&&(s.query=t.createPostQuery(),i!=null&&(typeof i=="string"?s.query.text=i:typeof i=="object"&&(s.query.text=JSON.stringify(i))));let n=this.userContentUrl;return r&&(n+="/"+(typeof r=="string"?r:r.id)),this.portal.request(n+"/addItem",s).then(c=>(t.id=c.id,t.portal=this.portal,t.loaded?t.reload():t.load()))}deleteItem(e){let t=this.userContentUrl;return e.ownerFolder&&(t+="/"+e.ownerFolder),this.portal.request(t+`/items/${e.id}/delete`,{method:"post"}).then(()=>{e.id=null,e.portal=null})}deleteItems(e){const t=this.userContentUrl+"/deleteItems",i=e.map(r=>r.id);if(i.length){const r={method:"post",query:{items:i.join(",")}};return this.portal.request(t,r).then(()=>{e.forEach(s=>{s.id=null,s.portal=null})})}return Promise.resolve(void 0)}fetchFolders(){const e={query:{num:1}};return this.portal.request(this.userContentUrl??"",e).then(t=>{let i;return i=t&&t.folders?t.folders.map(r=>{const s=WW.fromJSON(r);return s.portal=this.portal,s}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(e=>{let t;return t=e&&e.groups?e.groups.map(i=>{const r=uE.fromJSON(i);return r.portal=this.portal,r}):[],t})}fetchItems(e){const t=e??{};let i,r=this.userContentUrl??"";return t.folder&&(r+="/"+t.folder.id),ht(()=>Promise.resolve().then(()=>gN),void 0).then(({default:s})=>{i=s;const n={folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"};return this.portal.request(r,{query:n})}).then(s=>{let n;return s!=null&&s.items?(n=s.items.map(c=>{const o=i.fromJSON(c);return o.portal=this.portal,o}),Promise.all(n.map(c=>c.load())).catch(c=>c).then(()=>({items:n,nextStart:s.nextStart,total:s.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(e=>e.tags)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}queryFavorites(e){return this.favGroupId?(this._favGroup||(this._favGroup=new uE({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new Je("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new Je("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new hE;return t.sourceJSON=e,t.read(e),t}};v([I()],rr.prototype,"access",void 0),v([I({type:Date})],rr.prototype,"created",void 0),v([I()],rr.prototype,"culture",void 0),v([I()],rr.prototype,"description",void 0),v([I()],rr.prototype,"email",void 0),v([I()],rr.prototype,"favGroupId",void 0),v([I()],rr.prototype,"fullName",void 0),v([I({type:Date})],rr.prototype,"modified",void 0),v([I()],rr.prototype,"orgId",void 0),v([I()],rr.prototype,"portal",void 0),v([I()],rr.prototype,"preferredView",void 0),v([I()],rr.prototype,"privileges",void 0),v([I()],rr.prototype,"region",void 0),v([I()],rr.prototype,"role",void 0),v([I()],rr.prototype,"roleId",void 0),v([I()],rr.prototype,"sourceJSON",void 0),v([I()],rr.prototype,"thumbnail",void 0),v([I({readOnly:!0})],rr.prototype,"thumbnailUrl",null),v([I()],rr.prototype,"units",void 0),v([I({readOnly:!0})],rr.prototype,"userContentUrl",null),v([I({readOnly:!0})],rr.prototype,"url",null),v([I()],rr.prototype,"username",void 0),v([I()],rr.prototype,"userType",void 0),rr=hE=v([me("esri.portal.PortalUser")],rr);const CA=rr;var po;let J1;const L$={PortalGroup:()=>Promise.resolve({default:uE}),PortalItem:()=>ht(()=>Promise.resolve().then(()=>gN),void 0),PortalUser:()=>Promise.resolve({default:CA})};let rt=po=class extends p_(hh){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Pi.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){D$.unregister(this),this.defaultBasemap=nr(this.defaultBasemap),this.defaultDevBasemap=nr(this.defaultDevBasemap),this.defaultVectorBasemap=nr(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=gr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const t of e)Pi.request.trustedServers.includes(t)||Pi.request.trustedServers.push(t);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){var i;const e=(i=this.user)==null?void 0:i.orgId,t=!e||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let e=this.url;if(e){const t=e.indexOf("/sharing");e=t>0?e.substring(0,t):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,t=this.thumbnail;return e&&t?this._normalizeSSL(e+"/portals/self/resources/"+t):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let t=null;return e&&(t=CA.fromJSON(e),t.portal=this),t}load(e){const t=ht(()=>Promise.resolve().then(()=>EZ),void 0).then(({default:i})=>{dr(e),J1=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(i=>{var r;if(_i){const s=_i;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==po.AUTH_MODE_AUTO&&this.authMode!==po.AUTH_MODE_NO_PROMPT||((r=this._esriIdCredentialCreateHandle)==null||r.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",ZW(new WeakRef(this))),D$.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(t),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),t=(await ht(()=>import("./ElevationLayer-BtixgWbS.js"),[])).default;return e?e.map(i=>new t({id:i.id,url:i.url})):[]}async fetchBasemaps(e,t){const i=await this._fetchBasemaps(e,t);if((t==null?void 0:t.include3d)===!0&&this.use3dBasemaps!==!1){const r=await this._fetchBasemaps3D(e,t);i.unshift(...r)}return i}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(t=>t.categorySchema):ra(e)?Promise.reject(Nr()):Promise.resolve([])}fetchFeaturedGroups(e){const t=this.featuredGroups,i=new Oc;if(i.num=100,i.sortField="title",t&&t.length){const r=[];for(const s of t)r.push(`(title:"${s.title}" AND owner:${s.owner})`);return i.query=r.join(" OR "),this.queryGroups(i,e).then(s=>s.results)}return ra(e)?Promise.reject(Nr()):Promise.resolve([])}fetchRegions(e){var i;const t=((i=this.user)==null?void 0:i.culture)||this.culture||bo();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:t}})}fetchSettings(e){var i;const t=((i=this.user)==null?void 0:i.culture)||this.culture||bo();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:t}})}static getDefault(){return GW(()=>new po)}queryGroups(e,t){return this.queryPortal("/community/groups",e,"PortalGroup",t)}queryItems(e,t){return this.queryPortal("/search",e,"PortalItem",t)}queryUsers(e,t){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",t)}fetchSelf(e=this.authMode,t=!1,i){const r=this.restUrl+"/portals/self",s={authMode:e,query:{culture:bo().toLowerCase()},withCredentials:!0,...i};return s.authMode==="auto"&&(s.authMode="no-prompt"),t&&(s.query.default=!0),this.request(r,s)}queryPortal(e,t,i,r){const s=zn(Oc,t),n=c=>this.request(this.restUrl+e,{...s.toRequestOptions(this),...r}).then(o=>{const p=s.clone();return p.start=o.nextStart,new HW({nextQueryParams:p,queryParams:s,total:o.total,results:po._resultsToTypedArray(c,{portal:this},o,r)})}).then(o=>Promise.all(o.results.map(p=>typeof p.when=="function"?p.when():o)).then(()=>o,p=>(Na(p),o)));return i&&L$[i]?L$[i]().then(({default:c})=>(dr(r),n(c))):n()}signIn(){if(this.authMode===po.AUTH_MODE_ANONYMOUS||this.authMode===po.AUTH_MODE_NO_PROMPT&&!_i)return Promise.reject(new Je("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=t=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(t||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=t,this.fetchSelf("immediate"))):this.user&&this.credential===t?null:(this.credential=t,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return _i?_i.getCredential(this.restUrl,{prompt:this.authMode!==po.AUTH_MODE_NO_PROMPT}).then(t=>e(t)):e(this.credential)}normalizeUrl(e){var i;const t=(i=this.credential)==null?void 0:i.token;return this._normalizeSSL(t?e+(e.includes("?")?"&":"?")+"token="+t:e)}requestToTypedArray(e,t,i){return this.request(e,t).then(r=>{const s=po._resultsToTypedArray(i,{portal:this},r);return Promise.all(s.map(n=>typeof n.when=="function"?n.when():r)).then(()=>s,()=>s)})}request(e,t={}){const i={f:"json",...t.query},{authMode:r=this.authMode===po.AUTH_MODE_ANONYMOUS||this.authMode===po.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:s=null,cacheBust:n=!1,method:c="auto",responseType:o="json",signal:p}=t,g={authMode:r,body:s,cacheBust:n,method:c,query:i,responseType:o,timeout:0,signal:p};return t.withCredentials&&(g.withCredentials=!0),Xi(this._normalizeSSL(e),g).then(S=>S.data)}toJSON(){throw new Je("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new po({sourceJSON:e})}_getHelperService(e){const t=this.helperServices&&this.helperServices[e];if(!t)throw new Je("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return t}async _fetchBasemaps(e,t){const i=new Oc;i.query=e||(Pi.apiKey&&U4(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const r=await this.queryGroups(i,t);if(!r.total)return[];const s=r.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc";const n=await s.queryItems(i,t);return n.total?n.results.filter(c=>c.type==="Web Map").map(c=>new J1({portalItem:c})):[]}async _fetchBasemaps3D(e,t){const i=e||this.basemapGalleryGroupQuery3D;if(!i)return[];const r=new Oc({query:i,disableExtraQuery:!0}),s=await this.queryGroups(r,t);if(!s.total)return[];const n=s.results[0];r.num=100,r.query='type:"Web Scene"',r.sortField=n.sortField||"name",r.sortOrder=n.sortOrder||"desc";const c=await n.queryItems(r,t);return c.total?c.results.filter(o=>o.type==="Web Scene").map(o=>new J1({portalItem:o})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const t=J1.fromJSON(e);return t.portalItem={portal:this},t}return null}static _resultsToTypedArray(e,t,i,r){let s=[];if(i){const n=r!=null?r.signal:null;s=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||t)&&(s=s.map(c=>{const o=Object.assign(e?e.fromJSON(c):c,t);return typeof o.load=="function"&&o.load(n),o}))}else s=[];return s}};rt.AUTH_MODE_ANONYMOUS="anonymous",rt.AUTH_MODE_AUTO="auto",rt.AUTH_MODE_IMMEDIATE="immediate",rt.AUTH_MODE_NO_PROMPT="no-prompt",v([I()],rt.prototype,"access",void 0),v([I()],rt.prototype,"allSSL",void 0),v([I()],rt.prototype,"authMode",void 0),v([I()],rt.prototype,"authorizedCrossOriginDomains",void 0),v([fi("authorizedCrossOriginDomains")],rt.prototype,"readAuthorizedCrossOriginDomains",null),v([I()],rt.prototype,"basemapGalleryGroupQuery",void 0),v([I({json:{name:"3DBasemapGalleryGroupQuery"}})],rt.prototype,"basemapGalleryGroupQuery3D",void 0),v([I()],rt.prototype,"bingKey",void 0),v([I()],rt.prototype,"canListApps",void 0),v([I()],rt.prototype,"canListData",void 0),v([I()],rt.prototype,"canListPreProvisionedItems",void 0),v([I()],rt.prototype,"canProvisionDirectPurchase",void 0),v([I()],rt.prototype,"canSearchPublic",void 0),v([I()],rt.prototype,"canShareBingPublic",void 0),v([I()],rt.prototype,"canSharePublic",void 0),v([I()],rt.prototype,"canSignInArcGIS",void 0),v([I()],rt.prototype,"canSignInIDP",void 0),v([I()],rt.prototype,"colorSetsGroupQuery",void 0),v([I()],rt.prototype,"commentsEnabled",void 0),v([I({type:Date})],rt.prototype,"created",void 0),v([I()],rt.prototype,"credential",void 0),v([I()],rt.prototype,"culture",void 0),v([I()],rt.prototype,"currentVersion",void 0),v([I()],rt.prototype,"customBaseUrl",void 0),v([I()],rt.prototype,"defaultBasemap",void 0),v([fi("defaultBasemap")],rt.prototype,"readDefaultBasemap",null),v([I()],rt.prototype,"defaultDevBasemap",void 0),v([fi("defaultDevBasemap")],rt.prototype,"readDefaultDevBasemap",null),v([I({type:Bi})],rt.prototype,"defaultExtent",void 0),v([I()],rt.prototype,"defaultVectorBasemap",void 0),v([fi("defaultVectorBasemap")],rt.prototype,"readDefaultVectorBasemap",null),v([I()],rt.prototype,"description",void 0),v([I()],rt.prototype,"devBasemapGalleryGroupQuery",void 0),v([I()],rt.prototype,"eueiEnabled",void 0),v([I({readOnly:!0})],rt.prototype,"extraQuery",null),v([I()],rt.prototype,"featuredGroups",void 0),v([I()],rt.prototype,"featuredItemsGroupQuery",void 0),v([I()],rt.prototype,"galleryTemplatesGroupQuery",void 0),v([I()],rt.prototype,"layoutGroupQuery",void 0),v([I()],rt.prototype,"livingAtlasGroupQuery",void 0),v([I()],rt.prototype,"hasCategorySchema",void 0),v([I()],rt.prototype,"helpBase",void 0),v([I()],rt.prototype,"helperServices",void 0),v([I()],rt.prototype,"helpMap",void 0),v([I()],rt.prototype,"homePageFeaturedContent",void 0),v([I()],rt.prototype,"homePageFeaturedContentCount",void 0),v([I()],rt.prototype,"httpPort",void 0),v([I()],rt.prototype,"httpsPort",void 0),v([I()],rt.prototype,"id",void 0),v([I()],rt.prototype,"ipCntryCode",void 0),v([I({readOnly:!0})],rt.prototype,"isOrganization",null),v([I()],rt.prototype,"isPortal",void 0),v([I()],rt.prototype,"isReadOnly",void 0),v([I({readOnly:!0})],rt.prototype,"itemPageUrl",null),v([I()],rt.prototype,"layerTemplatesGroupQuery",void 0),v([I()],rt.prototype,"maxTokenExpirationMinutes",void 0),v([I({type:Date})],rt.prototype,"modified",void 0),v([I()],rt.prototype,"name",void 0),v([I()],rt.prototype,"portalHostname",void 0),v([I()],rt.prototype,"portalMode",void 0),v([I()],rt.prototype,"portalProperties",void 0),v([I()],rt.prototype,"region",void 0),v([I({readOnly:!0})],rt.prototype,"restUrl",null),v([I()],rt.prototype,"rotatorPanels",void 0),v([I()],rt.prototype,"showHomePageDescription",void 0),v([I()],rt.prototype,"sourceJSON",void 0),v([I()],rt.prototype,"staticImagesUrl",void 0),v([I({json:{name:"2DStylesGroupQuery"}})],rt.prototype,"stylesGroupQuery2d",void 0),v([I({json:{name:"stylesGroupQuery"}})],rt.prototype,"stylesGroupQuery3d",void 0),v([I()],rt.prototype,"supportsHostedServices",void 0),v([I()],rt.prototype,"symbolSetsGroupQuery",void 0),v([I()],rt.prototype,"templatesGroupQuery",void 0),v([I()],rt.prototype,"thumbnail",void 0),v([I({readOnly:!0})],rt.prototype,"thumbnailUrl",null),v([I()],rt.prototype,"units",void 0),v([I()],rt.prototype,"url",void 0),v([I()],rt.prototype,"urlKey",void 0),v([fi("urlKey")],rt.prototype,"readUrlKey",null),v([I()],rt.prototype,"user",void 0),v([fi("user")],rt.prototype,"readUser",null),v([I()],rt.prototype,"use3dBasemaps",void 0),v([I()],rt.prototype,"useStandardizedQuery",void 0),v([I()],rt.prototype,"useVectorBasemaps",void 0),v([I()],rt.prototype,"vectorBasemapGalleryGroupQuery",void 0),rt=po=v([me("esri.portal.Portal")],rt);const Wa=rt,D$=new FinalizationRegistry(e=>{e.remove()});function ZW(e){const t=_i;return()=>{const i=e.deref();i&&t.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let _c=class extends zt{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t!=null&&t.portalItem&&t.path?{...t,path:this._normalizePath(t.path,t.portalItem)}:t}set path(t){t!=null&&Nn(t)?_t.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this._normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",i){const r=this.cdnUrl;if(r==null)throw new Je("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:t,query:{token:this.portalItem.apiKey},signal:i==null?void 0:i.signal})}async update(t,i){const{addOrUpdateResources:r}=await ht(()=>import("./resourceUtils-D4PfXFWS.js"),[]);return await r(this.portalItem,[{resource:this,content:t,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"update",i),this}hasPath(){return this.path!=null}_normalizePath(t,i){return t==null?t:(t=t.replace(/^\/+/,""),i!=null&&Nn(t)&&(t=fA(t,i.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};v([I()],_c.prototype,"portalItem",void 0),v([I({type:String,value:null})],_c.prototype,"path",null),v([As("path")],_c.prototype,"_castPath",null),v([I({type:String,readOnly:!0})],_c.prototype,"url",null),v([I({type:String,readOnly:!0})],_c.prototype,"cdnUrl",null),v([I({type:String,readOnly:!0})],_c.prototype,"itemRelativeUrl",null),_c=v([me("esri.portal.PortalItemResource")],_c);const YW=_c;let Tg=class extends zt{constructor(t){super(t),this.created=null,this.rating=null}};v([I()],Tg.prototype,"created",void 0),v([I()],Tg.prototype,"rating",void 0),Tg=v([me("esri.portal.PortalRating")],Tg);const xS=Tg;function m_(e,t){var r;const i=(r=t==null?void 0:t.url)==null?void 0:r.path;if(e&&i&&(e=Ko(e,i,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const s=fA(e,t.portalItem.itemUrl);s!=null&&JW.test(s)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(s).path)}return(e=dE(e,t==null?void 0:t.portal))&&vx.test(e)?RA(e):e}function _x(e,t,i=V0.YES){var s,n;if((e=e&&vx.test(e)?yN(e):e)==null)return e;!Nn(e)&&(t!=null&&t.blockedRelativeUrls)&&t.blockedRelativeUrls.push(e);let r=Ko(e);if(t){const c=((s=t.verifyItemRelativeUrls)==null?void 0:s.rootPath)||((n=t.url)==null?void 0:n.path);if(c){const o=dE(c,t.portal),p=dE(r,t.portal);r=fA(p,o,o),r!=null&&r!==p&&r!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=kA(r,t==null?void 0:t.portal),Nn(r)&&(r=ta(r)),t!=null&&t.resources&&(t!=null&&t.portalItem)&&!Nn(r)&&!Mp(r)&&i===V0.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),r}function $A(e,t,i){return m_(e,i)}function vp(e,t,i,r){const s=_x(e,r);s!==void 0&&(t[i]=s)}const vx=/\/items\/([^\/]+)\/resources\/(.*)/,JW=/^\.\/resources\//;function KW(e){const t=(e==null?void 0:e.match(vx))??null;return(t==null?void 0:t[1])??null}function XW(e){const t=(e==null?void 0:e.match(vx))??null;if(t==null)return null;const i=t[2],r=i.lastIndexOf("/");if(r===-1){const{path:c,extension:o}=w$(i);return{prefix:null,filename:c,extension:o}}const{path:s,extension:n}=w$(i.slice(r+1));return{prefix:i.slice(0,r),filename:s,extension:n}}function kA(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?ZT(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function dE(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const i=`${t.urlKey}.${t.customBaseUrl}`,r=uA();return Tm(r,`${r.scheme}://${i}`)?ZT(e,t.portalHostname,i):ZT(e,i,t.portalHostname)}function RA(e){if(!e)return e||null;let t=e;return t&&_i&&!_i.findCredential(t)&&(t=_i._normalizeAGOLorgDomain(t),t=t.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),t=t.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),t=t.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),t}function yN(e){if(!e)return e||null;let t=e;return t=t.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),t=t.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),t=t.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),t&&_i&&!_i.findCredential(t)&&(t=_i._normalizeAGOLorgDomain(t)),t}var V0;(function(e){e[e.YES=0]="YES",e[e.NO=1]="NO"})(V0||(V0={}));const rge=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return V0},ensureMainOnlineDomain:kA,fromCDNUrl:yN,fromJSON:m_,itemIdFromResourceUrl:KW,prefixAndFilenameFromResourceUrl:XW,read:$A,toCDNUrl:RA,toJSON:_x,write:vp},Symbol.toStringTag,{value:"Module"}));var cd;const QW=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),eZ=new Set(["KML","GeoJson","CSV"]);let ii=cd=class extends p_(hh){static from(e){return lx(cd,e)}constructor(e){super(e),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const e=this.type,t=this.typeKeywords||[];let i=e;return e==="Feature Service"||e==="Feature Collection"?i=t.includes("Table")?"Table":t.includes("Route Layer")?"Route Layer":t.includes("Markup")?"Markup":"Feature Layer":e==="Image Service"?i=t.includes("Elevation 3D Layer")?"Elevation Layer":t.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":e==="Scene Service"?i="Scene Layer":e==="Video Service"?i="Video Layer":e==="Scene Package"?i="Scene Layer Package":e==="Stream Service"?i="Feature Layer":e==="Geoprocessing Service"?i=t.includes("Web Tool")?"Tool":"Geoprocessing Service":e==="Geoenrichment Service"?i="GeoEnrichment Service":e==="Geocoding Service"?i="Locator":e==="Microsoft Powerpoint"?i="Microsoft PowerPoint":e==="GeoJson"?i="GeoJSON":e==="Globe Service"?i="Globe Layer":e==="Vector Tile Service"?i="Tile Layer":e==="netCDF"?i="NetCDF":e==="Map Service"?i=t.includes("Spatiotemporal")||!t.includes("Hosted Service")&&!t.includes("Tiled")||t.includes("Relational")?"Map Image Layer":"Tile Layer":e&&e.toLowerCase().includes("add in")?i=e.replaceAll(/(add in)/gi,"Add-In"):e==="datastore catalog service"?i="Big Data File Share":e==="Compact Tile Package"?i="Tile Package (tpkx)":e==="Raster function template"?i="Raster Function Template":e==="OGCFeatureServer"?i="OGC Feature Layer":e==="web mapping application"&&t.includes("configurableApp")?i="Instant App":e==="Insights Page"?i="Insights Report":e==="Excalibur Imagery Project"?i="Excalibur Project":e==="3DTiles Service"?i="3D tiles layer":e==="3DTiles Package"&&(i="3D tiles package"),i}readExtent(e){return e&&e.length?new Bi(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){var O;const e=((O=this.type)==null?void 0:O.toLowerCase())||"",t=this.typeKeywords||[],i="esri/images/portal/",r="16";let s,n=!1,c=!1,o=!1,p=!1,g=!1,S=!1,M=!1,A=!1;return e.indexOf("service")>0||e==="feature collection"||e==="kml"||e==="wms"||e==="wmts"||e==="wfs"?(n=t.includes("Hosted Service"),e==="feature service"||e==="feature collection"||e==="kml"||e==="wfs"?(c=t.includes("Table"),o=t.includes("Route Layer"),p=t.includes("Markup"),g=t.includes("Spatiotemporal"),S=t.includes("UtilityNetwork"),s=g&&c?"spatiotemporaltable":c?"table":o?"routelayer":p?"markup":g?"spatiotemporal":S?"utilitynetwork":n?"featureshosted":"features"):e==="map service"||e==="wms"||e==="wmts"?(g=t.includes("Spatiotemporal"),M=t.includes("Relational"),s=g||M?"mapimages":n||t.includes("Tiled")||e==="wmts"?"maptiles":"mapimages"):s=e==="scene service"?t.includes("Line")?"sceneweblayerline":t.includes("3DObject")?"sceneweblayermultipatch":t.includes("Point")?"sceneweblayerpoint":t.includes("IntegratedMesh")?"sceneweblayermesh":t.includes("PointCloud")?"sceneweblayerpointcloud":t.includes("Polygon")?"sceneweblayerpolygon":t.includes("Building")?"sceneweblayerbuilding":t.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":e==="image service"?t.includes("Elevation 3D Layer")?"elevationlayer":t.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":e==="stream service"?"streamlayer":e==="vector tile service"?"vectortile":e==="datastore catalog service"?"datastorecollection":e==="geocoding service"?"geocodeservice":e==="video service"?t.includes("Live Stream")?"livestreamvideolayer":"videolayer":e==="geoprocessing service"?t.includes("Web Tool")?"tool":"layers":e==="geodata service"?"geodataservice":e==="3dtiles service"?t.includes("3DObject")?"3dobjecttileslayer":t.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):e==="web map"||e==="cityengine web scene"?s="maps":e==="web scene"?s=t.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":e==="web mapping application"&&t.includes("configurableApp")?s="instantapps":e==="web mapping application"||e==="mobile application"||e==="application"||e==="operation view"||e==="desktop application"?s="apps":e==="map document"||e==="map package"||e==="published map"||e==="scene document"||e==="globe document"||e==="basemap package"||e==="mobile basemap package"||e==="mobile map package"||e==="project package"||e==="project template"||e==="pro map"||e==="layout"||e==="layer"&&t.includes("ArcGIS Pro")||e==="explorer map"&&t.indexOf("Explorer Document")?s="mapsgray":e==="service definition"||e==="shapefile"||e==="cad drawing"||e==="geojson"||e==="netcdf"||e==="administrative report"?s="datafiles":e==="360 vr experience"?s="360vr":e==="explorer add in"||e==="desktop add in"||e==="windows viewer add in"||e==="windows viewer configuration"?s="appsgray":e==="arcgis pro add in"||e==="arcgis pro configuration"?s="addindesktop":e==="pdf"?s="pdf":e==="microsoft word"?s="word":e==="microsoft excel"?s="excel":e==="microsoft powerpoint"?s="ppt":e==="rule package"||e==="file geodatabase"||e==="sqlite geodatabase"||e==="csv collection"||e==="kml collection"||e==="windows mobile package"||e==="map template"||e==="desktop application template"||e==="gml"||e==="arcpad package"||e==="code sample"||e==="document link"||e==="earth configuration"||e==="operations dashboard add in"||e==="rules package"||e==="workflow manager package"||e==="explorer map"&&t.includes("Explorer Mapping Application")||t.includes("Document")?s="datafilesgray":e==="network analysis service"||e==="geoprocessing service"||e==="geodata service"||e==="geometry service"||e==="geoprocessing package"||e==="locator package"||e==="geoprocessing sample"||e==="workflow manager service"?s="toolsgray":e==="layer"||e==="layer package"||e==="explorer layer"?s="layersgray":e==="scene package"?s="scenepackage":e==="3dtiles package"?s="3dtileslayerpackage":e==="3dtiles service"?s="3dtileslayer":e==="mobile scene package"?s="mobilescenepackage":e==="tile package"||e==="compact tile package"?s="tilepackage":e==="task file"?s="taskfile":e==="report template"?s="report-template":e==="statistical data collection"?s="statisticaldatacollection":e==="insights workbook"?s="workbook":e==="insights model"?s="insightsmodel":e==="insights page"?s="insightspage":e==="insights theme"?s="insightstheme":e==="hub initiative"?s="hubinitiative":e==="hub page"?s="hubpage":e==="hub site application"?s="hubsite":e==="hub event"?s="hubevent":e==="hub project"?s="hubproject":e==="relational database connection"?s="relationaldatabaseconnection":e==="big data file share"?s="datastorecollection":e==="image collection"?s="imagecollection":e==="desktop style"?s="desktopstyle":e==="style"?s="style":e==="dashboard"?s="dashboard":e==="raster function template"?s="rasterprocessingtemplate":e==="vector tile package"?s="vectortilepackage":e==="ortho mapping project"?s="orthomappingproject":e==="ortho mapping template"?s="orthomappingtemplate":e==="solution"?s="solutions":e==="geopackage"?s="geopackage":e==="deep learning package"?s="deeplearningpackage":e==="real time analytic"?s="realtimeanalytics":e==="big data analytic"?s="bigdataanalytics":e==="feed"?s="feed":e==="excalibur imagery project"?s="excaliburimageryproject":e==="notebook"?s="notebook":e==="storymap"?s="storymap":e==="survey123 add in"?s="survey123addin":e==="mission"?s="mission":e==="mission report"?s="missionreport":e==="mission template"?s="missiontemplate":e==="quickcapture project"?s="quickcaptureproject":e==="pro report"?s="proreport":e==="pro report template"?s="proreporttemplate":e==="urban model"?s="urbanmodel":e==="web experience"?s="experiencebuilder":e==="web experience template"?s="webexperiencetemplate":e==="experience builder widget"?s="experiencebuilderwidget":e==="experience builder widget package"?s="experiencebuilderwidgetpackage":e==="workflow"?s="workflow":e==="kernel gateway connection"?s="kernelgatewayconnection":e==="insights script"?s="insightsscript":e==="hub initiative template"?s="hubinitiativetemplate":e==="storymap theme"?s="storymaptheme":e==="knowledge graph"?s="knowledgegraph":e==="knowledge studio project"?s="knowledgestudio":e==="native application"?s="nativeapp":e==="native application installer"?s="nativeappinstaller":e==="web link chart"?s="linkchart":e==="knowledge graph web investigation"?s="investigation":e==="ogcfeatureserver"?s="features":e==="pro project"?s="proproject":e==="insights workbook package"?s="insightsworkbookpackage":e==="apache parquet"?s="apacheparquet":e==="notebook code snippets"||e==="notebook code snippet library"?s="notebookcodesnippets":e==="suitability model"?s="suitabilitymodel":e==="esri classifier definition"?s="classifierdefinition":e==="esri classification schema"?s="classificationschema":e==="insights data engineering workbook"?s="dataengineeringworkbook":e==="insights data engineering model"?s="dataengineeringmodel":e==="deep learning studio project"?s="deeplearningproject":e==="discussion"?s="discussion":e==="allsource project"?s="allsourceproject":e==="api key"?s="apikey":e==="data pipeline"?s="datapipelines":e==="group layer"?(A=t.includes("Map"),s=A?"layergroup2d":"layergroup"):s=e==="media layer"?"onlinemedialayer":e==="form"?t.includes("Survey123")?"survey":"datafilesgray":e==="csv"?"csv":e==="image"?"image":"maps",s?$i(i+s+r+".png"):null}get isLayer(){return this.type!=null&&QW.has(this.type)}get itemCdnUrl(){return RA(this.itemUrl)}get itemPageUrl(){var t;const e=(t=this.portal)==null?void 0:t.itemPageUrl;return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const e=this.itemUrl,t=this.thumbnail;return e&&t?((i=this.portal)==null?void 0:i.normalizeUrl(`${e}/info/${t}?f=json`))??null:null}get userItemUrl(){var i,r,s;const e=(i=this.portal)==null?void 0:i.restUrl;if(!e)return null;const t=this.owner||((s=(r=this.portal)==null?void 0:r.user)==null?void 0:s.username);return t?`${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`:null}load(e){const t=this.portal??(this.portal=Wa.getDefault()),i=t.load(e).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?t.request(this.itemUrl,{signal:e!=null?e.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(e){const t={method:"post",query:{}};return e instanceof xS&&(e=e.rating),e==null||isNaN(e)||typeof e!="number"||(t.query.rating=e),this.portal?(await this.portal.request(this.itemUrl+"/addRating",t),new xS({rating:e,created:new Date})):null}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:He(this.applicationProxies),avgRating:this.avgRating,categories:He(this.categories),created:He(this.created),culture:this.culture,description:this.description,extent:He(this.extent),groupCategories:He(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:He(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:He(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:He(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:He(this.typeKeywords),url:this.url};this.loaded&&(e.loadStatus="loaded");const t=new cd({sourceJSON:this.sourceJSON}).set(e);return t._set("isOrgItem",this.isOrgItem),t}createPostQuery(){var i;const e=this.toJSON();for(const r of["tags","typeKeywords","categories"])e[r]=(i=e[r])==null?void 0:i.join(", ");const{extent:t}=e;return t&&(e.extent=JSON.stringify(t)),e}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(e="json",t){return this.portal.request(this.itemUrl+"/data",{responseType:e,...t,query:{token:this.apiKey}})}async fetchRating(e){const t=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...e});return t.rating!=null?(t.created=new Date(t.created),new xS(t)):null}fetchRelatedItems(e,t){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...e,token:this.apiKey},...t},cd)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(e=>(this.sourceJSON=e,this.read(e),this))}update(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const t=e==null?void 0:e.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,t!=null&&(typeof t=="string"?i.query.text=t:typeof t=="object"&&(i.query.text=JSON.stringify(t))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new Je("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(e){if(!this.id)throw new Je("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:t,itemUrl:i}=this;await t.signIn();const{copyResources:r,folder:s,tags:n,title:c}=e||{},o={method:"post",query:{copyPrivateResources:r==="all",folder:typeof s=="string"?s:s==null?void 0:s.id,includeResources:!!r,tags:n==null?void 0:n.join(","),title:c}},{itemId:p}=await t.request(`${i}/copy`,o);return new cd({id:p,portal:t})}updateThumbnail(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const t=e.thumbnail,i=e.filename,r={method:"post"};if(typeof t=="string")Mp(t)?r.query={data:t}:r.query={url:Ko(t)},i!=null&&(r.query.filename=i);else{const s=new FormData;i!=null?s.append("file",t,i):s.append("file",t),r.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new Je("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},t){const{fetchResources:i}=await ht(()=>import("./resourceUtils-D4PfXFWS.js"),[]);return i(this,e,t)}async addResource(e,t,i){const{addOrUpdateResources:r}=await ht(()=>import("./resourceUtils-D4PfXFWS.js"),[]);return e.portalItem=this,await r(this,[{resource:e,content:t,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"add",i),e}async removeResource(e,t){const{removeResource:i}=await ht(()=>import("./resourceUtils-D4PfXFWS.js"),[]);if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new Je("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,e,t)}async removeAllResources(e){const{removeAllResources:t}=await ht(()=>import("./resourceUtils-D4PfXFWS.js"),[]);return t(this,e)}resourceFromPath(e){return new YW({portalItem:this,path:e})}toJSON(){var i,r;const e=this.extent,t={accessInformation:this.accessInformation,categories:He(this.categories),created:(i=this.created)==null?void 0:i.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(r=this.modified)==null?void 0:r.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:He(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:He(this.typeKeywords),url:this.url};return E5(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new cd({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)t==="tags"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="typeKeywords"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="extent"&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};v([I({type:["private","shared","org","public"]})],ii.prototype,"access",void 0),v([I()],ii.prototype,"accessInformation",void 0),v([I({type:String})],ii.prototype,"apiKey",void 0),v([I({json:{read:{source:"appProxies"}}})],ii.prototype,"applicationProxies",void 0),v([I()],ii.prototype,"avgRating",void 0),v([I()],ii.prototype,"categories",void 0),v([I({type:Date})],ii.prototype,"created",void 0),v([I()],ii.prototype,"culture",void 0),v([I()],ii.prototype,"description",void 0),v([I({readOnly:!0})],ii.prototype,"displayName",null),v([I({type:Bi})],ii.prototype,"extent",void 0),v([fi("extent")],ii.prototype,"readExtent",null),v([I()],ii.prototype,"groupCategories",void 0),v([I({readOnly:!0})],ii.prototype,"iconUrl",null),v([I()],ii.prototype,"id",void 0),v([I({readOnly:!0})],ii.prototype,"isLayer",null),v([I({type:Boolean,readOnly:!0})],ii.prototype,"isOrgItem",void 0),v([I()],ii.prototype,"itemControl",void 0),v([I({readOnly:!0})],ii.prototype,"itemPageUrl",null),v([I({readOnly:!0})],ii.prototype,"itemUrl",null),v([I()],ii.prototype,"licenseInfo",void 0),v([I({type:Date})],ii.prototype,"modified",void 0),v([I()],ii.prototype,"name",void 0),v([I()],ii.prototype,"numComments",void 0),v([I()],ii.prototype,"numRatings",void 0),v([I()],ii.prototype,"numViews",void 0),v([I()],ii.prototype,"owner",void 0),v([I()],ii.prototype,"ownerFolder",void 0),v([I({type:Wa})],ii.prototype,"portal",void 0),v([I()],ii.prototype,"screenshots",void 0),v([I()],ii.prototype,"size",void 0),v([I()],ii.prototype,"snippet",void 0),v([I()],ii.prototype,"sourceJSON",void 0),v([I({type:String})],ii.prototype,"sourceUrl",void 0),v([I({type:String})],ii.prototype,"spatialReference",void 0),v([I()],ii.prototype,"tags",void 0),v([I()],ii.prototype,"thumbnail",void 0),v([I({readOnly:!0})],ii.prototype,"thumbnailUrl",null),v([I()],ii.prototype,"title",void 0),v([I()],ii.prototype,"type",void 0),v([I()],ii.prototype,"typeKeywords",void 0),v([I({type:String,json:{read(e,t){var i;if(eZ.has(t.type)){const r=(i=this.portal)==null?void 0:i.restUrl;e||(e=r&&this.id?`${r}/content/items/${this.id}/data`:null)}return e}}})],ii.prototype,"url",void 0),v([I({readOnly:!0})],ii.prototype,"userItemUrl",null),ii=cd=v([me("esri.portal.PortalItem")],ii);const m0=ii,gN=Object.freeze(Object.defineProperty({__proto__:null,default:m0},Symbol.toStringTag,{value:"Module"})),N$=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,tZ={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function z$(e){return e in tZ}const Eg=[],dm=new Map;function F$(e){for(const t of dm.keys())_N(e.pattern,t)&&dm.delete(t)}function iZ(e){return Eg.includes(e)||(F$(e),Eg.unshift(e)),Qi(()=>{const t=Eg.indexOf(e);t>-1&&(Eg.splice(t,1),F$(e))})}async function OA(e){const t=bo();dm.has(e)||dm.set(e,sZ(e,t));const i=dm.get(e);return i&&await nZ.add(i),i}function rZ(e){if(!N$.test(e))return null;const t=N$.exec(e);if(t===null)return null;const[,i,r]=t,s=i+(r?"-"+r.toUpperCase():"");return z$(s)?s:z$(i)?i:null}async function sZ(e,t){const i=[];for(const r of Eg)if(_N(r.pattern,e))try{return await r.fetchMessageBundle(e,t)}catch(s){i.push(s)}throw i.length?new Je("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:i}):new Je("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function _N(e,t){return typeof e=="string"?t.startsWith(e):e.test(t)}PA(()=>{dm.clear()});const nZ=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=sa())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function oZ(e){if(!e)return;const t=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e.includes("-3d")?e.slice(0,e.indexOf("-3d")):e,i=await OA("esri/t9n/basemaps");return i[e]||i[t]}const pE={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return $i("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return $i("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return $i("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return $i("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return $i("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return $i("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return $i("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return $i("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return $i("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return $i("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return $i("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return $i("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return $i("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return $i("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return $i("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return $i("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}},aZ=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let Mu=class extends zt{constructor(t){super(t),this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const t=bo().toLowerCase();switch(t){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const i=jW(t);return i==="pt"?"pt-BR":i&&aZ.has(i)?i:"global"}};v([I()],Mu.prototype,"id",void 0),v([I()],Mu.prototype,"language",void 0),v([I()],Mu.prototype,"places",void 0),v([I()],Mu.prototype,"serviceUrl",void 0),v([I()],Mu.prototype,"worldview",void 0),Mu=v([me("esri.support.BasemapStyle")],Mu);const lZ=Mu;function cZ(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function wf(e){return(e==null?void 0:e.type)==="subtype-sublayer"}const nge={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function oge(e){const t=e==null?void 0:e.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function bx(e){var t;return(e==null?void 0:e.type)==="feature"&&!e.url&&((t=e.source)==null?void 0:t.type)==="memory"}function age(e){var t;return((e==null?void 0:e.type)==="feature"||(e==null?void 0:e.type)==="subtype-group")&&((t=e.source)==null?void 0:t.type)==="feature-layer"}async function uZ(e,t){const i=_i==null?void 0:_i.findServerInfo(e);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const r=e.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const s=`${e.substring(0,r)}/rest/info`,n=t!=null?t.signal:null,{data:c}=await Xi(s,{query:{f:"json"},responseType:"json",signal:n});return(c==null?void 0:c.owningSystemUrl)||null}function hZ(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function dZ(e){return hZ(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function pZ(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function fZ(e){return!!pZ(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}const mZ=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),yZ=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function gZ(e){return e.layerContainerType==="basemap"?mZ:e.layerContainerType==="operational-layers"?yZ:null}function _Z(e,t){if(t.restrictedWebMapWriting){const i=gZ(t);return i==null||i.has(e.type)&&!bx(e)}return!0}function vZ(e,t){var i;if(t)if(bx(e)){const r=ix("featureCollection.layers",t),s=(i=r==null?void 0:r[0])==null?void 0:i.layerDefinition;s&&B$(e,s)}else e.type!=="group"&&B$(e,t)}function B$(e,t){"maxScale"in e&&(t.maxScale=ew(e.maxScale)??void 0),"minScale"in e&&(t.minScale=ew(e.minScale)??void 0)}function bZ(e,t){if(vZ(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,t.blendMode==="normal"&&delete t.blendMode),t.opacity=ew(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&e.type!=="wmts"))if(bx(e)){const i=t.featureCollection;i&&(i.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function U$(e,t,i){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return i!=null&&i.messages&&i.messages.push(new Je("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if(bx(e)&&!e.isTable)t=e.resourceInfo;else if(_Z(e,i)){const r={};return e.write(r,i)?r:null}return t!=null&&bZ(e,t=He(t)),t}var Ig;let wZ=0;const xZ="esri.Basemap";let fo=Ig=class extends p_(hh){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+wZ++,this.baseLayers=new Ut,this.referenceLayers=new Ut;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&_t.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.addHandles([this.baseLayers.on("after-add",r=>t(r.item)),this.referenceLayers.on("after-add",r=>t(r.item)),this.baseLayers.on("after-remove",r=>i(r.item)),this.referenceLayers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(e=>{_t.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroy();const t=this.referenceLayers.toArray();for(const i of t)i.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=nr(this.portalItem)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",dp(e,this._get("baseLayers")))}_writeBaseLayers(e,t,i){const r=[];e&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(s=>{const n=U$(s,i.webmap?i.webmap.getLayerJSONFromResourceInfo(s):null,i);n!=null&&r.push(n)}),this.referenceLayers.forEach(s=>{const n=U$(s,i.webmap?i.webmap.getLayerJSONFromResourceInfo(s):null,i);n!=null&&(s.type!=="scene"&&(n.isReference=!0),r.push(n))})),t.baseMapLayers=r}set referenceLayers(e){this._set("referenceLayers",dp(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Y4(this,e=>{e(this.baseLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(t=>Fb(t)?t.clone():t),referenceLayers:this.referenceLayers.map(t=>Fb(t)?t.clone():t)};return this.loaded&&(e.loadStatus="loaded"),new Ig({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){var i;return e=e||{},t!=null&&t.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&((i=this.resourceInfo)!=null&&i.data.baseMapLayers)&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const s=He(r);return s.url&&na(s.url)&&(s.url=`https:${s.url}`),s.templateUrl&&na(s.templateUrl)&&(s.templateUrl=`https:${s.templateUrl}`),s})),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:i,style:r}=this;dr(e);const s=[];if(t){const n=t.context?t.context.url:null;if(s.push(this._loadLayersFromJSON(t.data,n,e)),t.data.id&&!t.data.title){const c=t.data.id;s.push(oZ(c).then(o=>{o&&this.read({title:o},t.context)}))}}else i?s.push(this._loadFromItem(i,e)):r&&s.push(this._loadFromStylesService(r,e));await Promise.all(s)}async _loadLayersFromJSON(e,t,i){var p,g;const r=(p=this.resourceInfo)==null?void 0:p.context,s=((g=this.portalItem)==null?void 0:g.portal)||(r==null?void 0:r.portal)||null,n=TZ[(r==null?void 0:r.origin)||""]??"web-map",{populateOperationalLayers:c}=await ht(()=>import("./layersCreator-Bx-Ezijl.js"),__vite__mapDeps([2,3,4,5,6])),o=[];if(dr(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const S={context:{...r,origin:n,url:t,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},M=z=>n==="web-scene"&&z.layerType==="ArcGISSceneServiceLayer"||z.isReference,A=c(this.baseLayers,e.baseMapLayers.filter(z=>!M(z)),S);o.push(A);const O=c(this.referenceLayers,e.baseMapLayers.filter(M),S);o.push(O)}await Promise.allSettled(o)}async _loadFromItem(e,t){const i=await e.load(t),r=await i.fetchData("json",t),s=Mr(e.itemUrl??"");return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:SZ[e.type||""]??"web-map",portal:e.portal||Wa.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||Wa.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,t)}async _loadFromStylesService(e,t){const i=`${e.serviceUrl}/${e.id}`,r=(await Xi(i,{query:{language:e.getLanguageParamValue(),places:e.places,worldview:e.worldview},signal:t==null?void 0:t.signal})).data,s=Mr(i);return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:"web-map",url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this._loadLayersFromJSON(this.resourceInfo.data,s,t)}static fromId(e){const t=pE[e];return t?t.itemId?new Ig({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):Ig.fromJSON(t,{origin:t.is3d?"web-scene":"web-map"}):null}};v([I({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,i,r){this._writeBaseLayers(e,t,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ut}},writer(e,t,i,r){this._writeBaseLayers(e,t,r)}}}}}})],fo.prototype,"baseLayers",null),v([I({type:String,json:{origins:{"web-scene":{write:!0}}}})],fo.prototype,"id",void 0),v([I({type:m0})],fo.prototype,"portalItem",void 0),v([I()],fo.prototype,"referenceLayers",null),v([I({readOnly:!0})],fo.prototype,"resourceInfo",void 0),v([I({type:mi})],fo.prototype,"spatialReference",void 0),v([I({type:lZ})],fo.prototype,"style",void 0),v([I()],fo.prototype,"thumbnailUrl",void 0),v([I({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],fo.prototype,"title",void 0),v([ci("title")],fo.prototype,"writeTitle",null),fo=Ig=v([me(xZ)],fo);const SZ={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},TZ={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},y0=fo,EZ=Object.freeze(Object.defineProperty({__proto__:null,default:y0},Symbol.toStringTag,{value:"Module"})),fw={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function vN(e){return!!fw[e]||!!fw[e.toLowerCase()]}function LA(e){return fw[e]??fw[e.toLowerCase()]}function IZ(e){return[...LA(e)]}function SS(e,t,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?e+(t-e)*r:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function bN(e,t,i,r=1){const s=(e%360+360)%360/360,n=i<=.5?i*(t+1):i+t-i*t,c=2*i-n;return[Math.round(255*SS(c,n,s+1/3)),Math.round(255*SS(c,n,s)),Math.round(255*SS(c,n,s-1/3)),r]}function MZ(e){const t=e.length>5,i=t?8:4,r=(1<<i)-1,s=t?1:17,n=t?e.length===9:e.length===5;let c=+("0x"+e.substr(1));if(isNaN(c))return null;const o=[0,0,0,1];let p;return n&&(p=c&r,c>>=i,o[3]=s*p/255),p=c&r,c>>=i,o[2]=s*p,p=c&r,c>>=i,o[1]=s*p,p=c&r,c>>=i,o[0]=s*p,o}function Th(){return[0,0,0]}function AZ(e){return[e[0],e[1],e[2]]}function y_(e,t,i){return[e,t,i]}function PZ(e,t=Th()){const i=Math.min(3,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function CZ(e,t){return new Float64Array(e,t,3)}function wN(){return Th()}function xN(){return y_(1,1,1)}function SN(){return y_(1,0,0)}function TN(){return y_(0,1,0)}function EN(){return y_(0,0,1)}const $Z=wN(),kZ=xN(),RZ=SN(),OZ=TN(),LZ=EN();Object.freeze(Object.defineProperty({__proto__:null,ONES:kZ,UNIT_X:RZ,UNIT_Y:OZ,UNIT_Z:LZ,ZEROS:$Z,clone:AZ,create:Th,createView:CZ,fromArray:PZ,fromValues:y_,ones:xN,unitX:SN,unitY:TN,unitZ:EN,zeros:wN},Symbol.toStringTag,{value:"Module"}));let DA=1e-6;function aa(){return DA}function DZ(e){DA=e}const wx=Math.random,NZ=Math.PI/180,zZ=180/Math.PI;function NA(e){return e*NZ}function FZ(e){return e*zZ}function BZ(e,t){return Math.abs(e-t)<=DA*Math.max(1,Math.abs(e),Math.abs(t))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:wx,equals:BZ,getEpsilon:aa,setEpsilon:DZ,toDegree:FZ,toRadian:NA},Symbol.toStringTag,{value:"Module"}));function zA(e){const t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)}function UZ(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function IN(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e}function jZ(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function MN(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function AN(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function PN(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function VZ(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function GZ(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function qZ(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e}function HZ(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e}function WZ(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function ZZ(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function YZ(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function CN(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function JZ(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e}function $N(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(i*i+r*r+s*s)}function kN(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return i*i+r*r+s*s}function RN(e){const t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r}function KZ(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function XZ(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function fE(e,t){const i=t[0],r=t[1],s=t[2];let n=i*i+r*r+s*s;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e}function ON(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function QZ(e,t,i){const r=t[0],s=t[1],n=t[2],c=i[0],o=i[1],p=i[2];return e[0]=s*p-n*o,e[1]=n*c-r*p,e[2]=r*o-s*c,e}function eY(e,t,i,r){const s=t[0],n=t[1],c=t[2];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e[2]=c+r*(i[2]-c),e}function tY(e,t,i,r,s,n){const c=n*n,o=c*(2*n-3)+1,p=c*(n-2)+n,g=c*(n-1),S=c*(3-2*n);return e[0]=t[0]*o+i[0]*p+r[0]*g+s[0]*S,e[1]=t[1]*o+i[1]*p+r[1]*g+s[1]*S,e[2]=t[2]*o+i[2]*p+r[2]*g+s[2]*S,e}function iY(e,t,i,r,s,n){const c=1-n,o=c*c,p=n*n,g=o*c,S=3*n*o,M=3*p*c,A=p*n;return e[0]=t[0]*g+i[0]*S+r[0]*M+s[0]*A,e[1]=t[1]*g+i[1]*S+r[1]*M+s[1]*A,e[2]=t[2]*g+i[2]*S+r[2]*M+s[2]*A,e}function rY(e,t){t=t||1;const i=wx,r=2*i()*Math.PI,s=2*i()-1,n=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=s*t,e}function sY(e,t,i){const r=t[0],s=t[1],n=t[2];return e[0]=i[0]*r+i[4]*s+i[8]*n+i[12],e[1]=i[1]*r+i[5]*s+i[9]*n+i[13],e[2]=i[2]*r+i[6]*s+i[10]*n+i[14],e}function nY(e,t,i){const r=t[0],s=t[1],n=t[2];return e[0]=r*i[0]+s*i[3]+n*i[6],e[1]=r*i[1]+s*i[4]+n*i[7],e[2]=r*i[2]+s*i[5]+n*i[8],e}function oY(e,t,i){const r=i[0],s=i[1],n=i[2],c=i[3],o=t[0],p=t[1],g=t[2],S=s*g-n*p,M=n*o-r*g,A=r*p-s*o,O=s*A-n*M,z=n*S-r*A,V=r*M-s*S,W=2*c;return e[0]=o+S*W+2*O,e[1]=p+M*W+2*z,e[2]=g+A*W+2*V,e}function aY(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[0],n[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),n[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function lY(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),n[1]=s[1],n[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function cY(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),n[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),n[2]=s[2],e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function uY(e,t){fE(j$,e),fE(V$,t);const i=ON(j$,V$);return i>1?0:i<-1?Math.PI:Math.acos(i)}const j$=Th(),V$=Th();function hY(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function dY(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function pY(e,t){if(e===t)return!0;const i=e[0],r=e[1],s=e[2],n=t[0],c=t[1],o=t[2],p=aa();return Math.abs(i-n)<=p*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-c)<=p*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-o)<=p*Math.max(1,Math.abs(s),Math.abs(o))}function fY(e,t,i){const r=i[0]-t[0],s=i[1]-t[1],n=i[2]-t[2];let c=r*r+s*s+n*n;return c>0?(c=1/Math.sqrt(c),e[0]=r*c,e[1]=s*c,e[2]=n*c,e):(e[0]=0,e[1]=0,e[2]=0,e)}const mY=MN,yY=AN,gY=PN,_Y=$N,vY=kN,bY=zA,wY=RN;Object.freeze(Object.defineProperty({__proto__:null,abs:qZ,add:jZ,angle:uY,bezier:iY,ceil:VZ,copy:UZ,cross:QZ,direction:fY,dist:_Y,distance:$N,div:gY,divide:PN,dot:ON,equals:pY,exactEquals:dY,floor:GZ,hermite:tY,inverse:XZ,len:bY,length:zA,lerp:eY,max:ZZ,min:WZ,mul:yY,multiply:AN,negate:KZ,normalize:fE,random:rY,rotateX:aY,rotateY:lY,rotateZ:cY,round:YZ,scale:CN,scaleAndAdd:JZ,set:IN,sign:HZ,sqrDist:vY,sqrLen:wY,squaredDistance:kN,squaredLength:RN,str:hY,sub:mY,subtract:MN,transformMat3:nY,transformMat4:sY,transformQuat:oY},Symbol.toStringTag,{value:"Module"}));const G$=new Float32Array(1);function lge(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function Ol(e,t,i){return Math.min(Math.max(e,t),i)}function cge(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function xY(e,t,i){return e+(t-e)*i}function uge(e,t,i,r,s){return xY(r,s,(e-t)/(i-t))}function LN(e){return e*Math.PI/180}function DN(e){return 180*e/Math.PI}function hge(e){return Math.acos(Ol(e,-1,1))}function NN(e){return Math.asin(Ol(e,-1,1))}function TS(e,t,i=1e-6){return e===t?!0:!Number.isFinite(e)||!Number.isFinite(t)?!1:(e>t?e-t:t-e)<=i}const mw=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function SY(e){return mw.setFloat64(0,e),mw.getBigInt64(0)}function TY(e){return mw.setBigInt64(0,e),mw.getFloat64(0)}const ES=BigInt("1000000");EY(1);function EY(e){const t=SY(e=Math.abs(e)),i=TY(t<=ES?ES:t-ES);return Math.abs(e-i)}function dge(e){return zN(Math.max(-q$,Math.min(e,q$)))}function zN(e){return G$[0]=e,G$[0]}function pge(e,t){const i=zA(e),r=NN(e[2]/i),s=Math.atan2(e[1]/i,e[0]/i);return IN(t,i,r,s),t}function fge(e){const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[3]*e[3]+e[4]*e[4]+e[5]*e[5],r=e[6]*e[6]+e[7]*e[7]+e[8]*e[8];return!(TS(t,1)&&TS(i,1)&&TS(r,1))}const q$=zN(34028234663852886e22);function K1(e){return Ol(sA(e),0,255)}function X1(e,t,i){return e=Number(e),isNaN(e)?i:e<t?t:e>i?i:e}function Q1(e,t){const i=e.toString(16).padStart(2,"0");return t?i.substring(0,1):i}let Gv=class us{static blendColors(t,i,r,s=new us){return s.r=Math.round(t.r+(i.r-t.r)*r),s.g=Math.round(t.g+(i.g-t.g)*r),s.b=Math.round(t.b+(i.b-t.b)*r),s.a=t.a+(i.a-t.a)*r,s._sanitize()}static fromRgb(t,i){const r=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){const s=r[2].split(/\s*,\s*/),n=r[1];if(n==="rgb"&&s.length===3||n==="rgba"&&s.length===4){const c=s[0];if(c.charAt(c.length-1)==="%"){const o=s.map(p=>2.56*parseFloat(p));return s.length===4&&(o[3]=parseFloat(s[3])),us.fromArray(o,i)}return us.fromArray(s.map(o=>parseFloat(o)),i)}if(n==="hsl"&&s.length===3||n==="hsla"&&s.length===4)return us.fromArray(bN(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100,parseFloat(s[3])),i)}return null}static fromHex(t,i=new us){if(t[0]!=="#"||isNaN(+`0x${t.substring(1)}`))return null;switch(t.length){case 4:case 5:{const r=parseInt(t.substring(1,2),16),s=parseInt(t.substring(2,3),16),n=parseInt(t.substring(3,4),16),c=t.length===5?15:parseInt(t.substring(4),16);return us.fromArray([r+16*r,s+16*s,n+16*n,(c+16*c)/255],i)}case 7:case 9:{const r=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16),c=t.length===7?255:parseInt(t.substring(7),16);return us.fromArray([r,s,n,c/255],i)}default:return null}}static fromArray(t,i=new us){return i._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(t,i){const r=vN(t)?LA(t):null;return r&&us.fromArray(r,i)||us.fromRgb(t,i)||us.fromHex(t,i)}static fromJSON(t){return t!=null?new us([t[0],t[1],t[2],(t[3]??255)/255]):void 0}static toUnitRGB(t){return t!=null?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return t!=null?[t.r/255,t.g/255,t.b/255,t.a!=null?t.a:1]:null}constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(t){return typeof t=="string"?us.fromString(t,this):Array.isArray(t)?us.fromArray(t,this):(this._set(t.r??0,t.g??0,t.b??0,t.a??1),t instanceof us||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(t){const i=(t==null?void 0:t.capitalize)??!1,r=(t==null?void 0:t.digits)??6,s=r===3||r===4,n=r===4||r===8,c=`#${Q1(this.r,s)}${Q1(this.g,s)}${Q1(this.b,s)}${n?Q1(Math.round(255*this.a),s):""}`;return i?c.toUpperCase():c}toCss(t=!1){const i=this.r+", "+this.g+", "+this.b;return t?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=us.AlphaMode.ALWAYS){const i=K1(this.r),r=K1(this.g),s=K1(this.b);return t===us.AlphaMode.ALWAYS||this.a!==1?[i,r,s,K1(255*this.a)]:[i,r,s]}clone(){return new us(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return t!=null&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Math.round(X1(this.r,0,255)),this.g=Math.round(X1(this.g,0,255)),this.b=Math.round(X1(this.b,0,255)),this.a=X1(this.a,0,1),this}_set(t,i,r,s){this.r=t,this.g=i,this.b=r,this.a=s}};Gv.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(Gv||(Gv={}));const Bt=Gv;function mge(e){}function IY(e){return()=>e}function qt(e,t={}){const i=e instanceof Ms?e:new Ms(e,t),r={type:(t==null?void 0:t.ignoreUnknown)??1?i.apiValues:String,json:{type:i.jsonValues,read:!(t!=null&&t.readOnly)&&{reader:i.read},write:{writer:i.write}}};return(t==null?void 0:t.readOnly)!==void 0&&(r.readOnly=!!t.readOnly),(t==null?void 0:t.default)!==void 0&&(r.json.default=t.default),(t==null?void 0:t.name)!==void 0&&(r.json.name=t.name),(t==null?void 0:t.nonNullable)!==void 0&&(r.nonNullable=t.nonNullable),I(r)}var mE;let qv=mE=class extends At{constructor(e){super(e),this.type="none"}clone(){return new mE({type:this.type})}};v([qt({none:"none",stayAbove:"stay-above"})],qv.prototype,"type",void 0),qv=mE=v([me("esri.ground.NavigationConstraint")],qv);function FN(e){const t=sA(100*(1-e));return Math.max(0,Math.min(t,100))}function yw(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}var yE;let vc=yE=class extends p_(hh){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ut;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&_t.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>t(r.item)),this.layers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(e=>{qs(e)||_t.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)nr(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",dp(e,this._get("layers")))}writeLayers(e,t,i,r){const s=[];e&&(r={...r,layerContainerType:"ground"},e.forEach(n=>{if("write"in n){const c={};IY(n)().write(c,r)&&s.push(c)}else r!=null&&r.messages&&r.messages.push(new Je("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),t.layers=s}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Y4(this,e=>{e(this.layers)})}async queryElevation(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:i}=await ht(()=>import("./ElevationQuery-DZ0yNBHY.js"),[]);dr(t);const r=new i,s=this.layers.filter(H$).toArray();return r.queryAll(s,e,t)}async createElevationSampler(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:i}=await ht(()=>import("./ElevationQuery-DZ0yNBHY.js"),[]);dr(t);const r=new i,s=this.layers.filter(H$).toArray();return r.createSamplerAll(s,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:He(this.surfaceColor),navigationConstraint:He(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new yE({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,i){const r=(t==null?void 0:t.origin)||"web-scene",s=(t==null?void 0:t.portal)||null,n=(t==null?void 0:t.url)||null,{populateOperationalLayers:c}=await ht(()=>import("./layersCreator-Bx-Ezijl.js"),__vite__mapDeps([2,3,4,5,6]));dr(i);const o=[];if(e.layers&&Array.isArray(e.layers)){const p={context:{origin:r,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};o.push(c(this.layers,e.layers,p))}await Promise.allSettled(o)}};function MY(e){return e&&"createElevationSampler"in e}function H$(e){return e.type==="elevation"||MY(e)}v([I({json:{read:!1}})],vc.prototype,"layers",null),v([ci("layers")],vc.prototype,"writeLayers",null),v([I({readOnly:!0})],vc.prototype,"resourceInfo",void 0),v([I({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Er,read:{reader:yw,source:"transparency"},write:{writer:(e,t)=>{t.transparency=FN(e)},target:"transparency"}}})],vc.prototype,"opacity",void 0),v([I({type:Bt,json:{type:[Er],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],vc.prototype,"surfaceColor",void 0),v([I({type:qv,json:{write:!0}})],vc.prototype,"navigationConstraint",void 0),vc=yE=v([me("esri.Ground")],vc);const gw=vc;let Cf=class extends Ut{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(OG(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const t=this.getCollections!=null?this.getCollections():null;if(t==null)return void this.removeAll();let i=0;for(const r of t)r!=null&&(i=this._processCollection(i,r));this.splice(i,this.length)}_createNewInstance(t){return new Ut(t)}_processCollection(t,i){if(!i)return t;const r=this.itemFilterFunction??(s=>!!s);for(const s of i)if(s){if(r(s)){const n=this.indexOf(s,t);n>=0?n!==t&&this.reorder(s,t):this.add(s,t),++t}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const c of n)t=this._processCollection(t,c);else t=this._processCollection(t,n)}}return t}};v([I()],Cf.prototype,"getCollections",void 0),v([I()],Cf.prototype,"getChildrenFunction",void 0),v([I()],Cf.prototype,"itemFilterFunction",void 0),Cf=v([me("esri.core.CollectionFlattener")],Cf);const G0=Cf;function AY(e){var t,i;return!(!(e&&typeof e=="object"&&"loaded"in e&&e.loaded&&((i=(t=dZ(e))==null?void 0:t.operations)!=null&&i.supportsEditing)&&"type"in e)||"editingEnabled"in e&&!fZ(e))}const PY=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,CY="screenUtils.toPt: input not recognized!",BN=96;function gge(e){return e?e/72*BN:0}function fh(e){return e?72*e/BN:0}function yr(e){if(typeof e=="string"){const t=e.match(PY);if(t){const i=Number(t[1]),r=t[3]&&t[3].toLowerCase(),s=e.charAt(0)==="-",n=r==="px"?fh(i):i;return s?-n:n}return console.warn(CY),null}return e}function Ln(e=0,t=0){return{x:e,y:t}}function _ge(e=0,t=0){return[e,t]}function xx(){const e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function $Y(e){const t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function kY(e,t,i,r,s,n,c,o,p,g,S,M,A,O,z,V){const W=new Float32Array(16);return W[0]=e,W[1]=t,W[2]=i,W[3]=r,W[4]=s,W[5]=n,W[6]=c,W[7]=o,W[8]=p,W[9]=g,W[10]=S,W[11]=M,W[12]=A,W[13]=O,W[14]=z,W[15]=V,W}function RY(e,t){return new Float32Array(e,t,16)}const OY=xx();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:OY,clone:$Y,create:xx,createView:RY,fromValues:kY},Symbol.toStringTag,{value:"Module"}));function LY(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Eh(e,t,i,r,s,n,c,o,p,g,S,M,A,O,z,V,W){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=c,e[6]=o,e[7]=p,e[8]=g,e[9]=S,e[10]=M,e[11]=A,e[12]=O,e[13]=z,e[14]=V,e[15]=W,e}function Sx(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ih(e,t){if(e===t){const i=t[1],r=t[2],s=t[3],n=t[6],c=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=n,e[11]=t[14],e[12]=s,e[13]=c,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function DY(e,t){return UN(e,t)||Sx(e),e}function UN(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5],p=t[6],g=t[7],S=t[8],M=t[9],A=t[10],O=t[11],z=t[12],V=t[13],W=t[14],ie=t[15],ve=i*o-r*c,pe=i*p-s*c,_e=i*g-n*c,Me=r*p-s*o,$e=r*g-n*o,Fe=s*g-n*p,Ge=S*V-M*z,et=S*W-A*z,at=S*ie-O*z,ct=M*W-A*V,nt=M*ie-O*V,Pt=A*ie-O*W;let ft=ve*Pt-pe*nt+_e*ct+Me*at-$e*et+Fe*Ge;return ft?(ft=1/ft,e[0]=(o*Pt-p*nt+g*ct)*ft,e[1]=(s*nt-r*Pt-n*ct)*ft,e[2]=(V*Fe-W*$e+ie*Me)*ft,e[3]=(A*$e-M*Fe-O*Me)*ft,e[4]=(p*at-c*Pt-g*et)*ft,e[5]=(i*Pt-s*at+n*et)*ft,e[6]=(W*_e-z*Fe-ie*pe)*ft,e[7]=(S*Fe-A*_e+O*pe)*ft,e[8]=(c*nt-o*at+g*Ge)*ft,e[9]=(r*at-i*nt-n*Ge)*ft,e[10]=(z*$e-V*_e+ie*ve)*ft,e[11]=(M*_e-S*$e-O*ve)*ft,e[12]=(o*et-c*ct-p*Ge)*ft,e[13]=(i*ct-r*et+s*Ge)*ft,e[14]=(V*pe-z*Me-W*ve)*ft,e[15]=(S*Me-M*pe+A*ve)*ft,e):null}function NY(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5],p=t[6],g=t[7],S=t[8],M=t[9],A=t[10],O=t[11],z=t[12],V=t[13],W=t[14],ie=t[15];return e[0]=o*(A*ie-O*W)-M*(p*ie-g*W)+V*(p*O-g*A),e[1]=-(r*(A*ie-O*W)-M*(s*ie-n*W)+V*(s*O-n*A)),e[2]=r*(p*ie-g*W)-o*(s*ie-n*W)+V*(s*g-n*p),e[3]=-(r*(p*O-g*A)-o*(s*O-n*A)+M*(s*g-n*p)),e[4]=-(c*(A*ie-O*W)-S*(p*ie-g*W)+z*(p*O-g*A)),e[5]=i*(A*ie-O*W)-S*(s*ie-n*W)+z*(s*O-n*A),e[6]=-(i*(p*ie-g*W)-c*(s*ie-n*W)+z*(s*g-n*p)),e[7]=i*(p*O-g*A)-c*(s*O-n*A)+S*(s*g-n*p),e[8]=c*(M*ie-O*V)-S*(o*ie-g*V)+z*(o*O-g*M),e[9]=-(i*(M*ie-O*V)-S*(r*ie-n*V)+z*(r*O-n*M)),e[10]=i*(o*ie-g*V)-c*(r*ie-n*V)+z*(r*g-n*o),e[11]=-(i*(o*O-g*M)-c*(r*O-n*M)+S*(r*g-n*o)),e[12]=-(c*(M*W-A*V)-S*(o*W-p*V)+z*(o*A-p*M)),e[13]=i*(M*W-A*V)-S*(r*W-s*V)+z*(r*A-s*M),e[14]=-(i*(o*W-p*V)-c*(r*W-s*V)+z*(r*p-s*o)),e[15]=i*(o*A-p*M)-c*(r*A-s*M)+S*(r*p-s*o),e}function zY(e){const t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],c=e[5],o=e[6],p=e[7],g=e[8],S=e[9],M=e[10],A=e[11],O=e[12],z=e[13],V=e[14],W=e[15];return(t*c-i*n)*(M*W-A*V)-(t*o-r*n)*(S*W-A*z)+(t*p-s*n)*(S*V-M*z)+(i*o-r*c)*(g*W-A*O)-(i*p-s*c)*(g*V-M*O)+(r*p-s*o)*(g*z-S*O)}function jN(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=t[6],S=t[7],M=t[8],A=t[9],O=t[10],z=t[11],V=t[12],W=t[13],ie=t[14],ve=t[15];let pe=i[0],_e=i[1],Me=i[2],$e=i[3];return e[0]=pe*r+_e*o+Me*M+$e*V,e[1]=pe*s+_e*p+Me*A+$e*W,e[2]=pe*n+_e*g+Me*O+$e*ie,e[3]=pe*c+_e*S+Me*z+$e*ve,pe=i[4],_e=i[5],Me=i[6],$e=i[7],e[4]=pe*r+_e*o+Me*M+$e*V,e[5]=pe*s+_e*p+Me*A+$e*W,e[6]=pe*n+_e*g+Me*O+$e*ie,e[7]=pe*c+_e*S+Me*z+$e*ve,pe=i[8],_e=i[9],Me=i[10],$e=i[11],e[8]=pe*r+_e*o+Me*M+$e*V,e[9]=pe*s+_e*p+Me*A+$e*W,e[10]=pe*n+_e*g+Me*O+$e*ie,e[11]=pe*c+_e*S+Me*z+$e*ve,pe=i[12],_e=i[13],Me=i[14],$e=i[15],e[12]=pe*r+_e*o+Me*M+$e*V,e[13]=pe*s+_e*p+Me*A+$e*W,e[14]=pe*n+_e*g+Me*O+$e*ie,e[15]=pe*c+_e*S+Me*z+$e*ve,e}function FY(e,t,i){const r=i[0],s=i[1],n=i[2];if(t===e)e[12]=t[0]*r+t[4]*s+t[8]*n+t[12],e[13]=t[1]*r+t[5]*s+t[9]*n+t[13],e[14]=t[2]*r+t[6]*s+t[10]*n+t[14],e[15]=t[3]*r+t[7]*s+t[11]*n+t[15];else{const c=t[0],o=t[1],p=t[2],g=t[3],S=t[4],M=t[5],A=t[6],O=t[7],z=t[8],V=t[9],W=t[10],ie=t[11];e[0]=c,e[1]=o,e[2]=p,e[3]=g,e[4]=S,e[5]=M,e[6]=A,e[7]=O,e[8]=z,e[9]=V,e[10]=W,e[11]=ie,e[12]=c*r+S*s+z*n+t[12],e[13]=o*r+M*s+V*n+t[13],e[14]=p*r+A*s+W*n+t[14],e[15]=g*r+O*s+ie*n+t[15]}return e}function BY(e,t,i){const r=i[0],s=i[1],n=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function UY(e,t,i,r){let s,n,c,o,p,g,S,M,A,O,z,V,W,ie,ve,pe,_e,Me,$e,Fe,Ge,et,at,ct,nt=r[0],Pt=r[1],ft=r[2],vi=Math.sqrt(nt*nt+Pt*Pt+ft*ft);return vi<aa()?null:(vi=1/vi,nt*=vi,Pt*=vi,ft*=vi,s=Math.sin(i),n=Math.cos(i),c=1-n,o=t[0],p=t[1],g=t[2],S=t[3],M=t[4],A=t[5],O=t[6],z=t[7],V=t[8],W=t[9],ie=t[10],ve=t[11],pe=nt*nt*c+n,_e=Pt*nt*c+ft*s,Me=ft*nt*c-Pt*s,$e=nt*Pt*c-ft*s,Fe=Pt*Pt*c+n,Ge=ft*Pt*c+nt*s,et=nt*ft*c+Pt*s,at=Pt*ft*c-nt*s,ct=ft*ft*c+n,e[0]=o*pe+M*_e+V*Me,e[1]=p*pe+A*_e+W*Me,e[2]=g*pe+O*_e+ie*Me,e[3]=S*pe+z*_e+ve*Me,e[4]=o*$e+M*Fe+V*Ge,e[5]=p*$e+A*Fe+W*Ge,e[6]=g*$e+O*Fe+ie*Ge,e[7]=S*$e+z*Fe+ve*Ge,e[8]=o*et+M*at+V*ct,e[9]=p*et+A*at+W*ct,e[10]=g*et+O*at+ie*ct,e[11]=S*et+z*at+ve*ct,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function jY(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[4],c=t[5],o=t[6],p=t[7],g=t[8],S=t[9],M=t[10],A=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*s+g*r,e[5]=c*s+S*r,e[6]=o*s+M*r,e[7]=p*s+A*r,e[8]=g*s-n*r,e[9]=S*s-c*r,e[10]=M*s-o*r,e[11]=A*s-p*r,e}function VY(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[0],c=t[1],o=t[2],p=t[3],g=t[8],S=t[9],M=t[10],A=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s-g*r,e[1]=c*s-S*r,e[2]=o*s-M*r,e[3]=p*s-A*r,e[8]=n*r+g*s,e[9]=c*r+S*s,e[10]=o*r+M*s,e[11]=p*r+A*s,e}function GY(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[0],c=t[1],o=t[2],p=t[3],g=t[4],S=t[5],M=t[6],A=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s+g*r,e[1]=c*s+S*r,e[2]=o*s+M*r,e[3]=p*s+A*r,e[4]=g*s-n*r,e[5]=S*s-c*r,e[6]=M*s-o*r,e[7]=A*s-p*r,e}function qY(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function HY(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function WY(e,t,i){if(t===0)return Sx(e);let r,s,n,c=i[0],o=i[1],p=i[2],g=Math.sqrt(c*c+o*o+p*p);return g<aa()?null:(g=1/g,c*=g,o*=g,p*=g,r=Math.sin(t),s=Math.cos(t),n=1-s,e[0]=c*c*n+s,e[1]=o*c*n+p*r,e[2]=p*c*n-o*r,e[3]=0,e[4]=c*o*n-p*r,e[5]=o*o*n+s,e[6]=p*o*n+c*r,e[7]=0,e[8]=c*p*n+o*r,e[9]=o*p*n-c*r,e[10]=p*p*n+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ZY(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function YY(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function JY(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function VN(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=r+r,p=s+s,g=n+n,S=r*o,M=r*p,A=r*g,O=s*p,z=s*g,V=n*g,W=c*o,ie=c*p,ve=c*g;return e[0]=1-(O+V),e[1]=M+ve,e[2]=A-ie,e[3]=0,e[4]=M-ve,e[5]=1-(S+V),e[6]=z+W,e[7]=0,e[8]=A+ie,e[9]=z-W,e[10]=1-(S+O),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function KY(e,t){const i=XY,r=-t[0],s=-t[1],n=-t[2],c=t[3],o=t[4],p=t[5],g=t[6],S=t[7],M=r*r+s*s+n*n+c*c;return M>0?(i[0]=2*(o*c+S*r+p*n-g*s)/M,i[1]=2*(p*c+S*s+g*r-o*n)/M,i[2]=2*(g*c+S*n+o*s-p*r)/M):(i[0]=2*(o*c+S*r+p*n-g*s),i[1]=2*(p*c+S*s+g*r-o*n),i[2]=2*(g*c+S*n+o*s-p*r)),VN(e,t,i),e}const XY=Th();function QY(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function eJ(e,t){const i=t[0],r=t[1],s=t[2],n=t[4],c=t[5],o=t[6],p=t[8],g=t[9],S=t[10];return e[0]=Math.sqrt(i*i+r*r+s*s),e[1]=Math.sqrt(n*n+c*c+o*o),e[2]=Math.sqrt(p*p+g*g+S*S),e}function tJ(e,t){const i=t[0]+t[5]+t[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e}function iJ(e,t,i,r){const s=t[0],n=t[1],c=t[2],o=t[3],p=s+s,g=n+n,S=c+c,M=s*p,A=s*g,O=s*S,z=n*g,V=n*S,W=c*S,ie=o*p,ve=o*g,pe=o*S,_e=r[0],Me=r[1],$e=r[2];return e[0]=(1-(z+W))*_e,e[1]=(A+pe)*_e,e[2]=(O-ve)*_e,e[3]=0,e[4]=(A-pe)*Me,e[5]=(1-(M+W))*Me,e[6]=(V+ie)*Me,e[7]=0,e[8]=(O+ve)*$e,e[9]=(V-ie)*$e,e[10]=(1-(M+z))*$e,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function rJ(e,t,i,r,s){const n=t[0],c=t[1],o=t[2],p=t[3],g=n+n,S=c+c,M=o+o,A=n*g,O=n*S,z=n*M,V=c*S,W=c*M,ie=o*M,ve=p*g,pe=p*S,_e=p*M,Me=r[0],$e=r[1],Fe=r[2],Ge=s[0],et=s[1],at=s[2],ct=(1-(V+ie))*Me,nt=(O+_e)*Me,Pt=(z-pe)*Me,ft=(O-_e)*$e,vi=(1-(A+ie))*$e,Li=(W+ve)*$e,Tt=(z+pe)*Fe,Ft=(W-ve)*Fe,Hi=(1-(A+V))*Fe;return e[0]=ct,e[1]=nt,e[2]=Pt,e[3]=0,e[4]=ft,e[5]=vi,e[6]=Li,e[7]=0,e[8]=Tt,e[9]=Ft,e[10]=Hi,e[11]=0,e[12]=i[0]+Ge-(ct*Ge+ft*et+Tt*at),e[13]=i[1]+et-(nt*Ge+vi*et+Ft*at),e[14]=i[2]+at-(Pt*Ge+Li*et+Hi*at),e[15]=1,e}function sJ(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=i+i,o=r+r,p=s+s,g=i*c,S=r*c,M=r*o,A=s*c,O=s*o,z=s*p,V=n*c,W=n*o,ie=n*p;return e[0]=1-M-z,e[1]=S+ie,e[2]=A-W,e[3]=0,e[4]=S-ie,e[5]=1-g-z,e[6]=O+V,e[7]=0,e[8]=A+W,e[9]=O-V,e[10]=1-g-M,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function nJ(e,t,i,r,s,n,c){const o=1/(i-t),p=1/(s-r),g=1/(n-c);return e[0]=2*n*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n*p,e[6]=0,e[7]=0,e[8]=(i+t)*o,e[9]=(s+r)*p,e[10]=(c+n)*g,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*n*2*g,e[15]=0,e}function oJ(e,t,i,r,s){const n=1/Math.tan(t/2);let c;return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0?(c=1/(r-s),e[10]=(s+r)*c,e[14]=2*s*r*c):(e[10]=-1,e[14]=-2*r),e}function aJ(e,t,i,r){const s=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),p=2/(c+o),g=2/(s+n);return e[0]=p,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=g,e[6]=0,e[7]=0,e[8]=-(c-o)*p*.5,e[9]=(s-n)*g*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e}function lJ(e,t,i,r,s,n,c){const o=1/(t-i),p=1/(r-s),g=1/(n-c);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*p,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*g,e[11]=0,e[12]=(t+i)*o,e[13]=(s+r)*p,e[14]=(c+n)*g,e[15]=1,e}function cJ(e,t,i,r){const s=t[0],n=t[1],c=t[2];let o=s-i[0],p=n-i[1],g=c-i[2];const S=aa();if(Math.abs(o)<S&&Math.abs(p)<S&&Math.abs(g)<S)return void Sx(e);let M=1/Math.sqrt(o*o+p*p+g*g);o*=M,p*=M,g*=M;const A=r[0],O=r[1],z=r[2];let V=O*g-z*p,W=z*o-A*g,ie=A*p-O*o;M=Math.sqrt(V*V+W*W+ie*ie),M?(M=1/M,V*=M,W*=M,ie*=M):(V=0,W=0,ie=0);let ve=p*ie-g*W,pe=g*V-o*ie,_e=o*W-p*V;M=Math.sqrt(ve*ve+pe*pe+_e*_e),M?(M=1/M,ve*=M,pe*=M,_e*=M):(ve=0,pe=0,_e=0),e[0]=V,e[1]=ve,e[2]=o,e[3]=0,e[4]=W,e[5]=pe,e[6]=p,e[7]=0,e[8]=ie,e[9]=_e,e[10]=g,e[11]=0,e[12]=-(V*s+W*n+ie*c),e[13]=-(ve*s+pe*n+_e*c),e[14]=-(o*s+p*n+g*c),e[15]=1}function uJ(e,t,i,r){const s=t[0],n=t[1],c=t[2],o=r[0],p=r[1],g=r[2];let S=s-i[0],M=n-i[1],A=c-i[2],O=S*S+M*M+A*A;O>0&&(O=1/Math.sqrt(O),S*=O,M*=O,A*=O);let z=p*A-g*M,V=g*S-o*A,W=o*M-p*S;return O=z*z+V*V+W*W,O>0&&(O=1/Math.sqrt(O),z*=O,V*=O,W*=O),e[0]=z,e[1]=V,e[2]=W,e[3]=0,e[4]=M*W-A*V,e[5]=A*z-S*W,e[6]=S*V-M*z,e[7]=0,e[8]=S,e[9]=M,e[10]=A,e[11]=0,e[12]=s,e[13]=n,e[14]=c,e[15]=1,e}function hJ(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function dJ(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2+e[9]**2+e[10]**2+e[11]**2+e[12]**2+e[13]**2+e[14]**2+e[15]**2)}function pJ(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function GN(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function fJ(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}function mJ(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e}function yJ(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function gJ(e,t){if(e===t)return!0;const i=e[0],r=e[1],s=e[2],n=e[3],c=e[4],o=e[5],p=e[6],g=e[7],S=e[8],M=e[9],A=e[10],O=e[11],z=e[12],V=e[13],W=e[14],ie=e[15],ve=t[0],pe=t[1],_e=t[2],Me=t[3],$e=t[4],Fe=t[5],Ge=t[6],et=t[7],at=t[8],ct=t[9],nt=t[10],Pt=t[11],ft=t[12],vi=t[13],Li=t[14],Tt=t[15],Ft=aa();return Math.abs(i-ve)<=Ft*Math.max(1,Math.abs(i),Math.abs(ve))&&Math.abs(r-pe)<=Ft*Math.max(1,Math.abs(r),Math.abs(pe))&&Math.abs(s-_e)<=Ft*Math.max(1,Math.abs(s),Math.abs(_e))&&Math.abs(n-Me)<=Ft*Math.max(1,Math.abs(n),Math.abs(Me))&&Math.abs(c-$e)<=Ft*Math.max(1,Math.abs(c),Math.abs($e))&&Math.abs(o-Fe)<=Ft*Math.max(1,Math.abs(o),Math.abs(Fe))&&Math.abs(p-Ge)<=Ft*Math.max(1,Math.abs(p),Math.abs(Ge))&&Math.abs(g-et)<=Ft*Math.max(1,Math.abs(g),Math.abs(et))&&Math.abs(S-at)<=Ft*Math.max(1,Math.abs(S),Math.abs(at))&&Math.abs(M-ct)<=Ft*Math.max(1,Math.abs(M),Math.abs(ct))&&Math.abs(A-nt)<=Ft*Math.max(1,Math.abs(A),Math.abs(nt))&&Math.abs(O-Pt)<=Ft*Math.max(1,Math.abs(O),Math.abs(Pt))&&Math.abs(z-ft)<=Ft*Math.max(1,Math.abs(z),Math.abs(ft))&&Math.abs(V-vi)<=Ft*Math.max(1,Math.abs(V),Math.abs(vi))&&Math.abs(W-Li)<=Ft*Math.max(1,Math.abs(W),Math.abs(Li))&&Math.abs(ie-Tt)<=Ft*Math.max(1,Math.abs(ie),Math.abs(Tt))}function _J(e){const t=aa(),i=e[0],r=e[1],s=e[2],n=e[4],c=e[5],o=e[6],p=e[8],g=e[9],S=e[10];return Math.abs(1-(i*i+n*n+p*p))<=t&&Math.abs(1-(r*r+c*c+g*g))<=t&&Math.abs(1-(s*s+o*o+S*S))<=t}function vJ(e){return e[0]===1&&e[1]===0&&e[2]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[8]===0&&e[9]===0&&e[10]===1}const bJ=jN,wJ=GN;Object.freeze(Object.defineProperty({__proto__:null,add:pJ,adjoint:NY,copy:LY,determinant:zY,equals:gJ,exactEquals:yJ,frob:dJ,fromQuat:sJ,fromQuat2:KY,fromRotation:WY,fromRotationTranslation:VN,fromRotationTranslationScale:iJ,fromRotationTranslationScaleOrigin:rJ,fromScaling:HY,fromTranslation:qY,fromXRotation:ZY,fromYRotation:YY,fromZRotation:JY,frustum:nJ,getRotation:tJ,getScaling:eJ,getTranslation:QY,hasIdentityRotation:vJ,identity:Sx,invert:UN,invertOrIdentity:DY,isOrthoNormal:_J,lookAt:cJ,mul:bJ,multiply:jN,multiplyScalar:fJ,multiplyScalarAndAdd:mJ,ortho:lJ,perspective:oJ,perspectiveFromFieldOfView:aJ,rotate:UY,rotateX:jY,rotateY:VY,rotateZ:GY,scale:BY,set:Eh,str:hJ,sub:wJ,subtract:GN,targetTo:uJ,translate:FY,transpose:Ih},Symbol.toStringTag,{value:"Module"}));const xJ=(e,t)=>{const i=Eh(e,t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return Ih(i,i)},SJ=(e,t)=>{const i=Eh(e,t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return Ih(i,i)},TJ=(e,t)=>{const i=1-t,r=Eh(e,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return Ih(r,r)},EJ=(e,t)=>{const i=Math.sin(t*Math.PI/180),r=Math.cos(t*Math.PI/180),s=Eh(e,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return Ih(s,s)},IJ=(e,t)=>{const i=1-2*t,r=Eh(e,i,0,0,t,0,i,0,t,0,0,i,t,0,0,0,1);return Ih(r,r)},MJ=(e,t)=>{const i=Eh(e,.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return Ih(i,i)},AJ=(e,t)=>{const i=1-t,r=Eh(e,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return Ih(r,r)};let qN=class HN{constructor(t,i,r){this.strength=t,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(t,i,r){this.strength=Zn(t.strength,i.strength,r),this.radius=Zn(t.radius,i.radius,r),this.threshold=Zn(t.threshold,i.threshold,r)}clone(){return new HN(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:g0(this.radius),strength:this.strength,threshold:this.threshold}}},WN=class ZN{constructor(t){this.radius=t,this.type="blur"}interpolate(t,i,r){this.radius=Math.round(Zn(t.radius,i.radius,r))}clone(){return new ZN(this.radius)}toJSON(){return{type:"blur",radius:g0(this.radius)}}},gE=class YN{constructor(t,i){this.type=t,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.amount=Zn(t.amount,i.amount,r),this._updateMatrix()}clone(){return new YN(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||xx();switch(this.type){case"brightness":this._colorMatrix=xJ(t,this.amount);break;case"contrast":this._colorMatrix=SJ(t,this.amount);break;case"grayscale":this._colorMatrix=TJ(t,this.amount);break;case"invert":this._colorMatrix=IJ(t,this.amount);break;case"saturate":this._colorMatrix=MJ(t,this.amount);break;case"sepia":this._colorMatrix=AJ(t,this.amount)}}},JN=class KN{constructor(t,i,r,s){this.offsetX=t,this.offsetY=i,this.blurRadius=r,this.color=s,this.type="drop-shadow"}interpolate(t,i,r){this.offsetX=Zn(t.offsetX,i.offsetX,r),this.offsetY=Zn(t.offsetY,i.offsetY,r),this.blurRadius=Zn(t.blurRadius,i.blurRadius,r),this.color[0]=Math.round(Zn(t.color[0],i.color[0],r)),this.color[1]=Math.round(Zn(t.color[1],i.color[1],r)),this.color[2]=Math.round(Zn(t.color[2],i.color[2],r)),this.color[3]=Zn(t.color[3],i.color[3],r)}clone(){return new KN(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:g0(this.offsetX),yoffset:g0(this.offsetY),blurRadius:g0(this.blurRadius),color:t}}},XN=class QN{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.angle=Zn(t.angle,i.angle,r),this._updateMatrix()}clone(){return new QN(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||xx();this._colorMatrix=EJ(t,this.angle)}},e6=class t6{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,i,r){this.amount=Zn(t.amount,i.amount,r)}clone(){return new t6(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Zn(e,t,i){return e+(t-e)*i}function g0(e){return Math.round(1e3*fh(e))/1e3}function PJ(e){switch(e.type){case"grayscale":case"sepia":case"invert":return new gE(e.type,0);case"saturate":case"brightness":case"contrast":return new gE(e.type,1);case"opacity":return new e6(1);case"hue-rotate":return new XN(0);case"blur":return new WN(0);case"drop-shadow":return new JN(0,0,0,[...LA("transparent")]);case"bloom":return new qN(0,0,1)}}function CJ(e,t){const i=e.length>t.length?e:t;return(e.length>t.length?t:e).every((r,s)=>r.type===i[s].type)}function $J(e,t){const i=e.length>t.length?e:t,r=e.length>t.length?t:e;for(let s=r.length;s<i.length;s++)r.push(PJ(i[s]))}function kJ(e){const t=e[0];return!!t&&"type"in t}const W$=()=>_t.getLogger("esri.support.basemapUtils");function RJ(){return{}}function OJ(e){for(const t in e){const i=e[t];nr(i),delete e[t]}}function LJ(e,t){let i;if(typeof e=="string"){const r=e in pE,s=!r&&e.includes("/");if(!r&&!s){const n=Object.entries(pE).filter(([c,o])=>Pi.apiKey&&!o.classic||!Pi.apiKey&&(o.classic||o.is3d)).map(([c])=>`"${c}"`).sort().join(", ");return W$().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${n}`),null}t&&(i=t[e]),i||(i=r?y0.fromId(e):new y0({style:{id:e}}),t&&(t[e]=i))}else i=zn(y0,e);return i!=null&&i.destroyed&&(W$().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function DJ(e){return new G0({getCollections:()=>[e.tables,e.layers],getChildrenFunction:t=>{const i=[];return"tables"in t&&i.push(t.tables),"layers"in t&&i.push(t.layers),i},itemFilterFunction:t=>{const i=t.parent;return!!i&&"tables"in i&&i.tables.includes(t)}})}function IS(e){for(const t of e.values())t==null||t.destroy();e.clear()}const Z$={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function NJ(e){let t=null;if(typeof e=="string")if(e in Z$){const i=Z$[e];t=new gw({resourceInfo:{data:{layers:[i]}}})}else _t.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=zn(gw,e);return t}function Mm(e,t,i=!1){let{hasM:r,hasZ:s}=e;Array.isArray(t)?t.length!==4||r||s?t.length===3&&i&&!r?(s=!0,r=!1):t.length===3&&r&&s&&(r=!1,s=!1):(r=!0,s=!0):(s=!s&&t.hasZ&&(!r||t.hasM),r=!r&&t.hasM&&(!s||t.hasZ)),e.hasZ=s,e.hasM=r}var _E;function Y$(e){return(t,i)=>t==null?i:i==null?t:e(t,i)}function zJ(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let Au=_E=class extends Sh{constructor(...e){super(...e),this.points=[],this.type="multipoint"}normalizeCtorArgs(e,t){var s;if(!e&&!t)return{};const i={};Array.isArray(e)?(i.points=e,i.spatialReference=t):zJ(e)?i.spatialReference=e:(e.points&&(i.points=e.points),e.spatialReference&&(i.spatialReference=e.spatialReference),e.hasZ&&(i.hasZ=e.hasZ),e.hasM&&(i.hasM=e.hasM));const r=(s=i.points)==null?void 0:s[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const e=this.points;if(!e.length)return null;const t=new Bi,i=this.hasZ,r=this.hasM,s=i?3:2,n=e[0],c=Y$(Math.min),o=Y$(Math.max);let p,g,S,M,[A,O]=n,[z,V]=n;for(let W=0,ie=e.length;W<ie;W++){const ve=e[W],[pe,_e]=ve;if(A=c(A,pe),O=c(O,_e),z=o(z,pe),V=o(V,_e),i&&ve.length>2){const Me=ve[2];p=c(p,Me),S=o(S,Me)}if(r&&ve.length>s){const Me=ve[s];g=c(g,Me),M=o(M,Me)}}return t.xmin=A,t.ymin=O,t.xmax=z,t.ymax=V,t.spatialReference=this.spatialReference,i?(t.zmin=p,t.zmax=S):(t.zmin=void 0,t.zmax=void 0),r?(t.mmin=g,t.mmax=M):(t.mmin=void 0,t.mmax=void 0),t}writePoints(e,t){t.points=He(this.points)}addPoint(e){return Mm(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}clone(){const e={points:He(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new _E(e)}getPoint(e){if(!this._validateInputs(e))return null;const t=this.points[e],i={x:t[0],y:t[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=t[2],r=3),this.hasM&&(i.m=t[r]),new ri(i)}removePoint(e){if(!this._validateInputs(e))return null;const t=new ri(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}setPoint(e,t){return this._validateInputs(e)?(Mm(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}toJSON(e){return this.write({},e)}_validateInputs(e){return e!=null&&e>=0&&e<this.points.length}};v([I({readOnly:!0})],Au.prototype,"cache",null),v([I()],Au.prototype,"extent",null),v([I({type:[[Number]],json:{write:{isRequired:!0}}})],Au.prototype,"points",void 0),v([ci("points")],Au.prototype,"writePoints",null),Au=_E=v([me("esri.geometry.Multipoint")],Au),Au.prototype.toJSON.isDefaultToJSON=!0;const Tx=Au;function vge(e){const t=[];for(e.reset();e.nextPath();){const i=[];for(;e.nextPoint();)i.push([e.x,e.y]);t.push(i)}return e.reset(),t}function FJ(e){const t=[];for(;e.nextPoint();)t.push([e.x,e.y]);return e.seekPathStart(),t}var _w;(function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"})(_w||(_w={}));function i6(e,t){const i=t[0]-e[0],r=t[1]-e[1];if(e.length>2&&t.length>2){const s=e[2]-t[2];return Math.sqrt(i*i+r*r+s*s)}return Math.sqrt(i*i+r*r)}function BJ(e,t,i){const r=e[0]+i*(t[0]-e[0]),s=e[1]+i*(t[1]-e[1]);return e.length>2&&t.length>2?[r,s,e[2]+i*(t[2]-e[2])]:[r,s]}function UJ(e,t,i,r){return jJ(e,t,i[r],i[r+1])}function jJ(e,t,i,r){const[s,n]=t,[c,o]=i,[p,g]=r,S=p-c,M=g-o,A=S*S+M*M,O=(s-c)*S+(n-o)*M,z=Math.min(1,Math.max(0,O/A));return e[0]=c+S*z,e[1]=o+M*z,e}function VJ(e,t,i,r,s,n){let c=i,o=r,p=s-c,g=n-o;if(p!==0||g!==0){const S=((e-c)*p+(t-o)*g)/(p*p+g*g);S>1?(c=s,o=n):S>0&&(c+=p*S,o+=g*S)}return p=e-c,g=t-o,p*p+g*g}function r6(e,t){return BJ(e,t,.5)}function s6(e,t=_w.X,i=_w.Y){let r=0;const s=e.length;let n=e[0];for(let c=0;c<s-1;c++){const o=e[c+1];r+=(o[t]-n[t])*(o[i]+n[i]),n=o}return r>=0}function GJ(e){const t=e.length;return t>2&&Qw(e[0],e[t-1])}function bge(e){if("rings"in e&&(qJ(e),e.rings.length>0&&!s6(e.rings[0])))for(const t of e.rings)t.reverse()}function qJ(e){if("rings"in e)for(const t of e.rings)GJ(t)||t.push(t[0].slice())}function wge(e){return e?e.hasZ?[e.xmax-e.xmin/2,e.ymax-e.ymin/2,e.zmax-e.zmin/2]:[e.xmax-e.xmin/2,e.ymax-e.ymin/2]:null}function HJ(e){return e?WJ(e.rings,e.hasZ??!1):null}function WJ(e,t){if(!(e!=null&&e.length))return null;const i=[],r=[],s=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,c=e.length;n<c;n++){const o=n6(e[n],t,s);o&&r.push(o)}if(r.sort((n,c)=>{let o=n[2]-c[2];return o===0&&t&&(o=n[4]-c[4]),o}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],t&&(i[2]=r[0][3]),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||t&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)),!i.length){const n=e[0]&&e[0].length?ZJ(e[0],t):null;if(!n)return null;i[0]=n[0],i[1]=n[1],t&&n.length>2&&(i[2]=n[2])}return i}function n6(e,t,i){let r=0,s=0,n=0,c=0,o=0;const p=e.length?e[0][0]:0,g=e.length?e[0][1]:0,S=e.length&&t?e[0][2]:0;for(let A=0;A<e.length;A++){const O=e[A],z=e[(A+1)%e.length],[V,W,ie]=O,ve=V-p,pe=W-g,[_e,Me,$e]=z,Fe=_e-p,Ge=Me-g,et=ve*Ge-Fe*pe;if(c+=et,r+=(ve+Fe)*et,s+=(pe+Ge)*et,t&&O.length>2&&z.length>2){const at=ie-S,ct=$e-S,nt=ve*ct-Fe*at;n+=(at+ct)*nt,o+=nt}V<i[0]&&(i[0]=V),V>i[1]&&(i[1]=V),W<i[2]&&(i[2]=W),W>i[3]&&(i[3]=W),t&&(ie<i[4]&&(i[4]=ie),ie>i[5]&&(i[5]=ie))}if(c>0&&(c*=-1),o>0&&(o*=-1),!c)return null;c*=.5,o*=.5;const M=[r/(6*c)+p,s/(6*c)+g,c];return t&&(i[4]===i[5]||o===0?(M[3]=(i[4]+i[5])/2,M[4]=0):(M[3]=n/(6*o)+S,M[4]=o)),M}function xge(e,t){let i=0,r=0,s=0;e.nextPoint();const n=e.pathSize?e.x:0,c=e.pathSize?e.y:0;for(let o=0;o<e.pathSize;o++){e.seekInPath(o);const p=[e.x,e.y];e.seekInPath((o+1)%e.pathSize);const g=[e.x,e.y],[S,M]=p,A=S-n,O=M-c,[z,V]=g,W=z-n,ie=V-c,ve=A*ie-W*O;s+=ve,i+=(A+W)*ve,r+=(O+ie)*ve,S<t[0]&&(t[0]=S),S>t[1]&&(t[1]=S),M<t[2]&&(t[2]=M),M>t[3]&&(t[3]=M)}return s>0&&(s*=-1),s?(s*=.5,[i/(6*s)+n,r/(6*s)+c,s]):null}function ZJ(e,t){const i=t?[0,0,0]:[0,0],r=t?[0,0,0]:[0,0];let s=0,n=0,c=0,o=0;for(let p=0,g=e.length;p<g-1;p++){const S=e[p],M=e[p+1];if(S&&M){i[0]=S[0],i[1]=S[1],r[0]=M[0],r[1]=M[1],t&&S.length>2&&M.length>2&&(i[2]=S[2],r[2]=M[2]);const A=i6(i,r);if(A){s+=A;const O=r6(S,M);n+=A*O[0],c+=A*O[1],t&&O.length>2&&(o+=A*O[2])}}}return s>0?t?[n/s,c/s,o/s]:[n/s,c/s]:e.length?e[0]:null}function YJ(e){const{hasZ:t,totalSize:i}=e;if(i===0)return null;const r=[],s=[],n=t?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(e.reset();e.nextPath();){const c=n6(FJ(e),e.hasZ,n);c&&s.push(c)}if(s.sort((c,o)=>{let p=c[2]-o[2];return p===0&&t&&(p=c[4]-o[4]),p}),s.length&&(r[0]=s[0][0],r[1]=s[0][1],t&&(r[2]=s[0][3]),(r[0]<n[0]||r[0]>n[1]||r[1]<n[2]||r[1]>n[3]||t&&(r[2]<n[4]||r[2]>n[5]))&&(r.length=0)),!r.length){e.reset(),e.nextPath();const c=e.pathSize?JJ(e):null;if(!c)return null;r[0]=c[0],r[1]=c[1],t&&c.length>2&&(r[2]=c[2])}return r}function JJ(e){const{hasZ:t}=e,i=t?[0,0,0]:[0,0],r=t?[0,0,0]:[0,0];let s=0,n=0,c=0,o=0;if(e.nextPoint()){let p=e.x,g=e.y,S=e.z;for(;e.nextPoint();){const M=e.x,A=e.y,O=e.z;i[0]=p,i[1]=g,r[0]=M,r[1]=A,t&&(i[2]=S,r[2]=O);const z=i6(i,r);if(z){s+=z;const V=r6(i,r);n+=z*V[0],c+=z*V[1],t&&V.length>2&&(o+=z*V[2])}p=M,g=A,S=O}}return s>0?t?[n/s,c/s,o/s]:[n/s,c/s]:e.pathSize?(e.seekPathStart(),e.nextPoint(),[e.x,e.y]):null}const KJ=1e-6;function Sge(e){let t=0;for(e.reset();e.nextPath();)t+=e.getCurrentRingArea();if(t<KJ){const s=YJ(e);return s?[s[0],s[1]]:null}const i=[0,0];if(e.reset(),!e.nextPath()||!e.nextPoint())return null;const r=[e.x,e.y];for(e.reset();e.nextPath();)QJ(i,r,e);return i[0]*=1/t,i[1]*=1/t,i[0]+=r[0],i[1]+=r[1],i}const XJ=1/3;function QJ(e,t,i){if(!e||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,s=i.y;i.nextPoint();let n,c=i.x-r,o=i.y-s,p=0,g=0;for(;i.nextPoint();)p=i.x-r,g=i.y-s,n=.5*XJ*(p*o-g*c),e[0]+=n*(c+p),e[1]+=n*(o+g),c=p,o=g;const S=i.getCurrentRingArea(),M=[r,s];return M[0]-=t[0],M[1]-=t[1],M[0]*=S,M[1]*=S,e[0]+=M[0],e[1]+=M[1],e}function Xn(e=iK){return[e[0],e[1],e[2],e[3]]}function o6(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function eK(e,t,i,r,s=Xn()){return s[0]=e,s[1]=t,s[2]=i,s[3]=r,s}function Tge(e,t=Xn()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function Ege(e,t){return new Bi({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function Ige(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function Mge(e,t,i){if(t!=null)if("length"in t)vE(t)?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3])):t.length!==2&&t.length!==3||(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[0]),i[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":i[0]=Math.min(e[0],t.xmin),i[1]=Math.min(e[1],t.ymin),i[2]=Math.max(e[2],t.xmax),i[3]=Math.max(e[3],t.ymax);break;case"point":i[0]=Math.min(e[0],t.x),i[1]=Math.min(e[1],t.y),i[2]=Math.max(e[2],t.x),i[3]=Math.max(e[3],t.y)}else o6(i,e)}function a6(e){return e==null||e[0]>=e[2]?0:e[2]-e[0]}function l6(e){return e==null||e[1]>=e[3]?0:e[3]-e[1]}function Age(e){return a6(e)*l6(e)}function Pge(e,t,i){return t>=e[0]&&i>=e[1]&&t<=e[2]&&i<=e[3]}function Cge(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function tK(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function $ge(e){return e?o6(e,J$):Xn(J$)}function vE(e){return e!=null&&e.length===4}function kge(e,t){return vE(e)&&vE(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}const J$=[1/0,1/0,-1/0,-1/0],iK=[0,0,0,0];function c6(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function u6(e){return e.points!==void 0}function h6(e){return e.x!==void 0&&e.y!==void 0}function d6(e){return e.paths!==void 0}function p6(e){return e.rings!==void 0}function f6(e){function t(i,r){return i==null?r:r==null?i:e(i,r)}return t}const nh=f6(Math.min),oh=f6(Math.max);function Rge(e,t){return d6(t)?Am(e,t.paths,!1,!1):p6(t)?Am(e,t.rings,!1,!1):u6(t)?FA(e,t.points,!1,!1,!1,!1):c6(t)?m6(e,t):(h6(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function Oge(e){let t,i,r,s;for(e.reset(),t=r=1/0,i=s=-1/0;e.nextPath();){const n=rK(e);t=Math.min(n[0],t),r=Math.min(n[1],r),i=Math.max(n[2],i),s=Math.max(n[3],s)}return Xn([t,r,i,s])}function rK(e){let t,i,r,s;for(t=r=1/0,i=s=-1/0;e.nextPoint();)t=Math.min(e.x,t),r=Math.min(e.y,r),i=Math.max(e.x,i),s=Math.max(e.y,s);return Xn([t,r,i,s])}function Lge(e,t){return d6(t)?Am(e,t.paths,!0,!1):p6(t)?Am(e,t.rings,!0,!1):u6(t)?FA(e,t.points,!0,!1,!0,!1):c6(t)?m6(e,t,!0,!1,!0,!1):(h6(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function Am(e,t,i,r){const s=i?3:2;if(!t.length||!t[0].length)return null;let n,c,o,p,[g,S]=t[0][0],[M,A]=t[0][0];for(let O=0;O<t.length;O++){const z=t[O];for(let V=0;V<z.length;V++){const W=z[V],[ie,ve]=W;if(g=nh(g,ie),S=nh(S,ve),M=oh(M,ie),A=oh(A,ve),i&&W.length>2){const pe=W[2];n=nh(n,pe),c=oh(c,pe)}if(r&&W.length>s){const pe=W[s];o=nh(n,pe),p=oh(c,pe)}}}return i?r?(e[0]=g,e[1]=S,e[2]=n,e[3]=o,e[4]=M,e[5]=A,e[6]=c,e[7]=p,e.length=8,e):(e[0]=g,e[1]=S,e[2]=n,e[3]=M,e[4]=A,e[5]=c,e.length=6,e):r?(e[0]=g,e[1]=S,e[2]=o,e[3]=M,e[4]=A,e[5]=p,e.length=6,e):(e[0]=g,e[1]=S,e[2]=M,e[3]=A,e.length=4,e)}function m6(e,t,i,r,s,n){const c=t.xmin,o=t.xmax,p=t.ymin,g=t.ymax;let S=t.zmin,M=t.zmax,A=t.mmin,O=t.mmax;return s?(S=S||0,M=M||0,n?(A=A||0,O=O||0,e[0]=c,e[1]=p,e[2]=S,e[3]=A,e[4]=o,e[5]=g,e[6]=M,e[7]=O,e):(e[0]=c,e[1]=p,e[2]=S,e[3]=o,e[4]=g,e[5]=M,e)):n?(A=A||0,O=O||0,e[0]=c,e[1]=p,e[2]=A,e[3]=o,e[4]=g,e[5]=O,e):(e[0]=c,e[1]=p,e[2]=o,e[3]=g,e)}function FA(e,t,i,r,s,n){const c=i?3:2,o=r&&n,p=i&&s;if(!t.length||!t[0].length)return null;let g,S,M,A,[O,z]=t[0],[V,W]=t[0];for(let ie=0;ie<t.length;ie++){const ve=t[ie],[pe,_e]=ve;if(O=nh(O,pe),z=nh(z,_e),V=oh(V,pe),W=oh(W,_e),p&&ve.length>2){const Me=ve[2];g=nh(g,Me),S=oh(S,Me)}if(o&&ve.length>c){const Me=ve[c];M=nh(g,Me),A=oh(S,Me)}}return s?(g=g||0,S=S||0,n?(M=M||0,A=A||0,e[0]=O,e[1]=z,e[2]=g,e[3]=M,e[4]=V,e[5]=W,e[6]=S,e[7]=A,e):(e[0]=O,e[1]=z,e[2]=g,e[3]=V,e[4]=W,e[5]=S,e)):n?(M=M||0,A=A||0,e[0]=O,e[1]=z,e[2]=M,e[3]=V,e[4]=W,e[5]=A,e):(e[0]=O,e[1]=z,e[2]=V,e[3]=W,e)}function sK(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function nK(e){return e.points!==void 0}function oK(e){return e.x!==void 0&&e.y!==void 0}function aK(e){return e.paths!==void 0}function lK(e){return e.rings!==void 0}const BA=[];function y6(e,t,i,r){return{xmin:e,ymin:t,xmax:i,ymax:r}}function g6(e,t,i,r,s,n){return{xmin:e,ymin:t,zmin:i,xmax:r,ymax:s,zmax:n}}function _6(e,t,i,r,s,n){return{xmin:e,ymin:t,mmin:i,xmax:r,ymax:s,mmax:n}}function v6(e,t,i,r,s,n,c,o){return{xmin:e,ymin:t,zmin:i,mmin:r,xmax:s,ymax:n,zmax:c,mmax:o}}function UA(e,t=!1,i=!1){return t?i?v6(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):g6(e[0],e[1],e[2],e[3],e[4],e[5]):i?_6(e[0],e[1],e[2],e[3],e[4],e[5]):y6(e[0],e[1],e[2],e[3])}function Dge(e){return e?sK(e)?e:oK(e)?uK(e):lK(e)?b6(e):aK(e)?w6(e):nK(e)?cK(e):null:null}function cK(e){const{hasZ:t,hasM:i,points:r}=e;return UA(FA(BA,r,t??!1,i??!1),t,i)}function uK(e){const{x:t,y:i,z:r,m:s}=e,n=s!=null;return r!=null?n?v6(t,i,r,s,t,i,r,s):g6(t,i,r,t,i,r):n?_6(t,i,s,t,i,s):y6(t,i,t,i)}function b6(e){const{hasZ:t,hasM:i,rings:r}=e,s=Am(BA,r,t??!1,i??!1);return s?UA(s,t,i):null}function w6(e){const{hasZ:t,hasM:i,paths:r}=e,s=Am(BA,r,t??!1,i??!1);return s?UA(s,t,i):null}var Hv;function K$(e){return!Array.isArray(e[0])}let dl=Hv=class extends Sh{static fromExtent(e){const t=e.clone().normalize(),i=e.spatialReference;let r=!1,s=!1;for(const c of t)c.hasZ&&(r=!0),c.hasM&&(s=!0);const n={rings:t.map(c=>{const o=[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]];if(r&&c.hasZ){const p=c.zmin+.5*(c.zmax-c.zmin);for(let g=0;g<o.length;g++)o[g].push(p)}if(s&&c.hasM){const p=c.mmin+.5*(c.mmax-c.mmin);for(let g=0;g<o.length;g++)o[g].push(p)}return o}),spatialReference:i};return r&&(n.hasZ=!0),s&&(n.hasM=!0),new Hv(n)}constructor(...e){super(...e),this.rings=[],this.type="polygon"}normalizeCtorArgs(e,t){var c,o;let i,r,s=null,n=null;return e&&!Array.isArray(e)?(s=e.rings??null,t||(e.spatialReference?t=e.spatialReference:e.rings||(t=e)),i=e.hasZ,r=e.hasM):s=e,s=s||[],t=t||mi.WGS84,s.length&&((c=s[0])==null?void 0:c[0])!=null&&typeof s[0][0]=="number"&&(s=[s]),n=(o=s[0])==null?void 0:o[0],n&&(i===void 0&&r===void 0?(i=n.length>2,r=n.length>3):i===void 0?i=r?n.length>3:n.length>2:r===void 0&&(r=i?n.length>3:n.length>2)),{rings:s,spatialReference:t,hasZ:i,hasM:r}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const e=HJ(this);if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;const t=new ri;return t.x=e[0],t.y=e[1],t.spatialReference=this.spatialReference,this.hasZ&&(t.z=e[2]),t}get extent(){const{spatialReference:e}=this,t=b6(this);if(!t)return null;const i=new Bi(t);return i.spatialReference=e,i}get isSelfIntersecting(){return zW(this.rings)}writeRings(e,t){t.rings=He(this.rings)}addRing(e){if(!e)return;const t=this.rings,i=t.length;if(K$(e)){const r=[];for(let s=0,n=e.length;s<n;s++)r[s]=e[s].toArray();t[i]=r}else t[i]=e.concat();return this.notifyChange("rings"),this}clone(){const e=new Hv;return e.spatialReference=this.spatialReference,e.rings=He(this.rings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,i=e.spatialReference;if(t!=null!=(i!=null)||t!=null&&i!=null&&!t.equals(i)||this.rings.length!==e.rings.length)return!1;const r=([s,n,c,o],[p,g,S,M])=>s===p&&n===g&&(c==null&&S==null||c===S)&&(o==null&&M==null||o===M);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],c=e.rings[s];if(!Qw(n,c,r))return!1}return!0}contains(e){if(!e)return!1;const t=yx(e,this.spatialReference);return hN(this,t??e)}isClockwise(e){let t;return t=K$(e)?e.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):e,s6(t)}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.rings[e][t],r=this.hasZ,s=this.hasM;return r&&!s?new ri(i[0],i[1],i[2],void 0,this.spatialReference):s&&!r?new ri(i[0],i[1],void 0,i[2],this.spatialReference):r&&s?new ri(i[0],i[1],i[2],i[3],this.spatialReference):new ri(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(Mm(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e].splice(t,0,i),this.notifyChange("rings"),this):this}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new ri(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(e){if(!this._validateInputs(e,null))return null;const t=this.rings.splice(e,1)[0],i=this.spatialReference,r=t.map(s=>new ri(s,i));return this.notifyChange("rings"),r}setPoint(e,t,i){return this._validateInputs(e,t)?(Mm(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e][t]=i,this.notifyChange("rings"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.rings.length)return!1;if(t!=null){const r=this.rings[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};v([I({readOnly:!0})],dl.prototype,"cache",null),v([I({readOnly:!0})],dl.prototype,"centroid",null),v([I({readOnly:!0})],dl.prototype,"extent",null),v([I({readOnly:!0})],dl.prototype,"isSelfIntersecting",null),v([I({type:[[[Number]]],json:{write:{isRequired:!0}}})],dl.prototype,"rings",void 0),v([ci("rings")],dl.prototype,"writeRings",null),dl=Hv=v([me("esri.geometry.Polygon")],dl),dl.prototype.toJSON.isDefaultToJSON=!0;const mh=dl;var bE;function hK(e){return!Array.isArray(e[0])}let Pu=bE=class extends Sh{constructor(...e){super(...e),this.paths=[],this.type="polyline"}normalizeCtorArgs(e,t){var c,o;let i,r,s=null,n=null;return e&&!Array.isArray(e)?(s=e.paths??null,t||(e.spatialReference?t=e.spatialReference:e.paths||(t=e)),i=e.hasZ,r=e.hasM):s=e,s=s||[],t=t||mi.WGS84,s.length&&((c=s[0])==null?void 0:c[0])!=null&&typeof s[0][0]=="number"&&(s=[s]),n=(o=s[0])==null?void 0:o[0],n&&(i===void 0&&r===void 0?(i=n.length>2,r=!1):i===void 0?i=!r&&n.length>3:r===void 0&&(r=!i&&n.length>3)),{paths:s,spatialReference:t,hasZ:i,hasM:r}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:e}=this,t=w6(this);if(!t)return null;const i=new Bi(t);return i.spatialReference=e,i}writePaths(e,t){t.paths=He(this.paths)}addPath(e){if(!e)return;const t=this.paths,i=t.length;if(hK(e)){const r=[];for(let s=0,n=e.length;s<n;s++)r[s]=e[s].toArray();t[i]=r}else t[i]=e.concat();return this.notifyChange("paths"),this}clone(){const e=new bE;return e.spatialReference=this.spatialReference,e.paths=He(this.paths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.paths[e][t],r=this.hasZ,s=this.hasM;return r&&!s?new ri(i[0],i[1],i[2],void 0,this.spatialReference):s&&!r?new ri(i[0],i[1],void 0,i[2],this.spatialReference):r&&s?new ri(i[0],i[1],i[2],i[3],this.spatialReference):new ri(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(Mm(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e].splice(t,0,i),this.notifyChange("paths"),this):this}removePath(e){if(!this._validateInputs(e,null))return null;const t=this.paths.splice(e,1)[0],i=this.spatialReference,r=t.map(s=>new ri(s,i));return this.notifyChange("paths"),r}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new ri(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(e,t,i){return this._validateInputs(e,t)?(Mm(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e][t]=i,this.notifyChange("paths"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.paths.length)return!1;if(t!=null){const r=this.paths[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};v([I({readOnly:!0})],Pu.prototype,"cache",null),v([I({readOnly:!0})],Pu.prototype,"extent",null),v([I({type:[[[Number]]],json:{write:{isRequired:!0}}})],Pu.prototype,"paths",void 0),v([ci("paths")],Pu.prototype,"writePaths",null),Pu=bE=v([me("esri.geometry.Polyline")],Pu),Pu.prototype.toJSON.isDefaultToJSON=!0;const Ua=Pu,dK=Fn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Nge=Fn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function x6(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function S6(e){return e.points!==void 0}function T6(e){return e.x!==void 0&&e.y!==void 0}function E6(e){return e.paths!==void 0}function jA(e){return e.rings!==void 0}function Pm(e){return e==null?null:e instanceof Sh?e:T6(e)?ri.fromJSON(e):E6(e)?Ua.fromJSON(e):jA(e)?mh.fromJSON(e):S6(e)?Tx.fromJSON(e):x6(e)?Bi.fromJSON(e):null}function VA(e){return e?T6(e)?"esriGeometryPoint":E6(e)?"esriGeometryPolyline":jA(e)?"esriGeometryPolygon":x6(e)?"esriGeometryEnvelope":S6(e)?"esriGeometryMultipoint":null:null}const pK={esriGeometryPoint:ri,esriGeometryPolyline:Ua,esriGeometryPolygon:mh,esriGeometryEnvelope:Bi,esriGeometryMultipoint:Tx};function fK(e){return e&&pK[e]||null}const Ex={base:Sh,key:"type",typeMap:{extent:Bi,multipoint:Tx,point:ri,polyline:Ua,polygon:mh}};Uc(Ex);let I6=0;const GA=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+I6++})}};return t=v([me("esri.core.Identifiable")],t),t},qA=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:I6++})}};return t=v([me("esri.core.NumericIdentifiable")],t),t};let X$=class extends GA(class{}){};X$=v([me("esri.core.Identifiable")],X$);async function mK(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:i}=await ht(()=>import("./portalLayers-By9oDEHZ.js").then(r=>r.p),__vite__mapDeps([3,4,5]));try{return await i(t)}catch(r){const s=t&&t.portalItem,n=(s==null?void 0:s.id)||"unset",c=s&&s.portal&&s.portal.url||Pi.portalUrl;throw _t.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+c+"', id: '"+n+"')",r),r}}let yK=0,ss=class extends xh.EventedMixin(GA(hh)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Bi(-180,-90,180,90,mi.WGS84),this.id=Date.now().toString(16)+"-layer-"+yK++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=mi.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const i=typeof t=="string"?{url:t}:t;return(await ht(()=>import("./arcgisLayers-DakH7aKX.js"),__vite__mapDeps([7,4,8,5]))).fromUrl(i)}static fromPortalItem(t){return mK(t)}initialize(){this.when().catch(t=>{qs(t)||_t.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})})}destroy(){const t=this.parent;if(t){const i=this;"layers"in t&&t.layers.includes(i)?t.layers.remove(i):"tables"in t&&t.tables.includes(i)?t.tables.remove(i):"baseLayers"in t&&t.baseLayers.includes(i)?t.baseLayers.remove(i):"referenceLayers"in t&&t.referenceLayers.includes(i)&&t.referenceLayers.remove(i),this._set("parent",null)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Mr(this.url)}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await Xi(t,{query:{f:"json"},responseType:"json"})).data;throw new Je("layer:no-attribution-data","Layer does not have attribution data")}};v([I({type:String})],ss.prototype,"attributionDataUrl",void 0),v([I({type:Bi})],ss.prototype,"fullExtent",void 0),v([I({readOnly:!0})],ss.prototype,"hasAttributionData",null),v([I({type:String,clonable:!1})],ss.prototype,"id",void 0),v([I({type:Boolean,nonNullable:!0})],ss.prototype,"legendEnabled",void 0),v([I({type:["show","hide","hide-children"]})],ss.prototype,"listMode",void 0),v([I({type:Number,range:{min:0,max:1},nonNullable:!0})],ss.prototype,"opacity",void 0),v([I({clonable:!1})],ss.prototype,"parent",void 0),v([I({readOnly:!0})],ss.prototype,"parsedUrl",null),v([I({type:Boolean,readOnly:!0})],ss.prototype,"persistenceEnabled",void 0),v([I({type:Boolean})],ss.prototype,"popupEnabled",void 0),v([I({type:Boolean})],ss.prototype,"attributionVisible",void 0),v([I({type:mi})],ss.prototype,"spatialReference",void 0),v([I({type:String})],ss.prototype,"title",void 0),v([I({readOnly:!0,json:{read:!1}})],ss.prototype,"type",void 0),v([I()],ss.prototype,"url",void 0),v([I({type:Boolean,nonNullable:!0})],ss.prototype,"visible",void 0),ss=v([me("esri.layers.Layer")],ss);const M6=ss;function wE(e,t,i){let r,s;if(e)for(let n=0,c=e.length;n<c;n++){if(r=e.at(n),(r==null?void 0:r[t])===i)return r;if((r==null?void 0:r.type)==="group"&&(s=wE(r.layers,t,i),s))return s}}const gK=e=>{let t=class extends e{constructor(...i){super(...i),this.layers=new Ut;const r=c=>{c.parent&&"remove"in c.parent&&c.parent.remove(c)},s=c=>{c.parent=this,this.layerAdded(c),c.type!=="elevation"&&c.type!=="base-elevation"||_t.getLogger(this).error(`Layer 'title:${c.title}, id:${c.id}' of type '${c.type}' is not supported as an operational layer and will therefore be ignored.`)},n=c=>{c.parent=null,this.layerRemoved(c)};this.addHandles([this.layers.on("before-add",c=>r(c.item)),this.layers.on("after-add",c=>s(c.item)),this.layers.on("after-remove",c=>n(c.item))])}destroy(){const i=this.layers.toArray();for(const r of i)r.destroy();this.layers.destroy()}set layers(i){this._set("layers",dp(i,this._get("layers")))}add(i,r){const s=this.layers;if(r=s.getNextIndex(r),i instanceof M6){const n=i;n.parent===this?this.reorder(n,r):s.add(n,r)}else wh(i)?i.then(n=>{this.destroyed||this.add(n,r)}):_t.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const s=this.layers;let n=s.getNextIndex(r);i.slice().forEach(c=>{c.parent!==this?(s.add(c,n),n+=1):this.reorder(c,n)})}findLayerById(i){return wE(this.layers,"id",i)}findLayerByUid(i){return wE(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return v([I()],t.prototype,"layers",null),t=v([me("esri.support.LayersMixin")],t),t};function xE(e,t,i){if(e)for(let r=0,s=e.length;r<s;r++){const n=e.at(r);if(n[t]===i)return n;if((n==null?void 0:n.type)==="group"){const c=xE(n.tables,t,i);if(c)return c}}}const _K=e=>{let t=class extends e{constructor(...i){super(...i),this.tables=new Ut,this.addHandles([this.tables.on("after-add",r=>{const s=r.item;s.parent&&s.parent!==this&&"tables"in s.parent&&s.parent.tables.remove(s),s.parent=this,s.type!=="feature"&&_t.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",dp(i,this._get("tables")))}findTableById(i){return xE(this.tables,"id",i)}findTableByUid(i){return xE(this.tables,"uid",i)}};return v([I()],t.prototype,"tables",null),t=v([me("esri.support.TablesMixin")],t),t};let Ea=class extends _K(gK(xh.EventedMixin(zt))){constructor(t){super(t),this.allLayers=new G0({getCollections:()=>{var i,r,s;return[(i=this.basemap)==null?void 0:i.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(s=this.basemap)==null?void 0:s.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=DJ(this),this.basemap=null,this.editableLayers=new G0({getCollections:()=>[this.allLayers],itemFilterFunction:AY}),this.ground=new gw,this._basemapCache=RJ()}destroy(){OJ(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=nr(this.basemap),nr(this.ground),this._set("ground",null)}castBasemap(t){return LJ(t,this._basemapCache)}castGround(t){return NJ(t)??this._get("ground")}findLayerById(t){return this.allLayers.find(i=>i.id===t)}findTableById(t){return this.allTables.find(i=>i.id===t)}};v([I({readOnly:!0,dependsOn:[]})],Ea.prototype,"allLayers",void 0),v([I({readOnly:!0})],Ea.prototype,"allTables",void 0),v([I({type:y0,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Ea.prototype,"basemap",void 0),v([As("basemap")],Ea.prototype,"castBasemap",null),v([I({readOnly:!0})],Ea.prototype,"editableLayers",void 0),v([I({type:gw,nonNullable:!0})],Ea.prototype,"ground",void 0),v([As("ground")],Ea.prototype,"castGround",null),v([I()],Ea.prototype,"undoRedo",void 0),Ea=v([me("esri.Map")],Ea);const A6=Ea,Ul=e=>{let t=class extends e{clone(){var p;const i=So(this);N5(i,"unable to clone instance of non-accessor class");const r=i.metadata,s=i.store,n={},c=new Map;for(const g in r){const S=r[g],M=s==null?void 0:s.originOf(g),A=S.clonable;if(S.readOnly||A===!1||M!==pi.USER&&M!==pi.DEFAULTS&&M!==pi.WEB_MAP&&M!==pi.WEB_SCENE)continue;const O=this[g];let z=null;z=typeof A=="function"?A(O):A==="reference"?O:AT(O),O!=null&&z==null||(M===pi.DEFAULTS?c.set(g,z):n[g]=z)}const o=new(Object.getPrototypeOf(this)).constructor(n);if(c.size){const g=(p=So(o))==null?void 0:p.store;if(g)for(const[S,M]of c)g.set(S,M,pi.DEFAULTS)}return o}};return t=v([me("esri.core.Clonable")],t),t};let SE=class extends Ul(zt){};SE=v([me("esri.core.Clonable")],SE);let ud=class extends SE{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};v([I({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"row",void 0),v([I({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"column",void 0),v([I({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"rows",void 0),v([I({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"columns",void 0),ud=v([me("esri.CameraLayout")],ud);const P6=ud;let HA=class{constructor(t,i){this.min=t,this.max=i,this.range=i-t}ndiff(t,i=0){return Math.ceil((t-i)/this.range)*this.range+i}_normalize(t,i,r,s=0,n=!1){return(r-=s)<t?r+=this.ndiff(t-r):r>i&&(r-=this.ndiff(r-i)),n&&r===i&&(r=t),r+s}normalize(t,i=0,r=!1){return this._normalize(this.min,this.max,t,i,r)}clamp(t,i=0){return Ol(t-i,this.min,this.max)+i}monotonic(t,i,r){return t<i?i:i+this.ndiff(t-i,r)}minimalMonotonic(t,i,r){return this._normalize(t,t+this.range,i,r)}center(t,i,r){return i=this.monotonic(t,i,r),this.normalize((t+i)/2,r)}diff(t,i,r){return this.monotonic(t,i,r)-t}shortestSignedDiff(t,i){t=this.normalize(t);const r=(i=this.normalize(i))-t,s=i<t?this.minimalMonotonic(t,i)-t:i-this.minimalMonotonic(i,t);return Math.abs(r)<Math.abs(s)?r:s}contains(t,i,r){return i=this.minimalMonotonic(t,i),(r=this.minimalMonotonic(t,r))>t&&r<i}};function WA(e){for(const t in e){const i=e[t];i instanceof Function&&(e[t]=i.bind(e))}return e}WA(new HA(0,2*Math.PI));WA(new HA(-Math.PI,Math.PI));const vK=WA(new HA(0,360));let pl=class extends Ul(At){constructor(...t){super(...t),this.position=new ri([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new P6}normalizeCtorArgs(t,i,r,s){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){const n={position:t};return i!=null&&(n.heading=i),r!=null&&(n.tilt=r),s!=null&&(n.fov=s),n}return t}writePosition(t,i,r,s){const n=t.clone();n.x=za(t.x||0),n.y=za(t.y||0),n.z=t.hasZ?za(t.z||0):t.z,i[r]=n.write({},s)}readPosition(t,i){const r=new ri;return r.read(t,i),r.x=za(r.x||0),r.y=za(r.y||0),r.z=r.hasZ?za(r.z||0):r.z,r}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};v([I({type:ri,json:{write:{isRequired:!0}}})],pl.prototype,"position",void 0),v([ci("position")],pl.prototype,"writePosition",null),v([fi("position")],pl.prototype,"readPosition",null),v([I({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),As(e=>vK.normalize(za(e)))],pl.prototype,"heading",void 0),v([I({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),As(e=>Ol(za(e),-180,180))],pl.prototype,"tilt",void 0),v([I({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],pl.prototype,"fov",void 0),v([I({type:P6,nonNullable:!0,json:{read:!1,write:!1}})],pl.prototype,"layout",void 0),pl=v([me("esri.Camera")],pl);const bK=pl;var TE;let Cu=TE=class extends At{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new TE({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};function MS(){return{enabled:!this.camera}}v([I({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:MS}}}}})],Cu.prototype,"rotation",void 0),v([As("rotation")],Cu.prototype,"castRotation",null),v([I({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:MS}}}}})],Cu.prototype,"scale",void 0),v([I({types:Ex,json:{read:Pm,write:!0,origins:{"web-scene":{read:Pm,write:{overridePolicy:MS}}}}})],Cu.prototype,"targetGeometry",void 0),v([I({type:bK,json:{write:!0}})],Cu.prototype,"camera",void 0),Cu=TE=v([me("esri.Viewpoint")],Cu);const $l=Cu;function ti(e,t,i={}){return ZA(e,t,i,C6)}function yh(e,t,i={}){return ZA(e,t,i,$6)}function ZA(e,t,i={},r){let s=null;const n=i.once?(c,o)=>{r(c)&&(gr(s),t(c,o))}:(c,o)=>{r(c)&&t(c,o)};if(s=qG(e,n,i.sync,i.equals),i.initial){const c=e();n(c,c)}return s}function bp(e,t,i,r={}){let s=null,n=null,c=null;function o(){var S;s&&n&&(n.remove(),(S=r.onListenerRemove)==null||S.call(r,s),s=null,n=null)}function p(S){r.once&&r.once&&gr(c),i(S)}const g=ti(e,(S,M)=>{var A;o(),sx(S)&&(s=S,n=h_(S,t,p),(A=r.onListenerAdd)==null||A.call(r,S))},{sync:r.sync,initial:!0});return c=Qi(()=>{g.remove(),o()}),c}function Ix(e,t){return wK(e,$6,t)}function wK(e,t,i){if(ra(i))return Promise.reject(Nr());const r=e();if(t!=null&&t(r))return Promise.resolve(r);let s=null;function n(){s=gr(s)}return new Promise((c,o)=>{s=l_([eo(i,()=>{n(),o(Nr())}),ZA(e,p=>{n(),c(p)},{sync:!1,once:!0},t??C6)])})}function C6(e){return!0}function $6(e){return!!e}const wp={sync:!0},mn={initial:!0},Fa={sync:!0,initial:!0};let vw=class{constructor(t=i=>i.values().next().value){this._peeker=t,this._observable=new f_,this._items=new Set}get length(){return Ot(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let t;for(t of this._items);return t}peek(){if(this.length!==0)return this._peeker(this._items)}push(t){this.contains(t)||(this._items.add(t),this._observable.notify())}contains(t){return Ot(this._observable),this._items.has(t)}pop(){if(this.length===0)return;const t=this.peek();return this._items.delete(t),this._observable.notify(),t}popLast(){if(this.length===0)return;const t=this.last();return this._items.delete(t),this._observable.notify(),t}remove(t){this.contains(t)&&(this._items.delete(t),this._observable.notify())}filter(t){const i=this.length;return this._items.forEach(r=>{t(r)||this._items.delete(r)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){Ot(this._observable),yield*this._items}};const k6=new FinalizationRegistry(e=>{e.close()});function xK(e,t){k6.register(e,t,t)}function SK(e){k6.unregister(e)}const R6="worker:port-closed";var Is;(function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.OPEN=1]="OPEN",e[e.OPENED=2]="OPENED",e[e.RESPONSE=3]="RESPONSE",e[e.INVOKE=4]="INVOKE",e[e.ABORT=5]="ABORT",e[e.CLOSE=6]="CLOSE",e[e.OPEN_PORT=7]="OPEN_PORT",e[e.ON=8]="ON"})(Is||(Is={}));let TK=0;function O6(){return TK++}function EK(e){return e&&typeof e=="object"&&("result"in e||"transferList"in e)}function q0(e){return e?typeof e=="string"?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function YA(e,t,i,r){if(t.type===Is.OPEN_PORT)return void e.postMessage(t,[t.port]);if(t.type!==Is.INVOKE&&t.type!==Is.RESPONSE)return void e.postMessage(t);let s;if(EK(i)?(s=Q$(i.transferList),t.data=i.result):(s=Q$(r),t.data=i),s){if(Le("ff")){for(const n of s)if("byteLength"in n&&n.byteLength>267386880){const c="Worker call with large ArrayBuffer would crash Firefox";switch(t.type){case Is.INVOKE:throw c;case Is.RESPONSE:return void YA(e,{type:Is.RESPONSE,jobId:t.jobId,error:q0(c)})}}}e.postMessage(t,s)}else e.postMessage(t)}function H0(e){if(!e)return null;const t=e.data;return t?typeof t=="string"?JSON.parse(t):t:null}function Q$(e){if(!(e!=null&&e.length))return null;if(Le("esri-workers-arraybuffer-transfer"))return e;const t=e.filter(i=>!IK(i));return t.length?t:null}function IK(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="ArrayBuffer"}async function MK(e){try{return await e}catch(t){const i=(t==null?void 0:t.name)===R6;if(!(qs(t)||i))throw t;return}}function L6(e,t,i){return new Proxy({},{get:(r,s,n)=>(...c)=>{let o,p;const g=c[c.length-1];AK(g)&&(o=g.signal,p=g.transferList,c.pop());const S=e.apply(t?`${t}.${s.toString()}`:s.toString(),c,{transferList:p,signal:o});return i!=null&&i.ignoreConnectionErrors?MK(S):S}})}function AK(e){return typeof e=="object"&&!Array.isArray(e)&&e!=null&&("signal"in e||"transferList"in e||Object.keys(e).length===0)}const PK={statsWorker:()=>ht(()=>import("./statsWorker-Cpf17qXQ.js"),__vite__mapDeps([9,10,11,12,13,14,15])),geometryEngineWorker:()=>ht(()=>import("./geometryEngineWorker-BhdkastR.js"),__vite__mapDeps([16,17,18,19])),CSVSourceWorker:()=>ht(()=>import("./CSVSourceWorker-CUcWqyCB.js"),__vite__mapDeps([20,21,19,22,23,24,25,26,27,28,29,30,31,32,33,11,10,12,13,14,15,34,35,36,37,38])),EdgeProcessingWorker:()=>ht(()=>import("./EdgeProcessingWorker-B8Wgb69R.js"),__vite__mapDeps([39,40,41,42,43,44,45,46,47])),ElevationSamplerWorker:()=>ht(()=>import("./ElevationSamplerWorker-BiqPnVWi.js"),__vite__mapDeps([48,27,49,50,51,52,53,54,55,56,57,58,41])),FeatureServiceSnappingSourceWorker:()=>ht(()=>import("./FeatureServiceSnappingSourceWorker-yGYoVuCA.js"),__vite__mapDeps([59,23,24,22,25,26,27,28,19,29,30,31,32,33,11,10,12,13,14,15,34,35,60,61,62,63])),GeoJSONSourceWorker:()=>ht(()=>import("./GeoJSONSourceWorker-BH0rDQiP.js"),__vite__mapDeps([64,24,22,25,23,26,27,28,19,29,30,31,32,33,11,10,12,13,14,15,34,35,65,21,37,38,66])),LercWorker:()=>ht(()=>import("./LercWorker-D4c-rTQx.js"),[]),MemorySourceWorker:()=>ht(()=>import("./MemorySourceWorker-KgEBDOWH.js"),__vite__mapDeps([67,24,22,25,68,23,26,27,28,19,29,30,31,32,33,11,10,12,13,14,15,34,35,37,38,66,21])),PBFDecoderWorker:()=>ht(()=>import("./PBFDecoderWorker-xPqhWuo5.js"),__vite__mapDeps([69,24,22,25,60,61])),FeaturePipelineWorker:()=>ht(()=>import("./FeaturePipelineWorker-BvhW_xfa.js"),__vite__mapDeps([70,71,72,73,74,75,76,77,78,22,79,80,81,38,82,43,83,84,34,32,31,28,24,25,19,85,86,29,30,33,11,10,12,13,14,15,35,62,60,61,63,87,65,21,37,66,88,89])),PointCloudWorker:()=>ht(()=>import("./PointCloudWorker-fvUFFPrU.js"),__vite__mapDeps([90,57,53,58,91,92,93,94,47,95,54,55,96])),RasterWorker:()=>ht(()=>import("./RasterWorker-BpLUQKL7.js"),__vite__mapDeps([97,98,99,100,101,102])),SceneLayerSnappingSourceWorker:()=>ht(()=>import("./SceneLayerSnappingSourceWorker-BZ5COJN8.js"),__vite__mapDeps([103,104,105,96,53,54,58,106,43,44,45,46,40,41,42,47])),SceneLayerWorker:()=>ht(()=>import("./SceneLayerWorker-DUoc0SDc.js"),__vite__mapDeps([107,56,50,51,106,105,96,53,54,58,108,55,94,47,109,95,57])),WFSSourceWorker:()=>ht(()=>import("./WFSSourceWorker-CYWkEHWV.js"),__vite__mapDeps([110,24,22,25,23,26,27,28,19,29,30,31,32,33,11,10,12,13,14,15,34,35,65,21,66,111,112])),WorkerTileHandler:()=>ht(()=>import("./WorkerTileHandler-yI6tWdvc.js"),__vite__mapDeps([113,80,114,61,77,115,78])),Lyr3DWorker:()=>ht(()=>import("./Lyr3DWorker-DMTZDxJL.js"),[])},{CLOSE:ek,ABORT:tk,INVOKE:ik,RESPONSE:ag,OPEN_PORT:rk,ON:CK}=Is,$K=2;let kK=class{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===Is.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},gh=class $f{static connect(t){const i=new MessageChannel;let r;r=typeof t=="function"?new t:"default"in t&&typeof t.default=="function"?new t.default:t;const s=new $f(i.port1,{channel:i,client:r});return typeof r=="object"&&"remoteClient"in r&&(r.remoteClient=s),$f.clients.set(s,r),i.port2}static loadWorker(t){const i=PK[t];return i?i():Promise.resolve(null)}constructor(t,i,r){this._port=t,this._jobQueue=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new kK(s=>this._onInvokeMessage(s)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:ek}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,i,r){return this.apply(t,[i],r)}apply(t,i,r){const s=r==null?void 0:r.signal,n=r==null?void 0:r.transferList;if(!this._port)return Promise.reject(new Je(R6,`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:i}));const c=O6();return new Promise((o,p)=>{if(ra(s))return this._processWork(),void p(Nr());const g=eo(s,()=>{const M=this._outJobs.get(c);M&&(this._outJobs.delete(c),this._processWork(),gr(M.abortHandle),this._post({type:tk,jobId:c}),p(Nr()))}),S={resolve:o,reject:p,abortHandle:g,debugInfo:t};this._outJobs.set(c,S),this._post({type:ik,jobId:c,methodName:t,abortable:s!=null},i,n)})}createInvokeProxy(t,i){return L6(this,t,i)}on(t,i){const r=new MessageChannel;function s(n){i(n.data)}return this._port.postMessage({type:Is.ON,eventType:t,port:r.port2},[r.port2]),r.port1.addEventListener("message",s),r.port1.start(),Qi(()=>{r.port1.postMessage({type:Is.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",s)})}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:rk,port:t.port2}),t.port1}_processWork(){var c;if(this._outJobs.size>=$K)return;const t=(c=this._jobQueue)==null?void 0:c.pop();if(!t)return;const{methodName:i,data:r,invokeOptions:s,resolver:n}=t;this.apply(i,r,s).then(o=>n.resolve(o)).catch(o=>n.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(t=>{gr(t.abortHandle),t.reject(Nr(`Worker closing, aborting job calling '${t.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(t){this._schedule!=null?this._schedule(()=>this._processMessage(t)):this._processMessage(t)}_processMessage(t){const i=H0(t);if(i)switch(i.type){case ag:this._onResponseMessage(i);break;case ik:this._invokeQueue.push(i);break;case tk:this._onAbortMessage(i);break;case ek:this._onCloseMessage();break;case rk:this._onOpenPortMessage(i);break;case CK:this._onOnMessage(i)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,s=i.get(r);this._invokeQueue.push(t),s&&(s.controller&&s.controller.abort(),i.delete(r))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&$f.clients.get(this)===t&&t.destroy(),$f.clients.delete(this),t!=null&&t.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:i,jobId:r,data:s=[],abortable:n}=t,c=n?new AbortController:null,o=this._inJobs;let p,g=this._client,S=g[i];try{if(!S&&i&&i.includes(".")){const M=i.split(".");for(let A=0;A<M.length-1;A++)g=g[M[A]],S=g[M[A+1]]}if(typeof S!="function")throw new TypeError(`${i} is not a function`);s.push({client:this,signal:c?c.signal:null}),p=S.apply(g,s)}catch(M){return void this._post({type:ag,jobId:r,error:q0(M)})}wh(p)?(o.set(r,{controller:c,promise:p}),p.then(M=>{o.has(r)&&(o.delete(r),this._post({type:ag,jobId:r},M))},M=>{o.has(r)&&(o.delete(r),qs(M)||this._post({type:ag,jobId:r,error:q0(M||{message:`Error encountered at method ${i}`})}))})):this._post({type:ag,jobId:r},p)}_onOpenPortMessage(t){new $f(t.port,{client:this._client})}_onOnMessage(t){const{port:i}=t,r=this._client.on(t.eventType,n=>{i.postMessage(n)}),s=h_(t.port,"message",n=>{const c=H0(n);(c==null?void 0:c.type)===Is.CLOSE&&(s.remove(),r.remove(),i.close())})}_onResponseMessage(t){const{jobId:i,error:r,data:s}=t,n=this._outJobs;if(!n.has(i))return;const c=n.get(i);n.delete(i),this._processWork(),gr(c.abortHandle),r?c.reject(Je.fromJSON(JSON.parse(r))):c.resolve(s)}_post(t,i,r){return YA(this._port,t,i,r)}};gh.kernelInfo={buildDate:F4,fullVersion:gA,revision:B4},gh.clients=new Map;let RK=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new vw}destroy(){this.close()}get closed(){var t;return!((t=this._clients)!=null&&t.length)}open(t,i){return new Promise((r,s)=>{let n=!0;const c=o=>{dr(i.signal),n&&(n=!1,o())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let o=0;o<t.length;++o){const p=t[o];wh(p)?this._clientPromises[o]=p.then(g=>(this._clients[o]=new gh(g,i,this._ongoingJobsQueue),c(r),this._clients[o]),()=>(c(s),null)):(this._clients[o]=new gh(p,i,this._ongoingJobsQueue),this._clientPromises[o]=Promise.resolve(this._clients[o]),c(r))}})}broadcast(t,i,r){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const c=this._clientPromises[n];s[n]=c.then(o=>o==null?void 0:o.invoke(t,i,r))}return s}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.resolver.reject(Nr(`Worker closing, aborting job calling '${t.methodName}'`));for(const i of this._clientPromises)i.then(r=>r==null?void 0:r.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,SK(this)}invoke(t,i,r){return this.apply(t,[i],r)}apply(t,i,r){const s=sa();this._ongoingJobsQueue.push({methodName:t,data:i,invokeOptions:r,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const c=this._clients[n];c?c.jobAdded():this._clientPromises[n].then(o=>o==null?void 0:o.jobAdded())}return s.promise}createInvokeProxy(t){return L6(this,t)}on(t,i){return Promise.all(this._clientPromises).then(()=>l_(this._clients.map(r=>r.on(t,i))))}openPorts(){return new Promise(t=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then(n=>{n&&(i[s]=n.openPort()),--r==0&&t(i)})})}get test(){return{numClients:this._clients.length}}};const OK={async request(e,t){var c,o;const i=e.options,r=i.responseType;i.signal=t==null?void 0:t.signal,i.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&((c=L4(e.url))!=null&&c.after)?r:"array-buffer";const s=await Xi(e.url,i),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch((o=s.requestOptions)==null?void 0:o.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},sk=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class Pp extends Error{}class LK extends Pp{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class DK extends Pp{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class NK extends Pp{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class em extends Pp{}class D6 extends Pp{constructor(t){super(`Invalid unit ${t}`)}}class Jn extends Pp{}class wu extends Pp{constructor(){super("Zone is an abstract class")}}const yt="numeric",Za="short",wo="long",bw={year:yt,month:yt,day:yt},N6={year:yt,month:Za,day:yt},zK={year:yt,month:Za,day:yt,weekday:Za},z6={year:yt,month:wo,day:yt},F6={year:yt,month:wo,day:yt,weekday:wo},B6={hour:yt,minute:yt},U6={hour:yt,minute:yt,second:yt},j6={hour:yt,minute:yt,second:yt,timeZoneName:Za},V6={hour:yt,minute:yt,second:yt,timeZoneName:wo},G6={hour:yt,minute:yt,hourCycle:"h23"},q6={hour:yt,minute:yt,second:yt,hourCycle:"h23"},H6={hour:yt,minute:yt,second:yt,hourCycle:"h23",timeZoneName:Za},W6={hour:yt,minute:yt,second:yt,hourCycle:"h23",timeZoneName:wo},Z6={year:yt,month:yt,day:yt,hour:yt,minute:yt},Y6={year:yt,month:yt,day:yt,hour:yt,minute:yt,second:yt},J6={year:yt,month:Za,day:yt,hour:yt,minute:yt},K6={year:yt,month:Za,day:yt,hour:yt,minute:yt,second:yt},FK={year:yt,month:Za,day:yt,weekday:Za,hour:yt,minute:yt},X6={year:yt,month:wo,day:yt,hour:yt,minute:yt,timeZoneName:Za},Q6={year:yt,month:wo,day:yt,hour:yt,minute:yt,second:yt,timeZoneName:Za},ez={year:yt,month:wo,day:yt,weekday:wo,hour:yt,minute:yt,timeZoneName:wo},tz={year:yt,month:wo,day:yt,weekday:wo,hour:yt,minute:yt,second:yt,timeZoneName:wo};class g_{get type(){throw new wu}get name(){throw new wu}get ianaName(){return this.name}get isUniversal(){throw new wu}offsetName(t,i){throw new wu}formatOffset(t,i){throw new wu}offset(t){throw new wu}equals(t){throw new wu}get isValid(){throw new wu}}let AS=null;class Mx extends g_{static get instance(){return AS===null&&(AS=new Mx),AS}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return uz(t,i,r)}formatOffset(t,i){return _0(this.offset(t),i)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}}let Wv={};function BK(e){return Wv[e]||(Wv[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Wv[e]}const UK={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function jK(e,t){const i=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,s,n,c,o,p,g,S]=r;return[c,s,n,o,p,g,S]}function VK(e,t){const i=e.formatToParts(t),r=[];for(let s=0;s<i.length;s++){const{type:n,value:c}=i[s],o=UK[n];n==="era"?r[o]=c:ni(o)||(r[o]=parseInt(c,10))}return r}let ev={};class Ya extends g_{static create(t){return ev[t]||(ev[t]=new Ya(t)),ev[t]}static resetCache(){ev={},Wv={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch{return!1}}constructor(t){super(),this.zoneName=t,this.valid=Ya.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return uz(t,i,r,this.name)}formatOffset(t,i){return _0(this.offset(t),i)}offset(t){const i=new Date(t);if(isNaN(i))return NaN;const r=BK(this.name);let[s,n,c,o,p,g,S]=r.formatToParts?VK(r,i):jK(r,i);o==="BC"&&(s=-Math.abs(s)+1);const A=Px({year:s,month:n,day:c,hour:p===24?0:p,minute:g,second:S,millisecond:0});let O=+i;const z=O%1e3;return O-=z>=0?z:1e3+z,(A-O)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}}let nk={};function GK(e,t={}){const i=JSON.stringify([e,t]);let r=nk[i];return r||(r=new Intl.ListFormat(e,t),nk[i]=r),r}let EE={};function IE(e,t={}){const i=JSON.stringify([e,t]);let r=EE[i];return r||(r=new Intl.DateTimeFormat(e,t),EE[i]=r),r}let ME={};function qK(e,t={}){const i=JSON.stringify([e,t]);let r=ME[i];return r||(r=new Intl.NumberFormat(e,t),ME[i]=r),r}let AE={};function HK(e,t={}){const{base:i,...r}=t,s=JSON.stringify([e,r]);let n=AE[s];return n||(n=new Intl.RelativeTimeFormat(e,t),AE[s]=n),n}let Mg=null;function WK(){return Mg||(Mg=new Intl.DateTimeFormat().resolvedOptions().locale,Mg)}let ok={};function ZK(e){let t=ok[e];if(!t){const i=new Intl.Locale(e);t="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,ok[e]=t}return t}function YK(e){const t=e.indexOf("-x-");t!==-1&&(e=e.substring(0,t));const i=e.indexOf("-u-");if(i===-1)return[e];{let r,s;try{r=IE(e).resolvedOptions(),s=e}catch{const p=e.substring(0,i);r=IE(p).resolvedOptions(),s=p}const{numberingSystem:n,calendar:c}=r;return[s,n,c]}}function JK(e,t,i){return(i||t)&&(e.includes("-u-")||(e+="-u"),i&&(e+=`-ca-${i}`),t&&(e+=`-nu-${t}`)),e}function KK(e){const t=[];for(let i=1;i<=12;i++){const r=Kt.utc(2009,i,1);t.push(e(r))}return t}function XK(e){const t=[];for(let i=1;i<=7;i++){const r=Kt.utc(2016,11,13+i);t.push(e(r))}return t}function tv(e,t,i,r){const s=e.listingMode();return s==="error"?null:s==="en"?i(t):r(t)}function QK(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem==="latn"}class eX{constructor(t,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:s,floor:n,...c}=r;if(!i||Object.keys(c).length>0){const o={useGrouping:!1,...r};r.padTo>0&&(o.minimumIntegerDigits=r.padTo),this.inf=qK(t,o)}}format(t){if(this.inf){const i=this.floor?Math.floor(t):t;return this.inf.format(i)}else{const i=this.floor?Math.floor(t):QA(t,3);return as(i,this.padTo)}}}class tX{constructor(t,i,r){this.opts=r,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=t;else if(t.zone.type==="fixed"){const c=-1*(t.offset/60),o=c>=0?`Etc/GMT+${c}`:`Etc/GMT${c}`;t.offset!==0&&Ya.create(o).valid?(s=o,this.dt=t):(s="UTC",this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone)}else t.zone.type==="system"?this.dt=t:t.zone.type==="iana"?(this.dt=t,s=t.zone.name):(s="UTC",this.dt=t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=IE(i,n)}format(){return this.originalZone?this.formatToParts().map(({value:t})=>t).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const t=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?t.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):t}resolvedOptions(){return this.dtf.resolvedOptions()}}class iX{constructor(t,i,r){this.opts={style:"long",...r},!i&&lz()&&(this.rtf=HK(t,r))}format(t,i){return this.rtf?this.rtf.format(t,i):xX(i,t,this.opts.numeric,this.opts.style!=="long")}formatToParts(t,i){return this.rtf?this.rtf.formatToParts(t,i):[]}}const rX={firstDay:1,minimalDays:4,weekend:[6,7]};class Ki{static fromOpts(t){return Ki.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,i,r,s,n=!1){const c=t||Jr.defaultLocale,o=c||(n?"en-US":WK()),p=i||Jr.defaultNumberingSystem,g=r||Jr.defaultOutputCalendar,S=PE(s)||Jr.defaultWeekSettings;return new Ki(o,p,g,S,c)}static resetCache(){Mg=null,EE={},ME={},AE={}}static fromObject({locale:t,numberingSystem:i,outputCalendar:r,weekSettings:s}={}){return Ki.create(t,i,r,s)}constructor(t,i,r,s,n){const[c,o,p]=YK(t);this.locale=c,this.numberingSystem=i||o||null,this.outputCalendar=r||p||null,this.weekSettings=s,this.intl=JK(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=QK(this)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&i?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:Ki.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,PE(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,i=!1){return tv(this,t,pz,()=>{const r=i?{month:t,day:"numeric"}:{month:t},s=i?"format":"standalone";return this.monthsCache[s][t]||(this.monthsCache[s][t]=KK(n=>this.extract(n,r,"month"))),this.monthsCache[s][t]})}weekdays(t,i=!1){return tv(this,t,yz,()=>{const r=i?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},s=i?"format":"standalone";return this.weekdaysCache[s][t]||(this.weekdaysCache[s][t]=XK(n=>this.extract(n,r,"weekday"))),this.weekdaysCache[s][t]})}meridiems(){return tv(this,void 0,()=>gz,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Kt.utc(2016,11,13,9),Kt.utc(2016,11,13,19)].map(i=>this.extract(i,t,"dayperiod"))}return this.meridiemCache})}eras(t){return tv(this,t,_z,()=>{const i={era:t};return this.eraCache[t]||(this.eraCache[t]=[Kt.utc(-40,1,1),Kt.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[t]})}extract(t,i,r){const s=this.dtFormatter(t,i),n=s.formatToParts(),c=n.find(o=>o.type.toLowerCase()===r);return c?c.value:null}numberFormatter(t={}){return new eX(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,i={}){return new tX(t,this.intl,i)}relFormatter(t={}){return new iX(this.intl,this.isEnglish(),t)}listFormatter(t={}){return GK(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:cz()?ZK(this.locale):rX}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}let PS=null;class fn extends g_{static get utcInstance(){return PS===null&&(PS=new fn(0)),PS}static instance(t){return t===0?fn.utcInstance:new fn(t)}static parseSpecifier(t){if(t){const i=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new fn(Cx(i[1],i[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${_0(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${_0(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,i){return _0(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}}class sX extends g_{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function th(e,t){if(ni(e)||e===null)return t;if(e instanceof g_)return e;if(aX(e)){const i=e.toLowerCase();return i==="default"?t:i==="local"||i==="system"?Mx.instance:i==="utc"||i==="gmt"?fn.utcInstance:fn.parseSpecifier(i)||Ya.create(e)}else return sp(e)?fn.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new sX(e)}let ak=()=>Date.now(),lk="system",ck=null,uk=null,hk=null,dk=60,pk,fk=null;class Jr{static get now(){return ak}static set now(t){ak=t}static set defaultZone(t){lk=t}static get defaultZone(){return th(lk,Mx.instance)}static get defaultLocale(){return ck}static set defaultLocale(t){ck=t}static get defaultNumberingSystem(){return uk}static set defaultNumberingSystem(t){uk=t}static get defaultOutputCalendar(){return hk}static set defaultOutputCalendar(t){hk=t}static get defaultWeekSettings(){return fk}static set defaultWeekSettings(t){fk=PE(t)}static get twoDigitCutoffYear(){return dk}static set twoDigitCutoffYear(t){dk=t%100}static get throwOnInvalid(){return pk}static set throwOnInvalid(t){pk=t}static resetCaches(){Ki.resetCache(),Ya.resetCache()}}class ja{constructor(t,i){this.reason=t,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const iz=[0,31,59,90,120,151,181,212,243,273,304,334],rz=[0,31,60,91,121,152,182,213,244,274,305,335];function Qo(e,t){return new ja("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function JA(e,t,i){const r=new Date(Date.UTC(e,t-1,i));e<100&&e>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const s=r.getUTCDay();return s===0?7:s}function sz(e,t,i){return i+(__(e)?rz:iz)[t-1]}function nz(e,t){const i=__(e)?rz:iz,r=i.findIndex(n=>n<t),s=t-i[r];return{month:r+1,day:s}}function KA(e,t){return(e-t+7)%7+1}function ww(e,t=4,i=1){const{year:r,month:s,day:n}=e,c=sz(r,s,n),o=KA(JA(r,s,n),i);let p=Math.floor((c-o+14-t)/7),g;return p<1?(g=r-1,p=W0(g,t,i)):p>W0(r,t,i)?(g=r+1,p=1):g=r,{weekYear:g,weekNumber:p,weekday:o,...$x(e)}}function mk(e,t=4,i=1){const{weekYear:r,weekNumber:s,weekday:n}=e,c=KA(JA(r,1,t),i),o=pm(r);let p=s*7+n-c-7+t,g;p<1?(g=r-1,p+=pm(g)):p>o?(g=r+1,p-=pm(r)):g=r;const{month:S,day:M}=nz(g,p);return{year:g,month:S,day:M,...$x(e)}}function CS(e){const{year:t,month:i,day:r}=e,s=sz(t,i,r);return{year:t,ordinal:s,...$x(e)}}function yk(e){const{year:t,ordinal:i}=e,{month:r,day:s}=nz(t,i);return{year:t,month:r,day:s,...$x(e)}}function gk(e,t){if(!ni(e.localWeekday)||!ni(e.localWeekNumber)||!ni(e.localWeekYear)){if(!ni(e.weekday)||!ni(e.weekNumber)||!ni(e.weekYear))throw new em("Cannot mix locale-based week fields with ISO-based week fields");return ni(e.localWeekday)||(e.weekday=e.localWeekday),ni(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),ni(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function nX(e,t=4,i=1){const r=Ax(e.weekYear),s=ea(e.weekNumber,1,W0(e.weekYear,t,i)),n=ea(e.weekday,1,7);return r?s?n?!1:Qo("weekday",e.weekday):Qo("week",e.weekNumber):Qo("weekYear",e.weekYear)}function oX(e){const t=Ax(e.year),i=ea(e.ordinal,1,pm(e.year));return t?i?!1:Qo("ordinal",e.ordinal):Qo("year",e.year)}function oz(e){const t=Ax(e.year),i=ea(e.month,1,12),r=ea(e.day,1,xw(e.year,e.month));return t?i?r?!1:Qo("day",e.day):Qo("month",e.month):Qo("year",e.year)}function az(e){const{hour:t,minute:i,second:r,millisecond:s}=e,n=ea(t,0,23)||t===24&&i===0&&r===0&&s===0,c=ea(i,0,59),o=ea(r,0,59),p=ea(s,0,999);return n?c?o?p?!1:Qo("millisecond",s):Qo("second",r):Qo("minute",i):Qo("hour",t)}function ni(e){return typeof e>"u"}function sp(e){return typeof e=="number"}function Ax(e){return typeof e=="number"&&e%1===0}function aX(e){return typeof e=="string"}function lX(e){return Object.prototype.toString.call(e)==="[object Date]"}function lz(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function cz(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function cX(e){return Array.isArray(e)?e:[e]}function _k(e,t,i){if(e.length!==0)return e.reduce((r,s)=>{const n=[t(s),s];return r&&i(r[0],n[0])===r[0]?r:n},null)[1]}function uX(e,t){return t.reduce((i,r)=>(i[r]=e[r],i),{})}function Cm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function PE(e){if(e==null)return null;if(typeof e!="object")throw new Jn("Week settings must be an object");if(!ea(e.firstDay,1,7)||!ea(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(t=>!ea(t,1,7)))throw new Jn("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function ea(e,t,i){return Ax(e)&&e>=t&&e<=i}function hX(e,t){return e-t*Math.floor(e/t)}function as(e,t=2){const i=e<0;let r;return i?r="-"+(""+-e).padStart(t,"0"):r=(""+e).padStart(t,"0"),r}function Ju(e){if(!(ni(e)||e===null||e===""))return parseInt(e,10)}function ed(e){if(!(ni(e)||e===null||e===""))return parseFloat(e)}function XA(e){if(!(ni(e)||e===null||e==="")){const t=parseFloat("0."+e)*1e3;return Math.floor(t)}}function QA(e,t,i=!1){const r=10**t;return(i?Math.trunc:Math.round)(e*r)/r}function __(e){return e%4===0&&(e%100!==0||e%400===0)}function pm(e){return __(e)?366:365}function xw(e,t){const i=hX(t-1,12)+1,r=e+(t-i)/12;return i===2?__(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function Px(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function vk(e,t,i){return-KA(JA(e,1,t),i)+t-1}function W0(e,t=4,i=1){const r=vk(e,t,i),s=vk(e+1,t,i);return(pm(e)-r+s)/7}function CE(e){return e>99?e:e>Jr.twoDigitCutoffYear?1900+e:2e3+e}function uz(e,t,i,r=null){const s=new Date(e),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(n.timeZone=r);const c={timeZoneName:t,...n},o=new Intl.DateTimeFormat(i,c).formatToParts(s).find(p=>p.type.toLowerCase()==="timezonename");return o?o.value:null}function Cx(e,t){let i=parseInt(e,10);Number.isNaN(i)&&(i=0);const r=parseInt(t,10)||0,s=i<0||Object.is(i,-0)?-r:r;return i*60+s}function hz(e){const t=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(t))throw new Jn(`Invalid unit value ${e}`);return t}function Sw(e,t){const i={};for(const r in e)if(Cm(e,r)){const s=e[r];if(s==null)continue;i[t(r)]=hz(s)}return i}function _0(e,t){const i=Math.trunc(Math.abs(e/60)),r=Math.trunc(Math.abs(e%60)),s=e>=0?"+":"-";switch(t){case"short":return`${s}${as(i,2)}:${as(r,2)}`;case"narrow":return`${s}${i}${r>0?`:${r}`:""}`;case"techie":return`${s}${as(i,2)}${as(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function $x(e){return uX(e,["hour","minute","second","millisecond"])}const dX=["January","February","March","April","May","June","July","August","September","October","November","December"],dz=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pX=["J","F","M","A","M","J","J","A","S","O","N","D"];function pz(e){switch(e){case"narrow":return[...pX];case"short":return[...dz];case"long":return[...dX];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const fz=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],mz=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],fX=["M","T","W","T","F","S","S"];function yz(e){switch(e){case"narrow":return[...fX];case"short":return[...mz];case"long":return[...fz];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const gz=["AM","PM"],mX=["Before Christ","Anno Domini"],yX=["BC","AD"],gX=["B","A"];function _z(e){switch(e){case"narrow":return[...gX];case"short":return[...yX];case"long":return[...mX];default:return null}}function _X(e){return gz[e.hour<12?0:1]}function vX(e,t){return yz(t)[e.weekday-1]}function bX(e,t){return pz(t)[e.month-1]}function wX(e,t){return _z(t)[e.year<0?0:1]}function xX(e,t,i="always",r=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(e)===-1;if(i==="auto"&&n){const M=e==="days";switch(t){case 1:return M?"tomorrow":`next ${s[e][0]}`;case-1:return M?"yesterday":`last ${s[e][0]}`;case 0:return M?"today":`this ${s[e][0]}`}}const c=Object.is(t,-0)||t<0,o=Math.abs(t),p=o===1,g=s[e],S=r?p?g[1]:g[2]||g[1]:p?s[e][0]:e;return c?`${o} ${S} ago`:`in ${o} ${S}`}function bk(e,t){let i="";for(const r of e)r.literal?i+=r.val:i+=t(r.val);return i}const SX={D:bw,DD:N6,DDD:z6,DDDD:F6,t:B6,tt:U6,ttt:j6,tttt:V6,T:G6,TT:q6,TTT:H6,TTTT:W6,f:Z6,ff:J6,fff:X6,ffff:ez,F:Y6,FF:K6,FFF:Q6,FFFF:tz};class pn{static create(t,i={}){return new pn(t,i)}static parseFormat(t){let i=null,r="",s=!1;const n=[];for(let c=0;c<t.length;c++){const o=t.charAt(c);o==="'"?(r.length>0&&n.push({literal:s||/^\s+$/.test(r),val:r}),i=null,r="",s=!s):s||o===i?r+=o:(r.length>0&&n.push({literal:/^\s+$/.test(r),val:r}),r=o,i=o)}return r.length>0&&n.push({literal:s||/^\s+$/.test(r),val:r}),n}static macroTokenToFormatOpts(t){return SX[t]}constructor(t,i){this.opts=i,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...i}).format()}dtFormatter(t,i={}){return this.loc.dtFormatter(t,{...this.opts,...i})}formatDateTime(t,i){return this.dtFormatter(t,i).format()}formatDateTimeParts(t,i){return this.dtFormatter(t,i).formatToParts()}formatInterval(t,i){return this.dtFormatter(t.start,i).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,i){return this.dtFormatter(t,i).resolvedOptions()}num(t,i=0){if(this.opts.forceSimple)return as(t,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(t)}formatDateTimeFromString(t,i){const r=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(O,z)=>this.loc.extract(t,O,z),c=O=>t.isOffsetFixed&&t.offset===0&&O.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,O.format):"",o=()=>r?_X(t):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),p=(O,z)=>r?bX(t,O):n(z?{month:O}:{month:O,day:"numeric"},"month"),g=(O,z)=>r?vX(t,O):n(z?{weekday:O}:{weekday:O,month:"long",day:"numeric"},"weekday"),S=O=>{const z=pn.macroTokenToFormatOpts(O);return z?this.formatWithSystemDefault(t,z):O},M=O=>r?wX(t,O):n({era:O},"era"),A=O=>{switch(O){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return c({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return c({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return c({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return o();case"d":return s?n({day:"numeric"},"day"):this.num(t.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return g("short",!0);case"cccc":return g("long",!0);case"ccccc":return g("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return g("short",!1);case"EEEE":return g("long",!1);case"EEEEE":return g("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return p("short",!0);case"LLLL":return p("long",!0);case"LLLLL":return p("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(t.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return p("short",!1);case"MMMM":return p("long",!1);case"MMMMM":return p("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(t.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(t.year,6);case"G":return M("short");case"GG":return M("long");case"GGGGG":return M("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return S(O)}};return bk(pn.parseFormat(i),A)}formatDurationFromString(t,i){const r=p=>{switch(p[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},s=p=>g=>{const S=r(g);return S?this.num(p.get(S),g.length):g},n=pn.parseFormat(i),c=n.reduce((p,{literal:g,val:S})=>g?p:p.concat(S),[]),o=t.shiftTo(...c.map(r).filter(p=>p));return bk(n,s(o))}}const vz=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function jm(...e){const t=e.reduce((i,r)=>i+r.source,"");return RegExp(`^${t}$`)}function Vm(...e){return t=>e.reduce(([i,r,s],n)=>{const[c,o,p]=n(t,s);return[{...i,...c},o||r,p]},[{},null,1]).slice(0,2)}function Gm(e,...t){if(e==null)return[null,null];for(const[i,r]of t){const s=i.exec(e);if(s)return r(s)}return[null,null]}function bz(...e){return(t,i)=>{const r={};let s;for(s=0;s<e.length;s++)r[e[s]]=Ju(t[i+s]);return[r,null,i+s]}}const wz=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,TX=`(?:${wz.source}?(?:\\[(${vz.source})\\])?)?`,e3=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,xz=RegExp(`${e3.source}${TX}`),t3=RegExp(`(?:T${xz.source})?`),EX=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,IX=/(\d{4})-?W(\d\d)(?:-?(\d))?/,MX=/(\d{4})-?(\d{3})/,AX=bz("weekYear","weekNumber","weekDay"),PX=bz("year","ordinal"),CX=/(\d{4})-(\d\d)-(\d\d)/,Sz=RegExp(`${e3.source} ?(?:${wz.source}|(${vz.source}))?`),$X=RegExp(`(?: ${Sz.source})?`);function fm(e,t,i){const r=e[t];return ni(r)?i:Ju(r)}function kX(e,t){return[{year:fm(e,t),month:fm(e,t+1,1),day:fm(e,t+2,1)},null,t+3]}function qm(e,t){return[{hours:fm(e,t,0),minutes:fm(e,t+1,0),seconds:fm(e,t+2,0),milliseconds:XA(e[t+3])},null,t+4]}function v_(e,t){const i=!e[t]&&!e[t+1],r=Cx(e[t+1],e[t+2]),s=i?null:fn.instance(r);return[{},s,t+3]}function b_(e,t){const i=e[t]?Ya.create(e[t]):null;return[{},i,t+1]}const RX=RegExp(`^T?${e3.source}$`),OX=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function LX(e){const[t,i,r,s,n,c,o,p,g]=e,S=t[0]==="-",M=p&&p[0]==="-",A=(O,z=!1)=>O!==void 0&&(z||O&&S)?-O:O;return[{years:A(ed(i)),months:A(ed(r)),weeks:A(ed(s)),days:A(ed(n)),hours:A(ed(c)),minutes:A(ed(o)),seconds:A(ed(p),p==="-0"),milliseconds:A(XA(g),M)}]}const DX={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function i3(e,t,i,r,s,n,c){const o={year:t.length===2?CE(Ju(t)):Ju(t),month:dz.indexOf(i)+1,day:Ju(r),hour:Ju(s),minute:Ju(n)};return c&&(o.second=Ju(c)),e&&(o.weekday=e.length>3?fz.indexOf(e)+1:mz.indexOf(e)+1),o}const NX=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function zX(e){const[,t,i,r,s,n,c,o,p,g,S,M]=e,A=i3(t,s,r,i,n,c,o);let O;return p?O=DX[p]:g?O=0:O=Cx(S,M),[A,new fn(O)]}function FX(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const BX=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,UX=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,jX=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function wk(e){const[,t,i,r,s,n,c,o]=e;return[i3(t,s,r,i,n,c,o),fn.utcInstance]}function VX(e){const[,t,i,r,s,n,c,o]=e;return[i3(t,o,i,r,s,n,c),fn.utcInstance]}const GX=jm(EX,t3),qX=jm(IX,t3),HX=jm(MX,t3),WX=jm(xz),Tz=Vm(kX,qm,v_,b_),ZX=Vm(AX,qm,v_,b_),YX=Vm(PX,qm,v_,b_),JX=Vm(qm,v_,b_);function KX(e){return Gm(e,[GX,Tz],[qX,ZX],[HX,YX],[WX,JX])}function XX(e){return Gm(FX(e),[NX,zX])}function QX(e){return Gm(e,[BX,wk],[UX,wk],[jX,VX])}function eQ(e){return Gm(e,[OX,LX])}const tQ=Vm(qm);function iQ(e){return Gm(e,[RX,tQ])}const rQ=jm(CX,$X),sQ=jm(Sz),nQ=Vm(qm,v_,b_);function oQ(e){return Gm(e,[rQ,Tz],[sQ,nQ])}const xk="Invalid Duration",Ez={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},aQ={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Ez},Fo=146097/400,xf=146097/4800,lQ={years:{quarters:4,months:12,weeks:Fo/7,days:Fo,hours:Fo*24,minutes:Fo*24*60,seconds:Fo*24*60*60,milliseconds:Fo*24*60*60*1e3},quarters:{months:3,weeks:Fo/28,days:Fo/4,hours:Fo*24/4,minutes:Fo*24*60/4,seconds:Fo*24*60*60/4,milliseconds:Fo*24*60*60*1e3/4},months:{weeks:xf/7,days:xf,hours:xf*24,minutes:xf*24*60,seconds:xf*24*60*60,milliseconds:xf*24*60*60*1e3},...Ez},Hd=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],cQ=Hd.slice(0).reverse();function xu(e,t,i=!1){const r={values:i?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Ai(r)}function Iz(e,t){let i=t.milliseconds??0;for(const r of cQ.slice(1))t[r]&&(i+=t[r]*e[r].milliseconds);return i}function Sk(e,t){const i=Iz(e,t)<0?-1:1;Hd.reduceRight((r,s)=>{if(ni(t[s]))return r;if(r){const n=t[r]*i,c=e[s][r],o=Math.floor(n/c);t[s]+=o*i,t[r]-=o*c*i}return s},null),Hd.reduce((r,s)=>{if(ni(t[s]))return r;if(r){const n=t[r]%1;t[r]-=n,t[s]+=n*e[r][s]}return s},null)}function uQ(e){const t={};for(const[i,r]of Object.entries(e))r!==0&&(t[i]=r);return t}class Ai{constructor(t){const i=t.conversionAccuracy==="longterm"||!1;let r=i?lQ:aQ;t.matrix&&(r=t.matrix),this.values=t.values,this.loc=t.loc||Ki.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(t,i){return Ai.fromObject({milliseconds:t},i)}static fromObject(t,i={}){if(t==null||typeof t!="object")throw new Jn(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ai({values:Sw(t,Ai.normalizeUnit),loc:Ki.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(t){if(sp(t))return Ai.fromMillis(t);if(Ai.isDuration(t))return t;if(typeof t=="object")return Ai.fromObject(t);throw new Jn(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,i){const[r]=eQ(t);return r?Ai.fromObject(r,i):Ai.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,i){const[r]=iQ(t);return r?Ai.fromObject(r,i):Ai.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,i=null){if(!t)throw new Jn("need to specify a reason the Duration is invalid");const r=t instanceof ja?t:new ja(t,i);if(Jr.throwOnInvalid)throw new NK(r);return new Ai({invalid:r})}static normalizeUnit(t){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!i)throw new D6(t);return i}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?pn.create(this.loc,r).formatDurationFromString(this,t):xk}toHuman(t={}){if(!this.isValid)return xk;const i=Hd.map(r=>{const s=this.values[r];return ni(s)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:r.slice(0,-1)}).format(s)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=QA(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},Kt.fromMillis(i,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?Iz(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const i=Ai.fromDurationLike(t),r={};for(const s of Hd)(Cm(i.values,s)||Cm(this.values,s))&&(r[s]=i.get(s)+this.get(s));return xu(this,{values:r},!0)}minus(t){if(!this.isValid)return this;const i=Ai.fromDurationLike(t);return this.plus(i.negate())}mapUnits(t){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=hz(t(this.values[r],r));return xu(this,{values:i},!0)}get(t){return this[Ai.normalizeUnit(t)]}set(t){if(!this.isValid)return this;const i={...this.values,...Sw(t,Ai.normalizeUnit)};return xu(this,{values:i})}reconfigure({locale:t,numberingSystem:i,conversionAccuracy:r,matrix:s}={}){const c={loc:this.loc.clone({locale:t,numberingSystem:i}),matrix:s,conversionAccuracy:r};return xu(this,c)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return Sk(this.matrix,t),xu(this,{values:t},!0)}rescale(){if(!this.isValid)return this;const t=uQ(this.normalize().shiftToAll().toObject());return xu(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(c=>Ai.normalizeUnit(c));const i={},r={},s=this.toObject();let n;for(const c of Hd)if(t.indexOf(c)>=0){n=c;let o=0;for(const g in r)o+=this.matrix[g][c]*r[g],r[g]=0;sp(s[c])&&(o+=s[c]);const p=Math.trunc(o);i[c]=p,r[c]=(o*1e3-p*1e3)/1e3}else sp(s[c])&&(r[c]=s[c]);for(const c in r)r[c]!==0&&(i[n]+=c===n?r[c]:r[c]/this.matrix[n][c]);return Sk(this.matrix,i),xu(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=this.values[i]===0?0:-this.values[i];return xu(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function i(r,s){return r===void 0||r===0?s===void 0||s===0:r===s}for(const r of Hd)if(!i(this.values[r],t.values[r]))return!1;return!0}}const Sf="Invalid Interval";function hQ(e,t){return!e||!e.isValid?Or.invalid("missing or invalid start"):!t||!t.isValid?Or.invalid("missing or invalid end"):t<e?Or.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null}class Or{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,i=null){if(!t)throw new Jn("need to specify a reason the Interval is invalid");const r=t instanceof ja?t:new ja(t,i);if(Jr.throwOnInvalid)throw new DK(r);return new Or({invalid:r})}static fromDateTimes(t,i){const r=cg(t),s=cg(i),n=hQ(r,s);return n??new Or({start:r,end:s})}static after(t,i){const r=Ai.fromDurationLike(i),s=cg(t);return Or.fromDateTimes(s,s.plus(r))}static before(t,i){const r=Ai.fromDurationLike(i),s=cg(t);return Or.fromDateTimes(s.minus(r),s)}static fromISO(t,i){const[r,s]=(t||"").split("/",2);if(r&&s){let n,c;try{n=Kt.fromISO(r,i),c=n.isValid}catch{c=!1}let o,p;try{o=Kt.fromISO(s,i),p=o.isValid}catch{p=!1}if(c&&p)return Or.fromDateTimes(n,o);if(c){const g=Ai.fromISO(s,i);if(g.isValid)return Or.after(n,g)}else if(p){const g=Ai.fromISO(r,i);if(g.isValid)return Or.before(o,g)}}return Or.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(t,i);let s;return i!=null&&i.useLocaleWeeks?s=this.end.reconfigure({locale:r.locale}):s=this.end,s=s.startOf(t,i),Math.floor(s.diff(r,t).get(t))+(s.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:i}={}){return this.isValid?Or.fromDateTimes(t||this.s,i||this.e):this}splitAt(...t){if(!this.isValid)return[];const i=t.map(cg).filter(c=>this.contains(c)).sort((c,o)=>c.toMillis()-o.toMillis()),r=[];let{s}=this,n=0;for(;s<this.e;){const c=i[n]||this.e,o=+c>+this.e?this.e:c;r.push(Or.fromDateTimes(s,o)),s=o,n+=1}return r}splitBy(t){const i=Ai.fromDurationLike(t);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,s=1,n;const c=[];for(;r<this.e;){const o=this.start.plus(i.mapUnits(p=>p*s));n=+o>+this.e?this.e:o,c.push(Or.fromDateTimes(r,n)),r=n,s+=1}return c}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const i=this.s>t.s?this.s:t.s,r=this.e<t.e?this.e:t.e;return i>=r?null:Or.fromDateTimes(i,r)}union(t){if(!this.isValid)return this;const i=this.s<t.s?this.s:t.s,r=this.e>t.e?this.e:t.e;return Or.fromDateTimes(i,r)}static merge(t){const[i,r]=t.sort((s,n)=>s.s-n.s).reduce(([s,n],c)=>n?n.overlaps(c)||n.abutsStart(c)?[s,n.union(c)]:[s.concat([n]),c]:[s,c],[[],null]);return r&&i.push(r),i}static xor(t){let i=null,r=0;const s=[],n=t.map(p=>[{time:p.s,type:"s"},{time:p.e,type:"e"}]),c=Array.prototype.concat(...n),o=c.sort((p,g)=>p.time-g.time);for(const p of o)r+=p.type==="s"?1:-1,r===1?i=p.time:(i&&+i!=+p.time&&s.push(Or.fromDateTimes(i,p.time)),i=null);return Or.merge(s)}difference(...t){return Or.xor([this].concat(t)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Sf}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=bw,i={}){return this.isValid?pn.create(this.s.loc.clone(i),t).formatInterval(this):Sf}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:Sf}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Sf}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:Sf}toFormat(t,{separator:i=" – "}={}){return this.isValid?`${this.s.toFormat(t)}${i}${this.e.toFormat(t)}`:Sf}toDuration(t,i){return this.isValid?this.e.diff(this.s,t,i):Ai.invalid(this.invalidReason)}mapEndpoints(t){return Or.fromDateTimes(t(this.s),t(this.e))}}class iv{static hasDST(t=Jr.defaultZone){const i=Kt.now().setZone(t).set({month:12});return!t.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(t){return Ya.isValidZone(t)}static normalizeZone(t){return th(t,Jr.defaultZone)}static getStartOfWeek({locale:t=null,locObj:i=null}={}){return(i||Ki.create(t)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:t=null,locObj:i=null}={}){return(i||Ki.create(t)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:t=null,locObj:i=null}={}){return(i||Ki.create(t)).getWeekendDays().slice()}static months(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||Ki.create(i,r,n)).months(t)}static monthsFormat(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||Ki.create(i,r,n)).months(t,!0)}static weekdays(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null}={}){return(s||Ki.create(i,r,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null}={}){return(s||Ki.create(i,r,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Ki.create(t).meridiems()}static eras(t="short",{locale:i=null}={}){return Ki.create(i,null,"gregory").eras(t)}static features(){return{relative:lz(),localeWeek:cz()}}}function Tk(e,t){const i=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(t)-i(e);return Math.floor(Ai.fromMillis(r).as("days"))}function dQ(e,t,i){const r=[["years",(p,g)=>g.year-p.year],["quarters",(p,g)=>g.quarter-p.quarter+(g.year-p.year)*4],["months",(p,g)=>g.month-p.month+(g.year-p.year)*12],["weeks",(p,g)=>{const S=Tk(p,g);return(S-S%7)/7}],["days",Tk]],s={},n=e;let c,o;for(const[p,g]of r)i.indexOf(p)>=0&&(c=p,s[p]=g(e,t),o=n.plus(s),o>t?(s[p]--,e=n.plus(s),e>t&&(o=e,s[p]--,e=n.plus(s))):e=o);return[e,s,o,c]}function pQ(e,t,i,r){let[s,n,c,o]=dQ(e,t,i);const p=t-s,g=i.filter(M=>["hours","minutes","seconds","milliseconds"].indexOf(M)>=0);g.length===0&&(c<t&&(c=s.plus({[o]:1})),c!==s&&(n[o]=(n[o]||0)+p/(c-s)));const S=Ai.fromObject(n,r);return g.length>0?Ai.fromMillis(p,r).shiftTo(...g).plus(S):S}const r3={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Ek={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},fQ=r3.hanidec.replace(/[\[|\]]/g,"").split("");function mQ(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(e[i].search(r3.hanidec)!==-1)t+=fQ.indexOf(e[i]);else for(const s in Ek){const[n,c]=Ek[s];r>=n&&r<=c&&(t+=r-n)}}return parseInt(t,10)}else return t}function ba({numberingSystem:e},t=""){return new RegExp(`${r3[e||"latn"]}${t}`)}const yQ="missing Intl.DateTimeFormat.formatToParts support";function Ri(e,t=i=>i){return{regex:e,deser:([i])=>t(mQ(i))}}const gQ=" ",Mz=`[ ${gQ}]`,Az=new RegExp(Mz,"g");function _Q(e){return e.replace(/\./g,"\\.?").replace(Az,Mz)}function Ik(e){return e.replace(/\./g,"").replace(Az," ").toLowerCase()}function wa(e,t){return e===null?null:{regex:RegExp(e.map(_Q).join("|")),deser:([i])=>e.findIndex(r=>Ik(i)===Ik(r))+t}}function Mk(e,t){return{regex:e,deser:([,i,r])=>Cx(i,r),groups:t}}function rv(e){return{regex:e,deser:([t])=>t}}function vQ(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function bQ(e,t){const i=ba(t),r=ba(t,"{2}"),s=ba(t,"{3}"),n=ba(t,"{4}"),c=ba(t,"{6}"),o=ba(t,"{1,2}"),p=ba(t,"{1,3}"),g=ba(t,"{1,6}"),S=ba(t,"{1,9}"),M=ba(t,"{2,4}"),A=ba(t,"{4,6}"),O=W=>({regex:RegExp(vQ(W.val)),deser:([ie])=>ie,literal:!0}),V=(W=>{if(e.literal)return O(W);switch(W.val){case"G":return wa(t.eras("short"),0);case"GG":return wa(t.eras("long"),0);case"y":return Ri(g);case"yy":return Ri(M,CE);case"yyyy":return Ri(n);case"yyyyy":return Ri(A);case"yyyyyy":return Ri(c);case"M":return Ri(o);case"MM":return Ri(r);case"MMM":return wa(t.months("short",!0),1);case"MMMM":return wa(t.months("long",!0),1);case"L":return Ri(o);case"LL":return Ri(r);case"LLL":return wa(t.months("short",!1),1);case"LLLL":return wa(t.months("long",!1),1);case"d":return Ri(o);case"dd":return Ri(r);case"o":return Ri(p);case"ooo":return Ri(s);case"HH":return Ri(r);case"H":return Ri(o);case"hh":return Ri(r);case"h":return Ri(o);case"mm":return Ri(r);case"m":return Ri(o);case"q":return Ri(o);case"qq":return Ri(r);case"s":return Ri(o);case"ss":return Ri(r);case"S":return Ri(p);case"SSS":return Ri(s);case"u":return rv(S);case"uu":return rv(o);case"uuu":return Ri(i);case"a":return wa(t.meridiems(),0);case"kkkk":return Ri(n);case"kk":return Ri(M,CE);case"W":return Ri(o);case"WW":return Ri(r);case"E":case"c":return Ri(i);case"EEE":return wa(t.weekdays("short",!1),1);case"EEEE":return wa(t.weekdays("long",!1),1);case"ccc":return wa(t.weekdays("short",!0),1);case"cccc":return wa(t.weekdays("long",!0),1);case"Z":case"ZZ":return Mk(new RegExp(`([+-]${o.source})(?::(${r.source}))?`),2);case"ZZZ":return Mk(new RegExp(`([+-]${o.source})(${r.source})?`),2);case"z":return rv(/[a-z_+-/]{1,256}?/i);case" ":return rv(/[^\S\n\r]/);default:return O(W)}})(e)||{invalidReason:yQ};return V.token=e,V}const wQ={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function xQ(e,t,i){const{type:r,value:s}=e;if(r==="literal"){const p=/^\s+$/.test(s);return{literal:!p,val:p?" ":s}}const n=t[r];let c=r;r==="hour"&&(t.hour12!=null?c=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?c="hour12":c="hour24":c=i.hour12?"hour12":"hour24");let o=wQ[c];if(typeof o=="object"&&(o=o[n]),o)return{literal:!1,val:o}}function SQ(e){return[`^${e.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,e]}function TQ(e,t,i){const r=e.match(t);if(r){const s={};let n=1;for(const c in i)if(Cm(i,c)){const o=i[c],p=o.groups?o.groups+1:1;!o.literal&&o.token&&(s[o.token.val[0]]=o.deser(r.slice(n,n+p))),n+=p}return[r,s]}else return[r,{}]}function EQ(e){const t=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return ni(e.z)||(i=Ya.create(e.z)),ni(e.Z)||(i||(i=new fn(e.Z)),r=e.Z),ni(e.q)||(e.M=(e.q-1)*3+1),ni(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),ni(e.u)||(e.S=XA(e.u)),[Object.keys(e).reduce((n,c)=>{const o=t(c);return o&&(n[o]=e[c]),n},{}),i,r]}let $S=null;function IQ(){return $S||($S=Kt.fromMillis(1555555555555)),$S}function MQ(e,t){if(e.literal)return e;const i=pn.macroTokenToFormatOpts(e.val),r=$z(i,t);return r==null||r.includes(void 0)?e:r}function Pz(e,t){return Array.prototype.concat(...e.map(i=>MQ(i,t)))}function Cz(e,t,i){const r=Pz(pn.parseFormat(i),e),s=r.map(c=>bQ(c,e)),n=s.find(c=>c.invalidReason);if(n)return{input:t,tokens:r,invalidReason:n.invalidReason};{const[c,o]=SQ(s),p=RegExp(c,"i"),[g,S]=TQ(t,p,o),[M,A,O]=S?EQ(S):[null,null,void 0];if(Cm(S,"a")&&Cm(S,"H"))throw new em("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:r,regex:p,rawMatches:g,matches:S,result:M,zone:A,specificOffset:O}}}function AQ(e,t,i){const{result:r,zone:s,specificOffset:n,invalidReason:c}=Cz(e,t,i);return[r,s,n,c]}function $z(e,t){if(!e)return null;const r=pn.create(t,e).dtFormatter(IQ()),s=r.formatToParts(),n=r.resolvedOptions();return s.map(c=>xQ(c,e,n))}const kS="Invalid DateTime",Ak=864e13;function sv(e){return new ja("unsupported zone",`the zone "${e.name}" is not supported`)}function RS(e){return e.weekData===null&&(e.weekData=ww(e.c)),e.weekData}function OS(e){return e.localWeekData===null&&(e.localWeekData=ww(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function td(e,t){const i={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new Kt({...i,...t,old:i})}function kz(e,t,i){let r=e-t*60*1e3;const s=i.offset(r);if(t===s)return[r,t];r-=(s-t)*60*1e3;const n=i.offset(r);return s===n?[r,s]:[e-Math.min(s,n)*60*1e3,Math.max(s,n)]}function nv(e,t){e+=t*60*1e3;const i=new Date(e);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function Zv(e,t,i){return kz(Px(e),t,i)}function Pk(e,t){const i=e.o,r=e.c.year+Math.trunc(t.years),s=e.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,n={...e.c,year:r,month:s,day:Math.min(e.c.day,xw(r,s))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},c=Ai.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),o=Px(n);let[p,g]=kz(o,i,e.zone);return c!==0&&(p+=c,g=e.zone.offset(p)),{ts:p,o:g}}function lg(e,t,i,r,s,n){const{setZone:c,zone:o}=i;if(e&&Object.keys(e).length!==0||t){const p=t||o,g=Kt.fromObject(e,{...i,zone:p,specificOffset:n});return c?g:g.setZone(o)}else return Kt.invalid(new ja("unparsable",`the input "${s}" can't be parsed as ${r}`))}function ov(e,t,i=!0){return e.isValid?pn.create(Ki.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(e,t):null}function LS(e,t){const i=e.c.year>9999||e.c.year<0;let r="";return i&&e.c.year>=0&&(r+="+"),r+=as(e.c.year,i?6:4),t?(r+="-",r+=as(e.c.month),r+="-",r+=as(e.c.day)):(r+=as(e.c.month),r+=as(e.c.day)),r}function Ck(e,t,i,r,s,n){let c=as(e.c.hour);return t?(c+=":",c+=as(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(c+=":")):c+=as(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(c+=as(e.c.second),(e.c.millisecond!==0||!r)&&(c+=".",c+=as(e.c.millisecond,3))),s&&(e.isOffsetFixed&&e.offset===0&&!n?c+="Z":e.o<0?(c+="-",c+=as(Math.trunc(-e.o/60)),c+=":",c+=as(Math.trunc(-e.o%60))):(c+="+",c+=as(Math.trunc(e.o/60)),c+=":",c+=as(Math.trunc(e.o%60)))),n&&(c+="["+e.zone.ianaName+"]"),c}const Rz={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},PQ={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},CQ={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Oz=["year","month","day","hour","minute","second","millisecond"],$Q=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],kQ=["year","ordinal","hour","minute","second","millisecond"];function RQ(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new D6(e);return t}function $k(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return RQ(e)}}function kk(e,t){const i=th(t.zone,Jr.defaultZone),r=Ki.fromObject(t),s=Jr.now();let n,c;if(ni(e.year))n=s;else{for(const g of Oz)ni(e[g])&&(e[g]=Rz[g]);const o=oz(e)||az(e);if(o)return Kt.invalid(o);const p=i.offset(s);[n,c]=Zv(e,p,i)}return new Kt({ts:n,zone:i,loc:r,o:c})}function Rk(e,t,i){const r=ni(i.round)?!0:i.round,s=(c,o)=>(c=QA(c,r||i.calendary?0:2,!0),t.loc.clone(i).relFormatter(i).format(c,o)),n=c=>i.calendary?t.hasSame(e,c)?0:t.startOf(c).diff(e.startOf(c),c).get(c):t.diff(e,c).get(c);if(i.unit)return s(n(i.unit),i.unit);for(const c of i.units){const o=n(c);if(Math.abs(o)>=1)return s(o,c)}return s(e>t?-0:0,i.units[i.units.length-1])}function Ok(e){let t={},i;return e.length>0&&typeof e[e.length-1]=="object"?(t=e[e.length-1],i=Array.from(e).slice(0,e.length-1)):i=Array.from(e),[t,i]}class Kt{constructor(t){const i=t.zone||Jr.defaultZone;let r=t.invalid||(Number.isNaN(t.ts)?new ja("invalid input"):null)||(i.isValid?null:sv(i));this.ts=ni(t.ts)?Jr.now():t.ts;let s=null,n=null;if(!r)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(i))[s,n]=[t.old.c,t.old.o];else{const o=i.offset(this.ts);s=nv(this.ts,o),r=Number.isNaN(s.year)?new ja("invalid input"):null,s=r?null:s,n=r?null:o}this._zone=i,this.loc=t.loc||Ki.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new Kt({})}static local(){const[t,i]=Ok(arguments),[r,s,n,c,o,p,g]=i;return kk({year:r,month:s,day:n,hour:c,minute:o,second:p,millisecond:g},t)}static utc(){const[t,i]=Ok(arguments),[r,s,n,c,o,p,g]=i;return t.zone=fn.utcInstance,kk({year:r,month:s,day:n,hour:c,minute:o,second:p,millisecond:g},t)}static fromJSDate(t,i={}){const r=lX(t)?t.valueOf():NaN;if(Number.isNaN(r))return Kt.invalid("invalid input");const s=th(i.zone,Jr.defaultZone);return s.isValid?new Kt({ts:r,zone:s,loc:Ki.fromObject(i)}):Kt.invalid(sv(s))}static fromMillis(t,i={}){if(sp(t))return t<-Ak||t>Ak?Kt.invalid("Timestamp out of range"):new Kt({ts:t,zone:th(i.zone,Jr.defaultZone),loc:Ki.fromObject(i)});throw new Jn(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,i={}){if(sp(t))return new Kt({ts:t*1e3,zone:th(i.zone,Jr.defaultZone),loc:Ki.fromObject(i)});throw new Jn("fromSeconds requires a numerical input")}static fromObject(t,i={}){t=t||{};const r=th(i.zone,Jr.defaultZone);if(!r.isValid)return Kt.invalid(sv(r));const s=Ki.fromObject(i),n=Sw(t,$k),{minDaysInFirstWeek:c,startOfWeek:o}=gk(n,s),p=Jr.now(),g=ni(i.specificOffset)?r.offset(p):i.specificOffset,S=!ni(n.ordinal),M=!ni(n.year),A=!ni(n.month)||!ni(n.day),O=M||A,z=n.weekYear||n.weekNumber;if((O||S)&&z)throw new em("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(A&&S)throw new em("Can't mix ordinal dates with month/day");const V=z||n.weekday&&!O;let W,ie,ve=nv(p,g);V?(W=$Q,ie=PQ,ve=ww(ve,c,o)):S?(W=kQ,ie=CQ,ve=CS(ve)):(W=Oz,ie=Rz);let pe=!1;for(const at of W){const ct=n[at];ni(ct)?pe?n[at]=ie[at]:n[at]=ve[at]:pe=!0}const _e=V?nX(n,c,o):S?oX(n):oz(n),Me=_e||az(n);if(Me)return Kt.invalid(Me);const $e=V?mk(n,c,o):S?yk(n):n,[Fe,Ge]=Zv($e,g,r),et=new Kt({ts:Fe,zone:r,o:Ge,loc:s});return n.weekday&&O&&t.weekday!==et.weekday?Kt.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${et.toISO()}`):et}static fromISO(t,i={}){const[r,s]=KX(t);return lg(r,s,i,"ISO 8601",t)}static fromRFC2822(t,i={}){const[r,s]=XX(t);return lg(r,s,i,"RFC 2822",t)}static fromHTTP(t,i={}){const[r,s]=QX(t);return lg(r,s,i,"HTTP",i)}static fromFormat(t,i,r={}){if(ni(t)||ni(i))throw new Jn("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=r,c=Ki.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[o,p,g,S]=AQ(c,t,i);return S?Kt.invalid(S):lg(o,p,r,`format ${i}`,t,g)}static fromString(t,i,r={}){return Kt.fromFormat(t,i,r)}static fromSQL(t,i={}){const[r,s]=oQ(t);return lg(r,s,i,"SQL",t)}static invalid(t,i=null){if(!t)throw new Jn("need to specify a reason the DateTime is invalid");const r=t instanceof ja?t:new ja(t,i);if(Jr.throwOnInvalid)throw new LK(r);return new Kt({invalid:r})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,i={}){const r=$z(t,Ki.fromObject(i));return r?r.map(s=>s?s.val:null).join(""):null}static expandFormat(t,i={}){return Pz(pn.parseFormat(t),Ki.fromObject(i)).map(s=>s.val).join("")}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?RS(this).weekYear:NaN}get weekNumber(){return this.isValid?RS(this).weekNumber:NaN}get weekday(){return this.isValid?RS(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?OS(this).weekday:NaN}get localWeekNumber(){return this.isValid?OS(this).weekNumber:NaN}get localWeekYear(){return this.isValid?OS(this).weekYear:NaN}get ordinal(){return this.isValid?CS(this.c).ordinal:NaN}get monthShort(){return this.isValid?iv.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?iv.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?iv.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?iv.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const t=864e5,i=6e4,r=Px(this.c),s=this.zone.offset(r-t),n=this.zone.offset(r+t),c=this.zone.offset(r-s*i),o=this.zone.offset(r-n*i);if(c===o)return[this];const p=r-c*i,g=r-o*i,S=nv(p,c),M=nv(g,o);return S.hour===M.hour&&S.minute===M.minute&&S.second===M.second&&S.millisecond===M.millisecond?[td(this,{ts:p}),td(this,{ts:g})]:[this]}get isInLeapYear(){return __(this.year)}get daysInMonth(){return xw(this.year,this.month)}get daysInYear(){return this.isValid?pm(this.year):NaN}get weeksInWeekYear(){return this.isValid?W0(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?W0(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){const{locale:i,numberingSystem:r,calendar:s}=pn.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:s}}toUTC(t=0,i={}){return this.setZone(fn.instance(t),i)}toLocal(){return this.setZone(Jr.defaultZone)}setZone(t,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(t=th(t,Jr.defaultZone),t.equals(this.zone))return this;if(t.isValid){let s=this.ts;if(i||r){const n=t.offset(this.ts),c=this.toObject();[s]=Zv(c,n,t)}return td(this,{ts:s,zone:t})}else return Kt.invalid(sv(t))}reconfigure({locale:t,numberingSystem:i,outputCalendar:r}={}){const s=this.loc.clone({locale:t,numberingSystem:i,outputCalendar:r});return td(this,{loc:s})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const i=Sw(t,$k),{minDaysInFirstWeek:r,startOfWeek:s}=gk(i,this.loc),n=!ni(i.weekYear)||!ni(i.weekNumber)||!ni(i.weekday),c=!ni(i.ordinal),o=!ni(i.year),p=!ni(i.month)||!ni(i.day),g=o||p,S=i.weekYear||i.weekNumber;if((g||c)&&S)throw new em("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(p&&c)throw new em("Can't mix ordinal dates with month/day");let M;n?M=mk({...ww(this.c,r,s),...i},r,s):ni(i.ordinal)?(M={...this.toObject(),...i},ni(i.day)&&(M.day=Math.min(xw(M.year,M.month),M.day))):M=yk({...CS(this.c),...i});const[A,O]=Zv(M,this.o,this.zone);return td(this,{ts:A,o:O})}plus(t){if(!this.isValid)return this;const i=Ai.fromDurationLike(t);return td(this,Pk(this,i))}minus(t){if(!this.isValid)return this;const i=Ai.fromDurationLike(t).negate();return td(this,Pk(this,i))}startOf(t,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},s=Ai.normalizeUnit(t);switch(s){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(s==="weeks")if(i){const n=this.loc.getStartOfWeek(),{weekday:c}=this;c<n&&(r.weekNumber=this.weekNumber-1),r.weekday=n}else r.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);r.month=(n-1)*3+1}return this.set(r)}endOf(t,i){return this.isValid?this.plus({[t]:1}).startOf(t,i).minus(1):this}toFormat(t,i={}){return this.isValid?pn.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,t):kS}toLocaleString(t=bw,i={}){return this.isValid?pn.create(this.loc.clone(i),t).formatDateTime(this):kS}toLocaleParts(t={}){return this.isValid?pn.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:s=!0,extendedZone:n=!1}={}){if(!this.isValid)return null;const c=t==="extended";let o=LS(this,c);return o+="T",o+=Ck(this,c,i,r,s,n),o}toISODate({format:t="extended"}={}){return this.isValid?LS(this,t==="extended"):null}toISOWeekDate(){return ov(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:s=!1,extendedZone:n=!1,format:c="extended"}={}){return this.isValid?(s?"T":"")+Ck(this,c==="extended",i,t,r,n):null}toRFC2822(){return ov(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ov(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?LS(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let s="HH:mm:ss.SSS";return(i||t)&&(r&&(s+=" "),i?s+="z":t&&(s+="ZZ")),ov(this,s,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():kS}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const i={...this.c};return t.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,i="milliseconds",r={}){if(!this.isValid||!t.isValid)return Ai.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...r},n=cX(i).map(Ai.normalizeUnit),c=t.valueOf()>this.valueOf(),o=c?this:t,p=c?t:this,g=pQ(o,p,n,s);return c?g.negate():g}diffNow(t="milliseconds",i={}){return this.diff(Kt.now(),t,i)}until(t){return this.isValid?Or.fromDateTimes(this,t):this}hasSame(t,i,r){if(!this.isValid)return!1;const s=t.valueOf(),n=this.setZone(t.zone,{keepLocalTime:!0});return n.startOf(i,r)<=s&&s<=n.endOf(i,r)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const i=t.base||Kt.fromObject({},{zone:this.zone}),r=t.padding?this<i?-t.padding:t.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=t.unit;return Array.isArray(t.unit)&&(s=t.unit,n=void 0),Rk(i,this.plus(r),{...t,numeric:"always",units:s,unit:n})}toRelativeCalendar(t={}){return this.isValid?Rk(t.base||Kt.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(Kt.isDateTime))throw new Jn("min requires all arguments be DateTimes");return _k(t,i=>i.valueOf(),Math.min)}static max(...t){if(!t.every(Kt.isDateTime))throw new Jn("max requires all arguments be DateTimes");return _k(t,i=>i.valueOf(),Math.max)}static fromFormatExplain(t,i,r={}){const{locale:s=null,numberingSystem:n=null}=r,c=Ki.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return Cz(c,t,i)}static fromStringExplain(t,i,r={}){return Kt.fromFormatExplain(t,i,r)}static get DATE_SHORT(){return bw}static get DATE_MED(){return N6}static get DATE_MED_WITH_WEEKDAY(){return zK}static get DATE_FULL(){return z6}static get DATE_HUGE(){return F6}static get TIME_SIMPLE(){return B6}static get TIME_WITH_SECONDS(){return U6}static get TIME_WITH_SHORT_OFFSET(){return j6}static get TIME_WITH_LONG_OFFSET(){return V6}static get TIME_24_SIMPLE(){return G6}static get TIME_24_WITH_SECONDS(){return q6}static get TIME_24_WITH_SHORT_OFFSET(){return H6}static get TIME_24_WITH_LONG_OFFSET(){return W6}static get DATETIME_SHORT(){return Z6}static get DATETIME_SHORT_WITH_SECONDS(){return Y6}static get DATETIME_MED(){return J6}static get DATETIME_MED_WITH_SECONDS(){return K6}static get DATETIME_MED_WITH_WEEKDAY(){return FK}static get DATETIME_FULL(){return X6}static get DATETIME_FULL_WITH_SECONDS(){return Q6}static get DATETIME_HUGE(){return ez}static get DATETIME_HUGE_WITH_SECONDS(){return tz}}function cg(e){if(Kt.isDateTime(e))return e;if(e&&e.valueOf&&sp(e.valueOf()))return Kt.fromJSDate(e);if(e&&typeof e=="object")return Kt.fromObject(e);throw new Jn(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const Ll="system",s3="unknown",Z0="UTC",OQ=Intl.DateTimeFormat().resolvedOptions().timeZone,LQ="shortOffset";function DQ(e){return"timeZoneIANA"in e}function NQ(e){return e.startsWith("UTC")}function Zge(e,t=!1){return{json:{read:{source:e,reader:(i,r)=>r[e]?zQ(r[e]):null},write:!!t&&{allowNull:!0,writer(i,r){r[e]=i?FQ(i):null}}}}}function zQ(e,t=Ll){return e?DQ(e)?e.timeZoneIANA:BQ(e,t):t}function FQ(e){return{timeZoneIANA:e}}function BQ(e,t=Ll){if(!e||!sk.has(e.timeZone))return t;const i=sk.get(e.timeZone);return NQ(e.timeZone)||e.respectsDaylightSaving?i:UQ(i)}function UQ(e){const t=Kt.local().setZone(e),i=Math.min(t.set({month:1,day:1}).offset,t.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${fn.instance(-i).formatOffset(0,"narrow")}`}function Yge(e,t,i,r,s){if(t&&s==="date")return{timeZone:Z0,timeZoneName:void 0};const n=r.timeStyle||r.hour,c=i===s3;return{timeZone:c?s==="timestamp-offset"?void 0:e??Z0:i,timeZoneName:c&&n?LQ:void 0}}const jQ={year:void 0,month:void 0,day:void 0,weekday:void 0},VQ={hour:void 0,minute:void 0,second:void 0},Lz={timeZone:Z0},ll={year:"numeric",month:"numeric",day:"numeric"},ug={year:"numeric",month:"long",day:"numeric"},hg={year:"numeric",month:"short",day:"numeric"},dg={year:"numeric",month:"long",weekday:"long",day:"numeric"},Ku={hour:"numeric",minute:"numeric"},hd={...Ku,second:"numeric"},Dz={hourCycle:"h23"},pg={...Ku,...Dz},fg={...hd,...Dz},Nz={"short-date":ll,"short-date-short-time":{...ll,...Ku},"short-date-short-time-24":{...ll,...pg},"short-date-long-time":{...ll,...hd},"short-date-long-time-24":{...ll,...fg},"short-date-le":ll,"short-date-le-short-time":{...ll,...Ku},"short-date-le-short-time-24":{...ll,...pg},"short-date-le-long-time":{...ll,...hd},"short-date-le-long-time-24":{...ll,...fg},"long-month-day-year":ug,"long-month-day-year-short-time":{...ug,...Ku},"long-month-day-year-short-time-24":{...ug,...pg},"long-month-day-year-long-time":{...ug,...hd},"long-month-day-year-long-time-24":{...ug,...fg},"day-short-month-year":hg,"day-short-month-year-short-time":{...hg,...Ku},"day-short-month-year-short-time-24":{...hg,...pg},"day-short-month-year-long-time":{...hg,...hd},"day-short-month-year-long-time-24":{...hg,...fg},"long-date":dg,"long-date-short-time":{...dg,...Ku},"long-date-short-time-24":{...dg,...pg},"long-date-long-time":{...dg,...hd},"long-date-long-time-24":{...dg,...fg},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Ku,"long-time":hd},GQ=Fn()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),zz={ar:"ar-u-nu-latn-ca-gregory"};let $E=new WeakMap;const kx=Nz["short-date-short-time"];function qQ(e){let t=$E.get(e);if(!t){const i=bo(),r=zz[i]||i,s=o3(e.timeZone??Ll),n={...e,timeZone:s};t=new Intl.DateTimeFormat(r,n),$E.set(e,t)}return t}function Jge(e){return Nz[e]}function n3(e,t=kx){return qQ(t).format(e)}function Kge(e,t=kx){return n3(new Date(e),{...t,...Lz,...VQ})}function Xge(e,t=kx){return n3(new Date(`1970-01-01T${e}Z`),{...t,...Lz,...jQ})}function Qge(e,t=kx){if(t.timeZone)return n3(new Date(e),t);const i=Kt.fromISO(e,{setZone:!0}),r=bo(),s=zz[r]??r,n=i.offset===0?Z0:t.timeZone,c={...t,timeZone:n};return i.toLocaleString(c,{locale:s})}function o3(e){switch(e){case Ll:return OQ;case s3:return Z0;default:return e}}PA(()=>{$E=new WeakMap});const HQ={ar:"ar-u-nu-latn"};let Yv=new WeakMap,Fz={};function WQ(e){const t=e||Fz;if(!Yv.has(t)){const i=bo(),r=HQ[bo()]||i;Yv.set(t,new Intl.NumberFormat(r,e))}return Yv.get(t)}function e0e(e={}){const t={};return e.digitSeparator!=null&&(t.useGrouping=e.digitSeparator),e.places!=null&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function t0e(e,t){return Object.is(e,-0)&&(e=0),WQ(t).format(e)}PA(()=>{Yv=new WeakMap,Fz={}});async function ZQ(e,t,i,r){const s=t.exec(i);if(!s)throw new Je("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${t}"`);const n=s[1]?`${s[1]}/`:"",c=s[2],o=rZ(r),p=`${n}${c}.json`,g=o?`${n}${c}_${o}.json`:p;let S;try{S=await Lk(e(g))}catch(M){if(g===p)throw new Je("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:M});try{S=await Lk(e(p))}catch(A){throw new Je("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:A})}}return S}async function Lk(e){if(Dk.fetchBundleAsset!=null)return Dk.fetchBundleAsset(e);const t=await Xi(e,{responseType:"text"});return JSON.parse(t.data)}let YQ=class{constructor({base:t="",pattern:i,location:r=new URL(window.location.href)}){let s;s=typeof r=="string"?n=>new URL(n,new URL(r,window.location.href)).href:r instanceof URL?n=>new URL(n,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=s,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,i){return ZQ(this.getAssetUrl,this.matcher,t,i)}};function JQ(e){return new YQ(e)}const Dk={};iZ(JQ({pattern:"esri/",location:$i}));const KQ={};function XQ(e){var i;const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:{...e.has},map:{...e.map},packages:((i=e.packages)==null?void 0:i.concat())||[],paths:{...e.paths}};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=KQ.baseUrl),t}let QQ=class{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...r)=>t[i](...r)})}},Jv=class{constructor(){this._dispatcher=new QQ,this._workerPostMessage({type:Is.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){qb(()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))})}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,i,r){this._dispatcher.addEventListener(t,i,r)}removeEventListener(t,i,r){this._dispatcher.removeEventListener(t,i,r)}_workerPostMessage(t){qb(()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))})}async _workerMessageHandler(t){const i=H0(t);if(i&&i.type===Is.OPEN){const{modulePath:r,jobId:s}=i;let n=await gh.loadWorker(r);n||(n=await ht(()=>import(r),[]));const c=gh.connect(n);this._workerPostMessage({type:Is.OPENED,jobId:s,data:c})}}};const kE=()=>_t.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:eee}=Is,tee='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,s)=>{if(t){if(t.aborted)return s(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),s(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:s}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n??s}\\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case OPEN:let n;function t(e){const o=n.connect(e);self.postMessage({type:OPENED,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case RESPONSE:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let av,lv;const Nk="Failed to create Worker. Fallback to execute module in main thread";async function iee(){if(!Le("esri-workers"))return zk(new Jv);if(!av&&!lv)try{const t=tee.split('"{CONFIGURATION}"').join(`'${ree()}'`);av=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){lv=t||{}}let e;if(av)try{e=new Worker(av,{name:"esri-worker-"+see++})}catch{kE().warn(Nk,lv),e=new Jv}else kE().warn(Nk,lv),e=new Jv;return zk(e)}async function zk(e){return new Promise(t=>{function i(s){const n=H0(s);n&&n.type===eee&&(e.removeEventListener("message",i),e.removeEventListener("error",r),t(e))}function r(s){s.preventDefault(),e.removeEventListener("message",i),e.removeEventListener("error",r),kE().warn("Failed to create Worker. Fallback to execute module in main thread",s),(e=new Jv).addEventListener("message",i),e.addEventListener("error",r)}e.addEventListener("message",i),e.addEventListener("error",r)})}function ree(){let e;if(Pi.default!=null){const s={...Pi};delete s.default,e=JSON.parse(JSON.stringify(s))}else e=JSON.parse(JSON.stringify(Pi));e.assetsPath=Ko(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?Ko(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=bo(),e.has={"esri-csp-restrictions":Le("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Le("esri-2d-update-debug"),"esri-2d-log-updating":Le("esri-2d-log-updating"),"featurelayer-pbf":Le("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":Le("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":Le("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":Le("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":Le("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":Le("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":Le("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":Le("featurelayer-snapshot-enabled"),"esri-atomics":Le("esri-atomics"),"esri-shared-array-buffer":Le("esri-shared-array-buffer"),"esri-tiles-debug":Le("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Le("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":Le("feature-polyline-generalization-factor"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Ko(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Ko(e.workers.workerPath):e.workers.workerPath=Ko($i("esri/core/workers/RemoteClient.js")),e.workers.useDynamicImport=!1;const t=Pi.workers.loaderConfig,i=XQ({baseUrl:t==null?void 0:t.baseUrl,locale:bo(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...t==null?void 0:t.has},map:{...t==null?void 0:t.map},paths:{...t==null?void 0:t.paths},packages:(t==null?void 0:t.packages)||[]});return JSON.stringify({esriConfig:e,loaderConfig:i,kernelInfo:{buildDate:F4,fullVersion:gA,revision:B4}})}let see=0;const{ABORT:Fk,INVOKE:nee,OPEN:oee,OPENED:aee,RESPONSE:mg}=Is;let lee=class Bz{static async create(t){const i=await iee();return new Bz(i,t)}constructor(t,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=i,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",r=>{r.preventDefault(),_t.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(t,i={}){const{signal:r}=i,s=O6();return new Promise((n,c)=>{const o={resolve:n,reject:c,abortHandle:eA(r,()=>{this._outJobs.delete(s),this._post({type:Fk,jobId:s})})};this._outJobs.set(s,o),this._post({type:oee,jobId:s,modulePath:t})})}_onMessage(t){const i=H0(t);if(i)switch(i.type){case aee:this._onOpenedMessage(i);break;case mg:this._onResponseMessage(i);break;case Fk:this._onAbortMessage(i);break;case nee:this._onInvokeMessage(i)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,s=i.get(r);s&&(s.controller&&s.controller.abort(),i.delete(r))}_onInvokeMessage(t){const{methodName:i,jobId:r,data:s,abortable:n}=t,c=n?new AbortController:null,o=this._inJobs,p=OK[i];let g;try{if(typeof p!="function")throw new TypeError(`${i} is not a function`);g=p.call(null,s,{signal:c?c.signal:null})}catch(S){return void this._post({type:mg,jobId:r,error:q0(S)})}wh(g)?(o.set(r,{controller:c,promise:g}),g.then(S=>{o.has(r)&&(o.delete(r),this._post({type:mg,jobId:r},S))},S=>{o.has(r)&&(o.delete(r),S||(S={message:"Error encountered at method"+i}),qs(S)||this._post({type:mg,jobId:r,error:q0(S||{message:`Error encountered at method ${i}`})}))})):this._post({type:mg,jobId:r},g)}_onOpenedMessage(t){const{jobId:i,data:r}=t,s=this._outJobs.get(i);s&&(this._outJobs.delete(i),gr(s.abortHandle),s.resolve(r))}_onResponseMessage(t){const{jobId:i,error:r,data:s}=t,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),gr(n.abortHandle),r?n.reject(Je.fromJSON(JSON.parse(r))):n.resolve(s))}_post(t,i,r){return YA(this.worker,t,i,r)}};const Bk=Le("host-browser")?Math.min(navigator.hardwareConcurrency-1,Le("workers-pool-size")):0;let Wd=Le("esri-mobile")?Math.min(Bk,3):Bk;Wd||(Wd=Le("safari")&&Le("mac")?7:2);let Uk=0;const Kv=[];function cee(){Uz()}async function cv(e,t){const i=new RK,{registryTarget:r,...s}=t;return await i.open(e,s),r&&xK(r,i),i}async function n0e(e,t={}){if(typeof e!="string")throw new Je("workers:undefined-module","modulePath is missing");let i=t.strategy||"distributed";if(Le("host-webworker")&&!Le("esri-workers")&&(i="local"),i==="local"){let r=await gh.loadWorker(e);r||(r=await ht(()=>import(e),[])),dr(t.signal);const s=t.client||r;return cv([gh.connect(r)],{...t,client:s})}if(await Uz(),dr(t.signal),i==="dedicated"){const r=Uk++%Wd;return cv([await Kv[r].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const r=Math.min(t.maxNumWorkers,Wd);if(r<Wd){const s=new Array(r);for(let n=0;n<r;++n){const c=Uk++%Wd;s[n]=Kv[c].open(e,t)}return cv(s,t)}}return cv(Kv.map(r=>r.open(e,t)),t)}let uv=null;async function Uz(){if(uv)return uv;new AbortController;const e=[];for(let t=0;t<Wd;t++){const i=lee.create(t).then(r=>(Kv[t]=r,r));e.push(i)}return uv=Promise.all(e),uv}const Su=Ar.radius,xa=Ar.eccentricitySquared,uee={a1:Su*xa,a2:Su*xa*Su*xa,a3:Su*xa*xa/2,a4:Su*xa*Su*xa*2.5,a5:Su*xa+Su*xa*xa/2,a6:1-xa};1/294.9786982,1/298.257222101,Ar.radius,Ar.flattening,1/298.257222101,dh.radius,dh.flattening,1/192.0430107526882,Cl.radius,Cl.flattening,1/10.2079945799458,1/43.61604095563141,Cl.radius;var be;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",e[e.WGS84=2]="WGS84",e[e.WEB_MERCATOR=3]="WEB_MERCATOR",e[e.WGS84_ECEF=4]="WGS84_ECEF",e[e.CGCS2000=5]="CGCS2000",e[e.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",e[e.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",e[e.GCSMARS2000=8]="GCSMARS2000",e[e.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",e[e.GCSMOON2000=10]="GCSMOON2000",e[e.LON_LAT=11]="LON_LAT",e[e.PLATE_CARREE=12]="PLATE_CARREE"})(be||(be={}));const jz={[be.WGS84]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:qi,[be.SPHERICAL_ECEF]:tm,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:Y0,[be.PLATE_CARREE]:Zd,[be.WGS84]:qi,[be.WGS84_ECEF]:Kd},[be.CGCS2000]:{[be.CGCS2000]:qi,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:qi,[be.SPHERICAL_ECEF]:tm,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:Zd,[be.WGS84]:null,[be.WGS84_ECEF]:Kd},[be.GCSMARS2000]:{[be.CGCS2000]:null,[be.GCSMARS2000]:qi,[be.GCSMOON2000]:null,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:null,[be.SPHERICAL_ECEF]:null,[be.SPHERICAL_MARS_PCPF]:Vk,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:null,[be.WGS84]:null,[be.WGS84_ECEF]:null},[be.GCSMOON2000]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:qi,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:null,[be.SPHERICAL_ECEF]:null,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:jk,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:null,[be.WGS84]:null,[be.WGS84_ECEF]:null},[be.WEB_MERCATOR]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:v0,[be.WGS84_COMPARABLE_LON_LAT]:v0,[be.SPHERICAL_ECEF]:dee,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:qi,[be.PLATE_CARREE]:mee,[be.WGS84]:v0,[be.WGS84_ECEF]:pee},[be.WGS84_ECEF]:{[be.CGCS2000]:Xd,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:Xd,[be.WGS84_COMPARABLE_LON_LAT]:Xd,[be.SPHERICAL_ECEF]:Tee,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:Eee,[be.PLATE_CARREE]:yee,[be.WGS84]:Xd,[be.WGS84_ECEF]:qi},[be.SPHERICAL_ECEF]:{[be.CGCS2000]:Jd,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:Jd,[be.WGS84_COMPARABLE_LON_LAT]:Jd,[be.SPHERICAL_ECEF]:qi,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:wee,[be.PLATE_CARREE]:gee,[be.WGS84]:Jd,[be.WGS84_ECEF]:xee},[be.SPHERICAL_MARS_PCPF]:{[be.CGCS2000]:null,[be.GCSMARS2000]:qk,[be.GCSMOON2000]:null,[be.LON_LAT]:qk,[be.WGS84_COMPARABLE_LON_LAT]:null,[be.SPHERICAL_ECEF]:null,[be.SPHERICAL_MARS_PCPF]:qi,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:null,[be.WGS84]:null,[be.WGS84_ECEF]:null},[be.SPHERICAL_MOON_PCPF]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:Gk,[be.LON_LAT]:Gk,[be.WGS84_COMPARABLE_LON_LAT]:null,[be.SPHERICAL_ECEF]:null,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:qi,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:null,[be.WGS84]:null,[be.WGS84_ECEF]:null},[be.UNKNOWN]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:null,[be.WGS84_COMPARABLE_LON_LAT]:null,[be.SPHERICAL_ECEF]:null,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:qi,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:null,[be.WGS84]:null,[be.WGS84_ECEF]:null},[be.LON_LAT]:{[be.CGCS2000]:qi,[be.GCSMARS2000]:qi,[be.GCSMOON2000]:qi,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:qi,[be.SPHERICAL_ECEF]:tm,[be.SPHERICAL_MARS_PCPF]:Vk,[be.SPHERICAL_MOON_PCPF]:jk,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:Y0,[be.PLATE_CARREE]:Zd,[be.WGS84]:qi,[be.WGS84_ECEF]:Kd},[be.WGS84_COMPARABLE_LON_LAT]:{[be.CGCS2000]:null,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:qi,[be.WGS84_COMPARABLE_LON_LAT]:qi,[be.SPHERICAL_ECEF]:tm,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:null,[be.PLATE_CARREE]:Zd,[be.WGS84]:qi,[be.WGS84_ECEF]:Kd},[be.PLATE_CARREE]:{[be.CGCS2000]:Yd,[be.GCSMARS2000]:null,[be.GCSMOON2000]:null,[be.LON_LAT]:Yd,[be.WGS84_COMPARABLE_LON_LAT]:Yd,[be.SPHERICAL_ECEF]:_ee,[be.SPHERICAL_MARS_PCPF]:null,[be.SPHERICAL_MOON_PCPF]:null,[be.UNKNOWN]:null,[be.WEB_MERCATOR]:vee,[be.PLATE_CARREE]:qi,[be.WGS84]:Yd,[be.WGS84_ECEF]:bee}};function hee(e){const t=RE(e,Mee);return jz[t][be.WGS84_COMPARABLE_LON_LAT]}function Vz(e,t,i=Gz()){return e==null||t==null?null:Iee(e,t,i).projector}function RE(e,t){return e?t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=Ap(e,1)),dw(e)?t.spatialReferenceId=be.SPHERICAL_ECEF:U0(e)?t.spatialReferenceId=be.WGS84:fp(e)?t.spatialReferenceId=be.WEB_MERCATOR:XH(e)?t.spatialReferenceId=be.PLATE_CARREE:e.wkt===iW.wkt?t.spatialReferenceId=be.WGS84_ECEF:e.wkid===pp.CGCS2000?t.spatialReferenceId=be.CGCS2000:e.wkt===IA.wkt?t.spatialReferenceId=be.SPHERICAL_MARS_PCPF:e.wkt===MA.wkt?t.spatialReferenceId=be.SPHERICAL_MOON_PCPF:iN(e)?t.spatialReferenceId=be.GCSMARS2000:rN(e)?t.spatialReferenceId=be.GCSMOON2000:t.spatialReferenceId=be.UNKNOWN):be.UNKNOWN}function qi(e,t,i,r){e!==i&&(i[r++]=e[t++],i[r++]=e[t++],i[r]=e[t])}function v0(e,t,i,r){i[r]=km*(e[t]/np),i[r+1]=km*(Hz-2*Math.atan(Math.exp(-e[t+1]/np))),i[r+2]=e[t+2]}function dee(e,t,i,r){const s=e[t]/np,n=Hz-2*Math.atan(Math.exp(-e[t+1]/np)),c=np+e[t+2],o=Math.cos(n)*c;i[r]=Math.cos(s)*o,i[r+1]=Math.sin(s)*o,i[r+2]=Math.sin(n)*c}function pee(e,t,i,r){v0(e,t,i,r),Kd(i,r,i,r)}function fee(e,t,i,r,s){const n=.4999999*Rx,c=Ol($m*e[t+1],-n,n),o=Math.sin(c);i[r++]=$m*e[t]*s.radius,i[r++]=s.halfSemiMajorAxis*Math.log((1+o)/(1-o)),i[r]=e[t+2]}function Y0(e,t,i,r){fee(e,t,i,r,Ar)}function Zd(e,t,i,r){i[r]=e[t]*Hk,i[r+1]=e[t+1]*Hk,i[r+2]=e[t+2]}function Yd(e,t,i,r){i[r]=e[t]*Wk,i[r+1]=e[t+1]*Wk,i[r+2]=e[t+2]}function mee(e,t,i,r){v0(e,t,i,r),Zd(i,r,i,r)}function yee(e,t,i,r){Xd(e,t,i,r),Zd(i,r,i,r)}function gee(e,t,i,r){Jd(e,t,i,r),Zd(i,r,i,r)}function _ee(e,t,i,r){Yd(e,t,i,r),tm(i,r,i,r)}function vee(e,t,i,r){Yd(e,t,i,r),Y0(i,r,i,r)}function bee(e,t,i,r){Yd(e,t,i,r),Kd(i,r,i,r)}function a3(e,t,i,r,s){const n=s+e[t+2],c=$m*e[t+1],o=$m*e[t],p=Math.cos(c)*n;i[r]=Math.cos(o)*p,i[r+1]=Math.sin(o)*p,i[r+2]=Math.sin(c)*n}function jk(e,t,i,r){a3(e,t,i,r,dh.radius)}function Vk(e,t,i,r){a3(e,t,i,r,Cl.radius)}function tm(e,t,i,r){a3(e,t,i,r,Ar.radius)}function l3(e,t,i,r,s){const n=e[t],c=e[t+1],o=e[t+2],p=Math.sqrt(n*n+c*c+o*o),g=NN(o/(p===0?1:p)),S=Math.atan2(c,n);i[r++]=km*S,i[r++]=km*g,i[r]=p-s}function Gk(e,t,i,r){l3(e,t,i,r,dh.radius)}function qk(e,t,i,r){l3(e,t,i,r,Cl.radius)}function Jd(e,t,i,r){l3(e,t,i,r,Ar.radius)}function wee(e,t,i,r){Jd(e,t,i,r),Y0(i,r,i,r)}function xee(e,t,i,r){Jd(e,t,i,r),Kd(i,r,i,r)}function See(e,t,i,r,s){const n=$m*e[t],c=$m*e[t+1],o=e[t+2],p=Math.sin(c),g=Math.cos(c),S=s.radius/Math.sqrt(1-s.eccentricitySquared*p*p);i[r++]=(S+o)*g*Math.cos(n),i[r++]=(S+o)*g*Math.sin(n),i[r++]=(S*(1-s.eccentricitySquared)+o)*p}function Kd(e,t,i,r){See(e,t,i,r,Ar)}function Xd(e,t,i,r){const s=uee,n=e[t],c=e[t+1],o=e[t+2];let p,g,S,M,A,O,z,V,W,ie,ve,pe,_e,Me,$e,Fe,Ge,et,at,ct,nt;p=Math.abs(o),g=n*n+c*c,S=Math.sqrt(g),M=g+o*o,A=Math.sqrt(M),ct=Math.atan2(c,n),O=o*o/M,z=g/M,Me=s.a2/A,$e=s.a3-s.a4/A,z>.3?(V=p/A*(1+z*(s.a1+Me+O*$e)/A),at=Math.asin(V),ie=V*V,W=Math.sqrt(1-ie)):(W=S/A*(1-O*(s.a5-Me-z*$e)/A),at=Math.acos(W),ie=1-W*W,V=Math.sqrt(ie)),ve=1-Ar.eccentricitySquared*ie,pe=Ar.radius/Math.sqrt(ve),_e=s.a6*pe,Me=S-pe*W,$e=p-_e*V,Ge=W*Me+V*$e,Fe=W*$e-V*Me,et=Fe/(_e/ve+Ge),at+=et,nt=Ge+Fe*et/2,o<0&&(at=-at),i[r++]=km*ct,i[r++]=km*at,i[r]=nt}function Tee(e,t,i,r){Xd(e,t,i,r),tm(i,r,i,r)}function Eee(e,t,i,r){Xd(e,t,i,r),Y0(i,r,i,r)}function Iee(e,t,i){if(e==null||t==null||i.source.spatialReference===e&&i.dest.spatialReference===t)return i;const r=RE(e,i.source),s=RE(t,i.dest);return r===be.UNKNOWN&&s===be.UNKNOWN?Hs(e,t)?i.projector=qi:i.projector=null:i.projector=jz[r][s],i}function Gz(){return{source:{spatialReference:null,spatialReferenceId:be.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:be.UNKNOWN,metersPerUnit:1},projector:qi}}const Mee={spatialReference:null,spatialReferenceId:be.UNKNOWN},o0e={spatialReference:null,spatialReferenceId:be.UNKNOWN},qz=Gz(),$m=LN(1),km=DN(1),Rx=Math.PI,Hz=.5*Rx,np=Ar.radius,Hk=np*Rx/180,Wk=180/(np*Rx);function w_(e,t,i,r,s,n,c=1){const o=Vz(t,s,qz);if(o==null)return!1;if(o===qi){if(e===r&&i===n)return!0;const g=i+3*c;for(let S=i,M=n;S<g;S++,M++)r[M]=e[S];return!0}const p=i+3*c;for(let g=i,S=n;g<p;g+=3,S+=3)o(e,g,r,S);return!0}const a0e=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:w_},Symbol.toStringTag,{value:"Module"}));function Zk(e,t,i,r,s,n){return hv[0]=e,hv[1]=t,hv[2]=i,w_(hv,r,0,s,n,0,1)}const hv=Th();let dv=0,DS=class OE{static fromGE(t){const i=new OE;return i._wkt=t.wkt,i._wkid=t.wkid,i._isInverse=t.isInverse,i}constructor(t){this.uid=dv++,t?(this._wkt=t.wkt!=null?t.wkt:null,this._wkid=t.wkid!=null?t.wkid:-1,this._isInverse=t.isInverse!=null&&t.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=dv++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=dv++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=dv++}getInverse(){const t=new OE;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}},Tw=class Ag{static cacheKey(t,i){var r,s,n,c,o,p;return[((r=t.wkid)==null?void 0:r.toString())??"-1",((s=t.wkt)==null?void 0:s.toString())??"",((n=t.wkt2)==null?void 0:n.toString())??"",((c=i.wkid)==null?void 0:c.toString())??"-1",((o=i.wkt)==null?void 0:o.toString())??"",((p=i.wkt2)==null?void 0:p.toString())??""].join()}static fromGE(t){const i=new Ag;let r="";for(const s of t.steps){const n=DS.fromGE(s);i.steps.push(n),r+=n.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t==null?void 0:t.steps)for(const i of t.steps)i instanceof DS?this.steps.push(i):this.steps.push(new DS({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const t=new Ag;t.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];t.steps.push(r.getInverse())}return t}getGTListEntry(){let t="";for(const i of this.steps)t+=i.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,i,r){this._cachedProjection[Ag.cacheKey(t,i)]=r}getCachedGeTransformation(t,i){let r="";for(const n of this.steps)r+=n.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const s=this._cachedProjection[Ag.cacheKey(t,i)];return s===void 0?null:s}};function Aee(e,t,i){if(t==null||i==null||i.vcsWkid||Hs(t,i)||ph(t)||ph(i))return null;const r=P$(t)/P$(i);if(r===1)return null;switch(e){case"point":case"esriGeometryPoint":return s=>Pee(s,r);case"polyline":case"esriGeometryPolyline":return s=>$ee(s,r);case"polygon":case"esriGeometryPolygon":return s=>Cee(s,r);case"multipoint":case"esriGeometryMultipoint":return s=>kee(s,r);case"extent":case"esriGeometryEnvelope":return s=>Ree(s,r);default:return null}}function Pee(e,t){(e==null?void 0:e.z)!=null&&(e.z*=t)}function Cee(e,t){if(e)for(const i of e.rings)for(const r of i)r.length>2&&(r[2]*=t)}function $ee(e,t){if(e)for(const i of e.paths)for(const r of i)r.length>2&&(r[2]*=t)}function kee(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}function Ree(e,t){e&&e.zmin!=null&&e.zmax!=null&&(e.zmin*=t,e.zmax*=t)}let qa=null,_h=null,b0=null,Xv={};const c3=new f_;function Mh(){return!!qa&&SA()}function Wz(){return!!Mh()||(Ot(c3),vh(),!1)}function Zz(e,t){return!e||!t||Dl(e,t)||Wz()}function Oee(e,t){return!Dl(e,t)&&!Mh()}function vh(e){return b0==null&&(b0=Promise.all([J4(),ht(()=>import("./geometryEngineBase-DWTWNtQK.js"),[]).then(t=>t.g),ht(()=>import("./hydrated-C-VeN2I6.js"),[])])),b0.then(([,t,{hydratedAdapter:i}])=>{dr(e),_h=i,qa=t.default,qa._enableProjection(ZH),c3.notify()})}function Ah(e,t,i=null,r=null){return Array.isArray(e)?e.length===0?[]:LE(_h,e,e[0].spatialReference,t,i,r):LE(_h,[e],e.spatialReference,t,i,r)[0]}function LE(e,t,i,r,s=null,n=null){if(i==null||r==null)return t;if(Dl(i,r,s))return t.map(c=>Qv(c,i,r));if(s==null&&dw(i))return t.map(c=>Qv(c,i,mi.WGS84)).map(c=>J0(c,r));if(s==null&&dw(r))return t.map(c=>J0(c,mi.WGS84)).map(c=>Qv(c,mi.WGS84,r));if(s==null){const c=Tw.cacheKey(i,r);Xv[c]!==void 0?s=Xv[c]:((s=Jz(i,r,void 0))==null&&(s=new Tw),Xv[c]=s)}if(qa==null||e==null)throw new Ox;return n!=null?qa._project(e,t,i,r,s,n):qa._project(e,t,i,r,s)}function Lee(e,t){const i=Yz([e],t);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function Yz(e,t){if(!Mh()){for(const i of e)if(i!=null&&!Hs(i.spatialReference,t)&&Ba(i.spatialReference)&&Ba(t)&&!Dl(i.spatialReference,t))return Ot(c3),{pending:vh(),geometries:null}}return{pending:null,geometries:e.map(i=>i==null?null:Hs(i.spatialReference,t)?i:Ba(i.spatialReference)&&Ba(t)?J0(i,t):null)}}function Jz(e,t,i=null){if(e==null||t==null)return null;if(qa==null||_h==null)throw new Ox;const r=qa._getTransformation(_h,e,t,i,i==null?void 0:i.spatialReference);return r!==null?Tw.fromGE(r):null}function Dee(e,t,i=null){if(qa==null||_h==null)throw new Ox;const r=qa._getTransformationBySuitability(_h,e,t,i,i==null?void 0:i.spatialReference);if(r!==null){const s=[];for(const n of r)s.push(Tw.fromGE(n));return s}return[]}let Ox=class extends Je{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function Nee(){qa=null,_h=null,b0=null,Xv={}}const zee={get loadPromise(){return b0}};function J0(e,t){try{const i=Ah(e,t);if(i==null)return null;"xmin"in e&&"xmin"in i&&(i.zmin=e.zmin,i.zmax=e.zmax);const r=Aee(i.type,e.spatialReference,t);return r!=null&&r(i),i}catch(i){if(!(i instanceof Ox))throw i;return null}}async function Fee(e,t,i){const r=e.spatialReference;return r!=null&&t!=null&&await u3(r,t,null,i),J0(e,t)}function Dl(e,t,i){return!i&&(!!Hs(e,t)||Ba(e)&&Ba(t)&&!!Vz(e,t,qz))}async function u3(e,t,i,r){if(Mh())return Hb(r);if(Array.isArray(e)){for(const{source:s,dest:n,geographicTransformation:c}of e)if(s&&n&&!Dl(s,n,c))return vh(r)}else if(e&&t&&!Dl(e,t,i))return vh(r);return Hb(r)}function Qv(e,t,i){return e?"x"in e?Kz(e,t,new ri,i,0):"xmin"in e?tF(e,t,new Bi,i,0):"rings"in e?eF(e,t,new mh,i,0):"paths"in e?Qz(e,t,new Ua,i,0):"points"in e?Xz(e,t,new Tx,i,0):null:null}function Bee(e,t,i=t.spatialReference,r=0){return i!=null&&e.spatialReference!=null&&Kz(e,e.spatialReference,t,i,r)!=null}function Kz(e,t,i,r,s){hn[0]=e.x,hn[1]=e.y;const n=e.z;return hn[2]=n!==void 0?n:s,w_(hn,t,0,hn,r,0,1)?(i.x=hn[0],i.y=hn[1],i.spatialReference=r,n!==void 0||ph(r)?(i.z=hn[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),e.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=e.m,i.hasM=!0),i):null}function Uee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&Xz(e,e.spatialReference,t,i,r)!=null}function Xz(e,t,i,r,s){const{points:n,hasZ:c,hasM:o}=e,p=[],g=n.length,S=[];for(const A of n)S.push(A[0],A[1],c?A[2]:s);if(!w_(S,t,0,S,r,0,g))return null;const M=c||ph(r);for(let A=0;A<g;++A){const O=3*A,z=S[O],V=S[O+1];M&&o?p.push([z,V,S[O+2],n[A][3]]):M?p.push([z,V,S[O+2]]):o?p.push([z,V,n[A][2]]):p.push([z,V])}return i.points=p,i.spatialReference=r,i.hasZ=c,i.hasM=o,i}function jee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&Qz(e,e.spatialReference,t,i,r)!=null}function Qz(e,t,i,r,s){const{paths:n,hasZ:c,hasM:o}=e,p=[];if(!iF(n,c??!1,o??!1,t,p,r,s))return null;const g=c||ph(r);return i.paths=p,i.spatialReference=r,i.hasZ=g,i.hasM=o,i}function Vee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&eF(e,e.spatialReference,t,i,r)!=null}function eF(e,t,i,r,s){const{rings:n,hasZ:c,hasM:o}=e,p=[];if(!iF(n,c??!1,o??!1,t,p,r,s))return null;const g=c||ph(r);return i.rings=p,i.spatialReference=r,i.hasZ=g,i.hasM=o,i}function Gee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&tF(e,e.spatialReference,t,i,r)!=null}function tF(e,t,i,r,s){const{xmin:n,ymin:c,xmax:o,ymax:p,hasZ:g,hasM:S}=e,M=g?e.zmin:s;if(!Zk(n,c,M,t,hn,r))return null;const A=g||ph(r);i.xmin=hn[0],i.ymin=hn[1],A&&(i.zmin=hn[2]);const O=g?e.zmax:s;return Zk(o,p,O,t,hn,r)?(i.xmax=hn[0],i.ymax=hn[1],A&&(i.zmax=hn[2]),S&&(i.mmin=e.mmin,i.mmax=e.mmax),i.spatialReference=r,i):null}function iF(e,t,i,r,s,n,c=0){const o=new Array;for(const S of e)for(const M of S)o.push(M[0],M[1],t?M[2]:c);if(!w_(o,r,0,o,n,0,o.length/3))return!1;let p=0;s.length=0;const g=t||ph(n);for(const S of e){const M=new Array;for(const A of S)g&&i?M.push([o[p++],o[p++],o[p++],A[3]]):g?M.push([o[p++],o[p++],o[p++]]):i?(M.push([o[p++],o[p++],A[2]]),p++):(M.push([o[p++],o[p++]]),p++);s.push(M)}return!0}function qee(e){return e!=null&&hee(e)!=null}const hn=Th(),c0e=Object.freeze(Object.defineProperty({__proto__:null,canProjectToWGS84ComparableLonLat:qee,canProjectWithoutEngine:Dl,getTransformation:Jz,getTransformations:Dee,initializeProjection:u3,isLoaded:Mh,isLoadedOrLoad:Wz,isLoadedOrLoadFor:Zz,load:vh,project:Ah,projectExtent:Gee,projectMany:LE,projectMultipoint:Uee,projectOrLoad:Lee,projectOrLoadMany:Yz,projectPoint:Bee,projectPolygon:Vee,projectPolyline:jee,projectWithZConversion:Fee,projectWithoutEngine:Qv,requiresLoad:Oee,test:zee,tryProjectWithZConversion:J0,unload:Nee},Symbol.toStringTag,{value:"Module"}));var DE;let fl=DE=class extends At{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new DE({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};v([I({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fl.prototype,"cols",void 0),v([I({type:Er,json:{write:!0}})],fl.prototype,"level",void 0),v([I({type:String,json:{write:!0}})],fl.prototype,"levelValue",void 0),v([I({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fl.prototype,"origin",void 0),v([I({type:Number,json:{write:!0}})],fl.prototype,"resolution",void 0),v([I({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fl.prototype,"rows",void 0),v([I({type:Number,json:{write:!0}})],fl.prototype,"scale",void 0),fl=DE=v([me("esri.layers.support.LOD")],fl);const $c=fl;let rF=class{constructor(t,i,r,s,n=void 0){this.id=t,this.level=i,this.row=r,this.col=s,this.extent=n}};var $u;const Yk=new Ms({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let Us=$u=class extends At{static create(e={}){const{resolutionFactor:t=1,scales:i,size:r=256,spatialReference:s=mi.WebMercator,numLODs:n=24}=e;if(!Ba(s)){const M=[];if(i)for(let A=0;A<i.length;A++){const O=i[A];M.push(new $c({level:A,scale:O,resolution:O}))}else{let A=5e-4;for(let O=n-1;O>=0;O--)M.unshift(new $c({level:O,scale:A,resolution:A})),A*=2}return new $u({dpi:96,lods:M,origin:new ri(0,0,s),size:[r,r],spatialReference:s})}const c=to(s),o=e.origin?new ri({x:e.origin.x,y:e.origin.y,spatialReference:s}):new ri(c?{x:c.origin[0],y:c.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),p=96,g=1/(Ap(s)*39.37*p),S=[];if(i)for(let M=0;M<i.length;M++){const A=i[M],O=A*g;S.push(new $c({level:M,scale:A,resolution:O}))}else{let M=TA(s)?512/r*5916575275917094e-7:256/r*591657527591555e-6;const A=Math.ceil(n/t);S.push(new $c({level:0,scale:M,resolution:M*g}));for(let O=1;O<A;O++){const z=M/2**t,V=z*g;S.push(new $c({level:O,scale:z,resolution:V})),M=z}}return new $u({dpi:p,lods:S,origin:o,size:[r,r],spatialReference:s})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const i=to(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}readOrigin(e,t){return ri.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,i=0;const r=[],s=this._levelToLOD={};e&&(t=-1/0,i=1/0,e.forEach(n=>{r.push(n.scale),t=n.scale>t?n.scale:t,i=n.scale<i?n.scale:i,s[n.level]=n})),this._set("scales",r),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const i=Math.floor(e),r=i+1;return t[i]/(t[i]/t[r])**(e-i)}scaleToZoom(e){const t=this.scales,i=t.length-1;let r=0;for(;r<i;r++){const s=t[r],n=t[r+1];if(s<=e)return r;if(n===e)return r+1;if(s>e&&n<e)return r+Math.log(s/e)/Math.log(s/n)}return r}snapScale(e,t=.95){const i=this.scaleToZoom(e);return i%Math.floor(i)>=t?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(e,t,i,r){const s=this.lodAt(e);if(!s)return null;let n,c;if(typeof t=="number")n=t,c=i;else if(Hs(t.spatialReference,this.spatialReference))n=t.x,c=t.y,r=i;else{const g=yx(t,this.spatialReference);if(g==null)return null;n=g.x,c=g.y,r=i}const o=s.resolution*this.size[0],p=s.resolution*this.size[1];return r||(r=new rF(null,0,0,0,Xn())),r.level=e,r.row=Math.floor((this.origin.y-c)/p+.001),r.col=Math.floor((n-this.origin.x)/o+.001),this.updateTileInfo(r),r}updateTileInfo(e,t=$u.ExtrapolateOptions.NONE){let i=this.lodAt(e.level);if(!i&&t===$u.ExtrapolateOptions.POWER_OF_TWO){const c=this.lods[this.lods.length-1];c.level<e.level&&(i=c)}if(!i)return;const r=e.level-i.level,s=i.resolution*this.size[0]/2**r,n=i.resolution*this.size[1]/2**r;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=Xn()),e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*n,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+n}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||t.parentLevel===-1)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const i=this.lodAt(t.level);if(i==null)return null;const{resolution:r}=i,s=r*this.size[0],n=r*this.size[1];return e[0]=this.origin.x+t.col*s,e[1]=this.origin.y-(t.row+1)*n,e[2]=e[0]+s,e[3]=e[1]+n,e}lodAt(e){var t;return((t=this._levelToLOD)==null?void 0:t[e])??null}clone(){return $u.fromJSON(this.write({}))}getOrCreateCompatible(e,t){if(this.size[0]===256&&this.size[1]===256)return e===256?this:null;const i=[],r=this.lods.length;for(let s=0;s<r;s++){const n=this.lods[s],c=n.resolution*t;i.push(new $c({level:n.level,scale:n.scale,resolution:c}))}return new $u({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let i=0;i<e.length;i++){const r=e[i];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}};v([I({type:Number,json:{write:!0}})],Us.prototype,"compressionQuality",void 0),v([I({type:Number,json:{write:!0}})],Us.prototype,"dpi",void 0),v([I({type:String,json:{read:Yk.read,write:Yk.write,origins:{"web-scene":{read:!1,write:!1}}}})],Us.prototype,"format",void 0),v([I({readOnly:!0})],Us.prototype,"isWrappable",null),v([I({type:ri,json:{write:!0}})],Us.prototype,"origin",void 0),v([fi("origin")],Us.prototype,"readOrigin",null),v([I({type:[$c],value:null,json:{write:!0}})],Us.prototype,"lods",null),v([I({readOnly:!0})],Us.prototype,"scales",void 0),v([I({cast:e=>Array.isArray(e)?e:typeof e=="number"?[e,e]:[256,256]})],Us.prototype,"size",void 0),v([fi("size",["rows","cols"])],Us.prototype,"readSize",null),v([ci("size",{cols:{type:Er},rows:{type:Er}})],Us.prototype,"writeSize",null),v([I({type:mi,json:{write:!0}})],Us.prototype,"spatialReference",void 0),Us=$u=v([me("esri.layers.support.TileInfo")],Us),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(Us||(Us={}));const xp=Us,eb={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],r=t[1],s=this.values;return r>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},NS={xsmall:544,small:768,medium:992,large:1200};function Hee(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function zS(e,t){return t?eb[e].valueToClassName[t].split(" "):[]}const Wee=e=>{let t=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=NS}initialize(){this.addHandles(ti(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),mn))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i===this._get("breakpoints"))return;const r=Hee(i);if(!r){const s=JSON.stringify(NS,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s)}i=r?i:NS,this._set("breakpoints",{...i})}_updateClassNames(){if(!this.container)return;const i=kn.acquire(),r=kn.acquire();let s,n=!1;for(s in eb){const c=this[s],o=eb[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});c!==o&&(n=!0,this[s]=o,zS(s,c).forEach(p=>r.push(p)),zS(s,o).forEach(p=>i.push(p)))}n&&(this._applyClassNameChanges(i,r),kn.release(i),kn.release(r))}_applyClassNameChanges(i,r){const s=this.container;s&&(r.forEach(n=>s.classList.remove(n)),i.forEach(n=>s.classList.add(n)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in eb)zS(r,this[r]).forEach(s=>i.classList.remove(s))}};return v([I()],t.prototype,"breakpoints",null),v([I()],t.prototype,"orientation",void 0),v([I()],t.prototype,"widthBreakpoint",void 0),v([I()],t.prototype,"heightBreakpoint",void 0),t=v([me("esri.views.BreakpointsOwner")],t),t};function h3(e){return typeof e=="string"?document.getElementById(e):e??null}function sF(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function Jk(e,t){const i=t.parentNode;i&&i.insertBefore(e,t)}function Kk(e,t){for(;;){const i=e.firstChild;if(!i)break;t.appendChild(i)}}let op=class extends zt{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,i,r={}){return this._installWatch(t,i,r,ti)}addWhen(t,i,r={}){return this._installWatch(t,i,r,yh)}addOnCollectionChange(t,i,{initial:r=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([bp(t,"after-changes",this._createSyncUpdatingCallback(),wp),bp(t,"change",i,{onListenerAdd:r?c=>i({added:c.toArray(),removed:[]}):void 0,onListenerRemove:s?c=>i({added:[],removed:c.toArray()}):void 0})],n),Qi(()=>this.removeHandles(n))}addPromise(t){if(t==null)return t;const i=++this._handleId;this.addHandles(Qi(()=>{this._pendingPromises.delete(t)&&(this._pendingPromises.size!==0||this.hasHandles(pv)||this._set("updating",!1))}),i),this._pendingPromises.add(t),this._set("updating",!0);const r=()=>this.removeHandles(i);return t.then(r,r),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,i,r={},s){const n=++this._handleId;r.sync||this._installSyncUpdatingWatch(t,n);const c=s(t,i,r);return this.addHandles(c,n),Qi(()=>this.removeHandles(n))}_installSyncUpdatingWatch(t,i){const r=this._createSyncUpdatingCallback(),s=ti(t,r,{sync:!0,equals:()=>!1});return this.addHandles(s,i),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(pv),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(d_(()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(pv))}),pv)}}};v([I({readOnly:!0})],op.prototype,"updating",void 0),op=v([me("esri.core.support.UpdatingHandles")],op);const pv=-42;/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var Zee=function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},Dd={exports:{}},Pr={},K0={exports:{}},Cp={};function nF(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function Yee(e,t,i){}function Jee(e,t,i){}var Kee=/javascript\s*\:/img;function Xee(e,t){return Kee.test(t)?"":t}Cp.whiteList=nF();Cp.getDefaultWhiteList=nF;Cp.onAttr=Yee;Cp.onIgnoreAttr=Jee;Cp.safeAttrValue=Xee;var Qee={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,s;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,s=e.length;r<s;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},yg=Qee;function ete(e,t){e=yg.trimRight(e),e[e.length-1]!==";"&&(e+=";");var i=e.length,r=!1,s=0,n=0,c="";function o(){if(!r){var S=yg.trim(e.slice(s,n)),M=S.indexOf(":");if(M!==-1){var A=yg.trim(S.slice(0,M)),O=yg.trim(S.slice(M+1));if(A){var z=t(s,c.length,A,O,S);z&&(c+=z+"; ")}}}s=n+1}for(;n<i;n++){var p=e[n];if(p==="/"&&e[n+1]==="*"){var g=e.indexOf("*/",n+2);if(g===-1)break;n=g+1,s=n+1,r=!1}else p==="("?r=!0:p===")"?r=!1:p===";"?r||o():p===`
`&&o()}return yg.trim(c)}var tte=ete,fv=Cp,ite=tte;function Xk(e){return e==null}function rte(e){var t={};for(var i in e)t[i]=e[i];return t}function oF(e){e=rte(e||{}),e.whiteList=e.whiteList||fv.whiteList,e.onAttr=e.onAttr||fv.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||fv.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||fv.safeAttrValue,this.options=e}oF.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,s=i.onAttr,n=i.onIgnoreAttr,c=i.safeAttrValue,o=ite(e,function(p,g,S,M,A){var O=r[S],z=!1;if(O===!0?z=O:typeof O=="function"?z=O(M):O instanceof RegExp&&(z=O.test(M)),z!==!0&&(z=!1),M=c(S,M),!!M){var V={position:g,sourcePosition:p,source:A,isWhite:z};if(z){var W=s(S,M,V);return Xk(W)?S+":"+M:W}else{var W=n(S,M,V);if(!Xk(W))return W}}});return o};var ste=oF;(function(e,t){var i=Cp,r=ste;function s(c,o){var p=new r(o);return p.process(c)}t=e.exports=s,t.FilterCSS=r;for(var n in i)t[n]=i[n]})(K0,K0.exports);var d3={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,s;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,s=e.length;r<s;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,i=t.exec(e);return i?i.index:-1}},nte=K0.exports.FilterCSS,ote=K0.exports.getDefaultWhiteList,Ew=d3;function aF(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var lF=new nte;function ate(e,t,i){}function lte(e,t,i){}function cte(e,t,i){}function ute(e,t,i){}function cF(e){return e.replace(dte,"&lt;").replace(pte,"&gt;")}function hte(e,t,i,r){if(i=mF(i),t==="href"||t==="src"){if(i=Ew.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(t==="background"){if(mv.lastIndex=0,mv.test(i))return""}else if(t==="style"){if(Qk.lastIndex=0,Qk.test(i)||(eR.lastIndex=0,eR.test(i)&&(mv.lastIndex=0,mv.test(i))))return"";r!==!1&&(r=r||lF,i=r.process(i))}return i=yF(i),i}var dte=/</g,pte=/>/g,fte=/"/g,mte=/&quot;/g,yte=/&#([a-zA-Z0-9]*);?/gim,gte=/&colon;?/gim,_te=/&newline;?/gim,mv=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Qk=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,eR=/u\s*r\s*l\s*\(.*/gi;function uF(e){return e.replace(fte,"&quot;")}function hF(e){return e.replace(mte,'"')}function dF(e){return e.replace(yte,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function pF(e){return e.replace(gte,":").replace(_te," ")}function fF(e){for(var t="",i=0,r=e.length;i<r;i++)t+=e.charCodeAt(i)<32?" ":e.charAt(i);return Ew.trim(t)}function mF(e){return e=hF(e),e=dF(e),e=pF(e),e=fF(e),e}function yF(e){return e=uF(e),e=cF(e),e}function vte(){return""}function bte(e,t){typeof t!="function"&&(t=function(){});var i=!Array.isArray(e);function r(c){return i?!0:Ew.indexOf(e,c)!==-1}var s=[],n=!1;return{onIgnoreTag:function(c,o,p){if(r(c))if(p.isClosing){var g="[/removed]",S=p.position+g.length;return s.push([n!==!1?n:p.position,S]),n=!1,g}else return n||(n=p.position),"[removed]";else return t(c,o,p)},remove:function(c){var o="",p=0;return Ew.forEach(s,function(g){o+=c.slice(p,g[0]),p=g[1]}),o+=c.slice(p),o}}}function wte(e){for(var t="",i=0;i<e.length;){var r=e.indexOf("<!--",i);if(r===-1){t+=e.slice(i);break}t+=e.slice(i,r);var s=e.indexOf("-->",r);if(s===-1)break;i=s+3}return t}function xte(e){var t=e.split("");return t=t.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),t.join("")}Pr.whiteList=aF();Pr.getDefaultWhiteList=aF;Pr.onTag=ate;Pr.onIgnoreTag=lte;Pr.onTagAttr=cte;Pr.onIgnoreTagAttr=ute;Pr.safeAttrValue=hte;Pr.escapeHtml=cF;Pr.escapeQuote=uF;Pr.unescapeQuote=hF;Pr.escapeHtmlEntities=dF;Pr.escapeDangerHtml5Entities=pF;Pr.clearNonPrintableCharacter=fF;Pr.friendlyAttrValue=mF;Pr.escapeAttrValue=yF;Pr.onIgnoreTagStripAll=vte;Pr.StripTagBody=bte;Pr.stripCommentTag=wte;Pr.stripBlankChar=xte;Pr.cssFilter=lF;Pr.getDefaultCSSWhiteList=ote;var Lx={},Xu=d3;function Ste(e){var t=Xu.spaceIndex(e),i;return t===-1?i=e.slice(1,-1):i=e.slice(1,t+1),i=Xu.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function Tte(e){return e.slice(0,2)==="</"}function Ete(e,t,i){var r="",s=0,n=!1,c=!1,o=0,p=e.length,g="",S="";e:for(o=0;o<p;o++){var M=e.charAt(o);if(n===!1){if(M==="<"){n=o;continue}}else if(c===!1){if(M==="<"){r+=i(e.slice(s,o)),n=o,s=o;continue}if(M===">"){r+=i(e.slice(s,n)),S=e.slice(n,o+1),g=Ste(S),r+=t(n,r.length,g,S,Tte(S)),s=o+1,n=!1;continue}if(M==='"'||M==="'")for(var A=1,O=e.charAt(o-A);O.trim()===""||O==="=";){if(O==="="){c=M;continue e}O=e.charAt(o-++A)}}else if(M===c){c=!1;continue}}return s<e.length&&(r+=i(e.substr(s))),r}var Ite=/[^a-zA-Z0-9\\_:.-]/gim;function Mte(e,t){var i=0,r=0,s=[],n=!1,c=e.length;function o(A,O){if(A=Xu.trim(A),A=A.replace(Ite,"").toLowerCase(),!(A.length<1)){var z=t(A,O||"");z&&s.push(z)}}for(var p=0;p<c;p++){var g=e.charAt(p),S,M;if(n===!1&&g==="="){n=e.slice(i,p),i=p+1,r=e.charAt(i)==='"'||e.charAt(i)==="'"?i:Pte(e,p+1);continue}if(n!==!1&&p===r){if(M=e.indexOf(g,p+1),M===-1)break;S=Xu.trim(e.slice(r+1,M)),o(n,S),n=!1,p=M,i=p+1;continue}if(/\s|\n|\t/.test(g))if(e=e.replace(/\s|\n|\t/g," "),n===!1)if(M=Ate(e,p),M===-1){S=Xu.trim(e.slice(i,p)),o(S),n=!1,i=p+1;continue}else{p=M-1;continue}else if(M=Cte(e,p-1),M===-1){S=Xu.trim(e.slice(i,p)),S=tR(S),o(n,S),n=!1,i=p+1;continue}else continue}return i<e.length&&(n===!1?o(e.slice(i)):o(n,tR(Xu.trim(e.slice(i))))),Xu.trim(s.join(" "))}function Ate(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="="?t:-1}}function Pte(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="'"||i==='"'?t:-1}}function Cte(e,t){for(;t>0;t--){var i=e[t];if(i!==" ")return i==="="?t:-1}}function $te(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function tR(e){return $te(e)?e.substr(1,e.length-2):e}Lx.parseTag=Ete;Lx.parseAttr=Mte;var kte=K0.exports.FilterCSS,Ra=Pr,gF=Lx,Rte=gF.parseTag,Ote=gF.parseAttr,tb=d3;function yv(e){return e==null}function Lte(e){var t=tb.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=tb.trim(e.slice(t+1,-1));var i=e[e.length-1]==="/";return i&&(e=tb.trim(e.slice(0,-1))),{html:e,closing:i}}function Dte(e){var t={};for(var i in e)t[i]=e[i];return t}function Nte(e){var t={};for(var i in e)Array.isArray(e[i])?t[i.toLowerCase()]=e[i].map(function(r){return r.toLowerCase()}):t[i.toLowerCase()]=e[i];return t}function _F(e){e=Dte(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=Ra.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=Nte(e.whiteList||e.allowList):e.whiteList=Ra.whiteList,e.onTag=e.onTag||Ra.onTag,e.onTagAttr=e.onTagAttr||Ra.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||Ra.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||Ra.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||Ra.safeAttrValue,e.escapeHtml=e.escapeHtml||Ra.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new kte(e.css))}_F.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,s=i.onTag,n=i.onIgnoreTag,c=i.onTagAttr,o=i.onIgnoreTagAttr,p=i.safeAttrValue,g=i.escapeHtml,S=t.cssFilter;i.stripBlankChar&&(e=Ra.stripBlankChar(e)),i.allowCommentTag||(e=Ra.stripCommentTag(e));var M=!1;i.stripIgnoreTagBody&&(M=Ra.StripTagBody(i.stripIgnoreTagBody,n),n=M.onIgnoreTag);var A=Rte(e,function(O,z,V,W,ie){var ve={sourcePosition:O,position:z,isClosing:ie,isWhite:Object.prototype.hasOwnProperty.call(r,V)},pe=s(V,W,ve);if(!yv(pe))return pe;if(ve.isWhite){if(ve.isClosing)return"</"+V+">";var _e=Lte(W),Me=r[V],$e=Ote(_e.html,function(Fe,Ge){var et=tb.indexOf(Me,Fe)!==-1,at=c(V,Fe,Ge,et);return yv(at)?et?(Ge=p(V,Fe,Ge,S),Ge?Fe+'="'+Ge+'"':Fe):(at=o(V,Fe,Ge,et),yv(at)?void 0:at):at});return W="<"+V,$e&&(W+=" "+$e),_e.closing&&(W+=" /"),W+=">",W}else return pe=n(V,W,ve),yv(pe)?g(W):pe},g);return M&&(A=M.remove(A)),A};var zte=_F;(function(e,t){var i=Pr,r=Lx,s=zte;function n(o,p){var g=new s(p);return g.process(o)}t=e.exports=n,t.filterXSS=n,t.FilterXSS=s,function(){for(var o in i)t[o]=i[o];for(var p in r)t[p]=r[p]}();function c(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}c()&&(self.filterXSS=e.exports)})(Dd,Dd.exports);var Fte=function(){function e(t,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,c,o,p){return n==="a"&&c==="href"||(n==="img"||n==="source")&&c==="src"?r.sanitizeUrl(o):Dd.exports.safeAttrValue(n,c,o,p)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;t&&!i?s=t:t&&i?(s=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach(function(n){n==="whiteList"?s.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,t.whiteList||{}]):s[n]=t[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList),this.xssFilterOptions=s,this._xssFilter=new Dd.exports.FilterXSS(s)}return e.prototype.sanitize=function(t,i){switch(i===void 0&&(i={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,i);default:return i.allowUndefined&&typeof t>"u"?void 0:null}},e.prototype.sanitizeUrl=function(t,i){var r=(i??{}).isProtocolRequired,s=r===void 0?!0:r,n=this._trim(t.substring(0,t.indexOf(":"))),c=t==="/",o=/^#/.test(t),p=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return c||o||p?Dd.exports.escapeAttrValue(t):!n&&!s?Dd.exports.escapeAttrValue("https://".concat(t)):""},e.prototype.sanitizeHTMLAttribute=function(t,i,r,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(t,i,r,s):Dd.exports.safeAttrValue(t,i,r,s)},e.prototype.validate=function(t,i){i===void 0&&(i={});var r=this.sanitize(t,i);return{isValid:t===r,sanitized:r}},e.prototype.encodeHTML=function(t){var i=this;return String(t).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},e.prototype.encodeAttrValue=function(t){var i=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,function(r,s){return i.test(r)?r:"&#x".concat(Number(t.charCodeAt(s)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(t){var i={};return t.forEach(function(r){Object.keys(r).forEach(function(s){Array.isArray(r[s])&&Array.isArray(i[s])?i[s]=i[s].concat(r[s]):i[s]=r[s]})}),i},e.prototype._iterateOverObject=function(t,i){var r=this;i===void 0&&(i={});try{var s=!1,n=void 0;if(Array.isArray(t))n=t.reduce(function(o,p){var g=r.validate(p,i);return g.isValid?o.concat([p]):(s=!0,o.concat([g.sanitized]))},[]);else if(Zee(t)){var c=Object.keys(t);n=c.reduce(function(o,p){var g=t[p],S=r.validate(g,i);return S.isValid?o[p]=g:(s=!0,o[p]=S.sanitized),o},{})}else return i.allowUndefined&&typeof t>"u"?void 0:null;return s?n:t}catch{return null}},e.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},e}();const Dx=new Map;function vF(){Dx.clear()}function Bte(e){return Dx.get(e)}function Ute(e,t){Dx.set(e,t)}function FS(e){Dx.delete(e)}const jte=()=>_t.getLogger("esri.widgets.support.widgetUtils");function Vte(...e){const t=kn.acquire();for(let r=0;r<e.length;r++){const s=e[r],n=typeof s;if(n==="string")t.push(s);else if(Array.isArray(s))t.push.apply(t,s);else if(n==="object")for(const c in s)s[c]&&t.push(c)}const i=t.join(" ");return kn.release(t),i}(()=>{const e=new Map,t=new ResizeObserver(r=>{var s;vF();for(const n of r)(s=e.get(n.target))==null||s(n)}),i=(r,s,n)=>(e.has(r)&&jte().error("Already observing element",r),e.set(r,s),t.observe(r,n),Qi(()=>{t.unobserve(r),e.delete(r)}));return(r,s,n)=>{let c=null;return l_([ti(()=>typeof r=="function"?r():r,o=>{c==null||c.remove(),o&&(c=i(o,s,n))},Fa),Qi(()=>c==null?void 0:c.remove())])}})();function Gte(e){const t=e==null?void 0:e.closest("[dir]");return t!==null&&t instanceof HTMLElement&&t.dir==="rtl"||document.dir==="rtl"}function d0e(e){const t="data-node-ref";this[e.getAttribute(t)]=null}function p0e(e){const t="data-node-ref";this[e.getAttribute(t)]=e}const qte=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],Hte=qte.reduce((e,t)=>(e[t]=[],e),{}),Wte=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],bF=new Fte({whiteList:Hte,onTagAttr:(e,t,i)=>{const r=`${t}="${i}"`;if(Wte.includes(t))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Zte(e){return e==="Enter"||e===" "}const wF="http://www.w3.org/",Nx=`${wF}2000/svg`,xF=`${wF}1999/xlink`;let iR=[],p3=(e,t)=>{let i={};return Object.keys(e).forEach(r=>{i[r]=e[r]}),t&&Object.keys(t).forEach(r=>{i[r]=t[r]}),i},f3=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),SF=e=>{if(typeof e!="string")throw new Error("Style values must be strings")},Yte=(e,t,i)=>{if(t.vnodeSelector!==""){for(let r=i;r<e.length;r++)if(f3(e[r],t))return r}return-1},BS=(e,t,i,r)=>{let s=e[t];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let c=0;c<e.length;c++)if(c!==t){let o=e[c];if(f3(o,s))throw new Error(`${i.vnodeSelector} had a ${s.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},Jte=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},NE=[],zE=!1,TF=e=>{(e.children||[]).forEach(TF),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},rR=()=>{zE=!1,NE.forEach(TF),NE.length=0},sR=e=>{NE.push(e),zE||(zE=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(rR,{timeout:16}):setTimeout(rR,16))},nR=e=>{let t=e.domNode;if(e.properties){let i=e.properties.exitAnimation;if(i)return t.style.pointerEvents="none",void i(t,()=>{t.parentNode&&(t.parentNode.removeChild(t),sR(e))},e.properties)}t.parentNode&&(t.parentNode.removeChild(t),sR(e))},Kte=(e,t,i)=>{if(!t)return;let r=i.eventHandlerInterceptor,s=Object.keys(t),n=s.length;for(let c=0;c<n;c++){let o=s[c],p=t[o];if(o==="className")throw new Error('Property "className" is not supported, use "class".');if(o==="class")BE(e,p,!0);else if(o==="classes"){let g=Object.keys(p),S=g.length;for(let M=0;M<S;M++){let A=g[M];p[A]&&e.classList.add(A)}}else if(o==="styles"){let g=Object.keys(p),S=g.length;for(let M=0;M<S;M++){let A=g[M],O=p[A];O&&(SF(O),i.styleApplyer(e,A,O))}}else if(o!=="key"&&p!=null){let g=typeof p;g==="function"?(o.lastIndexOf("on",0)===0&&(r&&(p=r(o,p,e,t)),o==="oninput"&&function(){let S=p;p=function(M){S.apply(this,[M]),M.target["oninput-value"]=M.target.value}}()),e[o]=p):i.namespace===Nx?o==="href"?e.setAttributeNS(xF,o,p):e.setAttribute(o,p):g==="string"&&o!=="value"?o==="innerHTML"?e[o]=bF.sanitize(p):FE(e)&&o in e?e[o]=p:e.setAttribute(o,p):e[o]=p}}};function FE(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let Iw,Xte=(e,t,i)=>{if(t)for(let r of t)im(r,e,void 0,i)},EF=(e,t,i)=>{Xte(e,t.children,i),t.text&&(e.textContent=t.text),Kte(e,t.properties,i),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,i,t.vnodeSelector,t.properties,t.children])},im=(e,t,i,r)=>{let s,n=0,c=e.vnodeSelector,o=t.ownerDocument;if(c==="")s=e.domNode=o.createTextNode(e.text),i!==void 0?t.insertBefore(s,i):t.appendChild(s);else{for(let p=0;p<=c.length;++p){let g=c.charAt(p);if(p===c.length||g==="."||g==="#"){let S=c.charAt(n-1),M=c.slice(n,p);S==="."?s.classList.add(M):S==="#"?s.id=M:(M==="svg"&&(r=p3(r,{namespace:Nx})),r.namespace!==void 0?s=e.domNode=o.createElementNS(r.namespace,M):(s=e.domNode=e.domNode||o.createElement(M),M==="input"&&e.properties&&e.properties.type!==void 0&&s.setAttribute("type",e.properties.type)),i!==void 0?t.insertBefore(s,i):s.parentNode!==t&&t.appendChild(s)),n=p+1}}EF(s,e,r)}},BE=(e,t,i)=>{t&&t.split(" ").forEach(r=>{r&&e.classList.toggle(r,i)})},Qte=(e,t,i,r)=>{if(!i)return;let s=!1,n=Object.keys(i),c=n.length;for(let o=0;o<c;o++){let p=n[o],g=i[p],S=t[p];if(p==="class")S!==g&&(BE(e,S,!1),BE(e,g,!0));else if(p==="classes"){let M=e.classList,A=Object.keys(g),O=A.length;for(let z=0;z<O;z++){let V=A[z],W=!!g[V];W!==!!S[V]&&(s=!0,W?M.add(V):M.remove(V))}}else if(p==="styles"){let M=Object.keys(g),A=M.length;for(let O=0;O<A;O++){let z=M[O],V=g[z];V!==S[z]&&(s=!0,V?(SF(V),r.styleApplyer(e,z,V)):r.styleApplyer(e,z,""))}}else if(g||typeof S!="string"||(g=""),p!=="value"||FE(e)){if(g!==S){let M=typeof g;M==="function"&&r.eventHandlerInterceptor||(r.namespace===Nx?p==="href"?e.setAttributeNS(xF,p,g):e.setAttribute(p,g):M==="string"?p==="innerHTML"?e[p]=bF.sanitize(g):p==="role"&&g===""?e.removeAttribute(p):FE(e)&&p in e?e[p]=g:e.setAttribute(p,g):e[p]!==g&&(e[p]=g),s=!0)}}else{let M=e[p];M!==g&&(e["oninput-value"]?M===e["oninput-value"]:g!==S)&&(e[p]=g,e["oninput-value"]=void 0),g!==S&&(s=!0)}}return s},eie=(e,t,i,r,s)=>{if(i===r)return!1;r=r||iR;let n,c=(i=i||iR).length,o=r.length,p=0,g=0,S=!1;for(;g<o;){let M=p<c?i[p]:void 0,A=r[g];if(M!==void 0&&f3(M,A))S=Iw(M,A,s)||S,p++;else{let O=Yte(i,A,p+1);if(O>=0){for(n=p;n<O;n++)nR(i[n]),BS(i,n,e,"removed");S=Iw(i[O],A,s)||S,p=O+1}else im(A,t,p<c?i[p].domNode:void 0,s),Jte(A),BS(r,g,e,"added")}g++}if(c>p)for(n=p;n<c;n++)nR(i[n]),BS(i,n,e,"removed");return S};Iw=(e,t,i)=>{let r=e.domNode,s=!1;if(e===t)return!1;let n=!1;if(t.vnodeSelector===""){if(t.text!==e.text){let c=r.ownerDocument.createTextNode(t.text);return r.parentNode.replaceChild(c,r),t.domNode=c,s=!0,s}t.domNode=r}else t.vnodeSelector.lastIndexOf("svg",0)===0&&(i=p3(i,{namespace:Nx})),e.text!==t.text&&(n=!0,t.text===void 0?r.removeChild(r.firstChild):r.textContent=t.text),t.domNode=r,n=eie(t,r,e.children,t.children,i)||n,n=Qte(r,e.properties,t.properties,i)||n,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[r,i,t.vnodeSelector,t.properties,t.children]);return n&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(r,t.properties,e.properties),s};let gg=(e,t)=>({getLastRender:()=>e,update:i=>{if(e.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=e;e=i,Iw(r,i,t)},domNode:e.domNode});const tie={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{t.charAt(0)==="-"?e.style.setProperty(t,i):e.style[t]=i}};let kf=e=>p3(tie,e),ah={create:(e,t)=>(t=kf(t),im(e,document.createElement("div"),void 0,t),gg(e,t)),append:(e,t,i)=>(i=kf(i),im(t,e,void 0,i),gg(t,i)),insertBefore:(e,t,i)=>(i=kf(i),im(t,e.parentNode,e,i),gg(t,i)),merge:(e,t,i)=>(i=kf(i),t.domNode=e,EF(e,t,i),gg(t,i)),replace:(e,t,i)=>(i=kf(i),im(t,e.parentNode,e,i),e.parentNode.removeChild(e),gg(t,i))},IF,iie=(e,t)=>{let i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i};IF=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let rie=(e,t)=>{let i=e;return t.forEach(r=>{i=i&&i.children?IF(i.children,s=>s.domNode===r):void 0}),i},sie=(e,t,i)=>{let r=function(s){i("domEvent",s);let n=t(),c=iie(s.currentTarget,n.domNode);c.reverse();let o,p=rie(n.getLastRender(),c);return e.scheduleRender(),p&&(o=p.properties[`on${s.type}`].apply(p.properties.bind||this,arguments)),i("domEventProcessed",s),o};return(s,n,c,o)=>r},oR=e=>{let t,i,r=kf(e),s=r.performanceLogger,n=!0,c=!1,o=[],p=[],g=(M,A,O)=>{let z,V=()=>z;r.eventHandlerInterceptor=sie(t,V,s),z=M(A,O(),r),o.push(z),p.push(O)},S=()=>{if(i=void 0,n){n=!1,s("renderStart",void 0);for(let M=0;M<o.length;M++){let A=p[M]();s("rendered",void 0),o[M].update(A),s("patched",void 0)}s("renderDone",void 0),n=!0}};return t={renderNow:S,scheduleRender:()=>{i||c||(i=requestAnimationFrame(S))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),c=!0},resume:()=>{c=!1,n=!0,t.scheduleRender()},append:(M,A)=>{g(ah.append,M,A)},insertBefore:(M,A)=>{g(ah.insertBefore,M,A)},merge:(M,A)=>{g(ah.merge,M,A)},replace:(M,A)=>{g(ah.replace,M,A)},detach:M=>{for(let A=0;A<p.length;A++)if(p[A]===M)return p.splice(A,1),o.splice(A,1)[0];throw new Error("renderFunction was not found")}},t},ku=class extends zt{constructor(){super(...arguments),this.items=new Ut,this._watchUpdatingTracking=new op,this._callbacks=new Map,this._projector=oR(),this._hiddenProjector=oR()}get needsRender(){return this.items.length>0}get updating(){var t;return((t=this._watchUpdatingTracking)==null?void 0:t.updating)??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const r of i.added){const s=()=>r.render();this._callbacks.set(r,s),this._projector.append(this.surface,s)}for(const r of i.removed){const s=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(s.domNode),this._callbacks.delete(r)}})}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach(t=>this._projector.detach(t)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const i=this._hiddenSurface,r=this._hiddenProjector;let s;const n=()=>(s=t.render(),s);r.append(i,n),r.renderNow();const c={left:0,top:0,right:0,bottom:0};if(s!=null&&s.domNode){const o=s.domNode.getBoundingClientRect();c.left=o.left,c.top=o.top,c.right=o.right,c.bottom=o.bottom}for(r.detach(n);i.firstChild;)i.removeChild(i.firstChild);return c}overlaps(t,i){const r=this.computeBoundingRect(t),s=this.computeBoundingRect(i);return Math.max(r.left,s.left)<=Math.min(r.right,s.right)&&Math.max(r.top,s.top)<=Math.min(r.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(t=>t.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(t,i){const r=!!(i!=null&&i.disableDecorations);if(!this.items.some(n=>n.visible&&!(r&&n.isDecoration)))return;const s=t.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(n=>{r&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};v([I({readOnly:!0})],ku.prototype,"surface",void 0),v([I({readOnly:!0})],ku.prototype,"items",void 0),v([I({readOnly:!0})],ku.prototype,"needsRender",null),v([I({readOnly:!0})],ku.prototype,"_watchUpdatingTracking",void 0),v([I({readOnly:!0})],ku.prototype,"updating",null),ku=v([me("esri.views.overlay.ViewOverlay")],ku);const aR=ku,US=[0,0];function nie(e){const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return US[0]=i.left+((t==null?void 0:t.pageXOffset)??0),US[1]=i.top+((t==null?void 0:t.pageYOffset)??0),US}function lR(e){e&&(sF(e),e.parentNode&&e.parentNode.removeChild(e))}function oie(e){const t=document.createElement("div");return e.appendChild(t),t}const _g=16,gv=750,aie=512,lie=2,cie=e=>{let t=class extends e{constructor(...i){super(...i),this._freqInfo={freq:_g,time:gv},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ti(()=>this.cursor,r=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",r)}),ti(()=>this.navigating,r=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",r.toString())})])}initialize(){const i=Le("mac"),r=async()=>{i&&(await Ix(()=>this.ready),this.messagesCommon=await OA("esri/t9n/common").catch(()=>{}))};r(),this.addHandles([ti(()=>this.ui,(s,n)=>this._handleUIChange(s,n),mn),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused")),AA(r),ti(()=>[this.surface,this.messagesCommon],()=>{var s,n,c;i&&((c=this.surface)==null||c.setAttribute("aria-label",((n=(s=this.messagesCommon)==null?void 0:s.ariaLabels)==null?void 0:n.navigationMacVoiceOver)??""))})])}destroy(){this.destroyed||(this.ui=nr(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const r=this._get("container"),s=h3(i);if(s||typeof i!="string"||_t.getLogger(this).error("#container",`element with id '${i}' not found`),r===s)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(lR(this.root),this._set("root",null)),this.userContent&&(Kk(this.userContent,r),lR(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",Kk(s,n),s.appendChild(n),this._set("userContent",n);const c=document.createElement("div");c.className="esri-view-root",s.insertBefore(c,s.firstChild),this._set("root",c);const o=document.createElement("div");o.className="esri-view-surface",o.setAttribute("role","application"),o.tabIndex=0,c.appendChild(o),this._set("surface",o);const p=new aR;c.appendChild(p.surface),this._set("overlay",p),this.addHandles(ti(()=>p.needsRender,g=>{g&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Sm({render:()=>{var S;return(S=this.overlay)==null?void 0:S.render()}}):this._overlayRenderTaskHandle=gr(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,r,s){const n=this.position;return i-=n?n[0]:0,r-=n?n[1]:0,s?(s[0]=i,s[1]=r):s=[i,r],s}containerToPage(i,r,s){const n=this.position;return i+=n?n[0]:0,r+=n?n[1]:0,s?(s[0]=i,s[1]=r):s=[i,r],s}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(ti(()=>this.root,s=>{i.container=s?oie(s):null},mn),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=_g,i.time=gv,this.addHandles([h_(window,"resize",()=>{i.freq=_g,i.time=gv}),Sm({prepare:r=>{const s=this._measure(),n=this._freqInfo;if(n.time+=r.deltaTime,s&&(n.freq=_g,this._get("resizing")||this._set("resizing",!0)),n.time<n.freq)return;n.time=0;const c=this._position();n.freq=c||s?_g:Math.min(gv,n.freq*lie),!s&&n.freq>=aie&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,s=i?i.clientHeight:0;if(r===0||s===0)return this.suspended||this._set("suspended",!0),!1;const n=this.width,c=this.height;return r===n&&s===c?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:c,width:r,height:s}),!0)}_position(){const i=this.container,r=this.position,s=i&&nie(i);return!!s&&(!r||s[0]!==r[0]||s[1]!==r[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return v([I()],t.prototype,"container",null),v([I({readOnly:!0})],t.prototype,"focused",null),v([I({readOnly:!0})],t.prototype,"height",void 0),v([I()],t.prototype,"messagesCommon",void 0),v([I({type:aR})],t.prototype,"overlay",void 0),v([I({readOnly:!0})],t.prototype,"position",void 0),v([I({readOnly:!0})],t.prototype,"resizing",void 0),v([I({readOnly:!0})],t.prototype,"root",void 0),v([I({value:null,readOnly:!0})],t.prototype,"size",null),v([I({readOnly:!0})],t.prototype,"surface",void 0),v([I({readOnly:!0})],t.prototype,"suspended",void 0),v([I()],t.prototype,"ui",void 0),v([I({readOnly:!0})],t.prototype,"userContent",void 0),v([I({readOnly:!0})],t.prototype,"width",void 0),v([I()],t.prototype,"widthBreakpoint",void 0),t=v([me("esri.views.DOMContainer")],t),t};let uie=class{constructor(t,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in t){const s=t[r],n=new Y5(s,void 0,void 0,2,2);this._properties[r]={pool:n,acquired:[]}}this._afterDispatchHandle=FG(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const i=this._properties[t];for(const r of i.acquired)d$(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(t){const i=this._owner._get(t),r=this._properties[t];let s=r.pool.acquire();for(r.acquired.push(s);s===i;)r.acquired.push(s),s=r.pool.acquire();return s}_release(){for(const t in this._properties){const i=this._properties[t];let r=0;for(const s of i.acquired)d$(s)?i.acquired[r++]=s:i.pool.release(s);i.acquired.length=r}}};const hie=Le("mac")?"Meta":"Ctrl",die=new Set(["Alt","Ctrl","Meta","Shift","Primary"]),pie=e=>die.has(e);let fie=class{constructor(t,i=[]){this.eventType=t,this.keyModifiers=i}matches(t){if(t.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=t.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}};const cR=()=>_t.getLogger("esri.views.input.InputHandler");let ps=class{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const i=this._incoming[t];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(t=>t.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?cR().error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback(i=>this._handleEvent(i)),t.setUninstallCallback(()=>this._onUninstall()),this._manager=t)}onUninstall(){}registerIncoming(t,i,r){let s;typeof i=="function"?(r=i,s=[]):s=i||[];const n=typeof t=="string"?new fie(t,s):t,c=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=S=>{const M=this._incoming[S.match.eventType];if(M){const A=M.indexOf(S);M.splice(A,1),c(),this._manager&&this._manager.updateDependencies()}},p=new mie(n,r,{onPause:o,onRemove:o,onResume:S=>{const M=this._incoming[S.match.eventType];M&&!M.includes(S)&&(M.push(S),c(),this._manager&&this._manager.updateDependencies())}});let g=this._incoming[n.eventType];return g||(g=[],this._incoming[n.eventType]=g),g.push(p),c(),this._manager&&this._manager.updateDependencies(),p}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const i=new yie(t,{onEmit:(r,s,n,c)=>{var o;(o=this._manager)==null||o.emit(r.eventType,s,n,c)},onRemove:r=>{var s;delete this._outgoing[r.eventType],(s=this._manager)==null||s.updateDependencies()}});return this._outgoing[t]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(t){var i;(i=this._manager)==null||i.setPointerCapture(t,!0)}stopCapturingPointer(t){var i;(i=this._manager)==null||i.setPointerCapture(t,!1)}refreshHasPendingInputs(){var t;(t=this._manager)==null||t.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):cR().error("This InputHandler is not registered with an InputManager")}_handleEvent(t){var r;const i=this._incoming[t.type];if(i){for(const s of i)if(s.match.matches(t)&&((r=s.callback)==null||r.call(s,t),t.shouldStopPropagation()))break}}},mie=class{constructor(t,i,r){this.match=t,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},yie=class{constructor(t,i){this.eventType=t,this._removed=!1,this._handler=i}emit(t,i,r){this._removed||this._handler.onEmit(this,t,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},gie=class extends ps{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(t){const i=t.native.pointerType==="touch"?"touch":"mouse",{x:r,y:s}=t;i===this._value&&this._x===r&&this._y===s||(this._value=i,this._x=r,this._y=s,this._onChange(i,r,s))}},_ie=class{constructor(t,i){this._observable=new f_,this._value=t,this._equalityFunction=i}get value(){return Ot(this._observable),this._value}set value(t){this._equalityFunction(t,this._value)||(this._value=t,this._observable.notify())}mutate(t){t(this._value),this._observable.notify()}};function MF(e,t=P5){return new _ie(e,t)}let vie=class extends ps{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=MF(!1),this._onPointerAdd=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Vo=class extends zt{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=hie,this._latestPointerType="mouse",this._propertiesPool=new uie({latestPointerLocation:xie},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const i of t)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(t=>t.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(t,i,r=ch.INTERNAL){if(this._nameToGroup[t])return void _t.getLogger(this).error("There is already an InputHandler group registered under the name `"+t+"`");if(i.length===0)return void _t.getLogger(this).error("Can't register a group of zero handlers");const s={name:t,handlers:i.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[t]=s;for(let n=s.handlers.length-1;n>=0;n--){const c=s.handlers[n];this._handlers.push(c),c.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(o,p,g,S,M)=>{this._emitInputEvent(c.priorityIndex+1,o,p,g,M,S)},setPointerCapture:(o,p)=>{this._setPointerCapture(s,c,o,p)},setEventCallback:o=>{c.eventCallback=o},setUninstallCallback:o=>{c.uninstallCallback=o},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const i=this._nameToGroup[t];i?(i.handlers.forEach(r=>{var s;r.removed=!0,(s=r.uninstallCallback)==null||s.call(r)}),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):_t.getLogger(this).error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return this._nameToGroup[t]!==void 0}isModifierKeyDown(t){return this._activeKeyModifiers&&this._activeKeyModifiers.has(t)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,i=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const s=this._handlers[r];s.priorityIndex=r,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const s=this._handlersPriority[r];s.priorityIndex=r;let n=s.handler.hasSideEffects;if(!n){for(const c of s.handler.outgoingEventTypes)if(t.has(c)){n=!0;break}}if(n)for(const c of s.handler.incomingEventMatches){t.add(c.eventType);for(const o of c.keyModifiers)pie(o)||i.add(o)}s.active=n}this._sourceEvents=t,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(t,i,r){this._latestPointerType=t;const s=this._get("latestPointerLocation");if(s==null||s.x!==i||s.y!==r){const n=this._propertiesPool.get("latestPointerLocation");n.x=i,n.y=r,this._set("latestPointerLocation",n)}}_onEventReceived(t,i){if(t==="pointer-capture-lost"){const n=i;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(t,i);const r=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,s=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(t,i,r,s)}_updateKeyModifiers(t,i){if(!i)return;let r=!1;const s=()=>{if(!r){const o=new Set;this._activeKeyModifiers.forEach(p=>{o.add(p)}),this._activeKeyModifiers=o,r=!0}},n=(o,p)=>{p&&!this._activeKeyModifiers.has(o)?(s(),this._activeKeyModifiers.add(o)):!p&&this._activeKeyModifiers.has(o)&&(s(),this._activeKeyModifiers.delete(o))};if(t==="key-down"||t==="key-up"){const o=i.key;this._keyModifiers.has(o)&&n(o,t==="key-down")}const c=i.native;n("Alt",!(!c||!c.altKey)),n("Ctrl",!(!c||!c.ctrlKey)),n("Shift",!(!c||!c.shiftKey)),n("Meta",!(!c||!c.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new gie((t,i,r)=>this._setLatestPointer(t,i,r)),this._multiTouchHandler=new vie,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],ch.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,ch.INTERNAL)}_setPointerCapture(t,i,r,s){const n=t.name+"-"+i.priorityIndex,c=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,c),s?(c.add(n),c.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):c.has(n)&&(c.delete(n),c.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(t=>!t.removed),this.updateDependencies()}_emitInputEventFromSource(t,i,r,s){this._emitInputEvent(0,t,i,r,s)}_emitInputEvent(t,i,r,s,n,c){const o=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),p=n!==void 0&&n,g={event:new bie(i,r,o,c||this._activeKeyModifiers,p),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(g):this._doNewPropagation(g)}_doNewPropagation(t){this._currentPropagation={events:new vw,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){var i,r,s;this._paused=!1;const t=this._currentPropagation;if(t){for(;t.events.length>0;){const{event:n,priorityIndex:c}=t.events.pop(),o=(i=n.data)==null?void 0:i.eventId;if(!(o!=null&&this._stoppedPropagationEventIds.has(o)))for(t.currentHandler=this._handlersPriority[c];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!n.shouldStopPropagation()&&((s=(r=t.currentHandler).eventCallback)==null||s.call(r,n)),n.shouldStopPropagation()){o!=null&&this._stoppedPropagationEventIds.add(o);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const i=new vw;i.push(t);const r=this._currentPropagation;if(r){for(;r.events.length;)i.push(r.events.pop());r.events=i,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(t,i){if(t.handler.hasSideEffects!==i.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==i.groupPriority)return t.groupPriority>i.groupPriority?-1:1;for(const r of t.handler.incomingEventMatches)for(const s of i.handler.incomingEventMatches){if(r.eventType!==s.eventType)continue;const n=r.keyModifiers.filter(c=>s.keyModifiers.includes(c));if(n.length===r.keyModifiers.length!=(n.length===s.keyModifiers.length))return r.keyModifiers.length>s.keyModifiers.length?-1:1}return t.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(t){const i=[];for(const r of t){let s=0;for(;s<i.length&&this._compareHandlerPriority(r,i[s])>=0;)s++;i.splice(s,0,r)}return i}get debug(){const t=i=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=r};return{injectEvent:(i,r)=>{t(()=>{this._onEventReceived(i,r)})},disablePointerCapture:t}}};v([I({readOnly:!0})],Vo.prototype,"hasPendingInputs",null),v([I({constructOnly:!0})],Vo.prototype,"eventSource",void 0),v([I({constructOnly:!0})],Vo.prototype,"recognizers",void 0),v([I()],Vo.prototype,"_latestPointerType",void 0),v([I()],Vo.prototype,"latestPointerType",null),v([I()],Vo.prototype,"multiTouchActive",null),v([I({readOnly:!0})],Vo.prototype,"latestPointerLocation",void 0),v([I()],Vo.prototype,"_paused",void 0),v([I({readOnly:!0})],Vo.prototype,"updating",null),Vo=v([me("esri.views.input.InputManager")],Vo);let bie=class{constructor(t,i,r,s,n){this.type=t,this.data=i,this.timestamp=r,this.modifiers=s,this.cancelable=n,this._propagationState=Qu.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Qu.STOPPED}shouldStopPropagation(){return(this._propagationState&Qu.STOPPED)!=0}async(t){this._propagationState|=Qu.PAUSED;const i=(r,s)=>{this._propagationState&=~Qu.PAUSED;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw r;return r};return(typeof t=="function"?t():t).then(r=>i(r,!1),r=>i(r,!0))}shouldPausePropagation(t){return!!(this._propagationState&Qu.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}};var Qu;(function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED"})(Qu||(Qu={}));const ch={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let wie=class{};const xie=wie;function cl(e){return e!=null&&"open"in e&&"declaredClass"in e}function uR(e){return e!=null&&"declaredClass"in e&&"dockOptions"in e}const Sie=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ti(()=>[this.ui,this.popup],([i,r],s)=>{const n="popup",c="manual";if(s){const[o,p]=s;o&&cl(p)&&(p.view=null,uR(p)&&o.remove(p,n))}i&&cl(r)&&(r.view=this,uR(r)&&i.add(r,{key:n,position:c,internal:!0}))},mn),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(!cl(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(cl(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),cl(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))},ch.WIDGET)]),Ix(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{ht(()=>import("./Popup-DTYUVOhB.js"),__vite__mapDeps([116,1,117,118,13,93,119,79,120,121,71,101,122,123,124,125,126,34,32,127,11,12,128,62,60,61,22,25,63,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,81,38,145,146,147,148,149,150,151,152,153,154,155,6,156,157]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(cl(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void _t.getLogger(this).error(new Je("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),cl(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,r){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,r),r)}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!cl(this.popup))return this._popupSetupTask=px(async r=>{const{default:s}=await ht(()=>import("./Popup-DTYUVOhB.js"),__vite__mapDeps([116,1,117,118,13,93,119,79,120,121,71,101,122,123,124,125,126,34,32,127,11,12,128,62,60,61,22,25,63,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,81,38,145,146,147,148,149,150,151,152,153,154,155,6,156,157]));if(dr(r),!this.popup||cl(this.popup))return;const n=this.popup;delete n.open,delete n.close,this.popup=new s(n)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:r},s){const n=[],c=[];let o=!1;const p=yG(s,Le("popup-view-fetch-timeout")??Eie),g=A=>{const O=new Tie(A);return c.push(O),n.push(O.promise),O},S=A=>{const O=c.at(-1);return O&&O.layerView===A&&!o?O:g(A)};for(const A of r)"graphic"in A?(S(A.layerView).graphics.push(A.graphic),o=!1):(n.push(A.layerView.fetchPopupFeaturesAtLocation(A.mapPoint,p)),o=!0);c.map(A=>A.resolve(p));const M=mG(n).then(A=>A.filter(O=>!!O).flat());return{pendingFeatures:n,allGraphicsPromise:M,location:i}}async _getPopupHits(i,r){const{hits:s,location:n}=await this.popupHitTest(i);dr(r);const c=[];for(const o of s)if("graphic"in o){if(this._isValidPopupGraphic(o.graphic,r)){const p=this._isValidPopupGraphicsLayerView(o.layerView)?o.layerView:void 0;c.push({graphic:o.graphic,layerView:p})}}else this._isValidPopupLocationLayerView(o.layerView)&&c.push({mapPoint:o.mapPoint,layerView:o.layerView});return{hits:c,location:n}}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r!=null&&r.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return v([I({cast(i){return!i||cl(i)||typeof i=="object"&&(i.open=r=>(xm(_t.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(r)),i.close=()=>(xm(_t.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],t.prototype,"popup",void 0),v([I()],t.prototype,"popupEnabled",void 0),t=v([me("esri.views.PopupView")],t),t};let Tie=class{constructor(t){this.layerView=t,this._resolver=sa(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:i,graphics:r,_resolver:s}=this;if(!i)return s.resolve(r),s.promise;let n;return i.fetchPopupFeaturesFromGraphics(r,t).catch(c=>(n=c,null)).then(c=>{c?s.resolve(c):s.reject(n)}),s.promise}};const Eie=5e3,hR={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function ap(e,t,i,r=Ll){const s=new Ya(o3(r)),n=Kt.fromJSDate(e,{zone:s}),c=i==="decades"||i==="centuries"?"year":AF(i);return i==="decades"&&(t*=10),i==="centuries"&&(t*=100),n.plus({[c]:t}).toJSDate()}function dR(e,t,i=Ll){const r=new Ya(o3(i)),s=Kt.fromJSDate(e,{zone:r});if(t==="decades"||t==="centuries"){const c=s.startOf("year"),{year:o}=c,p=o-o%(t==="decades"?10:100);return c.set({year:p}).toJSDate()}const n=AF(t);return s.startOf(n).toJSDate()}function M0e(e,t,i){return e===0?0:e*hR[t]/hR[i]}function AF(e){switch(e){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Ia;let go=Ia=class extends At{static get allTime(){return pR}static get empty(){return Iie}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return t.end!=null?new Date(t.end):null}writeEnd(e,t){t.end=(e==null?void 0:e.getTime())??null}get isAllTime(){return this.equals(Ia.allTime)}get isEmpty(){return this.equals(Ia.empty)}readStart(e,t){return t.start!=null?new Date(t.start):null}writeStart(e,t){t.start=(e==null?void 0:e.getTime())??null}clone(){return new Ia({end:this.end,start:this.start})}equals(e){var n,c,o,p;if(!e)return!1;const t=((n=this.start)==null?void 0:n.getTime())??this.start,i=((c=this.end)==null?void 0:c.getTime())??this.end,r=((o=e.start)==null?void 0:o.getTime())??e.start,s=((p=e.end)==null?void 0:p.getTime())??e.end;return t===r&&i===s}expandTo(e,t=Ll){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=dR(i,e,t));let r=this.end;if(r){const s=dR(r,e,t);r=r.getTime()===s.getTime()?s:ap(s,1,e,t)}return new Ia({start:i,end:r})}intersection(e){var o,p,g,S;if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Ia.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=((o=this.start)==null?void 0:o.getTime())??-1/0,i=((p=this.end)==null?void 0:p.getTime())??1/0,r=((g=e.start)==null?void 0:g.getTime())??-1/0,s=((S=e.end)==null?void 0:S.getTime())??1/0;let n,c;if(r>=t&&r<=i?n=r:t>=r&&t<=s&&(n=t),i>=r&&i<=s?c=i:s>=t&&s<=i&&(c=s),n!=null&&c!=null&&!isNaN(n)&&!isNaN(c)){const M=new Ia;return M.start=n===-1/0?null:new Date(n),M.end=c===1/0?null:new Date(c),M}return Ia.empty}offset(e,t,i=Ll){if(this.isEmpty||this.isAllTime)return this.clone();const r=new Ia,{start:s,end:n}=this;return s!=null&&(r.start=ap(s,e,t,i)),n!=null&&(r.end=ap(n,e,t,i)),r}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return pR.clone();const t=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Ia({start:t,end:i})}};v([I({type:Date,json:{write:{allowNull:!0}}})],go.prototype,"end",void 0),v([fi("end")],go.prototype,"readEnd",null),v([ci("end")],go.prototype,"writeEnd",null),v([I({readOnly:!0,json:{read:!1}})],go.prototype,"isAllTime",null),v([I({readOnly:!0,json:{read:!1}})],go.prototype,"isEmpty",null),v([I({type:Date,json:{write:{allowNull:!0}}})],go.prototype,"start",void 0),v([fi("start")],go.prototype,"readStart",null),v([ci("start")],go.prototype,"writeStart",null),go=Ia=v([me("esri.TimeExtent")],go);const pR=new go,Iie=new go({start:void 0,end:void 0}),x_=go;let w0=class extends Ut{constructor(t){super(t),this.addHandles([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(Ut.ofType(this.itemType.Type))(t):new Ut(t)}};function fR(e,t){return{type:e,cast:W4,set(i){const r=dp(i,this._get(t),e);r.owner=this,this._set(t,r)}}}v([I()],w0.prototype,"owner",null),w0=v([me("esri.core.support.OwningCollection")],w0);var Pg;const Mw=Fn()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),PF=Mw.jsonValues.slice();v7(PF,"orthometric");const x0=Fn()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Ma=Pg=class extends At{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return Mw.write(e,t,i)}readHeightModel(e,t,i){return Mw.read(e)||(i!=null&&i.messages&&i.messages.push(Mie(e,{context:i})),null)}readHeightUnit(e,t,i){return x0.read(e)||(i!=null&&i.messages&&i.messages.push(mR(e,{context:i})),null)}readHeightUnitService(e,t,i){return oN(e)||x0.read(e)||(i!=null&&i.messages&&i.messages.push(mR(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new Pg({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=pW(t);return new Pg({heightModel:e.heightModel,heightUnit:i??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new Pg;return t.read(e,{origin:"web-scene"}),t}};function mR(e,t){return new jc("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}function Mie(e,t){return new jc("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}v([I({type:Mw.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:PF,default:"ellipsoidal"}}}})],Ma.prototype,"heightModel",void 0),v([ci("web-scene","heightModel")],Ma.prototype,"writeHeightModel",null),v([fi(["web-scene","service"],"heightModel")],Ma.prototype,"readHeightModel",null),v([I({type:x0.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:x0.jsonValues,write:x0.write}}}})],Ma.prototype,"heightUnit",void 0),v([fi("web-scene","heightUnit")],Ma.prototype,"readHeightUnit",null),v([fi("service","heightUnit")],Ma.prototype,"readHeightUnitService",null),v([I({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Ma.prototype,"vertCRS",void 0),v([fi("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Ma.prototype,"readVertCRS",null),Ma=Pg=v([me("esri.geometry.HeightModelInfo")],Ma);const m3=Ma;let Aw=class extends w0{constructor(t){super(t),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(_t.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};Aw=v([me("esri.support.AnalysesCollection")],Aw);async function Aie(e,t){const{WhereClause:i}=await ht(()=>import("./WhereClause-BX2Ta_r9.js").then(r=>r.W),__vite__mapDeps([30,31,32]));return i.create(e,t)}function C0e(e,t){return e!=null&&e!==""?t!=null&&t!==""?`(${e}) AND (${t})`:e:t}function $0e(e){return typeof e=="number"}function y3(e){return typeof e=="string"||e instanceof String}const Pie="yyyy-MM-dd",Cie="TT";var S0;(function(e){e.HM="HH:mm",e.HMS="HH:mm:ss",e.HMS_MS="HH:mm:ss.SSS"})(S0||(S0={}));const $ie=[S0.HMS_MS,S0.HMS,S0.HM,Cie];function yR(e){if(!e||!y3(e))return null;const t=Kt.fromFormat(e,Pie);return t.isValid?t:null}function gR(e){return e&&y3(e)?F7($ie,t=>{const i=Kt.fromFormat(e,t);return i.isValid?i:null})??null:null}function _R(e){if(!e||!y3(e))return null;const t=Kt.fromISO(e);return t.isValid?t:null}var Rm;(function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(Rm||(Rm={}));const kie=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function Rie(e){return e!=null&&kie.has(e.type)}function CF(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function $F(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function kF(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function Oie(e,t){const i=e==null?void 0:e.domain;if(!i)return null;switch(i.type){case"range":{const{min:r,max:s}=Lie(e);if(r!=null&&+t<r||s!=null&&+t>s)return Rm.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(i.codedValues==null||i.codedValues.every(r=>r==null||r.code!==t))return Rm.INVALID_CODED_VALUE}return null}function Lie(e,t){const i=t??(e==null?void 0:e.domain);if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,s="range"in i?i.range[1]:i.maxValue,n=Rie(e);return CF(e)||kF(e)||$F(e)?{...Die(e,s,r),isInteger:n}:{min:r!=null&&typeof r=="number"?r:null,max:s!=null&&typeof s=="number"?s:null,rawMin:r,rawMax:s,isInteger:n}}function Die(e,t,i){var r,s,n,c,o,p;return CF(e)?{min:(r=yR(i))==null?void 0:r.toMillis(),max:(s=yR(t))==null?void 0:s.toMillis(),rawMin:i,rawMax:t}:kF(e)?{min:(n=gR(i))==null?void 0:n.toMillis(),max:(c=gR(t))==null?void 0:c.toMillis(),rawMin:i,rawMax:t}:$F(e)?{min:(o=_R(i))==null?void 0:o.toMillis(),max:(p=_R(t))==null?void 0:p.toMillis(),rawMin:i,rawMax:t}:{max:null,min:null}}const Nie=()=>_t.getLogger("esri.support.arcadeOnDemand");let jS;function RF(){return jS||(jS=(async()=>{const e=await ht(()=>import("./arcadeUtils-DMrFbmdl.js").then(t=>t.aK),__vite__mapDeps([158,31,32,159,36,24,22,25,34]));return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),jS}const k0e=(e,t,i)=>OF.create(e,t,i,null,["$feature","$view"],[]),R0e=(e,t,i,r)=>OF.create(e,t,i,r,["$feature","$view"],[]);let OF=class LF{constructor(t,i,r,s,n,c,o){this.services=null,this.script=t,this.evaluate=s;const p=Array.isArray(c)?c:c==null?void 0:c.fields;this.fields=p??[],this._syntaxTree=r,this._arcade=i,this._arcadeFeature=n,this._spatialReference=o,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,i,r,s,n,c){const{arcade:o,Feature:p,Dictionary:g}=await RF(),S=mi.fromJSON(i);let M;try{M=o.parseScript(t,c)}catch(Ge){return Nie().error(new Je("arcade-bad-expression","Failed to parse arcade script",{script:t,error:Ge})),null}const A=n.reduce((Ge,et)=>({...Ge,[et]:null}),{});let O=null;s!=null&&(O=new g(s),O.immutable=!0,A.$config=null);const z=o.scriptUsesGeometryEngine(M),V=z&&o.enableGeometrySupport(),W=o.scriptUsesFeatureSet(M)&&o.enableFeatureSetSupport(),ie=o.scriptIsAsync(M),ve=ie&&o.enableAsyncSupport(),pe={vars:A,spatialReference:S,useAsync:!!ve};await Promise.all([V,W,ve]);const _e=new Set;await o.loadDependentModules(_e,M,null,ie,z);const Me=new g;Me.immutable=!1,Me.setField("scale",0);const $e=o.compileScript(M,pe),Fe=(Ge,et)=>{var ct;const at=(ct=Ge.$view)==null?void 0:ct.timeZone;return"$view"in Ge&&Ge.$view&&(Me.setField("scale",typeof Ge.$view=="object"&&"scale"in Ge.$view?Ge.$view.scale:void 0),Ge.$view=Me),O&&(Ge.$config=O),$e({vars:Ge,spatialReference:S,services:et,timeZone:at})};return new LF(t,o,M,Fe,new p,r,S)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const zie=/^([0-9_])/,Fie=/[^a-z0-9_\u0080-\uffff]+/gi;function O0e(e){return e==null?null:e.trim().replaceAll(Fie,"_").replace(zie,"F$1")||null}const Bie=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Uie=["field","normalizationField"];function L0e(e,t){if(e!=null&&t!=null){for(const i of Array.isArray(e)?e:[e])if(vR(Bie,i,t),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)vR(Uie,r,t)}}function vR(e,t,i){if(e)for(const r of e){const s=ix(r,t),n=s&&typeof s!="function"&&i.get(s);n&&Ep(r,n.name,t)}}function D0e(e,t){var i;if(e!=null&&((i=t==null?void 0:t.fields)!=null&&i.length))if("startField"in e){const r=t.get(e.startField),s=t.get(e.endField);e.startField=(r==null?void 0:r.name)??null,e.endField=(s==null?void 0:s.name)??null}else{const r=t.get(e.startTimeField),s=t.get(e.endTimeField);e.startTimeField=(r==null?void 0:r.name)??null,e.endTimeField=(s==null?void 0:s.name)??null}}const VS=new Set;function g3(e,t){return e&&t?(VS.clear(),X0(VS,e,t),Array.from(VS).sort()):[]}function X0(e,t,i){var r;if(i)if((r=t==null?void 0:t.fields)!=null&&r.length)if(i.includes("*"))for(const{name:s}of t.fields)e.add(s);else for(const s of i)zx(e,t,s);else{if(i.includes("*"))return e.clear(),void e.add("*");for(const s of i)s!=null&&e.add(s)}}function zx(e,t,i){if(typeof i=="string")if(t){const r=t.get(i);r&&e.add(r.name)}else e.add(i)}function N0e(e,t){return t==null||e==null?[]:t.includes("*")?(e.fields??[]).map(i=>i.name):t}function z0e(e,t,i=1){if(!t||!e)return[];if(t.includes("*"))return["*"];const r=g3(e,t);return r.length/e.fields.length>=i?["*"]:r}async function bh(e,t,i){var n;if(!i)return;const{arcadeUtils:r}=await RF(),s=r.extractFieldNames(i,(n=t==null?void 0:t.fields)==null?void 0:n.map(c=>c.name));for(const c of s)zx(e,t,c)}async function DF(e,t,i){if(i&&i!=="1=1"){const r=await Aie(i,t);if(!r.isStandardized)throw new Je("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});X0(e,t,r.fieldNames)}}function F0e({displayField:e,fields:t}){return e||(t!=null&&t.length?GS(t,"name-or-title")||GS(t,"unique-identifier")||GS(t,"type-or-category")||jie(t):null)}function jie(e){for(const t of e){if(!(t!=null&&t.name))continue;const i=t.name.toLowerCase();if(i.includes("name")||i.includes("title"))return t.name}return null}function GS(e,t){for(const i of e)if(i!=null&&i.valueType&&i.valueType===t)return i.name;return null}async function B0e(e,t){var r;if(!t)return;const i=(r=t.elevationInfo)==null?void 0:r.featureExpressionInfo;return i?i.collectRequiredFields(e,t.fieldsIndex):void 0}function Vie(e,t,i){i.onStatisticExpression?bh(e,t,i.onStatisticExpression.expression):e.add(i.onStatisticField)}async function U0e(e,t,i){if(!t||!i||!("fields"in i))return;const r=[],s=i.popupTemplate;r.push(Gie(e,t,s)),i.fields&&r.push(...i.fields.map(async n=>Vie(e,t.fieldsIndex,n))),await Promise.all(r)}async function Gie(e,t,i){const r=[];i!=null&&i.expressionInfos&&r.push(...i.expressionInfos.map(n=>bh(e,t.fieldsIndex,n.expression)));const s=i==null?void 0:i.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&r.push(bh(e,t.fieldsIndex,n.expressionInfo.expression));await Promise.all(r)}async function j0e(e,t,i){t&&(t.timeInfo&&(i!=null&&i.timeExtent)&&X0(e,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),t.floorInfo&&X0(e,t.fieldsIndex,[t.floorInfo.floorField]),(i==null?void 0:i.where)!=null&&await DF(e,t.fieldsIndex,i.where))}async function V0e(e,t,i){t&&i&&await Promise.all(i.map(r=>qie(e,t,r)))}async function qie(e,t,i){t&&i&&(i.valueExpression?await bh(e,t.fieldsIndex,i.valueExpression):i.field&&zx(e,t.fieldsIndex,i.field))}function G0e(e){return e?g3(e.fieldsIndex,NF(e)):[]}function Hie(e){if(!e)return[];const t=e.geometryFieldsInfo;return t?g3(e.fieldsIndex,[t.shapeAreaField,t.shapeLengthField]):[]}const Wie=new Set(["oid","global-id","guid"]),Zie=new Set(["oid","global-id"]),Yie=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function Jie(e){const t=new Set;zF(e).forEach(r=>t.add(r)),Hie(e).forEach(r=>t.add(r.toLowerCase()));const i=e&&"infoFor3D"in e?e.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>t.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>t.add(r.toLowerCase()))),Array.from(t)}function NF(e){if(!e)return[];const t="editFieldsInfo"in e&&e.editFieldsInfo;if(!t)return[];const{creationDateField:i,creatorField:r,editDateField:s,editorField:n}=t;return[i,r,s,n].filter(Boolean)}function zF(e){return NF(e).map(t=>t.toLowerCase())}function q0e(e,t){var i;return e.editable&&!Wie.has(e.type)&&!zF(t).includes(((i=e.name)==null?void 0:i.toLowerCase())??"")}function H0e(e,t){var r;const i=((r=e.name)==null?void 0:r.toLowerCase())??"";return!((t==null?void 0:t.objectIdField)!=null&&i===t.objectIdField.toLowerCase()||(t==null?void 0:t.globalIdField)!=null&&i===t.globalIdField.toLowerCase()||Jie(t).includes(i)||Zie.has(e.type)||Yie.some(s=>s.test(i)))}async function W0e(e,t){const{labelingInfo:i,fieldsIndex:r}=t;i!=null&&i.length&&await Promise.all(i.map(s=>Kie(e,r,s)))}async function Kie(e,t,i){if(!i)return;const r=i.getLabelExpression(),s=i.where;if(r.type==="arcade")await bh(e,t,r.expression);else{const n=r.expression.match(/{[^}]*}/g);n&&n.forEach(c=>{zx(e,t,c.slice(1,-1))})}await DF(e,t,s)}function Z0e(e){const t=e.defaultValue;return t!==void 0&&UF(e,t)?t:e.nullable?null:void 0}function Y0e(e){const t=typeof e=="string"?{type:e}:e;return ure(t)?255:t.type==="esriFieldTypeDate"||t.type==="date"?8:void 0}function FF(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function Xie(e){return e===null||FF(e)}function Qie(e){return e===null||Number.isInteger(e)}function BF(e){return e!=null&&typeof e=="string"}function ere(e){return e===null||BF(e)}function tre(){return!0}function UF(e,t){let i;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=e.nullable?Qie:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=e.nullable?Xie:FF;break;case"string":case"esriFieldTypeString":i=e.nullable?ere:BF;break;default:i=tre}return arguments.length===1?i:i(t)}const ire=["integer","small-integer","big-integer"],rre=["single","double"],sre=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],nre=["esriFieldTypeSingle","esriFieldTypeDouble"],ore=new Set([...ire,...sre]),are=new Set([...rre,...nre]),lre=i4(ore,are);function cre(e){return e!=null&&lre.has(e.type)}function ure(e){return e!=null&&(e.type==="string"||e.type==="esriFieldTypeString")}function J0e(e){return e!=null&&(e.type==="date"||e.type==="esriFieldTypeDate")}function K0e(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function X0e(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function Q0e(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function e_e(e){return e!=null&&(e.type==="oid"||e.type==="esriFieldTypeOID")}function t_e(e){return e!=null&&(e.type==="global-id"||e.type==="esriFieldTypeGlobalID")}function i_e(e,t){return hre(e,t)===null}var Pw,Cw;function r_e(e){return e==null||typeof e=="number"&&isNaN(e)?null:e}function hre(e,t){return e==null||e.nullable&&t===null?null:cre(e)&&!dre(e.type,Number(t))?Pw.OUT_OF_RANGE:UF(e,t)?e.domain?Oie(e,t):null:Cw.INVALID_TYPE}function dre(e,t){const i=typeof e=="string"?jF(e):e;if(!i)return!1;const r=i.min,s=i.max;return i.isInteger?Number.isInteger(t)&&t>=r&&t<=s:t>=r&&t<=s}function jF(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return pre;case"esriFieldTypeInteger":case"integer":return fre;case"esriFieldTypeBigInteger":case"big-integer":return mre;case"esriFieldTypeSingle":case"single":return yre;case"esriFieldTypeDouble":case"double":return gre}}(function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(Pw||(Pw={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}(Cw||(Cw={}));const pre={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},fre={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},mre={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},yre={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},gre={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function s_e(e,t,i){switch(e){case Rm.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Rm.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Cw.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case Pw.OUT_OF_RANGE:{const{min:r,max:s}=jF(t.type);return`Value ${i} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${r} to ${s}`}}}function n_e(e,t){return!_re(e,t,null)}function _re(e,t,i){if(!(t!=null&&t.attributes)||!e){if(i!=null)for(const n of e??[])i.add(n);return!0}const r=new Set(Object.keys(t.attributes));let s=!1;for(const n of e)if(!r.has(n)){if(s=!0,i==null)break;i.add(n)}return s}function o_e(e){return!!e&&["raster.itempixelvalue","raster.servicepixelvalue"].some(t=>e.toLowerCase().startsWith(t))}let ib=class extends At{constructor(t){super(t),this.type=null}};v([I({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],ib.prototype,"type",void 0),ib=v([me("esri.popup.content.Content")],ib);const Ph=ib;var UE;let dd=UE=class extends Ph{constructor(e){super(e),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new UE({description:this.description,displayType:this.displayType,title:this.title})}};v([I({type:String,json:{write:!0}})],dd.prototype,"description",void 0),v([I({type:["auto","preview","list"],json:{write:!0}})],dd.prototype,"displayType",void 0),v([I({type:String,json:{write:!0}})],dd.prototype,"title",void 0),v([I({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],dd.prototype,"type",void 0),dd=UE=v([me("esri.popup.content.AttachmentsContent")],dd);const $w=dd;var jE;let pd=jE=class extends Ph{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new jE({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?He(this.outFields):null})}};v([I()],pd.prototype,"creator",void 0),v([I()],pd.prototype,"destroyer",void 0),v([I()],pd.prototype,"outFields",void 0),v([I({type:["custom"],readOnly:!0})],pd.prototype,"type",void 0),pd=jE=v([me("esri.popup.content.CustomContent")],pd);const vre=pd;var VE;let Rf=VE=class extends At{constructor(e){super(e),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new VE({title:this.title,expression:this.expression})}};v([I({type:String,json:{write:!0}})],Rf.prototype,"title",void 0),v([I({type:String,json:{write:!0}})],Rf.prototype,"expression",void 0),v([I({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],Rf.prototype,"returnType",void 0),Rf=VE=v([me("esri.popup.ElementExpressionInfo")],Rf);const bre=Rf;var GE;let Cg=GE=class extends Ph{constructor(e){super(e),this.expressionInfo=null,this.type="expression"}clone(){var e;return new GE({expressionInfo:(e=this.expressionInfo)==null?void 0:e.clone()})}};v([I({type:bre,json:{write:!0}})],Cg.prototype,"expressionInfo",void 0),v([I({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Cg.prototype,"type",void 0),Cg=GE=v([me("esri.popup.content.ExpressionContent")],Cg);const _3=Cg;let Of=class extends Ul(At){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};v([qt(GQ)],Of.prototype,"dateFormat",void 0),v([I({type:Boolean,json:{write:!0}})],Of.prototype,"digitSeparator",void 0),v([I({type:Er,json:{write:!0}})],Of.prototype,"places",void 0),Of=v([me("esri.popup.support.FieldInfoFormat")],Of);const wre=Of;var qE;let Aa=qE=class extends At{constructor(e){super(e),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new qE({fieldName:this.fieldName,format:this.format?He(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};v([I({type:String,json:{write:!0}})],Aa.prototype,"fieldName",void 0),v([I({type:wre,json:{write:!0}})],Aa.prototype,"format",void 0),v([I({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Aa.prototype,"isEditable",void 0),v([I({type:String,json:{write:!0}})],Aa.prototype,"label",void 0),v([qt(new Ms({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Aa.prototype,"stringFieldOption",void 0),v([I({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Aa.prototype,"statisticType",void 0),v([I({type:String,json:{write:!0}})],Aa.prototype,"tooltip",void 0),v([I({type:Boolean,json:{write:!0}})],Aa.prototype,"visible",void 0),Aa=qE=v([me("esri.popup.FieldInfo")],Aa);const VF=Aa;var HE;let bc=HE=class extends Ph{constructor(e){super(e),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,t){t.fieldInfos=e&&e.map(i=>i.toJSON())}clone(){return new HE(He({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};v([I({type:Object,json:{write:!0}})],bc.prototype,"attributes",void 0),v([I({type:String,json:{write:!0}})],bc.prototype,"description",void 0),v([I({type:[VF]})],bc.prototype,"fieldInfos",void 0),v([ci("fieldInfos")],bc.prototype,"writeFieldInfos",null),v([I({type:String,json:{write:!0}})],bc.prototype,"title",void 0),v([I({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],bc.prototype,"type",void 0),bc=HE=v([me("esri.popup.content.FieldsContent")],bc);const kw=bc;let fd=class extends At{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};v([I({type:String,json:{write:!0}})],fd.prototype,"altText",void 0),v([I({type:String,json:{write:!0}})],fd.prototype,"caption",void 0),v([I({type:String,json:{write:!0}})],fd.prototype,"title",void 0),v([I({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],fd.prototype,"type",void 0),fd=v([me("esri.popup.content.mixins.MediaInfo")],fd);const v3=fd;var WE;let md=WE=class extends zt{constructor(e){super(e),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new WE({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};v([I()],md.prototype,"color",void 0),v([I()],md.prototype,"fieldName",void 0),v([I()],md.prototype,"tooltip",void 0),v([I()],md.prototype,"value",void 0),md=WE=v([me("esri.popup.content.support.ChartMediaInfoValueSeries")],md);const xre=md;var ZE;let Ru=ZE=class extends At{constructor(e){super(e),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new ZE({colors:He(this.colors),fields:He(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};v([I({type:[Bt],json:{type:[[Er]],write:!0}})],Ru.prototype,"colors",void 0),v([I({type:[String],json:{write:!0}})],Ru.prototype,"fields",void 0),v([I({type:String,json:{write:!0}})],Ru.prototype,"normalizeField",void 0),v([I({type:[xre],json:{read:!1}})],Ru.prototype,"series",void 0),v([I({type:String,json:{write:!0}})],Ru.prototype,"tooltipField",void 0),Ru=ZE=v([me("esri.popup.content.support.ChartMediaInfoValue")],Ru);const Sre=Ru;let $g=class extends v3{constructor(t){super(t),this.type=null,this.value=null}};v([I({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],$g.prototype,"type",void 0),v([I({type:Sre,json:{write:!0}})],$g.prototype,"value",void 0),$g=v([me("esri.popup.content.mixins.ChartMediaInfo")],$g);const Fx=$g,Bx=Fn()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var YE;let rb=YE=class extends Fx{constructor(e){super(e),this.type="bar-chart"}clone(){return new YE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};v([I({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:Bx.write}})],rb.prototype,"type",void 0),rb=YE=v([me("esri.popup.content.BarChartMediaInfo")],rb);const GF=rb;var JE;let sb=JE=class extends Fx{constructor(e){super(e),this.type="column-chart"}clone(){return new JE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};v([I({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:Bx.write}})],sb.prototype,"type",void 0),sb=JE=v([me("esri.popup.content.ColumnChartMediaInfo")],sb);const qF=sb;var KE;let kg=KE=class extends At{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new KE({linkURL:this.linkURL,sourceURL:this.sourceURL})}};v([I({type:String,json:{write:!0}})],kg.prototype,"linkURL",void 0),v([I({type:String,json:{write:!0}})],kg.prototype,"sourceURL",void 0),kg=KE=v([me("esri.popup.content.support.ImageMediaInfoValue")],kg);const Tre=kg;var XE;let Lf=XE=class extends v3{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new XE({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};v([I({type:Number,json:{write:!0}})],Lf.prototype,"refreshInterval",void 0),v([I({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],Lf.prototype,"type",void 0),v([I({type:Tre,json:{write:!0}})],Lf.prototype,"value",void 0),Lf=XE=v([me("esri.popup.content.ImageMediaInfo")],Lf);const HF=Lf;var QE;let nb=QE=class extends Fx{constructor(e){super(e),this.type="line-chart"}clone(){return new QE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};v([I({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:Bx.write}})],nb.prototype,"type",void 0),nb=QE=v([me("esri.popup.content.LineChartMediaInfo")],nb);const WF=nb;var eI;let ob=eI=class extends Fx{constructor(e){super(e),this.type="pie-chart"}clone(){return new eI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};v([I({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:Bx.write}})],ob.prototype,"type",void 0),ob=eI=v([me("esri.popup.content.PieChartMediaInfo")],ob);const ZF=ob,YF={base:v3,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":GF,"column-chart":qF,"line-chart":WF,"pie-chart":ZF,image:HF}};var tI;let Pa=tI=class extends Ph{constructor(e){super(e),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map(t=>t.type==="image"?HF.fromJSON(t):t.type==="barchart"?GF.fromJSON(t):t.type==="columnchart"?qF.fromJSON(t):t.type==="linechart"?WF.fromJSON(t):t.type==="piechart"?ZF.fromJSON(t):void 0).filter(Boolean)}writeMediaInfos(e,t){t.mediaInfos=e&&e.map(i=>i.toJSON())}clone(){return new tI(He({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};v([I()],Pa.prototype,"activeMediaInfoIndex",void 0),v([I({type:Object,json:{write:!0}})],Pa.prototype,"attributes",void 0),v([I({type:String,json:{write:!0}})],Pa.prototype,"description",void 0),v([I({types:[YF]})],Pa.prototype,"mediaInfos",void 0),v([fi("mediaInfos")],Pa.prototype,"readMediaInfos",null),v([ci("mediaInfos")],Pa.prototype,"writeMediaInfos",null),v([I({type:String,json:{write:!0}})],Pa.prototype,"title",void 0),v([I({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],Pa.prototype,"type",void 0),Pa=tI=v([me("esri.popup.content.MediaContent")],Pa);const Rw=Pa;var iI;let Rg=iI=class extends At{constructor(e){super(e),this.field=null,this.order=null}clone(){return new iI({field:this.field,order:this.order})}};v([I({type:String,json:{write:!0}})],Rg.prototype,"field",void 0),v([I({type:["asc","desc"],json:{write:!0}})],Rg.prototype,"order",void 0),Rg=iI=v([me("esri.popup.support.RelatedRecordsInfoFieldOrder")],Rg);const JF=Rg;let ml=class extends Ul(Ph){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};v([I({type:String,json:{write:!0}})],ml.prototype,"description",void 0),v([I({type:Number,json:{type:Er,write:!0}})],ml.prototype,"displayCount",void 0),v([I({type:["list"],json:{write:!0}})],ml.prototype,"displayType",void 0),v([I({type:[JF],json:{write:!0}})],ml.prototype,"orderByFields",void 0),v([I({type:Number,json:{type:Er,write:!0}})],ml.prototype,"relationshipId",void 0),v([I({type:String,json:{write:!0}})],ml.prototype,"title",void 0),v([I({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],ml.prototype,"type",void 0),ml=v([me("esri.popup.content.RelationshipContent")],ml);const Ow=ml;var rI;let Og=rI=class extends Ph{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new rI({text:this.text})}};v([I({type:String,json:{write:!0}})],Og.prototype,"text",void 0),v([I({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Og.prototype,"type",void 0),Og=rI=v([me("esri.popup.content.TextContent")],Og);const Lw=Og,Ere={base:null,key:"type",typeMap:{attachment:$w,media:Rw,text:Lw,expression:_3,field:kw,relationship:Ow}};var sI;let yd=sI=class extends At{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new sI({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};v([I({type:String,json:{write:!0}})],yd.prototype,"name",void 0),v([I({type:String,json:{write:!0}})],yd.prototype,"title",void 0),v([I({type:String,json:{write:!0}})],yd.prototype,"expression",void 0),v([I({type:["string","number"],json:{write:!0}})],yd.prototype,"returnType",void 0),yd=sI=v([me("esri.popup.ExpressionInfo")],yd);const Ire=yd;var nI;let Lg=nI=class extends At{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new nI({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};v([I({type:Boolean,json:{write:!0}})],Lg.prototype,"returnTopmostRaster",void 0),v([I({type:Boolean,json:{write:!0}})],Lg.prototype,"showNoDataRecords",void 0),Lg=nI=v([me("esri.popup.LayerOptions")],Lg);const Mre=Lg;var oI;let Dg=oI=class extends At{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new oI({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?He(this.orderByFields):null})}};v([I({type:Boolean,json:{write:!0}})],Dg.prototype,"showRelatedRecords",void 0),v([I({type:[JF],json:{write:!0}})],Dg.prototype,"orderByFields",void 0),Dg=oI=v([me("esri.popup.RelatedRecordsInfo")],Dg);const Are=Dg;var aI;let Go=aI=class extends GA(zt){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new aI({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};v([I()],Go.prototype,"active",void 0),v([I()],Go.prototype,"className",void 0),v([I()],Go.prototype,"disabled",void 0),v([I()],Go.prototype,"icon",void 0),v([I()],Go.prototype,"id",void 0),v([I()],Go.prototype,"indicator",void 0),v([I()],Go.prototype,"title",void 0),v([I()],Go.prototype,"type",void 0),v([I()],Go.prototype,"visible",void 0),Go=aI=v([me("esri.support.actions.ActionBase")],Go);const b3=Go;var lI;let ab=lI=class extends b3{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new lI({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};v([I()],ab.prototype,"image",void 0),ab=lI=v([me("esri.support.Action.ActionButton")],ab);const Pre=ab;var cI;let Ng=cI=class extends b3{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new cI({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};v([I()],Ng.prototype,"image",void 0),v([I()],Ng.prototype,"value",void 0),Ng=cI=v([me("esri.support.Action.ActionToggle")],Ng);const Cre=Ng,vg="relationships/",bR="expression/",$re=Ut.ofType({key:"type",defaultKeyValue:"button",base:b3,typeMap:{button:Pre,toggle:Cre}}),kre={base:Ph,key:"type",typeMap:{media:Rw,custom:vre,text:Lw,attachments:$w,fields:kw,expression:_3,relationship:Ow}},Rre=new Set(["attachments","fields","media","text","expression","relationship"]);let hs=class extends Ul(At){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map(i=>Uc(kre,i)):typeof t=="string"||typeof t=="function"||t instanceof HTMLElement||wh(t)?t:(_t.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeContent(t,i,r,s){typeof t!="string"?Array.isArray(t)&&(i.popupElements=t.filter(n=>Rre.has(n.type)).map(n=>n==null?void 0:n.toJSON(s)),i.popupElements.forEach(n=>{n.type==="attachments"?this._writeAttachmentContent(i):n.type==="media"?this._writeMediaContent(n,i):n.type==="text"?this._writeTextContent(n,i):n.type==="relationship"&&this._writeRelationshipContent(n,i)})):i.description=t}writeFieldInfos(t,i,r,s){const{content:n}=this,c=Array.isArray(n)?n:null;if(t){const o=c?c.filter(g=>g.type==="fields"):[],p=o.length&&o.every(g=>{var S;return(S=g.fieldInfos)==null?void 0:S.length});i.fieldInfos=t.filter(Boolean).map(g=>{const S=g.toJSON(s);return p&&(S.visible=!1),S})}if(c)for(const o of c)o.type==="fields"&&this._writeFieldsContent(o,i)}writeLayerOptions(t,i,r,s){i[r]=!t||t.showNoDataRecords===null&&t.returnTopmostRaster===null?null:t.toJSON(s)}writeTitle(t,i){i.title=t||""}async collectRequiredFields(t,i){const r=this.expressionInfos||[];await this._collectExpressionInfoFields(t,i,[...r,...this._getContentExpressionInfos(this.content,r)]),X0(t,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const i=new Set;return await this.collectRequiredFields(i,t),[...i].sort()}_writeFieldsContent(t,i){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const r=He(t.fieldInfos);Array.isArray(i.fieldInfos)?r.forEach(s=>{const n=i.fieldInfos.find(c=>c.fieldName.toLowerCase()===s.fieldName.toLowerCase());n?n.visible=!0:i.fieldInfos.push(s)}):i.fieldInfos=r}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,i){var n,c;const r=((n=t.orderByFields)==null?void 0:n.map(o=>this._toFieldOrderJSON(o,t.relationshipId)))||[],s=[...((c=i.relatedRecordsInfo)==null?void 0:c.orderByFields)||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...(s==null?void 0:s.length)&&{orderByFields:s}}}_writeTextContent(t,i){!i.description&&t.text&&(i.description=t.text)}_writeMediaContent(t,i){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const r=He(t.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(t,i,r){const s={description:!1,mediaInfos:!1};return r.map(n=>n.type==="media"?(n.mediaInfos||!i||s.mediaInfos||(n.mediaInfos=i,s.mediaInfos=!0),Rw.fromJSON(n)):n.type==="text"?(n.text||!t||s.description||(n.text=t,s.description=!0),Lw.fromJSON(n)):n.type==="attachments"?$w.fromJSON(n):n.type==="fields"?kw.fromJSON(n):n.type==="expression"?_3.fromJSON(n):n.type==="relationship"?Ow.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(t){const{field:i,order:r}=t;if(!(i!=null&&i.startsWith(vg)))return null;const s=i.replace(vg,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),c=s[1];return typeof n=="number"&&c?Ow.fromJSON({relationshipId:n,orderByFields:[{field:c,order:r}]}):null}_toFieldOrderJSON(t,i){const{order:r,field:s}=t;return{field:`${vg}${i}/${s}`,order:r}}_readPopupInfo({description:t,mediaInfos:i,showAttachments:r,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];t?n.push(new Lw({text:t})):n.push(new kw),Array.isArray(i)&&i.length&&n.push(Rw.fromJSON({mediaInfos:i})),r&&n.push($w.fromJSON({displayType:"auto"}));const{showRelatedRecords:c,orderByFields:o}=s;return c&&(o!=null&&o.length)&&o.forEach(p=>{const g=this._toRelationshipContent(p);g&&n.push(g)}),n.length?n:t}_getContentElementFields(t){const i=t==null?void 0:t.type;if(i==="attachments")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if(i==="custom")return t.outFields||[];if(i==="fields")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if(i==="media"){const r=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...r.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return i==="text"?this._extractFieldNames(t.text):[]}_getMediaInfoFields(t){const{caption:i,title:r,value:s}=t,n=s||{},{fields:c,normalizeField:o,tooltipField:p,sourceURL:g,linkURL:S}=n,M=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(g),...this._extractFieldNames(S),...c??[]];return o&&M.push(o),p&&M.push(p),M}_getContentExpressionInfos(t,i){return Array.isArray(t)?t.reduce((r,s)=>[...r,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],i):[]}_getContentFields(t){return typeof t=="string"?this._extractFieldNames(t):Array.isArray(t)?t.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(t,i,r){r&&await Promise.all(r.map(s=>bh(t,i,s.expression)))}_getFieldInfoFields(t){return t?t.filter(i=>i.visible===void 0||!!i.visible).map(i=>i.fieldName).filter(i=>!i.startsWith(vg)&&!i.startsWith(bR)):[]}_getActionsFields(t){return t?t.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(t){const{className:i,title:r,type:s}=t,n=s==="button"||s==="toggle"?t.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(n)]}_getTitleFields(t){return typeof t=="string"?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||typeof t!="string")return[];const i=/{[^}]*}/g,r=t.match(i);if(!r)return[];const s=/\{(\w+):.+\}/,n=r.filter(c=>!(c.indexOf(`{${vg}`)===0||c.indexOf(`{${bR}`)===0)).map(c=>c.replace(s,"{$1}"));return n?n.map(c=>c.slice(1,-1)):[]}};v([I({type:$re})],hs.prototype,"actions",void 0),v([I()],hs.prototype,"content",void 0),v([As("content")],hs.prototype,"castContent",null),v([fi("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],hs.prototype,"readContent",null),v([ci("content",{popupElements:{type:Ut.ofType(Ere)},showAttachments:{type:Boolean},mediaInfos:{type:Ut.ofType(YF)},description:{type:String},relatedRecordsInfo:{type:Are}})],hs.prototype,"writeContent",null),v([I({type:[Ire],json:{write:!0}})],hs.prototype,"expressionInfos",void 0),v([I({type:[VF]})],hs.prototype,"fieldInfos",void 0),v([ci("fieldInfos")],hs.prototype,"writeFieldInfos",null),v([I({type:Mre})],hs.prototype,"layerOptions",void 0),v([ci("layerOptions")],hs.prototype,"writeLayerOptions",null),v([I({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],hs.prototype,"lastEditInfoEnabled",void 0),v([I()],hs.prototype,"outFields",void 0),v([I()],hs.prototype,"overwriteActions",void 0),v([I()],hs.prototype,"returnGeometry",void 0),v([I({json:{type:String}})],hs.prototype,"title",void 0),v([ci("title")],hs.prototype,"writeTitle",null),hs=v([me("esri.PopupTemplate")],hs);const Ore=hs,wR=new Ms({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Lre=0,Df=class extends At{constructor(t){super(t),this.id="sym"+Lre++,this.type=null,this.color=new Bt([0,0,0,1])}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};v([I({type:wR.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:wR.write}}})],Df.prototype,"type",void 0),v([I({type:Bt,json:{write:{allowNull:!0}}})],Df.prototype,"color",void 0),v([fi("color")],Df.prototype,"readColor",null),Df=v([me("esri.symbols.Symbol")],Df);const Eo=Df;var uI;let Ou=uI=class extends Eo{constructor(e){super(e),this.data=null,this.type="cim"}readData(e,t){return t}writeData(e,t){Object.assign(t,e)}async collectRequiredFields(e,t){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const s=r.map(n=>{const c=n.valueExpressionInfo;return c?bh(e,t,c.expression):null});await Promise.all(s)}}}clone(){return new uI({data:He(this.data)})}hash(){return R5(JSON.stringify(this.data)).toString()}};v([I({json:{write:!1}})],Ou.prototype,"color",void 0),v([I({json:{write:!0}})],Ou.prototype,"data",void 0),v([fi("data",["symbol"])],Ou.prototype,"readData",null),v([ci("data",{})],Ou.prototype,"writeData",null),v([qt({CIMSymbolReference:"cim"},{readOnly:!0})],Ou.prototype,"type",void 0),Ou=uI=v([me("esri.symbols.CIMSymbol")],Ou);const Ux=Ou;let Nf=class extends At{constructor(t){super(t),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(t,i,r){t||(i[r]=t)}};v([I({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Nf.prototype,"enabled",void 0),v([ci("enabled")],Nf.prototype,"writeEnabled",null),v([I({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],Nf.prototype,"type",void 0),Nf=v([me("esri.symbols.Symbol3DLayer")],Nf);const jl=Nf;function Dre(e,t){const i=t.transparency!=null?yw(t.transparency):1,r=t.color;return r&&Array.isArray(r)?new Bt([r[0]||0,r[1]||0,r[2]||0,i]):null}function Nre(e,t){t.color=e.toJSON().slice(0,3);const i=FN(e.a);i!==0&&(t.transparency=i)}const Ch={type:Bt,json:{type:[Er],default:null,read:{source:["color","transparency"],reader:Dre},write:{target:{color:{type:[Er]},transparency:{type:Er}},writer:Nre}}},Nl={type:Number,cast:yr,json:{write:!0}};let gd=class extends At{constructor(t){super(t),this.color=new Bt([0,0,0,1]),this.extensionLength=0,this.size=fh(1)}clone(){}cloneProperties(){return{color:He(this.color),size:this.size,extensionLength:this.extensionLength}}};v([I({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],gd.prototype,"type",void 0),v([I(Ch)],gd.prototype,"color",void 0),v([I({...Nl,json:{write:{overridePolicy:e=>({enabled:!!e})}}})],gd.prototype,"extensionLength",void 0),v([I(Nl)],gd.prototype,"size",void 0),gd=v([me("esri.symbols.edges.Edges3D")],gd);const w3=gd;var hI;let lb=hI=class extends w3{constructor(e){super(e),this.type="sketch"}clone(){return new hI(this.cloneProperties())}};v([qt({sketch:"sketch"},{readOnly:!0})],lb.prototype,"type",void 0),lb=hI=v([me("esri.symbols.edges.SketchEdges3D")],lb);const zre=lb;var dI;let cb=dI=class extends w3{constructor(e){super(e),this.type="solid"}clone(){return new dI(this.cloneProperties())}};v([qt({solid:"solid"},{readOnly:!0})],cb.prototype,"type",void 0),cb=dI=v([me("esri.symbols.support.SolidEdges3D")],cb);const Fre=cb,KF={types:{key:"type",base:w3,typeMap:{solid:Fre,sketch:zre}},json:{write:!0}};var pI;let ia=pI=class extends At{constructor(e){super(e),this.color=null}clone(){const e={color:this.color!=null?this.color.clone():null};return new pI(e)}};v([I(Ch)],ia.prototype,"color",void 0),ia=pI=v([me("esri.symbols.support.Symbol3DMaterial")],ia);var fI;let Lu=fI=class extends jl{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new fI({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};v([qt({Extrude:"extrude"},{readOnly:!0})],Lu.prototype,"type",void 0),v([I({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Lu.prototype,"size",void 0),v([I({type:ia,json:{write:!0}})],Lu.prototype,"material",void 0),v([I({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Lu.prototype,"castShadows",void 0),v([I(KF)],Lu.prototype,"edges",void 0),Lu=fI=v([me("esri.symbols.ExtrudeSymbol3DLayer")],Lu);const XF=Lu;let zg=class extends Eo{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};v([qt({esriSLS:"simple-line"},{readOnly:!0})],zg.prototype,"type",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],zg.prototype,"width",void 0),zg=v([me("esri.symbols.LineSymbol")],zg);const Bre=zg,Ure=["begin","end","begin-end"],QF=["arrow","circle","square","diamond","cross","x"];var mI;let yl=mI=class extends At{constructor(e){super(e),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(e,t,i,r){t[i]=(r==null?void 0:r.origin)==="web-map"?"arrow":e}set color(e){this._set("color",e)}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}writeColor(e,t,i,r){(r==null?void 0:r.origin)==="web-map"||(t[i]=e)}clone(){return new mI({color:He(this.color),placement:this.placement,style:this.style})}hash(){var e;return`${this.placement}.${(e=this.color)==null?void 0:e.hash()}.${this.style}`}};v([I({type:["begin","end","begin-end"],json:{write:!0}})],yl.prototype,"placement",void 0),v([qt({"line-marker":"line-marker"},{readOnly:!0}),I({json:{origins:{"web-map":{write:!1}}}})],yl.prototype,"type",void 0),v([I({type:QF})],yl.prototype,"style",void 0),v([ci("style")],yl.prototype,"writeStyle",null),v([I({type:Bt,value:null,json:{write:{allowNull:!0}}})],yl.prototype,"color",null),v([fi("color")],yl.prototype,"readColor",null),v([ci("color")],yl.prototype,"writeColor",null),yl=mI=v([me("esri.symbols.LineSymbolMarker")],yl);const jre=yl;var yI;const qS=new Ms({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let wc=yI=class extends Bre{constructor(...e){super(...e),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(e,t,i,r,s,n){if(e&&typeof e!="string")return e;const c={};return e!=null&&(c.style=e),t!=null&&(c.color=t),i!=null&&(c.width=yr(i)),r!=null&&(c.cap=r),s!=null&&(c.join=s),n!=null&&(c.miterLimit=yr(n)),c}clone(){var e;return new yI({color:He(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(e=this.marker)==null?void 0:e.clone()})}hash(){var e,t;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(t=this.marker)==null?void 0:t.hash()}`}};v([qt({esriSLS:"simple-line"},{readOnly:!0})],wc.prototype,"type",void 0),v([I({type:qS.apiValues,json:{read:qS.read,write:qS.write}})],wc.prototype,"style",void 0),v([I({type:["butt","round","square"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&(i==null?void 0:i.origin)==null})}}})],wc.prototype,"cap",void 0),v([I({type:["miter","round","bevel"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&(i==null?void 0:i.origin)==null})}}})],wc.prototype,"join",void 0),v([I({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":jre}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],wc.prototype,"marker",void 0),v([I({type:Number,json:{read:!1,write:!1}})],wc.prototype,"miterLimit",void 0),wc=yI=v([me("esri.symbols.SimpleLineSymbol")],wc);const Hm=wc;let Fg=class extends Eo{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};v([I({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Hm}},json:{default:null,write:!0}})],Fg.prototype,"outline",void 0),v([I({type:["simple-fill","picture-fill"],readOnly:!0})],Fg.prototype,"type",void 0),Fg=v([me("esri.symbols.FillSymbol")],Fg);const e8=Fg;let ub=class extends At{constructor(t){super(t)}clone(){}};v([I({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],ub.prototype,"type",void 0),ub=v([me("esri.symbols.patterns.LinePattern3D")],ub);const t8=ub,Vre=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var gI;const Gre=Fn()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Bg=gI=class extends t8{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new gI(e)}};v([I({type:["style"]})],Bg.prototype,"type",void 0),v([qt(Gre),I({type:Vre})],Bg.prototype,"style",void 0),Bg=gI=v([me("esri.symbols.patterns.LineStylePattern3D")],Bg);const x3=Bg;let hb=class extends At{constructor(t){super(t)}clone(){}};v([I({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],hb.prototype,"type",void 0),hb=v([me("esri.symbols.patterns.Pattern3D")],hb);const i8=hb,qre=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var _I;let Ug=_I=class extends i8{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new _I(e)}};v([I({type:["style"]})],Ug.prototype,"type",void 0),v([I({type:qre,json:{read:!0,write:!0}})],Ug.prototype,"style",void 0),Ug=_I=v([me("esri.symbols.patterns.StylePattern3D")],Ug);const r8=Ug,Hre={types:{key:"type",base:i8,typeMap:{style:r8}},json:{write:!0}},s8={types:{key:"type",base:t8,typeMap:{style:x3}},json:{write:!0}},T0=new Bt("white");new Bt("black");const Wre=new Bt([255,255,255,0]);function Zre(e){return e.r===0&&e.g===0&&e.b===0}var vI;let E0=vI=class extends ia{constructor(e){super(e),this.colorMixMode=null}clone(){const e={color:this.color!=null?this.color.clone():null,colorMixMode:this.colorMixMode};return new vI(e)}};v([qt({multiply:"multiply",replace:"replace",tint:"tint"})],E0.prototype,"colorMixMode",void 0),E0=vI=v([me("esri.symbols.support.Symbol3DFillMaterial")],E0);function S3(e=Qre){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function T3(e,t,i,r,s,n,c=S3()){return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=s,c[5]=n,c}function b_e(e,t){const i=isFinite(e[2])||isFinite(e[5]);return new Bi(i?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function w_e(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function x_e(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function S_e(e,t,i=0,r=t.length/3){let s=e[0],n=e[1],c=e[2],o=e[3],p=e[4],g=e[5];for(let S=0;S<r;S++)s=Math.min(s,t[i+3*S]),n=Math.min(n,t[i+3*S+1]),c=Math.min(c,t[i+3*S+2]),o=Math.max(o,t[i+3*S]),p=Math.max(p,t[i+3*S+1]),g=Math.max(g,t[i+3*S+2]);e[0]=s,e[1]=n,e[2]=c,e[3]=o,e[4]=p,e[5]=g}function Yre(e){return e[0]>=e[3]?0:e[3]-e[0]}function Jre(e){return e[1]>=e[4]?0:e[4]-e[1]}function Kre(e){return e[2]>=e[5]?0:e[5]-e[2]}function T_e(e,t=[0,0,0]){return t[0]=Yre(e),t[1]=Jre(e),t[2]=Kre(e),t}function E_e(e,t,i=e){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function I_e(e,t,i=e){return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function Xre(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function M_e(e){return e?Xre(e,SR):S3(SR)}function A_e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function P_e(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=Number.NEGATIVE_INFINITY,e[3]=r,e[4]=s,e[5]=Number.POSITIVE_INFINITY,e}function xR(e){return e.length===6}function C_e(e,t,i){if(e==null||t==null)return e===t;if(!xR(e)||!xR(t))return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const SR=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Qre=[0,0,0,0,0,0];S3();const ese=T3(-.5,-.5,-.5,.5,.5,.5),tse=T3(-.5,-.5,0,.5,.5,1),ise=T3(-.5,-.5,0,.5,.5,.5);function $_e(e){switch(e){case"sphere":case"cube":case"diamond":return ese;case"cylinder":case"cone":case"inverted-cone":return tse;case"tetrahedron":return ise;default:return}}const E3=["butt","square","round"],rse=[...E3,"none"],n8=["miter","bevel","round"];var bI;let _d=bI=class extends At{constructor(e){super(e),this.color=new Bt([0,0,0,1]),this.size=fh(1),this.pattern=null,this.patternCap="butt"}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new bI(e)}};v([I(Ch)],_d.prototype,"color",void 0),v([I(Nl)],_d.prototype,"size",void 0),v([I(s8)],_d.prototype,"pattern",void 0),v([I({type:E3,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],_d.prototype,"patternCap",void 0),_d=bI=v([me("esri.symbols.support.Symbol3DOutline")],_d);var db;let xc=db=class extends jl{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new db(e)}static fromSimpleFillSymbol(e){var r,s,n;const t=e.outline&&e.outline.style&&e.outline.style!=="inside-frame"&&e.outline.style!=="solid"?new x3({style:e.outline.style}):null,i={size:((r=e.outline)==null?void 0:r.width)??0,color:(((s=e.outline)==null?void 0:s.color)??T0).clone(),pattern:t};return t&&((n=e.outline)!=null&&n.cap)&&(i.patternCap=e.outline.cap),new db({material:new E0({color:(e.color??Wre).clone()}),pattern:e.style&&e.style!=="solid"?new r8({style:e.style}):null,outline:i})}};v([qt({Fill:"fill"},{readOnly:!0})],xc.prototype,"type",void 0),v([I({type:E0,json:{write:!0}})],xc.prototype,"material",void 0),v([I(Hre)],xc.prototype,"pattern",void 0),v([I({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],xc.prototype,"castShadows",void 0),v([I({type:_d,json:{write:!0}})],xc.prototype,"outline",void 0),v([I(KF)],xc.prototype,"edges",void 0),xc=db=v([me("esri.symbols.FillSymbol3DLayer")],xc);const S_=xc,sse=["none","underline","line-through"],nse=["normal","italic","oblique"],ose=["normal","lighter","bold","bolder"],o8={type:Number,cast:e=>{const t=za(e);return t===0?1:Ol(t,.1,4)},nonNullable:!0},ase=["left","right","center"],lse=["baseline","top","middle","bottom"],a8={type:ase,nonNullable:!0},l8={type:lse,nonNullable:!0},k_e=8;var wI;let Sc=wI=class extends At{constructor(e){super(e),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(e){return yr(e)}clone(){return new wI({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};v([I({type:sse,json:{default:"none",write:!0}})],Sc.prototype,"decoration",void 0),v([I({type:String,json:{write:!0}})],Sc.prototype,"family",void 0),v([I({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:!i||!i.textSymbol3D})}}})],Sc.prototype,"size",void 0),v([As("size")],Sc.prototype,"castSize",null),v([I({type:nse,json:{default:"normal",write:!0}})],Sc.prototype,"style",void 0),v([I({type:ose,json:{default:"normal",write:!0}})],Sc.prototype,"weight",void 0),Sc=wI=v([me("esri.symbols.Font")],Sc);const jx=Sc;var xI;const cse=Fn()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let vd=xI=class extends At{constructor(e){super(e)}readHref(e,t,i){return e?m_(e,i):t.dataURI}writeHref(e,t,i,r){e&&(Mp(e)?t.dataURI=e:(t.href=_x(e,r),Nn(t.href)&&(t.href=ta(t.href))))}clone(){return new xI({href:this.href,primitive:this.primitive})}};v([I({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],vd.prototype,"href",void 0),v([fi("href")],vd.prototype,"readHref",null),v([ci("href",{href:{type:String},dataURI:{type:String}})],vd.prototype,"writeHref",null),v([qt(cse)],vd.prototype,"primitive",void 0),vd=xI=v([me("esri.symbols.support.IconSymbol3DLayerResource")],vd);var SI;let rm=SI=class extends zt{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new SI({x:this.x,y:this.y})}};v([I({type:Number})],rm.prototype,"x",void 0),v([I({type:Number})],rm.prototype,"y",void 0),rm=SI=v([me("esri.symbols.support.Symbol3DAnchorPosition2D")],rm);var TI;let jg=TI=class extends At{constructor(e){super(e),this.color=new Bt([0,0,0,1]),this.size=fh(1)}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size};return new TI(e)}};v([I(Ch)],jg.prototype,"color",void 0),v([I(Nl)],jg.prototype,"size",void 0),jg=TI=v([me("esri.symbols.support.Symbol3DIconOutline")],jg);var zf;const c8="esri.symbols.IconSymbol3DLayer";let gl=zf=class extends jl{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new zf({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,outline:this.outline!=null?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(e){const t=e.color||T0,i=TR(e),r=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||T0).clone()}:null;return new zf({size:e.size,resource:{primitive:hse(e.style)},material:{color:t},outline:r,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const t=!e.color||Zre(e.color)?T0:e.color,i=TR(e);return new zf({size:e.width<=e.height?e.height:e.width,resource:{href:e.url},material:{color:t.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new zf({resource:{href:D4({mediaType:"application/json",data:JSON.stringify(e.data)})}})}};function TR(e){const t="width"in e?e.width:e.size,i="height"in e?e.height:e.size,r=ER(e.xoffset),s=ER(e.yoffset);return(r||s)&&t&&i?{x:-r/t,y:s/i}:null}function ER(e){return isFinite(e)?e:0}v([I({type:ia,json:{write:!0}})],gl.prototype,"material",void 0),v([I({type:vd,json:{write:!0}})],gl.prototype,"resource",void 0),v([qt({Icon:"icon"},{readOnly:!0})],gl.prototype,"type",void 0),v([I(Nl)],gl.prototype,"size",void 0),v([qt({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),I({json:{default:"center"}})],gl.prototype,"anchor",void 0),v([I({type:rm,json:{type:[Number],read:{reader:e=>new rm({x:e[0],y:e[1]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],gl.prototype,"anchorPosition",void 0),v([I({type:jg,json:{write:!0}})],gl.prototype,"outline",void 0),gl=zf=v([me(c8)],gl);const use={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function hse(e){return use[e]||(_t.getLogger(c8).warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Qd=gl;let bd=class extends Ul(At){constructor(t){super(t),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(t){return t!=null&&t.placement===this.placement&&t.style===this.style&&(this.color==null&&t.color==null||this.color!=null&&t.color!=null&&this.color.toJSON()===t.color.toJSON())}};v([I({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],bd.prototype,"type",void 0),v([I({type:Ure,json:{default:"begin-end",write:!0}})],bd.prototype,"placement",void 0),v([I({type:QF,json:{default:"arrow",write:!0}})],bd.prototype,"style",void 0),v([I({type:Bt,json:{type:[Er],default:null,write:!0}})],bd.prototype,"color",void 0),bd=v([me("esri.symbols.LineStyleMarker3D")],bd);const EI=bd;var pb;let _l=pb=class extends jl{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=fh(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new pb(e)}static fromSimpleLineSymbol(e){var i;const t={enabled:!0,size:e.width??fh(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style&&e.style!=="inside-frame"?new x3({style:e.style}):null,material:new ia({color:(e.color||T0).clone()}),marker:e.marker?new EI({placement:e.marker.placement,style:e.marker.style,color:((i=e.marker.color)==null?void 0:i.clone())??null}):null};return new pb(t)}};v([I({type:ia,json:{write:!0}})],_l.prototype,"material",void 0),v([qt({Line:"line"},{readOnly:!0})],_l.prototype,"type",void 0),v([I({type:n8,json:{write:!0,default:"miter"}})],_l.prototype,"join",void 0),v([I({type:E3,json:{write:!0,default:"butt"}})],_l.prototype,"cap",void 0),v([I(Nl)],_l.prototype,"size",void 0),v([I(s8)],_l.prototype,"pattern",void 0),v([I({types:{key:"type",base:EI,typeMap:{style:EI}},json:{write:!0}})],_l.prototype,"marker",void 0),_l=pb=v([me("esri.symbols.LineSymbol3DLayer")],_l);const T_=_l;var II;const dse=Fn()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Vg=II=class extends At{clone(){return new II({href:this.href,primitive:this.primitive})}};v([I({type:String,json:{read:$A,write:vp}})],Vg.prototype,"href",void 0),v([qt(dse)],Vg.prototype,"primitive",void 0),Vg=II=v([me("esri.symbols.support.ObjectSymbol3DLayerResource")],Vg);var MI;let Nd=MI=class extends zt{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new MI({x:this.x,y:this.y,z:this.z})}};v([I({type:Number})],Nd.prototype,"x",void 0),v([I({type:Number})],Nd.prototype,"y",void 0),v([I({type:Number})],Nd.prototype,"z",void 0),Nd=MI=v([me("esri.symbols.support.Symbol3DAnchorPosition3D")],Nd);var AI;let ln=AI=class extends jl{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var e,t,i;return new AI({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(e=this.anchorPosition)==null?void 0:e.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((t=this.material)==null?void 0:t.clone())??null,castShadows:this.castShadows,resource:(i=this.resource)==null?void 0:i.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};v([I({type:ia,json:{write:!0}})],ln.prototype,"material",void 0),v([I({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ln.prototype,"castShadows",void 0),v([I({type:Vg,json:{write:!0}})],ln.prototype,"resource",void 0),v([qt({Object:"object"},{readOnly:!0})],ln.prototype,"type",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"width",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"height",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"depth",void 0),v([qt({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),I({json:{default:"origin"}})],ln.prototype,"anchor",void 0),v([I({type:Nd,json:{type:[Number],read:{reader:e=>new Nd({x:e[0],y:e[1],z:e[2]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y,e.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],ln.prototype,"anchorPosition",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"heading",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"tilt",void 0),v([I({type:Number,json:{write:!0}})],ln.prototype,"roll",void 0),v([I({readOnly:!0})],ln.prototype,"isPrimitive",null),ln=AI=v([me("esri.symbols.ObjectSymbol3DLayer")],ln);const I3=ln;var PI;let En=PI=class extends jl{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,t){return e??(t.height==null&&t.size!=null?t.size:void 0)}readHeight(e,t){return e??(t.width==null&&t.size!=null?t.size:void 0)}clone(){return new PI({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};v([I({type:ia,json:{write:!0}})],En.prototype,"material",void 0),v([I({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],En.prototype,"castShadows",void 0),v([qt({Path:"path"},{readOnly:!0})],En.prototype,"type",void 0),v([I({type:["circle","quad"],json:{write:!0,default:"circle"}})],En.prototype,"profile",void 0),v([I({type:n8,json:{write:!0,default:"miter"}})],En.prototype,"join",void 0),v([I({type:rse,json:{write:!0,default:"butt"}})],En.prototype,"cap",void 0),v([I({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],En.prototype,"width",void 0),v([fi("width",["width","size","height"])],En.prototype,"readWidth",null),v([I({type:Number,json:{write:!0}})],En.prototype,"height",void 0),v([fi("height",["height","size","width"])],En.prototype,"readHeight",null),v([I({type:["center","bottom","top"],json:{write:!0,default:"center"}})],En.prototype,"anchor",void 0),v([I({type:["heading","all"],json:{write:!0,default:"all"}})],En.prototype,"profileRotation",void 0),En=PI=v([me("esri.symbols.PathSymbol3DLayer")],En);const M3=En;var CI;let sm=CI=class extends At{constructor(){super(...arguments),this.color=new Bt([0,0,0,1]),this.size=0}clone(){const e={color:He(this.color),size:this.size};return new CI(e)}};v([I(Ch)],sm.prototype,"color",void 0),v([I(Nl)],sm.prototype,"size",void 0),sm=CI=v([me("esri.symbols.support.Symbol3DHalo")],sm);let I0=class extends Ul(At){constructor(t){super(t),this.color=null}};v([I(Ch)],I0.prototype,"color",void 0),I0=v([me("esri.symbols.support.Symbol3DTextBackground")],I0);var fb;let qn=fb=class extends jl{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,t,i,r){const s={...r,textSymbol3D:!0};t.font=e.write({},s),delete t.font.size}get size(){var e;return this._userSize!=null?this._userSize:((e=this.font)==null?void 0:e.size)!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new fb({enabled:this.enabled,font:this.font&&He(this.font),halo:this.halo&&He(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:He(this.background)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new fb({font:e.font!=null?e.font.clone():new jx,halo:pse(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new ia({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new I0({color:e.backgroundColor.clone()}):null})}};function pse(e,t){return e&&t!=null&&t>0?new sm({color:He(e),size:t}):null}v([I({type:jx,json:{write:!0}})],qn.prototype,"font",null),v([ci("font")],qn.prototype,"writeFont",null),v([I({type:sm,json:{write:!0}})],qn.prototype,"halo",void 0),v([I({...a8,json:{default:"center",write:!0}})],qn.prototype,"horizontalAlignment",void 0),v([I({...o8,json:{default:1,write:!0}})],qn.prototype,"lineHeight",void 0),v([I({type:ia,json:{write:!0}})],qn.prototype,"material",void 0),v([I({type:I0,json:{write:!0}})],qn.prototype,"background",void 0),v([I(Nl)],qn.prototype,"size",null),v([I({type:String,json:{write:!0}})],qn.prototype,"text",void 0),v([qt({Text:"text"},{readOnly:!0})],qn.prototype,"type",void 0),v([I({...l8,json:{default:"baseline",write:!0}})],qn.prototype,"verticalAlignment",void 0),qn=fb=v([me("esri.symbols.TextSymbol3DLayer")],qn);const Wm=qn;var $I;let Du=$I=class extends jl{constructor(e){super(e),this.color=kI.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new $I({color:He(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};v([I({type:Bt,nonNullable:!0,json:{type:[Er],write:(e,t,i)=>t[i]=e.toArray(Bt.AlphaMode.UNLESS_OPAQUE),default:()=>kI.clone(),defaultEquals:e=>e.toCss(!0)===kI.toCss(!0)}})],Du.prototype,"color",void 0),v([qt({Water:"water"},{readOnly:!0})],Du.prototype,"type",void 0),v([I({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Du.prototype,"waterbodySize",void 0),v([I({type:Number,json:{write:!0,default:null}})],Du.prototype,"waveDirection",void 0),v([I({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Du.prototype,"waveStrength",void 0),Du=$I=v([me("esri.symbols.WaterSymbol3DLayer")],Du);const kI=new Bt([0,119,190]),u8=Du;var RI;let wd=RI=class extends zt{constructor(e){super(e),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new RI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};v([I({type:String})],wd.prototype,"name",void 0),v([I({type:String})],wd.prototype,"styleUrl",void 0),v([I({type:String})],wd.prototype,"styleName",void 0),v([I({type:Wa})],wd.prototype,"portal",void 0),wd=RI=v([me("esri.symbols.support.StyleOrigin")],wd);const OI=wd;var LI;let M0=LI=class extends zt{constructor(){super(...arguments),this.url=""}clone(){return new LI({url:this.url})}};v([I({type:String})],M0.prototype,"url",void 0),M0=LI=v([me("esri.symbols.support.Thumbnail")],M0);const h8={icon:Qd,object:I3,line:T_,path:M3,fill:S_,extrude:XF,text:Wm,water:u8},fse=Ut.ofType({base:jl,key:"type",typeMap:h8,errorContext:"symbol-layer"});let vl=class extends Eo{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i==null?void 0:i.type,s=r||Ut;this._set("symbolLayers",new s)}get color(){return null}set color(t){this.constructed&&_t.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){dp(t,this._get("symbolLayers"))}readStyleOrigin(t,i,r){if(t.styleUrl&&t.name){const s=m_(t.styleUrl,r);return new OI({styleUrl:s,name:t.name})}if(t.styleName&&t.name)return new OI({portal:(r==null?void 0:r.portal)||Wa.getDefault(),styleName:t.styleName,name:t.name});r!=null&&r.messages&&r.messages.push(new jc("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:t}))}writeStyleOrigin(t,i,r,s){if(t.styleUrl&&t.name){let n=_x(t.styleUrl,s);Nn(n)&&(n=ta(n)),i.styleOrigin={styleUrl:n,name:t.name}}else t.styleName&&t.name&&(t.portal&&(s!=null&&s.portal)&&!O4(t.portal.restUrl,s.portal.restUrl)?s!=null&&s.messages&&s.messages.push(new jc("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof jl||t&&h8[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};v([I({json:{read:!1,write:!1}})],vl.prototype,"color",null),v([I({type:fse,nonNullable:!0,json:{write:!0}}),As(W4)],vl.prototype,"symbolLayers",null),v([I({type:OI})],vl.prototype,"styleOrigin",void 0),v([fi("styleOrigin")],vl.prototype,"readStyleOrigin",null),v([ci("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],vl.prototype,"writeStyleOrigin",null),v([I({type:M0,json:{read:!1}})],vl.prototype,"thumbnail",void 0),v([I({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],vl.prototype,"type",void 0),vl=v([me("esri.symbols.Symbol3D")],vl);const E_=vl;let Gg=class extends At{constructor(t){super(t),this.visible=!0}clone(){}};v([I({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],Gg.prototype,"type",void 0),v([I({readOnly:!0})],Gg.prototype,"visible",void 0),Gg=v([me("esri.symbols.callouts.Callout3D")],Gg);const d8=Gg;var DI;let mb=DI=class extends At{constructor(e){super(e),this.color=new Bt("white")}clone(){return new DI({color:He(this.color)})}};v([I(Ch)],mb.prototype,"color",void 0),mb=DI=v([me("esri.symbols.callouts.LineCallout3DBorder")],mb);const mse=mb;var NI;let Nu=NI=class extends d8{constructor(e){super(e),this.type="line",this.color=new Bt([0,0,0,1]),this.size=fh(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new NI({color:He(this.color),size:this.size,border:He(this.border)})}};v([qt({line:"line"})],Nu.prototype,"type",void 0),v([I(Ch)],Nu.prototype,"color",void 0),v([I(Nl)],Nu.prototype,"size",void 0),v([I({type:mse,json:{write:!0}})],Nu.prototype,"border",void 0),v([I({readOnly:!0})],Nu.prototype,"visible",null),Nu=NI=v([me("esri.symbols.callouts.LineCallout3D")],Nu);const p8=Nu;function A3(e){if(!e)return!1;const t=e.verticalOffset;return!!t&&!(t.screenLength<=0||t.maxWorldLength!=null&&t.maxWorldLength<=0)}function f8(e){if(!e||!e.supportsCallout||!e.supportsCallout())return!1;const t=e.callout;return!!t&&!!t.visible&&!!A3(e)}const m8={types:{key:"type",base:d8,typeMap:{line:p8}},json:{write:!0}};var zI;let Ff=zI=class extends At{constructor(e){super(e),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new zI({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};v([I(Nl)],Ff.prototype,"screenLength",void 0),v([I({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Ff.prototype,"minWorldLength",void 0),v([I({type:Number,json:{write:!0}})],Ff.prototype,"maxWorldLength",void 0),Ff=zI=v([me("esri.symbols.support.Symbol3DVerticalOffset")],Ff);const P3=Ff;var yb;const y8=Ut.ofType({base:null,key:"type",typeMap:{text:Wm}});let zu=yb=class extends E_{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new y8,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return f8(this)}hasVisibleVerticalOffset(){return A3(this)}clone(){return new yb({styleOrigin:He(this.styleOrigin),symbolLayers:He(this.symbolLayers),thumbnail:He(this.thumbnail),callout:He(this.callout),verticalOffset:He(this.verticalOffset)})}static fromTextSymbol(e){return new yb({symbolLayers:new Ut([Wm.fromTextSymbol(e)])})}};v([I({type:P3,json:{write:!0}})],zu.prototype,"verticalOffset",void 0),v([I(m8)],zu.prototype,"callout",void 0),v([I({json:{read:!1,write:!1}})],zu.prototype,"styleOrigin",void 0),v([I({type:y8})],zu.prototype,"symbolLayers",void 0),v([qt({LabelSymbol3D:"label-3d"},{readOnly:!0})],zu.prototype,"type",void 0),zu=yb=v([me("esri.symbols.LabelSymbol3D")],zu);const C3=zu;var gb;const g8=Ut.ofType({base:null,key:"type",typeMap:{line:T_,path:M3}}),yse=Ut.ofType({base:null,key:"type",typeMap:{line:T_,path:M3}});let qg=gb=class extends E_{constructor(e){super(e),this.symbolLayers=new g8,this.type="line-3d"}clone(){return new gb({styleOrigin:He(this.styleOrigin),symbolLayers:He(this.symbolLayers),thumbnail:He(this.thumbnail)})}static fromSimpleLineSymbol(e){return new gb({symbolLayers:new Ut([T_.fromSimpleLineSymbol(e)])})}};v([I({type:g8,json:{type:yse}})],qg.prototype,"symbolLayers",void 0),v([qt({LineSymbol3D:"line-3d"},{readOnly:!0})],qg.prototype,"type",void 0),qg=gb=v([me("esri.symbols.LineSymbol3D")],qg);const $3=qg;let Fu=class extends Eo{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};v([I({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],Fu.prototype,"angle",void 0),v([I({type:["simple-marker","picture-marker"],readOnly:!0})],Fu.prototype,"type",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],Fu.prototype,"xoffset",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],Fu.prototype,"yoffset",void 0),v([I({type:Number,cast:e=>e==="auto"?e:yr(e),json:{write:!0}})],Fu.prototype,"size",void 0),Fu=v([me("esri.symbols.MarkerSymbol")],Fu);const _8=Fu;var _b;const v8=Ut.ofType({base:null,key:"type",typeMap:{fill:S_}});let Hg=_b=class extends E_{constructor(e){super(e),this.symbolLayers=new v8,this.type="mesh-3d"}clone(){return new _b({styleOrigin:He(this.styleOrigin),symbolLayers:He(this.symbolLayers),thumbnail:He(this.thumbnail)})}static fromSimpleFillSymbol(e){return new _b({symbolLayers:new Ut([S_.fromSimpleFillSymbol(e)])})}};v([I({type:v8})],Hg.prototype,"symbolLayers",void 0),v([qt({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Hg.prototype,"type",void 0),Hg=_b=v([me("esri.symbols.MeshSymbol3D")],Hg);const k3=Hg;function gse(e,t,i){return t.imageData?D4({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):b8(t.url,i)}function b8(e,t){if(!Nn(e)){const i=vse(t);if(i)return hp(i,"images",e)}return m_(e,t)}function _se(e,t,i,r){if(Mp(e)){const s=B0(e);if(!s)return;t.contentType=s.mediaType,t.imageData=s.data,i&&i.imageData===t.imageData&&i.url&&vp(i.url,t,"url",r)}else vp(e,t,"url",r)}const w8={json:{read:{source:["imageData","url"],reader:gse},write:{writer(e,t,i,r){_se(e,t,this.source,r)}}}},x8={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,t,i){const r={};return t.imageData&&(r.imageData=t.imageData),t.contentType&&(r.contentType=t.contentType),t.url&&(r.url=b8(t.url,i)),r}}}};function vse(e){var s,n;if(!e)return null;const{origin:t,layer:i}=e;if(t!=="service"&&t!=="portal-item")return null;const r=i==null?void 0:i.type;return r==="feature"||r==="stream"?(s=i.parsedUrl)==null?void 0:s.path:r==="map-image"||r==="tile"?(n=e.url)==null?void 0:n.path:null}var FI;let qo=FI=class extends e8{constructor(...e){super(...e),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string"&&e.imageData==null)return e;const s={};return e&&(s.url=e),t&&(s.outline=t),i!=null&&(s.width=yr(i)),r!=null&&(s.height=yr(r)),s}clone(){const e=new FI({color:He(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",He(this.source)),e}hash(){var e;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};v([qt({esriPFS:"picture-fill"},{readOnly:!0})],qo.prototype,"type",void 0),v([I(w8)],qo.prototype,"url",void 0),v([I({type:Number,json:{write:!0}})],qo.prototype,"xscale",void 0),v([I({type:Number,json:{write:!0}})],qo.prototype,"yscale",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],qo.prototype,"width",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],qo.prototype,"height",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],qo.prototype,"xoffset",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],qo.prototype,"yoffset",void 0),v([I(x8)],qo.prototype,"source",void 0),qo=FI=v([me("esri.symbols.PictureFillSymbol")],qo);const S8=qo;var BI;let Ca=BI=class extends _8{constructor(...e){super(...e),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string"&&e.imageData==null)return e;const r={};return e&&(r.url=e),t!=null&&(r.width=yr(t)),i!=null&&(r.height=yr(i)),r}readHeight(e,t){return t.size||e}readWidth(e,t){return t.size||e}clone(){const e=new BI({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",He(this.source)),e}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};v([I({json:{write:!1}})],Ca.prototype,"color",void 0),v([qt({esriPMS:"picture-marker"},{readOnly:!0})],Ca.prototype,"type",void 0),v([I(w8)],Ca.prototype,"url",void 0),v([I(x8)],Ca.prototype,"source",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],Ca.prototype,"height",void 0),v([fi("height",["height","size"])],Ca.prototype,"readHeight",null),v([I({type:Number,cast:yr,json:{write:!0}})],Ca.prototype,"width",void 0),v([I({json:{write:!1}})],Ca.prototype,"size",void 0),Ca=BI=v([me("esri.symbols.PictureMarkerSymbol")],Ca);const R3=Ca;var xd;const T8=Ut.ofType({base:null,key:"type",typeMap:{icon:Qd,object:I3,text:Wm}});let Sd=xd=class extends E_{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new T8,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return f8(this)}hasVisibleVerticalOffset(){return A3(this)}clone(){return new xd({verticalOffset:He(this.verticalOffset),callout:He(this.callout),styleOrigin:He(this.styleOrigin),symbolLayers:He(this.symbolLayers),thumbnail:He(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new xd({symbolLayers:new Ut([Qd.fromSimpleMarkerSymbol(e)])})}static fromPictureMarkerSymbol(e){return new xd({symbolLayers:new Ut([Qd.fromPictureMarkerSymbol(e)])})}static fromCIMSymbol(e){var r,s;if(((s=(r=e.data)==null?void 0:r.symbol)==null?void 0:s.type)!=="CIMPointSymbol")return null;const i=e.data.symbol;return new xd(i!=null&&i.callout?{symbolLayers:new Ut([Qd.fromCIMSymbol(e)]),callout:new p8({size:.5,color:new Bt([0,0,0])}),verticalOffset:new P3({screenLength:40})}:{symbolLayers:new Ut([Qd.fromCIMSymbol(e)])})}static fromTextSymbol(e){return new xd({symbolLayers:new Ut([Wm.fromTextSymbol(e)])})}};v([I({type:P3,json:{write:!0}})],Sd.prototype,"verticalOffset",void 0),v([I(m8)],Sd.prototype,"callout",void 0),v([I({type:T8,json:{origins:{"web-scene":{write:!0}}}})],Sd.prototype,"symbolLayers",void 0),v([qt({PointSymbol3D:"point-3d"},{readOnly:!0})],Sd.prototype,"type",void 0),Sd=xd=v([me("esri.symbols.PointSymbol3D")],Sd);const O3=Sd;var Wg;const E8=Ut.ofType({base:null,key:"type",typeMap:{extrude:XF,fill:S_,icon:Qd,line:T_,object:I3,text:Wm,water:u8}});let Zg=Wg=class extends E_{constructor(e){super(e),this.symbolLayers=new E8,this.type="polygon-3d"}initialize(){const e=t=>{t.type==="line"&&xm(_t.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),t.type==="text"&&xm(_t.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const t of this.symbolLayers)e(t);this.addHandles(bp(()=>this.symbolLayers,"after-add",({item:t})=>e(t),wp))}clone(){return new Wg({styleOrigin:He(this.styleOrigin),symbolLayers:He(this.symbolLayers),thumbnail:He(this.thumbnail)})}static fromJSON(e){var i;const t=new Wg;if(t.read(e),t.symbolLayers.length===2&&t.symbolLayers.at(0).type==="fill"&&t.symbolLayers.at(1).type==="line"){const r=t.symbolLayers.at(0),s=t.symbolLayers.at(1);!s.enabled||(i=e.symbolLayers)!=null&&i[1]&&e.symbolLayers[1].enable===!1||(r.outline={size:s.size,color:s.material!=null?s.material.color:null}),t.symbolLayers.removeAt(1)}return t}static fromSimpleFillSymbol(e){return new Wg({symbolLayers:new Ut([S_.fromSimpleFillSymbol(e)])})}};v([I({type:E8,json:{write:!0}})],Zg.prototype,"symbolLayers",void 0),v([qt({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Zg.prototype,"type",void 0),Zg=Wg=v([me("esri.symbols.PolygonSymbol3D")],Zg);const L3=Zg;var UI;const HS=new Ms({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Td=UI=class extends e8{constructor(...e){super(...e),this.color=new Bt([0,0,0,.25]),this.outline=new Hm,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.style=e),t&&(r.outline=t),i&&(r.color=i),r}clone(){return new UI({color:He(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};v([I()],Td.prototype,"color",void 0),v([I()],Td.prototype,"outline",void 0),v([qt({esriSFS:"simple-fill"},{readOnly:!0})],Td.prototype,"type",void 0),v([I({type:HS.apiValues,json:{read:HS.read,write:HS.write}})],Td.prototype,"style",void 0),Td=UI=v([me("esri.symbols.SimpleFillSymbol")],Td);const I8=Td;var jI;const WS=new Ms({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let bl=jI=class extends _8{constructor(...e){super(...e),this.color=new Bt([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Hm}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string")return e;const s={};return e&&(s.style=e),t!=null&&(s.size=yr(t)),i&&(s.outline=i),r&&(s.color=r),s}writeColor(e,t){e&&this.style!=="x"&&this.style!=="cross"&&(t.color=e.toJSON()),e===null&&(t.color=null)}set path(e){this.style="path",this._set("path",e)}clone(){return new jI({angle:this.angle,color:He(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(e=this.outline)==null?void 0:e.hash()}`}};v([I()],bl.prototype,"color",void 0),v([ci("color")],bl.prototype,"writeColor",null),v([qt({esriSMS:"simple-marker"},{readOnly:!0})],bl.prototype,"type",void 0),v([I()],bl.prototype,"size",void 0),v([I({type:WS.apiValues,json:{read:WS.read,write:WS.write}})],bl.prototype,"style",void 0),v([I({type:String,json:{write:!0}})],bl.prototype,"path",null),v([I({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Hm}},json:{default:null,write:!0}})],bl.prototype,"outline",void 0),bl=jI=v([me("esri.symbols.SimpleMarkerSymbol")],bl);const D3=bl;var VI;let ur=VI=class extends Eo{constructor(...e){super(...e),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new jx,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.text=e),t&&(r.font=t),i&&(r.color=i),r}writeLineWidth(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}castLineWidth(e){return yr(e)}writeLineHeight(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}clone(){return new VI({angle:this.angle,backgroundColor:He(this.backgroundColor),borderLineColor:He(this.borderLineColor),borderLineSize:this.borderLineSize,color:He(this.color),font:this.font&&this.font.clone(),haloColor:He(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e,t,i;return`${(e=this.backgroundColor)==null?void 0:e.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(t=this.color)==null?void 0:t.hash()}.${this.font&&this.font.hash()}.${(i=this.haloColor)==null?void 0:i.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};v([I({type:Bt,json:{write:!0}})],ur.prototype,"backgroundColor",void 0),v([I({type:Bt,json:{write:!0}})],ur.prototype,"borderLineColor",void 0),v([I({type:Number,json:{write:!0},cast:yr})],ur.prototype,"borderLineSize",void 0),v([I({type:jx,json:{write:!0}})],ur.prototype,"font",void 0),v([I({...a8,json:{write:!0}})],ur.prototype,"horizontalAlignment",void 0),v([I({type:Boolean,json:{write:!0}})],ur.prototype,"kerning",void 0),v([I({type:Bt,json:{write:!0}})],ur.prototype,"haloColor",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],ur.prototype,"haloSize",void 0),v([I({type:Boolean,json:{write:!0}})],ur.prototype,"rightToLeft",void 0),v([I({type:Boolean,json:{write:!0}})],ur.prototype,"rotated",void 0),v([I({type:String,json:{write:!0}})],ur.prototype,"text",void 0),v([qt({esriTS:"text"},{readOnly:!0})],ur.prototype,"type",void 0),v([I({...l8,json:{write:!0}})],ur.prototype,"verticalAlignment",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],ur.prototype,"xoffset",void 0),v([I({type:Number,cast:yr,json:{write:!0}})],ur.prototype,"yoffset",void 0),v([I({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],ur.prototype,"angle",void 0),v([I({type:Number,json:{write:!0}})],ur.prototype,"width",void 0),v([I({type:Number})],ur.prototype,"lineWidth",void 0),v([ci("lineWidth")],ur.prototype,"writeLineWidth",null),v([As("lineWidth")],ur.prototype,"castLineWidth",null),v([I(o8)],ur.prototype,"lineHeight",void 0),v([ci("lineHeight")],ur.prototype,"writeLineHeight",null),ur=VI=v([me("esri.symbols.TextSymbol")],ur);const Vx=ur;var GI;let $a=GI=class extends Eo{constructor(e){super(e),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=this.portal!=null?this.portal:Wa.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t==null?void 0:t.portal,super.read(e,t)}clone(){return new GI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol("webRef",e)}fetchCIMSymbol(e){return this._fetchSymbol("cimRef",e)}async _fetchSymbol(e,t){const i=t!=null?t.cache:null,r=i?this._fetchCacheKey:null;if(i!=null){const o=r&&i.get(r);if(o)return o.clone()}const{resolveWebStyleSymbol:s}=await ht(()=>import("./webStyleSymbolUtils-1gcc6uYW.js"),__vite__mapDeps([160,161,124,125]));dr(t);const n=s(this,{portal:this.portal},e,t);n.catch(o=>{_t.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const c=await n;return e==="webRef"&&c.type==="point-3d"||e==="cimRef"&&c.type==="cim"?(i!=null&&i.set(r,c.clone()),c):null}};v([I({json:{write:!1}})],$a.prototype,"color",void 0),v([I({type:String,json:{write:!0}})],$a.prototype,"styleName",void 0),v([I({type:Wa,json:{write:!1}})],$a.prototype,"portal",void 0),v([I({type:String,json:{read:$A,write:vp}})],$a.prototype,"styleUrl",void 0),v([I({type:M0,json:{read:!1}})],$a.prototype,"thumbnail",void 0),v([I({type:String,json:{write:!0}})],$a.prototype,"name",void 0),v([qt({styleSymbolReference:"web-style"},{readOnly:!0})],$a.prototype,"type",void 0),v([I()],$a.prototype,"_fetchCacheKey",null),$a=GI=v([me("esri.symbols.WebStyleSymbol")],$a);const Gx=$a;function z_e(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function F_e(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const N3={base:Eo,key:"type",typeMap:{"simple-fill":I8,"picture-fill":S8,"picture-marker":R3,"simple-line":Hm,"simple-marker":D3,text:Vx,"label-3d":C3,"line-3d":$3,"mesh-3d":k3,"point-3d":O3,"polygon-3d":L3,"web-style":Gx,cim:Ux},errorContext:"symbol"},B_e={base:Eo,key:"type",typeMap:{"picture-marker":R3,"simple-marker":D3,text:Vx,"web-style":Gx,cim:Ux},errorContext:"symbol"},U_e=nA({types:N3}),j_e={base:Eo,key:"type",typeMap:{"simple-fill":I8,"picture-fill":S8,"picture-marker":R3,"simple-line":Hm,"simple-marker":D3,text:Vx,"line-3d":$3,"mesh-3d":k3,"point-3d":O3,"polygon-3d":L3,"web-style":Gx,cim:Ux},errorContext:"symbol"},V_e={base:Eo,key:"type",typeMap:{text:Vx,"label-3d":C3},errorContext:"symbol"},G_e={base:Eo,key:"type",typeMap:{"line-3d":$3,"mesh-3d":k3,"point-3d":O3,"polygon-3d":L3,"web-style":Gx,cim:Ux},errorContext:"symbol"},q_e={base:Eo,key:"type",typeMap:{"label-3d":C3},errorContext:"symbol"},H_e=Uc(N3);var qI;function bse(e){if(!e)return null;const t={};for(const i in e){const r=Pm(e[i]);r&&(t[i]=r)}return Object.keys(t).length!==0?t:null}function wse(e){if(e==null)return null;const t={};for(const i in e){const r=e[i];r&&(t[i]=r.toJSON())}return Object.keys(t).length!==0?t:null}let In=qI=class extends Ul(At){constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:u0(),configurable:!0})}normalizeCtorArgs(e,t,i,r){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:i,popupTemplate:r}}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}cloneShallow(){return new qI({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const t=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[t,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(e&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(e){var t;return(t=this.attributes)==null?void 0:t[e]}setAttribute(e,t){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",i,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var e;return{aggregateGeometries:wse(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:qT(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((e=this.popupTemplate)==null?void 0:e.toJSON())??null}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(e={}){const{geometry:t}=this;if((t==null?void 0:t.type)==="mesh"){const i={origin:t.origin,transform:t.transform};this._notifyLayer("origin-transform",i,i,e.action)}}_notifyLayer(e,t,i,r){if(!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:t,newValue:i};e==="origin-transform"&&(s.action=r),e==="attributes"&&(s.attributeName=r),this.layer.graphicChanged(s)}};v([I({value:null,json:{read:bse}})],In.prototype,"aggregateGeometries",null),v([I({value:null})],In.prototype,"attributes",null),v([I({value:null,types:Ex,json:{read:Pm}})],In.prototype,"geometry",null),v([I({type:Boolean})],In.prototype,"isAggregate",void 0),v([I({clonable:"reference"})],In.prototype,"layer",void 0),v([I({clonable:"reference"})],In.prototype,"origin",void 0),v([I({type:Ore})],In.prototype,"popupTemplate",void 0),v([I({clonable:"reference"})],In.prototype,"sourceLayer",void 0),v([I({value:null,types:N3})],In.prototype,"symbol",null),v([I({type:Boolean,value:!0})],In.prototype,"visible",null),In=qI=v([me("esri.Graphic")],In),function(e){e.generateUID=u0}(In||(In={}));const HI=In;let A0=class extends w0{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};v([q4({Type:HI,ensureType:zn(HI)})],A0.prototype,"itemType",void 0),A0=v([me("esri.support.GraphicsCollection")],A0);let Bu=class extends zt{constructor(t){super(t),this.view=null,this.baseLayerViews=new Ut,this.referenceLayerViews=new Ut,this._loadingHandle=ti(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap},i=>{i&&i.load().catch(()=>{})},mn)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,r;if(this.view&&this.view.suspended)return!1;const t=(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap;return!!t&&!!t.loaded&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};v([I({constructOnly:!0})],Bu.prototype,"view",void 0),v([I({readOnly:!0})],Bu.prototype,"baseLayerViews",void 0),v([I({readOnly:!0})],Bu.prototype,"referenceLayerViews",void 0),v([I({readOnly:!0})],Bu.prototype,"suspended",null),v([I({type:Boolean,readOnly:!0})],Bu.prototype,"updating",null),Bu=v([me("esri.views.BasemapView")],Bu);function xse(e){return"tryRecycleWith"in e}let Sse=class{constructor(t,i,r){this.layer=t,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=sa(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,eo(this._controller.signal,()=>{const s=new Je("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(s)})}tryRecycle(t){if(!this.done||!this.layerView||!xse(this.layerView))return null;const i=this.layer.type,r=this._controller.signal;for(let s=0;s<t.length;s++){const n=t[s];if(n.type!==i)continue;const c=this.layerView.tryRecycleWith(n,{signal:r});if(c){t.splice(s,1),this.layer=n;const o=this.layerView,p=o.view;return this.promise=Promise.race([c.then(()=>(dr(this._controller.signal),n.emit("layerview-destroy",{view:p,layerView:o}),p.emit("layerview-destroy",{view:p,layerView:o}),n.emit("layerview-create",{view:p,layerView:o}),p.emit("layerview-create",{view:p,layerView:o}),o)),new Promise((g,S)=>eo(this._controller.signal,()=>S(Nr())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:t}),r.emit("layerview-destroy",{layer:i,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var s,n;if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:i,view:r}=this;this._map=r.map;try{let c,o;if(await i.load({signal:t}),i.prefetchResources&&await i.prefetchResources({signal:t}),Ese(i))c=await i.createLayerView(r,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new Je("layer:view-not-supported","No layerview implementation was found");const S=await this.layerViewImporter.importLayerView(i);dr(t),c="default"in S?new S.default({layer:i,view:r}):new S({layer:i,view:r})}const p=()=>{o=gr(o),c.destroyed||c.destroy(),c.layer=null,c.parent=null,c.view=null,this.done=!0};o=eo(t,p),dr(t);try{await c.when()}catch(S){throw p(),S}if(!((n=(s=this._map)==null?void 0:s.allLayers)==null?void 0:n.includes(i)))return p(),void this._deferred.reject(new Je("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=c,i.emit("layerview-create",{view:r,layerView:c}),r.emit("layerview-create",{layer:i,layerView:c}),this.done=!0,this._deferred.resolve(c)}catch(c){i.emit("layerview-create-error",{view:r,error:c}),r.emit("layerview-create-error",{layer:i,error:c}),this.done=!0,this._deferred.reject(new Je("layerview:create-error","layerview creation failed",{layer:i,error:c}))}}},Ho=class extends zt{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new op,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const i=(r=this.view.map)==null?void 0:r.allLayers;if(i)for(const s of i)this.layerViewImporter.hasLayerViewModule(s)&&this.layerViewImporter.importLayerView(s)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=sa(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(d_(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var p,g,S;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,s=[],n=this.view.ready,c=M=>{if(M!=null){for(const A of M)if(A){r.add(A);const O=this._layerLayerViewInfoMap.get(A);O&&n?O.start():O||this._recyclingInfoMap.has(A)||s.push(A),"layers"in A&&A.layers&&c(A.layers)}}};for(const M of this._rootCollectionNames)c(Va(this,M));for(const[M,A]of this._layerLayerViewInfoMap)if(!r.has(M)){this._layerLayerViewInfoMap.delete(A.layer);const O=A.tryRecycle(s);O?(this.notifyChange("updating"),this._recyclingInfoMap.set(A.layer,A),O.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(A.layer),this._layerLayerViewInfoMap.set(A.layer,A),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(A.layer),A.destroy(),this._reschedule()})):A.destroy()}for(const[M,A]of this._recyclingInfoMap)r.has(M)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(A.layer),A.destroy());for(const M of s)this._createLayerView(M);this._refreshCollections();const o=[(p=i==null?void 0:i.ground)==null?void 0:p.layers,(g=i==null?void 0:i.basemap)==null?void 0:g.baseLayers,(S=i==null?void 0:i.basemap)==null?void 0:S.referenceLayers,i==null?void 0:i.layers].filter(M=>!!M);r.forEach(M=>"layers"in M&&o.push(M.layers)),this.addHandles(o.map(M=>this._watchUpdatingTracking.addOnCollectionChange(()=>M,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([bp(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ti(()=>{const t=this.view,i=t==null?void 0:t.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,t==null?void 0:t.ready]},()=>this._reschedule(),Fa)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),IS(this._recyclingInfoMap),IS(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Nr()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||ax(this._layerLayerViewInfoMap,t=>!t.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++t;return t}clear(){this.destroyed||(IS(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new Je("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}_refreshCollections(){for(const[t,i]of this._layersToLayerViews)this._populateLayerViewsOwners(Va(this,t),Va(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,i,r){if(!t||!i)return void(i&&i.removeAll());let s=0;for(const n of t){const c=this._layerLayerViewInfoMap.get(n);if(!(c!=null&&c.layerView))continue;const o=c.layerView;o.layer=n,o.parent=r,i.at(s)!==o&&i.splice(s,0,o),n.layers&&this._populateLayerViewsOwners(n.layers,o.layerViews,o),s+=1}s<i.length&&i.splice(s,i.length)}_createLayerView(t){t.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const i=new Sse(t,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),r=>{r&&(qs(r)||r.name==="cancelled:layerview-create")||_t.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(t,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};v([I()],Ho.prototype,"_workPromise",void 0),v([I({readOnly:!0})],Ho.prototype,"_watchUpdatingTracking",void 0),v([I({readOnly:!0})],Ho.prototype,"_layersToLayerViews",null),v([I({readOnly:!0})],Ho.prototype,"_rootCollectionNames",null),v([I()],Ho.prototype,"layerViewImporter",void 0),v([I()],Ho.prototype,"supportsGround",void 0),v([I({readOnly:!0})],Ho.prototype,"updating",null),v([I({readOnly:!0})],Ho.prototype,"updatingRemaining",null),v([I({constructOnly:!0})],Ho.prototype,"view",void 0),Ho=v([me("esri.views.LayerViewManager")],Ho);const Tse=Ho;function Ese(e){return"createLayerView"in e&&e.createLayerView!=null}let mo=class extends zt{constructor(t){super(t),this.factor=1.5,this.offset=Ln(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};v([I({type:Number})],mo.prototype,"factor",void 0),v([I({nonNullable:!0})],mo.prototype,"offset",void 0),v([I()],mo.prototype,"position",void 0),v([I({type:Number,range:{min:0}})],mo.prototype,"size",void 0),v([I()],mo.prototype,"maskUrl",void 0),v([I()],mo.prototype,"maskEnabled",void 0),v([I()],mo.prototype,"overlayUrl",void 0),v([I()],mo.prototype,"overlayEnabled",void 0),v([I({readOnly:!0})],mo.prototype,"version",null),v([I({type:Boolean})],mo.prototype,"visible",void 0),mo=v([me("esri.views.Magnifier")],mo);const M8=mo;let vb=class{constructor(t){this._observable=new f_,this._map=new Map(t)}get size(){return Ot(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(t){const i=this._map.delete(t);return i&&this._observable.notify(),i}entries(){return Ot(this._observable),this._map.entries()}forEach(t,i){Ot(this._observable),this._map.forEach((r,s)=>t.call(i,r,s,this),i)}get(t){return Ot(this._observable),this._map.get(t)}has(t){return Ot(this._observable),this._map.has(t)}keys(){return Ot(this._observable),this._map.keys()}set(t,i){return this._map.set(t,i),this._observable.notify(),this}values(){return Ot(this._observable),this._map.values()}[Symbol.iterator](){return Ot(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var WI;let Yg=WI=class extends At{constructor(e){super(e),this.name=null,this.code=null}clone(){return new WI({name:this.name,code:this.code})}};v([I({type:String,json:{write:!0}})],Yg.prototype,"name",void 0),v([I({type:[String,Number],json:{write:!0}})],Yg.prototype,"code",void 0),Yg=WI=v([me("esri.layers.support.CodedValue")],Yg);const Ise=new Ms({inherited:"inherited",codedValue:"coded-value",range:"range"});let Jg=class extends At{constructor(t){super(t),this.name=null,this.type=null}};v([I({type:String,json:{write:!0}})],Jg.prototype,"name",void 0),v([qt(Ise)],Jg.prototype,"type",void 0),Jg=v([me("esri.layers.support.Domain")],Jg);const qx=Jg;var ZI;let Kg=ZI=class extends qx{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const i=String(e);this.codedValues.some(r=>(String(r.code)===i&&(t=r.name),!!t))}return t}clone(){return new ZI({codedValues:He(this.codedValues),name:this.name})}};v([I({type:[Yg],json:{write:!0}})],Kg.prototype,"codedValues",void 0),v([qt({codedValue:"coded-value"})],Kg.prototype,"type",void 0),Kg=ZI=v([me("esri.layers.support.CodedValueDomain")],Kg);const A8=Kg;var YI;let bb=YI=class extends qx{constructor(e){super(e),this.type="inherited"}clone(){return new YI}};v([qt({inherited:"inherited"})],bb.prototype,"type",void 0),bb=YI=v([me("esri.layers.support.InheritedDomain")],bb);const P8=bb;var JI;let Bf=JI=class extends qx{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new JI({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};v([I({json:{type:[Number],read:{source:"range",reader:(e,t)=>{var i;return(i=t.range)==null?void 0:i[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(e,t,i){t[i]=[this.minValue||0,e]}}}})],Bf.prototype,"maxValue",void 0),v([I({json:{type:[Number],read:{source:"range",reader:(e,t)=>{var i;return(i=t.range)==null?void 0:i[0]}},write:{target:"range",writer(e,t,i){t[i]=[e,this.maxValue||0]}}}})],Bf.prototype,"minValue",void 0),v([qt({range:"range"})],Bf.prototype,"type",void 0),Bf=JI=v([me("esri.layers.support.RangeDomain")],Bf);const C8=Bf,Mse={key:"type",base:qx,typeMap:{range:C8,"coded-value":A8,inherited:P8}};function Ase(e){if(!(e!=null&&e.type))return null;switch(e.type){case"range":return C8.fromJSON(e);case"codedValue":return A8.fromJSON(e);case"inherited":return P8.fromJSON(e)}return null}const Pse=new Ms({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var KI;const Cse=new Ms({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let cn=KI=class extends At{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let i=null;try{i=t?JSON.parse(t):null}catch{}return(i==null?void 0:i.value)??null}readValueType(e,{description:t}){let i=null;try{i=t?JSON.parse(t):null}catch{}return i?Cse.fromJSON(i.fieldValueType):null}clone(){var e;return new KI({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((e=this.domain)==null?void 0:e.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};v([I({type:String,json:{write:!0}})],cn.prototype,"alias",void 0),v([I({type:[String,Number],json:{write:{allowNull:!0}}})],cn.prototype,"defaultValue",void 0),v([I()],cn.prototype,"description",void 0),v([fi("description")],cn.prototype,"readDescription",null),v([I({types:Mse,json:{read:{reader:Ase},write:!0}})],cn.prototype,"domain",void 0),v([I({type:Boolean,json:{write:!0}})],cn.prototype,"editable",void 0),v([I({type:Er,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],cn.prototype,"length",void 0),v([I({type:String,json:{write:!0}})],cn.prototype,"name",void 0),v([I({type:Boolean,json:{write:!0}})],cn.prototype,"nullable",void 0),v([qt(Pse)],cn.prototype,"type",void 0),v([I()],cn.prototype,"valueType",void 0),v([fi("valueType",["description"])],cn.prototype,"readValueType",null),v([I({type:Boolean,json:{read:!1}})],cn.prototype,"visible",void 0),cn=KI=v([me("esri.layers.support.Field")],cn);const $se=cn;var XI;let Uf=XI=class extends At{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new XI({mapLayerId:e,gdbVersion:t})}};v([qt({mapLayer:"map-layer"})],Uf.prototype,"type",void 0),v([I({type:Er,json:{write:!0}})],Uf.prototype,"mapLayerId",void 0),v([I({type:String,json:{write:!0}})],Uf.prototype,"gdbVersion",void 0),Uf=XI=v([me("esri.layers.support.source.MapLayerSource")],Uf);var QI;let Tc=QI=class extends At{constructor(e){super(e),this.type="query-table"}clone(){const{workspaceId:e,query:t,oidFields:i,spatialReference:r,geometryType:s}=this,n={workspaceId:e,query:t,oidFields:i,spatialReference:(r==null?void 0:r.clone())??void 0,geometryType:s};return new QI(n)}};v([qt({queryTable:"query-table"})],Tc.prototype,"type",void 0),v([I({type:String,json:{write:!0}})],Tc.prototype,"workspaceId",void 0),v([I({type:String,json:{write:!0}})],Tc.prototype,"query",void 0),v([I({type:String,json:{write:!0}})],Tc.prototype,"oidFields",void 0),v([I({type:mi,json:{write:!0}})],Tc.prototype,"spatialReference",void 0),v([qt(dK)],Tc.prototype,"geometryType",void 0),Tc=QI=v([me("esri.layers.support.source.QueryTableDataSource")],Tc);var eM;let jf=eM=class extends At{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new eM({workspaceId:e,dataSourceName:t})}};v([qt({raster:"raster"})],jf.prototype,"type",void 0),v([I({type:String,json:{write:!0}})],jf.prototype,"dataSourceName",void 0),v([I({type:String,json:{write:!0}})],jf.prototype,"workspaceId",void 0),jf=eM=v([me("esri.layers.support.source.RasterDataSource")],jf);var tM;let Ed=tM=class extends At{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:i}=this;return new tM({workspaceId:e,gdbVersion:t,dataSourceName:i})}};v([qt({table:"table"})],Ed.prototype,"type",void 0),v([I({type:String,json:{write:!0}})],Ed.prototype,"workspaceId",void 0),v([I({type:String,json:{write:!0}})],Ed.prototype,"gdbVersion",void 0),v([I({type:String,json:{write:!0}})],Ed.prototype,"dataSourceName",void 0),Ed=tM=v([me("esri.layers.support.source.TableDataSource")],Ed);var iM,rM;const kse=Fn()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let yo=iM=class extends At{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,i){return IR()(e,t,i)}castLeftTableSource(e){return Uc(sM(),e)}readRightTableSource(e,t,i){return IR()(e,t,i)}castRightTableSource(e){return Uc(sM(),e)}clone(){const{leftTableKey:e,rightTableKey:t,leftTableSource:i,rightTableSource:r,joinType:s}=this,n={leftTableKey:e,rightTableKey:t,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(r==null?void 0:r.clone())??void 0,joinType:s};return new iM(n)}};v([qt({joinTable:"join-table"})],yo.prototype,"type",void 0),v([I({type:String,json:{write:!0}})],yo.prototype,"leftTableKey",void 0),v([I({type:String,json:{write:!0}})],yo.prototype,"rightTableKey",void 0),v([I({json:{write:!0}})],yo.prototype,"leftTableSource",void 0),v([fi("leftTableSource")],yo.prototype,"readLeftTableSource",null),v([As("leftTableSource")],yo.prototype,"castLeftTableSource",null),v([I({json:{write:!0}})],yo.prototype,"rightTableSource",void 0),v([fi("rightTableSource")],yo.prototype,"readRightTableSource",null),v([As("rightTableSource")],yo.prototype,"castRightTableSource",null),v([qt(kse)],yo.prototype,"joinType",void 0),yo=iM=v([me("esri.layers.support.source.JoinTableDataSource")],yo);let ZS=null;function IR(){return ZS||(ZS=nA({types:sM()})),ZS}let YS=null;function sM(){return YS||(YS={key:"type",base:null,typeMap:{"data-layer":Ac,"map-layer":Uf}}),YS}const Rse={key:"type",base:null,typeMap:{"join-table":yo,"query-table":Tc,raster:jf,table:Ed}};let Ac=rM=class extends At{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new rM({fields:e,dataSource:t})}};v([qt({dataLayer:"data-layer"})],Ac.prototype,"type",void 0),v([I({type:[$se],json:{write:!0}})],Ac.prototype,"fields",void 0),v([I({types:Rse,json:{write:!0}})],Ac.prototype,"dataSource",void 0),Ac=rM=v([me("esri.layers.support.source.DataLayerSource")],Ac),Ac.from=zn(Ac);let Id=class extends Ul(At){constructor(t){super(t),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};v([I({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Id.prototype,"onFields",void 0),v([I({type:String,json:{write:!0}})],Id.prototype,"operator",void 0),v([I({type:String,json:{write:!0}})],Id.prototype,"searchTerm",void 0),v([I({type:String,json:{write:!0}})],Id.prototype,"searchType",void 0),Id=v([me("esri.rest.support.FullTextSearch")],Id);const Ose=Id;var nM;const MR=new Ms({upperLeft:"upper-left",lowerLeft:"lower-left"});let Md=nM=class extends At{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new nM(He({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};v([I({type:Bi,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Md.prototype,"extent",void 0),v([I({type:["view","edit"],json:{write:!0}})],Md.prototype,"mode",void 0),v([I({type:String,json:{read:MR.read,write:MR.write}})],Md.prototype,"originPosition",void 0),v([I({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Md.prototype,"tolerance",void 0),Md=nM=v([me("esri.rest.support.QuantizationParameters")],Md);const $8=Md,Lse=new Ms({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var oM;const AR=new Ms({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let ka=oM=class extends At{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(t.statisticParameters=He(e))}clone(){return new oM({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:He(this.statisticParameters)})}};v([I({type:Number,json:{write:!0}})],ka.prototype,"maxPointCount",void 0),v([I({type:Number,json:{write:!0}})],ka.prototype,"maxRecordCount",void 0),v([I({type:Number,json:{write:!0}})],ka.prototype,"maxVertexCount",void 0),v([I({type:String,json:{write:!0}})],ka.prototype,"onStatisticField",void 0),v([I({type:String,json:{write:!0}})],ka.prototype,"outStatisticFieldName",void 0),v([I({type:String,json:{read:{source:"statisticType",reader:AR.read},write:{target:"statisticType",writer:AR.write}}})],ka.prototype,"statisticType",void 0),v([I({type:Object})],ka.prototype,"statisticParameters",void 0),v([ci("statisticParameters")],ka.prototype,"writeStatisticParameters",null),ka=oM=v([me("esri.rest.support.StatisticDefinition")],ka);const Dse=ka;var wb;const Nse=new Ms({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Lt=wb=class extends At{static from(e){return lx(wb,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const i={};for(const r in e){const s=e[r];Array.isArray(s)?i[r]=s.map(n=>n instanceof Date?n.getTime():n):s instanceof Date?i[r]=s.getTime():i[r]=s}t.parameterValues=i}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new wb(He({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};Lt.MAX_MAX_RECORD_COUNT_FACTOR=5,v([I({json:{write:!0}})],Lt.prototype,"aggregateIds",void 0),v([I({type:Boolean,json:{write:!0}})],Lt.prototype,"cacheHint",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"compactGeometryEnabled",void 0),v([I({json:{write:!0}})],Lt.prototype,"datumTransformation",void 0),v([As("datumTransformation")],Lt.prototype,"castDatumTransformation",null),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"defaultSpatialReferenceEnabled",void 0),v([I({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],Lt.prototype,"distance",void 0),v([I({type:Ac,json:{write:!0}})],Lt.prototype,"dynamicDataSource",void 0),v([I({type:String,json:{write:!0}})],Lt.prototype,"formatOf3DObjects",void 0),v([I({type:[Ose],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],Lt.prototype,"fullText",void 0),v([I({type:String,json:{write:!0}})],Lt.prototype,"gdbVersion",void 0),v([I({types:Ex,json:{read:Pm,write:!0}})],Lt.prototype,"geometry",void 0),v([I({type:Number,json:{write:!0}})],Lt.prototype,"geometryPrecision",void 0),v([I({type:[String],json:{write:!0}})],Lt.prototype,"groupByFieldsForStatistics",void 0),v([I({type:String,json:{write:!0}})],Lt.prototype,"having",void 0),v([I({type:Date})],Lt.prototype,"historicMoment",void 0),v([ci("historicMoment")],Lt.prototype,"writeHistoricMoment",null),v([I({type:Number,json:{write:!0}})],Lt.prototype,"maxAllowableOffset",void 0),v([I({type:Number,cast:e=>e<1?1:e>Lt.MAX_MAX_RECORD_COUNT_FACTOR?Lt.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],Lt.prototype,"maxRecordCountFactor",void 0),v([I({type:["xyFootprint"],json:{write:!0}})],Lt.prototype,"multipatchOption",void 0),v([I({type:Number,json:{read:{source:"resultRecordCount"}}})],Lt.prototype,"num",void 0),v([I({json:{write:!0}})],Lt.prototype,"objectIds",void 0),v([I({type:[String],json:{write:!0}})],Lt.prototype,"orderByFields",void 0),v([I({type:[String],json:{write:!0}})],Lt.prototype,"outFields",void 0),v([I({type:mi,json:{name:"outSR",write:!0}})],Lt.prototype,"outSpatialReference",void 0),v([I({type:[Dse],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],Lt.prototype,"outStatistics",void 0),v([I({json:{write:!0}})],Lt.prototype,"parameterValues",void 0),v([ci("parameterValues")],Lt.prototype,"writeParameterValues",null),v([I({type:ri,json:{write:!0}})],Lt.prototype,"pixelSize",void 0),v([I({type:$8,json:{write:!0}})],Lt.prototype,"quantizationParameters",void 0),v([I({type:[Object],json:{write:!0}})],Lt.prototype,"rangeValues",void 0),v([I({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],Lt.prototype,"relationParameter",void 0),v([I({type:String,json:{write:!0}})],Lt.prototype,"resultType",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"returnCentroid",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"returnDistinctValues",void 0),v([I({type:Boolean,json:{default:!0,write:!0}})],Lt.prototype,"returnExceededLimitFeatures",void 0),v([I({type:Boolean,json:{write:!0}})],Lt.prototype,"returnGeometry",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"returnQueryGeometry",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"returnM",void 0),v([I({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Lt.prototype,"returnZ",void 0),v([I({type:mi,json:{write:!0}})],Lt.prototype,"sourceSpatialReference",void 0),v([qt(Lse,{ignoreUnknown:!1,name:"spatialRel"})],Lt.prototype,"spatialRelationship",void 0),v([I({type:Number,json:{read:{source:"resultOffset"}}})],Lt.prototype,"start",void 0),v([ci("start"),ci("num")],Lt.prototype,"writeStart",null),v([I({type:String,json:{write:!0}})],Lt.prototype,"sqlFormat",void 0),v([I({type:String,json:{write:!0}})],Lt.prototype,"text",void 0),v([I({type:x_,json:{write:!0}})],Lt.prototype,"timeExtent",void 0),v([I({type:Boolean,json:{default:!1,write:!0}})],Lt.prototype,"timeReferenceUnknownClient",void 0),v([qt(Nse,{ignoreUnknown:!1}),I({json:{write:{overridePolicy(e){return{enabled:!!e&&this.distance!=null&&this.distance>0}}}}})],Lt.prototype,"units",void 0),v([I({type:String,json:{write:{overridePolicy(e){return{enabled:e!=null||this.start!=null&&this.start>0}}}}})],Lt.prototype,"where",void 0),v([ci("where")],Lt.prototype,"writeWhere",null),Lt=wb=v([me("esri.rest.support.Query")],Lt);const PR=Lt;let Ec=class extends xh.EventedAccessor{constructor(t){super(t),this._selectionMap=new vb,this._trashCan=[],this._layerEditHandles=new Ut,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([ti(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),bp(()=>this.sources,"change",i=>{const r=this._selectionMap;for(const s of i.removed)r.delete(s);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const t=new Ut;this.view.when().then(()=>{this.view.map.allLayers.flatten(i=>"sublayers"in i&&i.sublayers?i.sublayers:null).forEach(i=>{(_v(i)&&!cZ(i)||wf(i))&&t.add(i)}),this._set("sources",t)})}destroy(){this._layerEditHandles.drain(gr)}get selections(){return Array.from(this._selectionMap.entries()).map(t=>{const[i,r]=t;return{layer:i,selection:[...r.selection]}})}get count(){let t=0;for(const i of this._selectionMap.values())t+=i.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._get("sources")}set sources(t){this._set("sources",t)}async getSelectedFeatures(t,i={},r="layerView"){const{view:s,selections:n}=this,c=(t!==void 0?n.filter(o=>t.includes(o.layer)):n).filter(o=>o.selection.length>0).map(async o=>{const{layer:p,selection:g}=o,S=wf(p)?p.parent:p;if(S==null||!CR(S))return null;if(r==="layer")return $R(S,g,i);const M=await s.whenLayerView(S);return $R(M,g,i)});return(await Promise.all(c)).filter(o=>o!==null)}updateSelection(t){const i=new Map;for(const[n,c]of this._selectionMap)i.set(n,[...c.selection]);let r=!1;const s=t.current.concat(t.added);for(const n of s){const c=n.sourceLayer,o=n.getObjectId();if(this.sources.includes(c)&&(_v(c)||wf(c))&&o!==null){const p=rA(i,c,()=>[]);p.includes(o)||(p.push(o),r=!0)}}for(const n of t.removed){const c=n.sourceLayer,o=n.getObjectId();if(this.sources.includes(c)&&(_v(c)||wf(c))&&o!==null){const p=i.get(c),g=p==null?void 0:p.indexOf(o);g!==void 0&&g>=0&&(p==null||p.splice(g,1),r=!0)}}if(r){const{_selectionMap:n,_trashCan:c}=this,o=[];for(const[p,g]of i){const S=n.get(p);S!==void 0&&c.push(S),n.set(p,{selection:g}),o.push({layer:p,selection:g,...ZC(S!==void 0?S.selection:[],g)})}this._onSelectionChange(o)}}setSelection(t,i){this._setSelection(t,i)}getSelection(t){const i=this._selectionMap.get(t);return i==null?void 0:i.selection}appendToSelection(t,i){const r=this._selectionMap.get(t),s=r!==void 0?[...r.selection]:[];for(const n of i)s.includes(n)||s.push(n);this._setSelection(t,s)}removeFromSelection(t,i){const r=this._selectionMap.get(t);if(!r)return;const s=[];for(const n of r.selection)i.includes(n)||s.push(n);this._setSelection(t,s)}toggleInSelection(t,i){const r=this._selectionMap.get(t);if(!r||r.selection.length===0)return void this._setSelection(t,i);const s=new Set(r.selection),n=new Set(i),c=CG(s,n);this._setSelection(t,Array.from(c))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const i=[];for(const[r,s]of this._selectionMap.entries())i.push({layer:r,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){var c;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const o=this._trashCan.pop();(c=o==null?void 0:o.highlightHandle)==null||c.remove()}const{sources:t,view:i,_selectionMap:r,showHighlight:s}=this,n=this._vizTaskId;for(const o of t){const p=r.get(o),g=wf(o)?o.parent:o;g!=null&&CR(g)&&i.whenLayerView(g).then(S=>{var M;(M=p==null?void 0:p.highlightHandle)==null||M.remove(),p!==void 0&&s&&n===this._vizTaskId&&"highlight"in S&&typeof S.highlight=="function"&&p.selection.length>0&&(p.highlightHandle=S.highlight(p.selection,"selection"))})}}_refreshListeners(){this._layerEditHandles.drain(gr);for(const t of this.sources){const i=wf(t)?t.parent:t;if(i!=null&&_v(i)){const r=i.on("edits",s=>{this._handleEditChanges(s,t)});this._layerEditHandles.push(r)}}}_handleEditChanges(t,i){if(t.deletedFeatures!==void 0&&t.deletedFeatures.length>0&&this._selectionMap.has(i)){const r=t.deletedFeatures.filter(s=>s.error==null).map(s=>s.objectId).filter(O0);this.removeFromSelection(i,r)}}_setSelection(t,i){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const r=this._selectionMap.get(t);if(r===void 0||!Fse(r,{selection:i})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(t,{selection:[...i]});const s={layer:t,selection:[...i],...ZC(r!==void 0?r.selection:[],i)};this._onSelectionChange([s])}}};v([I({readOnly:!0,nonNullable:!0})],Ec.prototype,"selections",null),v([I({readOnly:!0,nonNullable:!0})],Ec.prototype,"count",null),v([I({constructOnly:!0,nonNullable:!0})],Ec.prototype,"view",void 0),v([I({readOnly:!0,nonNullable:!0})],Ec.prototype,"hasSelection",null),v([I()],Ec.prototype,"showHighlight",void 0),v([I()],Ec.prototype,"sources",null),Ec=v([me("esri.views.SelectionManager")],Ec);const _v=e=>e.createQuery!==void 0&&e.on!==void 0,zse=e=>e.layer!==void 0,CR=e=>(e==null?void 0:e.when)!==void 0,Fse=(e,t)=>{if(e==null&&t==null)return!0;if(e!=null&&t==null||e==null&&t!=null)return!1;if(e!=null&&t!=null&&e.selection!=null&&t.selection!=null){const i=[...e.selection],r=[...t.selection];if(i.length!==r.length)return!1;i.sort(),r.sort();for(let s=0;s<i.length;s++)if(i[s]!==r[s])return!1}return!0},$R=async(e,t,i={})=>{let r;if(zse(e)){const s=e;r=s===void 0?null:await s.queryFeatures(new PR({...i,objectIds:t})).then(n=>({data:n,layer:e.layer}))}else{const s=e;r=s===void 0?null:await s.queryFeatures(new PR({...i,objectIds:t})).then(n=>({data:n,layer:s}))}return r},Bse=Ec;let Xg=class extends Ul(zt){constructor(t){super(t),this.accentColor=new Bt([255,127,0]),this.textColor=new Bt([255,255,255])}};v([I({type:Bt,nonNullable:!0})],Xg.prototype,"accentColor",void 0),v([I({type:Bt,nonNullable:!0})],Xg.prototype,"textColor",void 0),Xg=v([me("esri.views.Theme")],Xg);const aM=Xg;var kR;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"})(kR||(kR={}));const k8=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],R8={};function O8(e){return!!R8[e]}function Use(e){for(const t of e)if(!O8(t))return!1;return!0}k8.forEach(e=>{R8[e]=!0});let jse=class{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach(({handler:i,priority:r},s)=>{var n;return(n=this.inputManager)==null?void 0:n.installHandlers(s,[i],r)})}disconnect(){this.inputManager&&this._handlers.forEach((t,i)=>{var r;return(r=this.inputManager)==null?void 0:r.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,i,r,s){const n=Array.isArray(t)?t:t.split(",");if(!Use(n))return n.some(O8)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let c,o;Array.isArray(i)?o=i:(c=i,o=[]),typeof r=="function"?c=r:s=r,s=s??ch.DEFAULT;const p=this._createUniqueGroupName(),g=new Vse(this.view,n,o,c);this._handlers.set(p,{handler:g,priority:s});for(const S of n){const M=this._handlerCounts.get(S)||0;this._handlerCounts.set(S,M+1)}return this.inputManager&&this.inputManager.installHandlers(p,[g],s),Qi(()=>this._removeHandler(p,n))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,i){if(this._handlers.has(t)){this._handlers.delete(t);for(const r of i){const s=this._handlerCounts.get(r);s===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",r):s===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,s-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Vse=class extends ps{constructor(t,i,r,s){super(!0),this._latestDragStart=void 0,this.view=t;for(const n of i)switch(n){case"click":this.registerIncoming("click",r,c=>s(this._wrapClick(c)));break;case"double-click":this.registerIncoming("double-click",r,c=>s(this._wrapDoubleClick(c)));break;case"immediate-click":this.registerIncoming("immediate-click",r,c=>s(this._wrapImmediateClick(c)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,c=>s(this._wrapImmediateDoubleClick(c)));break;case"hold":this.registerIncoming("hold",r,c=>s(this._wrapHold(c)));break;case"drag":this.registerIncoming("drag",r,c=>{const o=this._wrapDrag(c);o&&s(o)});break;case"key-down":this.registerIncoming("key-down",r,c=>s(this._wrapKeyDown(c)));break;case"key-up":this.registerIncoming("key-up",r,c=>s(this._wrapKeyUp(c)));break;case"pointer-down":this.registerIncoming("pointer-down",r,c=>s(this._wrapPointer(c,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,c=>s(this._wrapPointer(c,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,c=>s(this._wrapPointer(c,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,c=>s(this._wrapPointerDrag(c)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,c=>s(this._wrapMouseWheel(c)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,c=>s(this._wrapPointer(c,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,c=>s(this._wrapPointer(c,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,c=>{s(this._wrapGamepad(c))});break;case"focus":this.registerIncoming("focus",r,c=>{s(this._wrapFocus(c))});break;case"blur":this.registerIncoming("blur",r,c=>{s(this._wrapBlur(c))})}}_wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:i=>t.async(i),preventDefault:()=>t.preventDefault()}}_wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:i=>t.async(i),preventDefault:()=>t.preventDefault()}}_wrapClick(t){const{pointerType:i,button:r,buttons:s,x:n,y:c,native:o,eventId:p}=t.data,{cancelable:g,timestamp:S}=t;return{type:"click",pointerType:i,button:r,buttons:s,x:n,y:c,native:o,timestamp:S,screenPoint:Ln(n,c),mapPoint:this._getMapPoint(n,c),eventId:p,cancelable:g,stopPropagation:()=>t.stopPropagation(),async:M=>t.async(M),preventDefault:()=>t.preventDefault()}}_wrapDoubleClick(t){const{pointerType:i,button:r,buttons:s,x:n,y:c,native:o,eventId:p}=t.data,{cancelable:g,timestamp:S}=t;return{type:"double-click",pointerType:i,button:r,buttons:s,x:n,y:c,native:o,timestamp:S,mapPoint:this._getMapPoint(n,c),eventId:p,cancelable:g,stopPropagation:()=>t.stopPropagation(),async:M=>t.async(M),preventDefault:()=>t.preventDefault()}}_wrapImmediateClick(t){const{pointerType:i,button:r,buttons:s,x:n,y:c,native:o,eventId:p}=t.data,g=o.pointerId,{cancelable:S,timestamp:M}=t;return{type:"immediate-click",pointerId:g,pointerType:i,button:r,buttons:s,x:n,y:c,native:o,timestamp:M,mapPoint:this._getMapPoint(n,c),eventId:p,cancelable:S,stopPropagation:()=>t.stopPropagation(),async:A=>t.async(A),preventDefault:()=>t.preventDefault()}}_wrapImmediateDoubleClick(t){const{pointerType:i,button:r,buttons:s,x:n,y:c,native:o,eventId:p}=t.data,g=o.pointerId,{cancelable:S,timestamp:M}=t;return{type:"immediate-double-click",pointerId:g,pointerType:i,button:r,buttons:s,x:n,y:c,native:o,timestamp:M,mapPoint:this._getMapPoint(n,c),eventId:p,cancelable:S,stopPropagation:()=>t.stopPropagation(),async:A=>t.async(A),preventDefault:()=>t.preventDefault()}}_wrapHold(t){const{pointerType:i,button:r,buttons:s,x:n,y:c,native:o}=t.data,{cancelable:p,timestamp:g}=t;return{type:"hold",pointerType:i,button:r,buttons:s,x:n,y:c,native:o,timestamp:g,mapPoint:this._getMapPoint(n,c),cancelable:p,stopPropagation:()=>t.stopPropagation(),async:S=>t.async(S),preventDefault:()=>t.preventDefault()}}_getMapPoint(t,i){return this.view.toMap(Ln(t,i),{exclude:[]})}_wrapDrag(t){const i=t.data,{x:r,y:s}=i.center,{action:n,pointerType:c,button:o}=i;if(n==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const p=i.pointer.native,g=i.buttons,{cancelable:S,timestamp:M}=t,A={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:r,y:s,origin:A,pointerType:c,button:o,buttons:g,radius:i.radius,angle:DN(i.angle),native:p,timestamp:M,cancelable:S,stopPropagation:()=>t.stopPropagation(),async:O=>t.async(O),preventDefault:()=>t.preventDefault()}}_wrapKeyDown(t){const{key:i,repeat:r,native:s}=t.data,{cancelable:n,timestamp:c}=t;return{type:"key-down",key:i,repeat:r,native:s,timestamp:c,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}_wrapKeyUp(t){const{key:i,native:r}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-up",key:i,native:r,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:c=>t.async(c),preventDefault:()=>t.preventDefault()}}_wrapPointer(t,i){const{x:r,y:s,button:n,buttons:c,native:o,eventId:p}=t.data,g=o.pointerId,S=o.pointerType,{cancelable:M,timestamp:A}=t;return{type:i,x:r,y:s,pointerId:g,pointerType:S,button:n,buttons:c,native:o,timestamp:A,eventId:p,cancelable:M,stopPropagation:()=>t.stopPropagation(),async:O=>t.async(O),preventDefault:()=>t.preventDefault()}}_wrapPointerDrag(t){const{x:i,y:r,buttons:s,native:n,eventId:c}=t.data.currentEvent,{button:o}=t.data.startEvent,p=t.data.startEvent.native.pointerId,g=t.data.startEvent.native.pointerType,S=t.data.action,M={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:A,timestamp:O}=t;return{type:"pointer-drag",x:i,y:r,pointerId:p,pointerType:g,button:o,buttons:s,action:S,origin:M,native:n,timestamp:O,eventId:c,cancelable:A,stopPropagation:()=>t.stopPropagation(),async:z=>t.async(z),preventDefault:()=>t.preventDefault()}}_wrapMouseWheel(t){const{cancelable:i,data:r,timestamp:s}=t,{x:n,y:c,deltaY:o,native:p}=r;return{type:"mouse-wheel",x:n,y:c,deltaY:o,native:p,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),async:g=>t.async(g),preventDefault:()=>t.preventDefault()}}_wrapGamepad(t){const{action:i,state:r,device:s}=t.data,{cancelable:n,timestamp:c}=t,{buttons:o,axes:p}=r;return{type:"gamepad",device:s,timestamp:c,action:i,buttons:o,axes:p,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:g=>t.async(g),preventDefault:()=>t.preventDefault()}}};var Q0,RR,OR;(function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"})(Q0||(Q0={})),function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"}(RR||(RR={})),function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"}(OR||(OR={}));function Gse(e){return[e.on("before-add",t=>{const i=t.item;if(i==null||e.includes(i))return _t.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()}),e.on("after-remove",t=>{const i=t.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function lM(e){return e.visible&&e.getEditableFlag!=null&&e.getEditableFlag(Q0.USER)&&e.getEditableFlag(Q0.MANAGER)}function wl(e){return Ln(e.x,e.y)}function L8(e,t){var r;const i=(r=e instanceof HTMLElement?e:e.surface)==null?void 0:r.getBoundingClientRect();return i?Ln(t.clientX-i.left,t.clientY-i.top):Ln(0,0)}function D8(e,t){return t instanceof Event?L8(e,t):wl(t)}function N8(e){if(e instanceof Event)return!0;if(typeof e=="object"&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let qse=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,i){const r=()=>t.stopPropagation();switch(t.type){case"pointer-move":LR(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!DR(t))break;const s=wl(t),n=this._intersect(s,t.pointerType,i.forEachTool);if(n==null)break;const c=n.manipulator,o=n.tool;c==null||o==null||!c.interactive||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._releaseManipulatorBeforeDragging(c,t,i),c!=null&&o!=null&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:c,tool:o,start:s,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(n.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:s}),r());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,i);break;case"pointer-drag":{if(!DR(t))break;const s=this._grabbedManipulators.get(t.pointerId),n=s==null?void 0:s.manipulator,c=s==null?void 0:s.tool;if(n==null||c==null)break;const o=wl(t);o.x=Ol(o.x,0,i.view.width),o.y=Ol(o.y,0,i.view.height);const p=s.start,g=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,g?n.events.emit("drag",{action:"update",start:p,screenPoint:o}):n.events.emit("drag",{action:"start",start:p,screenPoint:o,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:c,manipulator:n,start:p}));break;case"end":n.dragging=!1,g&&n.events.emit("drag",{action:"end",start:p,screenPoint:o}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,i)}r();break}case"immediate-click":{const s=wl(t),n=this._intersect(s,t.pointerType,i.forEachTool);if(Hse(t)||i.forEachTool(g=>{if((n==null||n.tool!==g||g.automaticManipulatorSelection)&&g.manipulators){let S=!1;g.manipulators.forEach(({manipulator:M})=>{M.selected&&(M.selected=!1,S=!0)}),S&&g.onManipulatorSelectionChanged&&g.onManipulatorSelectionChanged()}}),n==null)break;const{manipulator:c,tool:o}=n;if(!c.interactive)break;c.selectable&&o.automaticManipulatorSelection&&(c.selected=!c.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const p=t.native.shiftKey;c.events.emit("immediate-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:p,stopPropagation:r}),JS(c,r);break}case"click":{const s=wl(t),n=this._intersect(s,t.pointerType,i.forEachTool),c=n==null?void 0:n.manipulator;if(c==null||!c.interactive)break;const o=t.native.shiftKey;c.events.emit(t.type,{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:o}),r();break}case"double-click":{const s=wl(t),n=this._intersect(s,t.pointerType,i.forEachTool),c=n!=null?n.manipulator:null;if(c==null||!c.interactive)break;const o=t.native.shiftKey;c.events.emit("double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:r}),JS(c,r);break}case"immediate-double-click":{const s=wl(t),n=this._intersect(s,t.pointerType,i.forEachTool),c=n!=null?n.manipulator:null;if(c==null||!c.interactive)break;const o=t.native.shiftKey;c.events.emit("immediate-double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:r}),JS(c,r);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(t,i,r){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:wl(i)}),this._grabbedManipulators.forEach(({manipulator:s},n)=>{s===t&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(t,i){var s;const r=(s=this._grabbedManipulators.get(t.pointerId))==null?void 0:s.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:wl(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_cursorFromMap(t){let i=null;return ax(t,({manipulator:r})=>!(r==null||!r.interactive)&&(r.grabbing&&r.grabCursor?(i=r.grabCursor,!0):!!r.cursor&&(i=r.cursor,!0))),i}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:s})=>{i.add(s)}),this._hoveredManipulators.forEach(({tool:s})=>{r.add(s)}),t(s=>{s.hasGrabbedManipulators=i.has(s),s.hasHoveredManipulators=r.has(s);const n=this._grabbedManipulators.values(),c=N7(n,({tool:o})=>o===s);s.firstGrabbedManipulator=c!=null?c.manipulator:null})}clearPointers(t,{forEachTool:i,setActiveTool:r},s=!0,n){const c=(o,p)=>o===t&&(n==null||n===p);this._grabbedManipulators.forEach(({tool:o,manipulator:p,pointerType:g},S)=>{c(o,p)&&(this._grabbedManipulators.delete(S),p.grabbing=!1,p.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:g}))}),this._draggedManipulators.forEach(({tool:o,manipulator:p},g)=>{c(o,p)&&(this._draggedManipulators.delete(g),p.dragging=!1,p.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:o,manipulator:p},g)=>{c(o,p)&&(this._hoveredManipulators.delete(g),p.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(i)}_intersect(t,i,r){let s=null;return r(n=>{if(n.manipulators==null||!lM(n))return!1;const c=n.manipulators.intersect(t,i);return c!=null&&(s={tool:n,manipulator:c},!0)}),s}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Ln(i.x,i.y),r,i.pointerType,t)})}handleHoverEvent(t,i){t.type!=="pointer-up"&&t.type!=="immediate-click"&&t.type!=="pointer-move"||!LR(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(wl(t),t.pointerId,t.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(t,i,r,s){var o;let n=this._intersect(t,r,s);const c=(o=this._hoveredManipulators.get(i))==null?void 0:o.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&c===n.manipulator||(c!=null&&(c.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(i,n)):this._hoveredManipulators.delete(i),this._onFocusChange(s))}_afterManipulatorRelease(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}};function LR(e){return e==="mouse"}function DR(e){return e.pointerType!=="mouse"||e.button===0}function Hse(e){return!!e.native.shiftKey}function JS(e,t){e!=null&&e.consumesClicks&&t()}const NR="attached",KS="tools",zR=1e3;let xl=class extends zt{constructor(t){super(t),this._updatingHandles=new op,this._clock=Bm,this._manipulatorState=new qse,this.tools=new Ut,this.cursor=null,this._interacting=!1,this._interactingTimeout=zR,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const r of this.tools.items)if(i(r))return}}initialize(){this.addHandles([this.view.on(k8,t=>{this._handleInputEvent(t)},ch.TOOL),...Gse(this.tools),this.tools.on("before-add",({item:t})=>{this._updateToolEditableFlag(t)}),this.tools.on("before-remove",({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(t=>t.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(t!=null&&!this.view.ready)return void _t.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const i=this.activeTool;this._set("activeTool",t),i!=null&&i.deactivate(),t!=null&&t.activate(),this._removeIncompleteTools(t);for(const r of this.tools){this._updateToolEditableFlag(r);const s=lM(r);this.activeTool!=null&&s||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(t=>t.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=gr(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var t;this.view.type==="3d"?this.addHandles([ti(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(t=this.view.elevationProvider)==null?void 0:t.on("elevation-change",i=>this._forEachManipulator(r=>r.onElevationChange(i)))],NR):this.addHandles(ti(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(NR),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:r})=>t(r,i))})}_handleInputEvent(t){let i=!1;const r={...t,stopPropagation:()=>{i=!0,t.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(s=>{!i&&s.visible&&s.handleInputEvent(r)}),!i&&t.type==="key-down"&&t.key==="Escape"&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor(),t.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(KS),this._forEachTool(t=>{if(t instanceof zt){const i=ti(()=>[t.cursor,t.visible,t.editable],()=>{lM(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,KS)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),t.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],KS)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){var i;(i=t.setEditableFlag)==null||i.call(t,Q0.MANAGER,this.activeTool==null||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;t==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(t=i.cursor,!0)),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter(i=>(t==null||i!==t)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){const t=this;return{setClock:i=>this._clock=i,set interactingTimeoutEnabled(i){t._interactingTimeout=i?zR:0},get interactingTimeoutEnabled(){return t._interactingTimeout!==0}}}};v([I({constructOnly:!0,nonNullable:!0})],xl.prototype,"view",void 0),v([I({value:null})],xl.prototype,"activeTool",null),v([I({readOnly:!0,type:Ut})],xl.prototype,"tools",void 0),v([I({readOnly:!0})],xl.prototype,"cursor",void 0),v([I({readOnly:!0})],xl.prototype,"updating",null),v([I()],xl.prototype,"_interacting",void 0),v([I({readOnly:!0})],xl.prototype,"interacting",null),xl=v([me("esri.views.ToolViewManager")],xl);let Vf=class extends zt{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",t.mapping==="standard"?this._detectedDeviceType="standard":Wse.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Zse[this.deviceType]}};v([I({nonNullable:!0,readOnly:!0})],Vf.prototype,"nativeIndex",void 0),v([I({type:String,readOnly:!0})],Vf.prototype,"deviceType",null),v([I({type:Number,readOnly:!0})],Vf.prototype,"axisThreshold",null),Vf=v([me("esri.views.input.gamepad.GamepadInputDevice")],Vf);const Wse=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Zse={standard:.15,spacemouse:.025,unknown:0},z3=Vf;let Qg=class extends zt{constructor(...t){super(...t),this.devices=new Ut,this.enabledFocusMode="document"}};v([I({type:Ut.ofType(z3),readOnly:!0})],Qg.prototype,"devices",void 0),v([I({type:["document","view","none"]})],Qg.prototype,"enabledFocusMode",void 0),Qg=v([me("esri.views.input.gamepad.GamepadSettings")],Qg);const Yse=Qg;let xb=class extends zt{constructor(){super(...arguments),this.gamepad=new Yse}};v([I({readOnly:!0})],xb.prototype,"gamepad",void 0),xb=v([me("esri.views.input.Input")],xb);const Jse=xb;let Uu=class extends zt{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};v([I({type:Boolean,nonNullable:!0})],Uu.prototype,"enabled",void 0),v([I({type:z3})],Uu.prototype,"device",void 0),v([I({type:["pan","zoom"],nonNullable:!0})],Uu.prototype,"mode",void 0),v([I({type:["forward-down","forward-up"],nonNullable:!0})],Uu.prototype,"tiltDirection",void 0),v([I({type:Number,nonNullable:!0})],Uu.prototype,"velocityFactor",void 0),Uu=v([me("esri.views.navigation.gamepad.GamepadSettings")],Uu);const z8=Uu;let Ad=class extends zt{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new z8,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};v([I({type:Boolean})],Ad.prototype,"browserTouchPanEnabled",void 0),v([I({type:z8,nonNullable:!0})],Ad.prototype,"gamepad",void 0),v([I({type:Boolean})],Ad.prototype,"momentumEnabled",void 0),v([I({type:Boolean})],Ad.prototype,"mouseWheelZoomEnabled",void 0),Ad=v([me("esri.views.navigation.Navigation")],Ad);const F8=Ad,B8={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer"},U8=Object.values(B8),j8=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${U8.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),Kse=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${U8.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),Xse=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function d1e(e){return!!j8.test(e)}function Hx(e){if(e==null)return null;const t=Mr(e),i=(t==null?void 0:t.path.match(j8))||(t==null?void 0:t.path.match(Kse));if(!i)return null;const[,r,s,n,c]=i,o=s.indexOf("/");return{title:V8(o!==-1?s.slice(o+1):s),serverType:B8[n.toLowerCase()],sublayer:c!=null&&c!==""?parseInt(c,10):null,url:{path:r}}}function Qse(e){const t=Mr(e).path.match(Xse);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function V8(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function p1e(e,t){const i=[];if(e){const r=Hx(e);r!=null&&r.title&&i.push(r.title)}if(t){const r=V8(t);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function f1e(e){if(!e)return!1;const t=".arcgis.com/",i="//services",r="//tiles",s="//features",n=(e=e.toLowerCase()).includes(t),c=e.includes(i)||e.includes(r)||e.includes(s);return n&&c}function ene(e,t){return e&&dx(N4(e,t))}function m1e(e){let{url:t}=e;if(!t)return{url:t};t=N4(t,e.logger);const i=Mr(t),r=Hx(i.path);let s;if(r!=null)r.sublayer!=null&&e.layer.layerId==null&&(s=r.sublayer),t=r.url.path;else if(e.nonStandardUrlAllowed){const n=Qse(i.path);n!=null&&(t=n.serviceUrl,s=n.sublayerId)}return{url:dx(t),layerId:s}}function y1e(e,t,i,r,s){vp(t,r,"url",s),r.url&&e.layerId!=null&&(r.url=hp(r.url,i,e.layerId.toString()))}function g1e(e){if(!e)return!1;const t=e.toLowerCase(),i=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),s=t.includes("/imageserver/wmsserver"),n=t.includes("/wmsserver");return i&&(r||s||n)}var FR;function tne(e){var r;if(e.type==="integrated-mesh-3dtiles")return null;const t=e.url?Hx(e.url):void 0;return!(((r=e.spatialReference)==null?void 0:r.vcsWkid)==null&&t!=null&&t.serverType==="ImageServer")&&G8(e)&&e.heightModelInfo?e.heightModelInfo:ine(e)?m3.deriveUnitFromSR(sne,e.spatialReference):null}function G8(e){return"heightModelInfo"in e}function q8(e){if(e.type==="unknown"||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function ine(e){return q8(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):H8(e)}function rne(e){return e.layers!=null||H8(e)||q8(e)||G8(e)}function H8(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(FR||(FR={}));const sne=new m3({heightModel:"gravity-related-height"});var Dw;(function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"})(Dw||(Dw={}));let cM,XS=null;async function nne(e){XS||(XS=ht(()=>import("./geometryServiceUtils-DynSZflB.js"),__vite__mapDeps([162,163])).then(t=>cM=t)),await XS,dr(e)}async function W8(e,t,i,r){if(!e)return null;const s=e.spatialReference;return Mh()||Dl(s,t)?Ah(e,t):cM?cM.projectGeometry(e,t,i,r):(await Promise.race([nne(r),vh(r)]),W8(e,t,i,r))}let Vi=class extends zt{constructor(t){super(t),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=L0(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var r,s,n,c;const t=(r=this.map)==null?void 0:r.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:t==null?void 0:t.basemap,layers:(s=t==null?void 0:t.basemap)==null?void 0:s.baseLayers},{layers:t==null?void 0:t.layers},{parent:t==null?void 0:t.ground,layers:(n=t==null?void 0:t.ground)==null?void 0:n.layers},{parent:t==null?void 0:t.basemap,layers:(c=t==null?void 0:t.basemap)==null?void 0:c.referenceLayers}),i}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:t,updating:i}=this._allLayers;let r=null;for(const n of t){const c=this._getSupportedSpatialReferences(n);if(c.length>0){const o=this._narrowDownSpatialReferenceCandidates(r,c);o!=null&&(r=o)}if(r!=null&&r.length===1)break}if(i&&(r==null||r.length!==1))return{updating:!0};const s=this._pickSpatialReferenceCandidate(r);return{spatialReference:s!=null?s.spatialReference:null,viewingMode:s!=null?s.viewingMode:null,updating:!1}}get _tileInfoTask(){var r,s,n,c,o,p,g;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:t,updating:i}=this._collectLayers([{parent:(s=(r=this.map)==null?void 0:r.call(this))==null?void 0:s.basemap,layers:(o=(c=(n=this.map)==null?void 0:n.call(this))==null?void 0:c.basemap)==null?void 0:o.baseLayers},{layers:(g=(p=this.map)==null?void 0:p.call(this))==null?void 0:g.layers}]);if(t&&t.length>0&&"tileInfo"in t[0]){const S=t[0].tileInfo;return{tileInfo:S&&S.spatialReference.equals(this.spatialReference)?S:null,updating:!1}}return{updating:i}}get _heightModelInfoTask(){var r,s,n;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:t,updating:i}=this._allLayers;for(const c of t)if(rne(c)){const o=tne(c);if(o)return{heightModelInfo:o,vcsWkid:(s=c.spatialReference)==null?void 0:s.vcsWkid,latestVcsWkid:(n=c.spatialReference)==null?void 0:n.latestVcsWkid,updating:!1}}return{updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=this._allLayers,i=t.updating,r=[];for(const s of t.layers){const n="fullExtents"in s&&s.fullExtents||(s.fullExtent!=null?[s.fullExtent]:[]),c=this.requiresExtentInSpatialReference?null:n[0],o=n.find(p=>p.spatialReference.equals(this.spatialReference))??c;if(o)return{candidates:[{extent:o,layer:s}],updating:!1};if(this._getSupportedSpatialReferences(s).length>0)for(const p of n)r.push({extent:p,layer:s})}return{candidates:r,updating:i}}get _extentTask(){const{candidates:t,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(t==null||t.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(t),s=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=L0(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:s.clone(),task:px(async n=>{try{const c=await W8(r.extent,s,"portalItem"in r.layer?r.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:c}}catch{if(ra(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,i){if(t==null)return i;const r=[],s=(n,c)=>n!=null?c!=null?n===c&&n:n:c;for(const n of t)for(const c of i){if(!n.spatialReference.equals(c.spatialReference))continue;const o=s(n.viewingMode,c.viewingMode);if(o!==!1){r.push({spatialReference:n.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(t){const i=this.defaultSpatialReference;return t==null||t.length<1?i!=null?{spatialReference:i,viewingMode:null}:null:(i!=null&&t.length>1&&t.some(({spatialReference:r})=>r.equals(i))&&(t=t.filter(({spatialReference:r})=>r.equals(i))),t.length>1&&t.some(({viewingMode:r})=>r!==Dw.Local)&&(t=t.filter(({viewingMode:r})=>r!==Dw.Local)),t[0])}_getSupportedSpatialReferences(t){const i="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(i.length===0)return[];const r=[];for(const s of i){const n=this.getSpatialReferenceSupport({spatialReference:s,layer:t});if(n!=null){const c=n.constraints!=null?n.constraints:[{spatialReference:s,viewingMode:null}];for(const{spatialReference:o,viewingMode:p}of c)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!o.equals(this.userSpatialReference)||r.push({spatialReference:o,viewingMode:p})}}return r}_pickExtentCandidate(t){const i=this.spatialReference;return t.find(({extent:r})=>i.equals(r.spatialReference))||t[0]}_collectLayers(t){var r;if(this._loadMaybe((r=this.map)==null?void 0:r.call(this))!=="loaded")return{layers:[],updating:!0};const i=new one;for(const s of t)if(this._collectCollection(s,i),i.preloading===this.sourcePreloadCount)break;return{layers:i.layers,updating:i.updating}}_collectCollection(t,i){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const r of t.layers){switch(this._loadMaybe(r)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":i.updating||i.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},i)}if(i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&t.loadStatus!=null?t.loadStatus==="not-loaded"?(t.load().catch(i=>{qs(i)||console.log(i)}),"loading"):t.loadStatus:"loaded"}};v([I()],Vi.prototype,"required",void 0),v([I({constructOnly:!0})],Vi.prototype,"map",void 0),v([I({constructOnly:!0})],Vi.prototype,"getSpatialReferenceSupport",void 0),v([I()],Vi.prototype,"defaultSpatialReference",void 0),v([I()],Vi.prototype,"userSpatialReference",void 0),v([I()],Vi.prototype,"sourcePreloadCount",void 0),v([I()],Vi.prototype,"priorityCollection",void 0),v([I()],Vi.prototype,"requiresExtentInSpatialReference",void 0),v([I()],Vi.prototype,"suspended",void 0),v([I({readOnly:!0})],Vi.prototype,"ready",null),v([I({readOnly:!0})],Vi.prototype,"heightModelInfoReady",null),v([I({readOnly:!0})],Vi.prototype,"spatialReference",null),v([I({readOnly:!0})],Vi.prototype,"extent",null),v([I({readOnly:!0})],Vi.prototype,"heightModelInfo",null),v([I({readOnly:!0})],Vi.prototype,"vcsWkid",null),v([I({readOnly:!0})],Vi.prototype,"latestVcsWkid",null),v([I({readOnly:!0})],Vi.prototype,"viewingMode",null),v([I({readOnly:!0})],Vi.prototype,"tileInfo",null),v([I({readOnly:!0})],Vi.prototype,"mapCollections",null),v([I({readOnly:!0})],Vi.prototype,"_allLayers",null),v([I({readOnly:!0})],Vi.prototype,"_spatialReferenceTask",null),v([I({readOnly:!0})],Vi.prototype,"_tileInfoTask",null),v([I({readOnly:!0})],Vi.prototype,"_heightModelInfoTask",null),v([I({readOnly:!0})],Vi.prototype,"_extentCandidatesTask",null),v([I()],Vi.prototype,"_extentTask",null),v([I()],Vi.prototype,"_projectExtentTask",void 0),Vi=v([me("esri.views.support.DefaultsFromMap")],Vi);let one=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var e0;let Ct=e0=class extends xh.EventedMixin(_A(zt)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new XM,this.updatingHandles=new op,this.allLayerViews=new G0({getCollections:()=>{var t,i,r;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:lne}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new A0,this.analyses=new Aw,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ut,this.magnifier=new M8,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Jse,this.navigation=new F8,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new jse(this),this.persistableViewModels=new Ut,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(ti(()=>this.preconditionsReady,t=>{var r,s;const i=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,e0.views.add(this)):(this._lockedSpatialReference=null,e0.views.remove(this)),this.notifyChange("spatialReference"),!t&&i)(r=this.toolViewManager)==null||r.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(s=this.layerViewManager)==null||s.clear(),this._teardown();else if(t&&!i){try{this._startup()}catch(n){return void queueMicrotask(()=>{console.error("View._startup failed",n),this.fatalError=new Je("startup-error",null,n)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},wp))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,Ix(()=>this.ready)))),this.basemapView=new Bu({view:this}),this.layerViewManager=new Tse({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new xl({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new Bse({view:this}),this.addHandles([ti(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},Fa),ti(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},wp),ti(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},Fa)])}_setupSpatialReferenceLogger(){let e=null;this.addHandles([ti(()=>{var t;return(t=this.defaultsFromMap)==null?void 0:t.ready},t=>{var r;const i=((r=this.map)==null?void 0:r.allLayers.length)>0;if(t&&!this.spatialReference&&i){if(e!=null)return;const s=Qi(()=>e=L0(e));e=px(async n=>{try{await Q5(this.spatialReferenceWarningDelay,null,n)}catch{return}finally{e=null}_t.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(s,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var e,t;this.destroyed||(e0.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=nr(this.graphics),this.analyses=nr(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),nr(this.analysisViewManager),this.toolViewManager=nr(this.toolViewManager),this.layerViewManager=nr(this.layerViewManager),this.selectionManager=nr(this.selectionManager),this.basemapView=nr(this.basemapView),(e=this.groundView)==null||e.destroy(),(t=this.layerViews)==null||t.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=nr(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return _t.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var e;return(e=this.toolViewManager)==null?void 0:e.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Vi({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:e=>this.getSpatialReferenceSupport(e),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var e;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||hh.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((e=this.defaultsFromMap)!=null&&e.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e!=null&&e.destroyed&&(_t.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),hh.isLoadable(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get spatialReference(){var t,i;const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&((i=(t=this.defaultsFromMap)==null?void 0:t.required)!=null&&i.heightModelInfo)){const r=e.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return e}set spatialReference(e){const t=!Hs(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Ll}set timeZone(e){const t=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));this._userTimeZone=e,e===Ll||e===s3||t.has(e.toLowerCase())||i.has(e.toLowerCase())||_t.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){var e;return(e=this.toolViewManager)==null?void 0:e.tools}get initialExtent(){var e;return(e=this.defaultsFromMap)==null?void 0:e.extent}get cursor(){var e;return((e=this.toolViewManager)==null?void 0:e.cursor)??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new aM}whenLayerView(e){var t;return((t=this.layerViewManager)==null?void 0:t.whenLayerView(e))??Promise.reject()}getDefaultSpatialReference(){var e;return(e=this.defaultsFromMap)==null?void 0:e.spatialReference}getDefaultHeightModelInfo(){var e;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((e=this.defaultsFromMap)==null?void 0:e.heightModelInfo)??null}getDefaultTimeZone(){return null}importLayerView(e){throw new Je("importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport({spatialReference:e})!=null}when(e,t){return this.isResolved()&&!this.ready&&_t.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(yh(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};Ct.views=new Ut,v([I()],Ct.prototype,"_userSpatialReference",void 0),v([I()],Ct.prototype,"activeTool",null),v([I({readOnly:!0})],Ct.prototype,"allLayerViews",void 0),v([I()],Ct.prototype,"groundView",void 0),v([I()],Ct.prototype,"animation",null),v([I()],Ct.prototype,"basemapView",void 0),v([I()],Ct.prototype,"center",null),v([I({readOnly:!0})],Ct.prototype,"_defaultsFromMapSettings",null),v([I()],Ct.prototype,"defaultsFromMap",null),v([I()],Ct.prototype,"fatalError",void 0),v([I({type:Bi})],Ct.prototype,"extent",null),v([I(fR(A0,"graphics"))],Ct.prototype,"graphics",void 0),v([I(fR(Aw,"analyses"))],Ct.prototype,"analyses",void 0),v([I({readOnly:!0,type:m3})],Ct.prototype,"heightModelInfo",null),v([I({readOnly:!0})],Ct.prototype,"interacting",null),v([I({readOnly:!0})],Ct.prototype,"navigating",null),v([I({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Ct.prototype,"preconditionsReady",null),v([I({readOnly:!0})],Ct.prototype,"typeSpecificPreconditionsReady",void 0),v([I({type:Ut,readOnly:!0})],Ct.prototype,"layerViews",void 0),v([I()],Ct.prototype,"resolution",null),v([I({type:M8})],Ct.prototype,"magnifier",void 0),v([I({value:null,type:A6})],Ct.prototype,"map",null),v([I()],Ct.prototype,"padding",void 0),v([I({readOnly:!0})],Ct.prototype,"ready",void 0),v([I({type:mi})],Ct.prototype,"spatialReference",null),v([I()],Ct.prototype,"spatialReferenceWarningDelay",void 0),v([I()],Ct.prototype,"stationary",null),v([I({readOnly:!0})],Ct.prototype,"supportsGround",void 0),v([I({type:x_})],Ct.prototype,"timeExtent",void 0),v([I({type:String,nonNullable:!0})],Ct.prototype,"timeZone",null),v([I()],Ct.prototype,"tools",null),v([I()],Ct.prototype,"toolViewManager",void 0),v([I({readOnly:!0})],Ct.prototype,"type",void 0),v([I({type:Number})],Ct.prototype,"scale",void 0),v([I({readOnly:!0})],Ct.prototype,"updating",void 0),v([I({readOnly:!0})],Ct.prototype,"initialExtentRequired",void 0),v([I({readOnly:!0})],Ct.prototype,"initialExtent",null),v([I()],Ct.prototype,"cursor",null),v([I({readOnly:!0})],Ct.prototype,"input",void 0),v([I({type:F8,nonNullable:!0})],Ct.prototype,"navigation",void 0),v([I()],Ct.prototype,"layerViewManager",void 0),v([I()],Ct.prototype,"analysisViewManager",void 0),v([I()],Ct.prototype,"selectionManager",void 0),v([I()],Ct.prototype,"width",void 0),v([I()],Ct.prototype,"height",void 0),v([I({readOnly:!0})],Ct.prototype,"resizing",void 0),v([I({value:null,readOnly:!0})],Ct.prototype,"size",null),v([I({readOnly:!0})],Ct.prototype,"suspended",void 0),v([I({readOnly:!0})],Ct.prototype,"viewEvents",void 0),v([I({readOnly:!0})],Ct.prototype,"persistableViewModels",void 0),v([I()],Ct.prototype,"_isValid",void 0),v([I()],Ct.prototype,"_readyCycleForced",void 0),v([I()],Ct.prototype,"_lockedSpatialReference",void 0),v([I()],Ct.prototype,"_userTimeZone",void 0),v([I()],Ct.prototype,"_lockedTimeZone",void 0),v([I({type:aM})],Ct.prototype,"theme",void 0),v([I({readOnly:!0,type:aM})],Ct.prototype,"effectiveTheme",null),Ct=e0=v([me("esri.views.View")],Ct);const ane=Ct;function lne(e){return e.layerViews}let ju=class extends nw{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=sa(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var t;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(t=this._resolver)==null||t.reject(new Je("ViewAnimation stopped")))}finish(){var t;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(t=this._resolver)==null||t.resolve())}update(t,i){i||(i=wh(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",i)}};v([I({readOnly:!0})],ju.prototype,"done",null),v([I({readOnly:!0,type:String})],ju.prototype,"state",void 0),v([I()],ju.prototype,"target",void 0),ju=v([me("esri.views.ViewAnimation")],ju),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(ju||(ju={}));const uM=ju;function ih(e,t,i,r){const s=3*e,n=3*(i-e)-s,c=1-s-n,o=3*t,p=3*(r-t)-o,g=1-o-p;function S(z){return((c*z+n)*z+s)*z}function M(z){return((g*z+p)*z+o)*z}function A(z){return(3*c*z+2*n)*z+s}function O(z,V){let W,ie,ve,pe,_e,Me;for(ve=z,Me=0;Me<8;Me++){if(pe=S(ve)-z,Math.abs(pe)<V)return ve;if(_e=A(ve),Math.abs(_e)<1e-6)break;ve-=pe/_e}if(W=0,ie=1,ve=z,ve<W)return W;if(ve>ie)return ie;for(;W<ie;){if(pe=S(ve),Math.abs(pe-z)<V)return ve;z>pe?W=ve:ie=ve,ve=.5*(ie-W)+W}return ve}return function(z,V=1e-6){return M(O(z,V))}}const cne=/^cubic-bezier\((.*)\)/,Zo={};function une(e){let t=Zo[e]||null;if(!t){const i=cne.exec(e);if(i){const r=i[1].split(",").map(s=>parseFloat(s.trim()));r.length!==4||r.some(s=>isNaN(s))||(t=ih.apply(ih,r))}}return t}Zo.ease=ih(.25,.1,.25,1),Zo.linear=ih(0,0,1,1),Zo.easeIn=Zo["ease-in"]=ih(.42,0,1,1),Zo.easeOut=Zo["ease-out"]=ih(0,0,.58,1),Zo.easeInOut=Zo["ease-in-out"]=ih(.42,0,.58,1);function hne(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function dne(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function pne(e,t,i,r,s,n,c){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=c,e}function F3(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5];let p=i*n-r*s;return p?(p=1/p,e[0]=n*p,e[1]=-r*p,e[2]=-s*p,e[3]=i*p,e[4]=(s*o-n*c)*p,e[5]=(r*c-i*o)*p,e):null}function fne(e){return e[0]*e[3]-e[1]*e[2]}function Z8(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=i[0],S=i[1],M=i[2],A=i[3],O=i[4],z=i[5];return e[0]=r*g+n*S,e[1]=s*g+c*S,e[2]=r*M+n*A,e[3]=s*M+c*A,e[4]=r*O+n*z+o,e[5]=s*O+c*z+p,e}function Wx(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=Math.sin(i),S=Math.cos(i);return e[0]=r*S+n*g,e[1]=s*S+c*g,e[2]=r*-g+n*S,e[3]=s*-g+c*S,e[4]=o,e[5]=p,e}function B3(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=i[0],S=i[1];return e[0]=r*g,e[1]=s*g,e[2]=n*S,e[3]=c*S,e[4]=o,e[5]=p,e}function e_(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=i[0],S=i[1];return e[0]=r,e[1]=s,e[2]=n,e[3]=c,e[4]=r*g+n*S+o,e[5]=s*g+c*S+p,e}function Y8(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e}function J8(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function U3(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function mne(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function yne(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function gne(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e}function K8(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}function _ne(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e}function vne(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e}function bne(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function wne(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],c=e[4],o=e[5],p=t[0],g=t[1],S=t[2],M=t[3],A=t[4],O=t[5],z=aa();return Math.abs(i-p)<=z*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(r-g)<=z*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(s-S)<=z*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(n-M)<=z*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(c-A)<=z*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(o-O)<=z*Math.max(1,Math.abs(o),Math.abs(O))}const xne=Z8,Sne=K8;Object.freeze(Object.defineProperty({__proto__:null,add:gne,copy:hne,determinant:fne,equals:wne,exactEquals:bne,frob:yne,fromRotation:Y8,fromScaling:J8,fromTranslation:U3,identity:dne,invert:F3,mul:xne,multiply:Z8,multiplyScalar:_ne,multiplyScalarAndAdd:vne,rotate:Wx,scale:B3,set:pne,str:mne,sub:Sne,subtract:K8,translate:e_},Symbol.toStringTag,{value:"Module"}));function Nc(){return[1,0,0,1,0,0]}function Tne(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function Ene(e,t,i,r,s,n){return[e,t,i,r,s,n]}function Ine(e,t){return new Float64Array(e,t,6)}const Mne=Nc();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Mne,clone:Tne,create:Nc,createView:Ine,fromValues:Ene},Symbol.toStringTag,{value:"Module"}));function t_(e,t){return e[0]=t[0],e[1]=t[1],e}function Es(e,t,i){return e[0]=t,e[1]=i,e}function X8(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function i_(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function Q8(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function eB(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function Ane(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Pne(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Cne(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function $ne(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function kne(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function I_(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function Rne(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e}function Zx(e,t){const i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)}function Nw(e,t){const i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function zw(e){const t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function tB(e){const t=e[0],i=e[1];return t*t+i*i}function iB(e,t){return e[0]=-t[0],e[1]=-t[1],e}function One(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function hM(e,t){const i=t[0],r=t[1];let s=i*i+r*r;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s),e}function rB(e,t){return e[0]*t[0]+e[1]*t[1]}function sB(e,t,i){const r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e}function Lne(e,t,i,r){const s=t[0],n=t[1];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e}function Dne(e,t){t=t||1;const i=2*wx()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e}function Nne(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s,e[1]=i[1]*r+i[3]*s,e}function La(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s+i[4],e[1]=i[1]*r+i[3]*s+i[5],e}function zne(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[3]*s+i[6],e[1]=i[1]*r+i[4]*s+i[7],e}function Fne(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[4]*s+i[12],e[1]=i[1]*r+i[5]*s+i[13],e}function Bne(e,t,i,r){const s=t[0]-i[0],n=t[1]-i[1],c=Math.sin(r),o=Math.cos(r);return e[0]=s*o-n*c+i[0],e[1]=s*c+n*o+i[1],e}function Une(e,t){const i=e[0],r=e[1],s=t[0],n=t[1];let c=i*i+r*r;c>0&&(c=1/Math.sqrt(c));let o=s*s+n*n;o>0&&(o=1/Math.sqrt(o));const p=(i*s+r*n)*c*o;return p>1?0:p<-1?Math.PI:Math.acos(p)}function jne(e){return"vec2("+e[0]+", "+e[1]+")"}function Vne(e,t){return e[0]===t[0]&&e[1]===t[1]}function Gne(e,t){const i=e[0],r=e[1],s=t[0],n=t[1],c=aa();return Math.abs(i-s)<=c*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-n)<=c*Math.max(1,Math.abs(r),Math.abs(n))}function qne(e,t,i,r,s){let n=t[0]-i[0],c=t[1]-i[1];const o=(r[0]*n+r[1]*c)*(s-1);return n=r[0]*o,c=r[1]*o,e[0]=t[0]+n,e[1]=t[1]+c,e}const Hne=zw,j3=i_,Wne=Q8,Zne=eB,Yne=Zx,Jne=Nw,Kne=tB;Object.freeze(Object.defineProperty({__proto__:null,add:X8,angle:Une,ceil:Ane,copy:t_,cross:sB,dist:Yne,distance:Zx,div:Zne,divide:eB,dot:rB,equals:Gne,exactEquals:Vne,floor:Pne,inverse:One,len:Hne,length:zw,lerp:Lne,max:$ne,min:Cne,mul:Wne,multiply:Q8,negate:iB,normalize:hM,projectAndScale:qne,random:Dne,rotate:Bne,round:kne,scale:I_,scaleAndAdd:Rne,set:Es,sqrDist:Jne,sqrLen:Kne,squaredDistance:Nw,squaredLength:tB,str:jne,sub:j3,subtract:i_,transformMat2:Nne,transformMat2d:La,transformMat3:zne,transformMat4:Fne},Symbol.toStringTag,{value:"Module"}));function zr(){return[0,0]}function Xne(e){return[e[0],e[1]]}function M_(e,t){return[e,t]}function Qne(e,t=zr()){const i=Math.min(2,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function eoe(e,t){return new Float64Array(e,t,2)}function nB(){return zr()}function oB(){return M_(1,1)}function aB(){return M_(1,0)}function lB(){return M_(0,1)}const toe=nB(),ioe=oB(),roe=aB(),soe=lB();Object.freeze(Object.defineProperty({__proto__:null,ONES:ioe,UNIT_X:roe,UNIT_Y:soe,ZEROS:toe,clone:Xne,create:zr,createView:eoe,fromArray:Qne,fromValues:M_,ones:oB,unitX:aB,unitY:lB,zeros:nB},Symbol.toStringTag,{value:"Module"}));const vv={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Ua({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:mi.WebMercator}),minus180Line:new Ua({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:mi.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Ua({paths:[[[180,-180],[180,180]]],spatialReference:mi.WGS84}),minus180Line:new Ua({paths:[[[-180,-180],[-180,180]]],spatialReference:mi.WGS84})}};function ep(e,t){return Math.ceil((e-t)/(2*t))}function cB(e,t){const i=P0(e);for(const r of i)for(const s of r)s[0]+=t;return e}function P0(e){return jA(e)?e.rings:e.paths}function w1e(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function noe(e){return typeof e=="string"?Mr(e):He(e)}function ooe(e,t,i){const r={};for(const s in e){if(s==="declaredClass")continue;const n=e[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))r[s]=n.map(c=>ooe({item:c},t,i).item);else if(typeof n=="object")if(n.toJSON){const c=n.toJSON(i==null?void 0:i[s]);r[s]=t?c:JSON.stringify(c)}else r[s]=t?n:JSON.stringify(n);else r[s]=n}return r}async function aoe(e,t,i,r){const s=noe(e),n=t[0].spatialReference,c={...r,responseType:"json",query:{...s.query,f:"json",sr:tN(n),target:JSON.stringify({geometryType:VA(t[0]),geometries:t}),cutter:JSON.stringify(i)}},o=await Xi(s.path+"/cut",c),{cutIndexes:p,geometries:g=[]}=o.data;return{cutIndexes:p,geometries:g.map(S=>{const M=Pm(S);return M.spatialReference=n,M})}}function loe(e){return{geometryType:VA(e[0]),geometries:e.map(t=>t.toJSON())}}function coe(e,t,i){const r=fK(t);return e.map(s=>{const n=r.fromJSON(s);return n.spatialReference=i,n})}async function uoe(e,t,i){const r=typeof e=="string"?Mr(e):e,s=t[0].spatialReference,n=VA(t[0]),c={...i,query:{...r.query,f:"json",sr:tN(s),geometries:JSON.stringify(loe(t))}},{data:o}=await Xi(r.path+"/simplify",c);return coe(o.geometries,n,s)}const uB=()=>_t.getLogger("esri.geometry.support.normalizeUtils");function hoe(e){return e.type==="polygon"}function doe(e){return e[0].type==="polygon"}function poe(e){return e[0].type==="polyline"}function BR(e){const t=[];let i=0,r=0;for(let s=0;s<e.length;s++){const n=e[s];let c=null;for(let o=0;o<n.length;o++)c=n[o],t.push(c),o===0?(i=c[0],r=i):(i=Math.min(i,c[0]),r=Math.max(r,c[0]));c&&t.push([(i+r)/2,0])}return t}function foe(e,t){if(!(e instanceof Ua||e instanceof mh)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw uB().error(s),new Je(s)}const i=P0(e),r=[];for(const s of i){const n=[];r.push(n),n.push([s[0][0],s[0][1]]);for(let c=0;c<s.length-1;c++){const o=s[c][0],p=s[c][1],g=s[c+1][0],S=s[c+1][1],M=Math.sqrt((g-o)*(g-o)+(S-p)*(S-p)),A=(S-p)/M,O=(g-o)/M,z=M/t;if(z>1){for(let ve=1;ve<=z-1;ve++){const pe=ve*t,_e=O*pe+o,Me=A*pe+p;n.push([_e,Me])}const V=(M+Math.floor(z-1)*t)/2,W=O*V+o,ie=A*V+p;n.push([W,ie])}n.push([g,S])}}return hoe(e)?new mh({rings:r,spatialReference:e.spatialReference}):new Ua({paths:r,spatialReference:e.spatialReference})}function UR(e,t,i){if(t){const r=foe(e,1e6);e=Qf(r,!0)}return i&&(e=cB(e,i)),e}function jR(e,t,i){if(Array.isArray(e)){const r=e[0];if(r>t){const s=ep(r,t);e[0]=r+s*(-2*t)}else if(r<i){const s=ep(r,i);e[0]=r+s*(-2*i)}}else{const r=e.x;if(r>t){const s=ep(r,t);e=e.clone().offset(s*(-2*t),0)}else if(r<i){const s=ep(r,i);e=e.clone().offset(s*(-2*i),0)}}return e}function moe(e,t){let i=-1;for(let r=0;r<t.cutIndexes.length;r++){const s=t.cutIndexes[r],n=t.geometries[r],c=P0(n);for(let o=0;o<c.length;o++){const p=c[o];p.some(g=>{if(g[0]<180)return!0;{let S=0;for(let A=0;A<p.length;A++){const O=p[A][0];S=O>S?O:S}S=Number(S.toFixed(9));const M=-360*ep(S,180);for(let A=0;A<p.length;A++){const O=n.getPoint(o,A);n.setPoint(o,A,O.clone().offset(M,0))}return!0}})}if(s===i){if(doe(e))for(const o of P0(n))e[s]=e[s].addRing(o);else if(poe(e))for(const o of P0(n))e[s]=e[s].addPath(o)}else i=s,e[s]=n}return e}async function yoe(e,t,i){if(!Array.isArray(e))return yoe([e],t);t&&typeof t!="string"&&uB().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof t=="string"?t:(t==null?void 0:t.url)??Pi.geometryServiceUrl;let s,n,c,o,p,g,S,M,A=0;const O=[],z=[];for(const _e of e)if(_e!=null)if(s||(s=_e.spatialReference,n=to(s),c=s.isWebMercator,g=c?102100:4326,o=vv[g].maxX,p=vv[g].minX,S=vv[g].plus180Line,M=vv[g].minus180Line),n)if(_e.type==="mesh")z.push(_e);else if(_e.type==="point")z.push(jR(_e.clone(),o,p));else if(_e.type==="multipoint"){const Me=_e.clone();Me.points=Me.points.map($e=>jR($e,o,p)),z.push(Me)}else if(_e.type==="extent"){const Me=_e.clone()._normalize(!1,!1,n);z.push(Me.rings?new mh(Me):Me)}else if(_e.extent){const Me=_e.extent,$e=ep(Me.xmin,p)*(2*o);let Fe=$e===0?_e.clone():cB(_e.clone(),$e);Me.offset($e,0),Me.intersects(S)&&Me.xmax!==o?(A=Me.xmax>A?Me.xmax:A,Fe=UR(Fe,c),O.push(Fe),z.push("cut")):Me.intersects(M)&&Me.xmin!==p?(A=Me.xmax*(2*o)>A?Me.xmax*(2*o):A,Fe=UR(Fe,c,360),O.push(Fe),z.push("cut")):z.push(Fe)}else z.push(_e.clone());else z.push(_e);else z.push(_e);let V=ep(A,o),W=-90;const ie=V,ve=new Ua;for(;V>0;){const _e=360*V-180;ve.addPath([[_e,W],[_e,-1*W]]),W*=-1,V--}if(O.length>0&&ie>0){const _e=moe(O,await aoe(r,O,ve,i)),Me=[],$e=[];for(let et=0;et<z.length;et++){const at=z[et];if(at!=="cut")$e.push(at);else{const ct=_e.shift(),nt=e[et];nt!=null&&nt.type==="polygon"&&nt.rings&&nt.rings.length>1&&ct.rings.length>=nt.rings.length?(Me.push(ct),$e.push("simplify")):$e.push(c?Dc(ct):ct)}}if(!Me.length)return $e;const Fe=await uoe(r,Me,i),Ge=[];for(let et=0;et<$e.length;et++){const at=$e[et];at!=="simplify"?Ge.push(at):Ge.push(c?Dc(Fe.shift()):Fe.shift())}return Ge}const pe=[];for(let _e=0;_e<z.length;_e++){const Me=z[_e];if(Me!=="cut")pe.push(Me);else{const $e=O.shift();pe.push(c===!0?Dc($e):$e)}}return pe}function goe(e){if(!e)return null;const t=e.extent;if(!t)return null;const i=e.spatialReference&&to(e.spatialReference);if(!i)return t;const[r,s]=i.valid,n=2*s,{width:c}=t;let o,{xmin:p,xmax:g}=t;if([p,g]=[g,p],e.type==="extent"||c===0||c<=s||c>n||p<r||g>s)return t;switch(e.type){case"polygon":if(!(e.rings.length>1))return t;o=BR(e.rings);break;case"polyline":if(!(e.paths.length>1))return t;o=BR(e.paths);break;case"multipoint":o=e.points}const S=t.clone();for(let M=0;M<o.length;M++){let A=o[M][0];A<0?(A+=s,g=Math.max(A,g)):(A-=s,p=Math.min(A,p))}return S.xmin=p,S.xmax=g,S.width<c?(S.xmin-=s,S.xmax-=s,S):t}function hB(e,t,i){const r=to(i);if(r==null)return e;const[s,n]=r.valid,c=2*n;let o=0,p=0;t>n?o=Math.ceil(Math.abs(t-n)/c):t<s&&(o=-Math.ceil(Math.abs(t-s)/c)),e>n?p=Math.ceil(Math.abs(e-n)/c):e<s&&(p=-Math.ceil(Math.abs(e-s)/c));let g=e+(o-p)*c;const S=g-t;return S>n?g-=c:S<s&&(g+=c),g}function x1e(e,t){const i=to(t);if(i){const[r,s]=i.valid,n=s-r;if(e<r)for(;e<r;)e+=n;if(e>s)for(;e>s;)e-=n}return e}const dB=96,pB=39.37,_oe=180/Math.PI;function fB(e){return e.wkid?e:e.spatialReference||mi.WGS84}function V3(e,t){return t.type?Es(e,t.x,t.y):t_(e,t)}function mB(e){return Ap(e)}function mm(e,t,i=0){let r=e.width,s=e.height;if(i!==0){const o=LN(i),p=Math.abs(Math.cos(o)),g=Math.abs(Math.sin(o));r=e.width*p+e.height*g,s=e.width*g+e.height*p}const n=Math.max(1,t[0]),c=Math.max(1,t[1]);return Math.max(r/n,s/c)*Moe(e.spatialReference)}async function t0(e,t,i,r){var o,p;let s,n;if(!e||Array.isArray(e)&&!e.length)return null;if(Ut.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&typeof e[0]=="object"){const g=e.every(A=>"attributes"in A),S=e.some(A=>!A.geometry);let M=e;if(g&&S&&t&&t.allLayerViews){const A=new Map;for(const W of e){const ie=W.layer,ve=A.get(ie)||[],pe=W.attributes[ie.objectIdField];pe!=null&&ve.push(pe),A.set(ie,ve)}const O=[];A.forEach((W,ie)=>{const ve=t.allLayerViews.find(pe=>pe.layer.id===ie.id);if(ve&&"queryFeatures"in ve){const pe=ie.createQuery();pe.objectIds=W,pe.returnGeometry=!0,O.push(ve.queryFeatures(pe))}});const z=await Promise.all(O),V=[];for(const W of z)if(W&&W.features&&W.features.length)for(const ie of W.features)ie.geometry!=null&&V.push(ie.geometry);M=V}for(const A of M)r=await t0(A,t,i,r);return r}if(Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number")s=new ri(e);else if(e instanceof Sh)s=e;else if("geometry"in e){if(e.geometry)s=e.geometry;else if(e.layer){const g=e.layer,S=t.allLayerViews.find(M=>M.layer.id===g.id);if(S&&"queryFeatures"in S){const M=g.createQuery();M.objectIds=[e.attributes[g.objectIdField]],M.returnGeometry=!0;const A=await S.queryFeatures(M);s=(p=(o=A==null?void 0:A.features)==null?void 0:o[0])==null?void 0:p.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new Bi({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=goe(s);break;default:n=s.extent}if(!n)return null;Mh()||Dl(n.spatialReference,i)||await vh();const c=Ah(n,i);return c?r=r?r.union(c):c:null}function voe(e){var t;if(e&&(!Array.isArray(e)||typeof e[0]!="number")&&(typeof e=="object"||Array.isArray(e)&&typeof e[0]=="object")){if("layer"in e&&((t=e.layer)==null?void 0:t.minScale)!=null&&e.layer.maxScale!=null){const i=e.layer;return{min:i.minScale,max:i.maxScale}}if(Array.isArray(e)&&e.length&&e.every(i=>"layer"in i)){let i=0,r=0;for(const s of e){const n=s.layer;n!=null&&n.minScale&&n.maxScale&&(i=n.minScale<i?n.minScale:i,r=n.maxScale>r?n.maxScale:r)}return i&&r?{min:i,max:r}:null}}}function QS(e,t){return Hs(fB(e),t)?e:Ah(e,t)}async function boe(e,t){var W;if(!e||!t)return new $l({targetGeometry:new ri,scale:0,rotation:0});let i=t.spatialReference;const{constraints:r,padding:s,viewpoint:n,size:c}=t,o=[s?c[0]-s.left-s.right:c[0],s?c[1]-s.top-s.bottom:c[1]];let p=null;e instanceof $l?p=e:e.viewpoint?p=e.viewpoint:e.target&&e.target.declaredClass==="esri.Viewpoint"&&(p=e.target);let g=null;p!=null&&p.targetGeometry?g=p.targetGeometry:e instanceof Bi?g=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(g=await t0(e.center,t,i)||await t0(e.extent,t,i)||await t0(e.target,t,i)||await t0(e,t,i)),!g&&(n!=null&&n.targetGeometry)?g=n.targetGeometry:!g&&t.extent&&(g=t.extent),i||(i=fB(t.spatialReference||t.extent||g)),Mh()||Hs(g.spatialReference,i)||Dl(g.spatialReference,i)||await vh();const S=QS(g,i),M="center"in S?S.center:S;t.pickClosestTarget!==!1&&M.type==="point"&&((W=n.targetGeometry)==null?void 0:W.type)==="point"&&(M.x=hB(M.x,n.targetGeometry.x,M.spatialReference));let A=0;p?A=p.rotation:e.hasOwnProperty("rotation")?A=e.rotation:n&&(A=n.rotation);let O=0;if((p==null?void 0:p.targetGeometry)!=null&&p.targetGeometry.type==="point")O=p.scale;else if("scale"in e&&e.scale)O=e.scale;else if("zoom"in e&&e.zoom!==-1&&r&&r.effectiveLODs)O=r.zoomToScale(e.zoom);else if(Array.isArray(g)||g.type==="point"||g.type==="extent"&&g.width===0&&g.height===0){const ie=QS(t.extent,i);O=ie!=null?mm(ie,o,A):t.extent?mm(t.extent,o,A):n.scale}else O=mm(QS(g.extent,i),o,A);const z=voe(e.target??e);z&&(z.min&&z.min<O?O=z.min:z.max&&z.max>O&&(O=z.max));let V=new $l({targetGeometry:M,scale:O,rotation:A});return r&&(V=r.fit(V),r.constrainByGeometry(V),r.rotationEnabled||(V.rotation=n.rotation)),V}function Xa(e,t){const i=e.targetGeometry,r=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function woe(e,t,i){return i?Es(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):I_(e,t,.5)}const xoe=function(){const e=zr();return function(t,i,r){const s=i.targetGeometry;V3(e,s);const n=.5*Zm(i);return t.xmin=e[0]-n*r[0],t.ymin=e[1]-n*r[1],t.xmax=e[0]+n*r[0],t.ymax=e[1]+n*r[1],t.spatialReference=s.spatialReference,t}}();function Soe(e,t,i,r,s){var n;return dM(e,t,i.center),e.scale=mm(i,r),(n=s==null?void 0:s.constraints)==null||n.constrain(e),e}function Toe(e,t,i,r){return H3(e,t,i,r),F3(e,e)}const yB=function(){const e=zr();return function(t,i,r){return j3(t,Aoe(t,i),woe(e,i,r))}}(),Eoe=function(){const e=Nc(),t=zr();return function(i,r,s,n){const c=Zm(r),o=G3(r);return Es(t,c,c),J8(e,t),Wx(e,e,o),e_(e,e,yB(t,s,n)),e_(e,e,[0,n.top-n.bottom]),Es(i,e[4],e[5])}}();function Zm(e){return e.scale*Ioe(e.targetGeometry)}function Ioe(e){return e!=null&&Ba(e.spatialReference)?1/(mB(e.spatialReference)*pB*dB):1}function G3(e){return NA(e.rotation)||0}function Moe(e){return Ba(e)?mB(e)*pB*dB:1}function Aoe(e,t){return I_(e,t,.5)}const q3=function(){const e=zr(),t=zr(),i=zr();return function(r,s,n,c,o,p){return iB(e,s),I_(t,n,.5*p),Es(i,1/c*p,-1/c*p),U3(r,t),o&&Wx(r,r,o),B3(r,r,i),e_(r,r,e),r}}(),H3=function(){const e=zr();return function(t,i,r,s){const n=Zm(i),c=G3(i);return V3(e,i.targetGeometry),q3(t,e,r,n,c,s)}}(),Poe=function(){const e=zr();return function(t,i,r,s){const n=Zm(i);return V3(e,i.targetGeometry),q3(t,e,r,n,0,s)}}();function Coe(e){const t=to(e);return t?t.valid[1]-t.valid[0]:0}function $oe(e,t){return Math.round(Coe(e)/t)}const koe=function(){const e=zr(),t=zr(),i=[0,0,0];return function(r,s,n){i_(e,r,s),hM(e,e),i_(t,r,n),hM(t,t),sB(i,e,t);let c=Math.acos(rB(e,t)/(zw(e)*zw(t)))*_oe;return i[2]<0&&(c=-c),isNaN(c)&&(c=0),c}}(),Roe=function(){const e=zr();return function(t,i,r,s){const n=t.targetGeometry;return Xa(t,i),Eoe(e,i,r,s),n.x+=e[0],n.y+=e[1],t}}(),dM=function(e,t,i){Xa(e,t);const r=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,e},Ooe=function(){const e=zr();return function(t,i,r,s,n){n||(n="center"),j3(e,r,s),I_(e,e,.5);const c=e[0],o=e[1];switch(n){case"center":Es(e,0,0);break;case"left":Es(e,-c,0);break;case"top":Es(e,0,o);break;case"right":Es(e,c,0);break;case"bottom":Es(e,0,-o);break;case"top-left":Es(e,-c,o);break;case"bottom-left":Es(e,-c,-o);break;case"top-right":Es(e,c,o);break;case"bottom-right":Es(e,c,-o)}return Yx(t,i,e),t}}();function S1e(e,t,i){return Xa(e,t),e.rotation+=i,e}function Loe(e,t,i){return Xa(e,t),e.rotation=i,e}const Doe=function(){const e=zr();return function(t,i,r,s,n){return Xa(t,i),isNaN(r)||r===0||(_B(e,s,i,n),t.scale=i.scale*r,vB(e,e,t,n),Yx(t,t,Es(e,e[0]-s[0],s[1]-e[1]))),t}}();function VR(e,t,i){return Xa(e,t),e.scale=i,e}const gB=function(){const e=zr();return function(t,i,r,s,n,c){return Xa(t,i),isNaN(r)||r===0||(_B(e,n,i,c),t.scale=i.scale*r,t.rotation+=s,vB(e,e,t,c),Yx(t,t,Es(e,e[0]-n[0],n[1]-e[1]))),t}}(),T1e=function(){const e=zr(),t=zr();return function(i,r,s,n,c,o,p){return yB(t,o,p),X8(e,c,t),n?gB(i,r,s,n,e,o):Doe(i,r,s,e,o)}}(),_B=function(){const e=Nc();return function(t,i,r,s){return La(t,i,Toe(e,r,s,1))}}(),vB=function(){const e=Nc();return function(t,i,r,s){return La(t,i,H3(e,r,s,1))}}(),Yx=function(){const e=zr(),t=Nc();return function(i,r,s){Xa(i,r);const n=Zm(r),c=i.targetGeometry;return Y8(t,G3(r)),B3(t,t,M_(n,n)),La(e,s,t),c.x+=e[0],c.y+=e[1],i}}();let Noe=class{constructor(t,i,r,s){const n=t.targetGeometry,c=i.targetGeometry;s?typeof s=="string"&&(s=une(s)||Zo.ease):s=Zo.ease,this.easing=s,this.duration=r,this.sCenterX=n.x,this.sCenterY=n.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=c.x,this.tCenterY=c.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,i){const r=this.easing(i);let s,n,c,o;i>=1?(s=this.tCenterX,n=this.tCenterY,c=this.tRotation,o=this.tScale):(s=this.sCenterX+r*this.dCenterX,n=this.sCenterY+r*this.dCenterY,c=this.sRotation+r*this.dRotation,o=this.sScale+r*this.dScale),t.targetGeometry.x=s,t.targetGeometry.y=n,t.scale=o,t.rotation=c}},Vu=class extends zt{constructor(t){super(t),this._animation=null,this.updateFunction=null,this.duration=200,this.transition=null,this.easing=Zo.ease,this.view=null,this.viewpoint=new $l({targetGeometry:new ri,scale:0,rotation:0}),this._updateTask=Sm({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=gr(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view&&(this.view.animation=t)}animate(t,i,r){this.stop();const s=this.viewpoint;Xa(s,i),this.transition=new Noe(this.viewpoint,t.target,(r==null?void 0:r.duration)||this.duration,(r==null?void 0:r.easing)||this.easing);const n=()=>{var c,o;this.animation===t&&this._updateTask&&(t.state==="finished"&&((c=this.transition)==null||c.applyRatio(this.viewpoint,1),(o=this.view)!=null&&o.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,i){this.stop(),this.updateFunction=i,this.viewpoint=t;const r=new uM({target:t.clone()}),s=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){var r,s;const i=this.animation;if(i&&i.state!==uM.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else{const n=this.transition,c=(performance.now()-this._startTime)/n.duration,o=c>=1;n.applyRatio(this.viewpoint,c),o&&((r=this.animation)==null||r.finish())}(s=this.view)!=null&&s.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};v([I()],Vu.prototype,"duration",void 0),v([I()],Vu.prototype,"transition",void 0),v([I()],Vu.prototype,"easing",void 0),v([I()],Vu.prototype,"view",void 0),v([I()],Vu.prototype,"viewpoint",void 0),Vu=v([me("esri.views.2d.AnimationManager")],Vu);const zoe=Vu;let Foe=class{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var c,o;if(this._updateRequested=!1,(c=this.view)==null?void 0:c.destroyed)return;const{allLayerViews:i,graphicsView:r,labelManager:s,state:{id:n}}=this.view;i.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==n&&(s.viewChange(),s.lastUpdateId=n),s.updateRequested&&s.processUpdate(this._updateParameters)),r!=null&&(r.lastUpdateId!==n&&(r.viewChange(),r.lastUpdateId=n),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((o=this._frameTaskHandle)==null||o.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=ti(()=>t.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=Sm(this),this.requestUpdate()}stop(){var t;this._frameTaskHandle&&(this._updateRequested=!1,(t=this._stationaryHandle)==null||t.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){var s;if(!t.attached)return void this.requestUpdate();const i=this.view.state,r=t.lastUpdateId;r!=null&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),r!==i.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=i.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&((s=t.layerViews)==null||s.forEach(this._updateLayerView,this))}},Sb=class extends zt{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,i){if(!t)return void _t.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new uM;this.view.animation=r,await Ix(()=>this.view.ready,i);const s={animate:!0,...i},{extent:n,spatialReference:c,size:o,viewpoint:p,constraints:g,padding:S,allLayerViews:M}=this.view,A=boe(t,{extent:n,spatialReference:c,size:o,viewpoint:p,constraints:g,padding:S,allLayerViews:M,pickClosestTarget:(i==null?void 0:i.pickClosestTarget)??!0});return r==null||r.update(A),this._gotoTask={},s.animate?this._gotoAnimated(A,s):this._gotoImmediate(A,s)}_gotoImmediate(t,i){const r=this._gotoTask,s=this.view.animation,n=t.then(c=>{if(dr(i),r!==this._gotoTask)throw new Je("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=c,s.finish()});return this._cancellableGoTo(r,s,n,i)}_gotoAnimated(t,i){const r=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=t.then(c=>{if(dr(i),r!==this._gotoTask)throw new Je("view:goto-interrupted","Goto was interrupted");return s.update(c),this.view.animationManager.animate(s,this.view.viewpoint,i),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,s,n,i)}_cancellableGoTo(t,i,r,s){const n=()=>t===this._gotoTask;return fG(r,s).finally(()=>{n()&&(i.done||i.stop())})}};v([I({constructOnly:!0})],Sb.prototype,"view",void 0),Sb=v([me("esri.views.2d.GoToManager")],Sb);function sr(){return Promise.all([ht(()=>import("./webglDeps-DM1GBXs_.js"),__vite__mapDeps([164,75,74,165,166])),ht(()=>import("./mapViewDeps-ChYiU5J0.js"),__vite__mapDeps([167,76,77,78,22,79,80,73,74,75,81,38,82,43,83,84,127,11,168,169,170,171,166,114,24,25,164,165,172,88,173,72,34,32,31,28,19,71,174,175,176,177,178,179,61,180,181,182,183,184,185,186,187,91,188]))])}const bg=()=>sr().then(()=>ht(()=>import("./TileLayerView2D-DJ6Rypzj.js"),__vite__mapDeps([189,76,77,78,22,79,80,73,74,75,81,38,82,43,83,84,127,11,169,170,171,166,114,24,25,172,88,173,72,34,32,31,28,19,71,61,181,175,176,182,183,91,190,191,187,192,193,194,185,186,195,196,197,198,199]))),Tf=()=>sr().then(()=>ht(()=>import("./FeatureLayerView2D-BoiUVKcw.js").then(e=>e.F),__vite__mapDeps([200,71,170,83,74,137,129,192,193,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,85,122,147,154,144,124,12,168,169,181,201,197,199,195]))),GR={"base-dynamic":()=>sr().then(()=>ht(()=>import("./BaseDynamicLayerView2D-B_XLh1jP.js"),__vite__mapDeps([202,203,171,73,74,75,166,170,83,114,78,24,22,25,192,193,204,191,195]))),"base-tile":bg,"bing-maps":bg,catalog:()=>sr().then(()=>ht(()=>import("./CatalogLayerView2D-DoTxRGOR.js"),__vite__mapDeps([205,192,193,170,83,74]))),"catalog-dynamic-group":()=>sr().then(()=>ht(()=>import("./CatalogDynamicGroupLayerView2D-BU3bk_9-.js"),__vite__mapDeps([206,192,193,170,83,74]))),"catalog-footprint":()=>sr().then(()=>ht(()=>import("./CatalogFootprintLayerView2D-BZQR95V6.js"),__vite__mapDeps([207,200,71,170,83,74,137,129,192,193,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,85,122,147,154,144,124,12,168,169,181,201,197,199,195]))),csv:Tf,"geo-rss":()=>sr().then(()=>ht(()=>import("./GeoRSSLayerView2D-Ctuffmjc.js"),__vite__mapDeps([208,120,121,93,71,101,122,123,124,125,126,34,32,127,79,11,12,129,192,193,170,83,74,184,185,186,76,77,78,22,80,73,75,81,38,82,43,84,187,171,166,114,24,25,181,91,182,72,31,28,19,183]))),feature:Tf,geojson:Tf,graphics:()=>sr().then(()=>ht(()=>import("./GraphicsLayerView2D-Co8l_XgP.js"),__vite__mapDeps([209,83,192,193,170,74,184,185,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,181,91,182,34,32,127,11,72,31,28,19,71,183,201]))),group:()=>sr().then(()=>ht(()=>import("./GroupLayerView2D-n0y23QYl.js"),__vite__mapDeps([210,192,193,170,83,74]))),imagery:()=>sr().then(()=>ht(()=>import("./ImageryLayerView2D-x7cFwFOL.js"),__vite__mapDeps([211,212,75,74,166,98,171,73,170,83,114,78,24,22,25,192,193,182,34,32,76,77,79,80,81,38,82,43,84,127,11,72,31,28,19,71,181,183,194,185,186,187,91,203,191,204,102,199,195]))),"imagery-tile":()=>sr().then(()=>ht(()=>import("./ImageryTileLayerView2D-BawVA14J.js"),__vite__mapDeps([213,214,212,75,74,166,98,171,73,170,83,114,78,24,22,25,192,193,215,187,216,102,199,195]))),kml:()=>sr().then(()=>ht(()=>import("./KMLLayerView2D-DC5lMTou.js"),__vite__mapDeps([217,218,120,121,93,71,101,122,123,124,125,126,34,32,127,79,11,12,129,191,170,83,74,203,171,73,75,166,114,78,24,22,25,192,193,184,185,186,76,77,80,81,38,82,43,84,187,181,91,182,72,31,28,19,183,102,174,164,165,175,176,173,169,177,215]))),"knowledge-graph":()=>sr().then(()=>ht(()=>import("./KnowledgeGraphLayerView2D-CzKHXsfS.js"),__vite__mapDeps([219,192,193,170,83,74]))),"link-chart":()=>sr().then(()=>ht(()=>import("./KnowledgeGraphLayerView2D-CzKHXsfS.js"),__vite__mapDeps([219,192,193,170,83,74]))),"knowledge-graph-sublayer":Tf,"map-image":()=>sr().then(()=>ht(()=>import("./MapImageLayerView2D-B2lmoKCZ.js"),__vite__mapDeps([220,203,171,73,74,75,166,170,83,114,78,24,22,25,192,193,182,34,32,76,77,79,80,81,38,82,43,84,127,11,72,31,28,19,71,181,183,194,185,186,187,91,204,191,221,197,198,195,196,199]))),"map-notes":()=>sr().then(()=>ht(()=>import("./MapNotesLayerView2D-CUb7TNIv.js"),__vite__mapDeps([222,83,192,193,170,74,184,185,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,181,91,182,34,32,127,11,72,31,28,19,71,183]))),media:()=>sr().then(()=>ht(()=>import("./MediaLayerView2D-6-EEL1H4.js"),__vite__mapDeps([223,121,93,71,101,122,123,124,125,120,126,34,32,127,79,11,12,224,183,53,76,77,78,22,80,73,74,75,81,38,82,43,83,84,169,170,171,166,114,24,25,172,88,173,72,31,28,19,61,181,175,176,182,91,180,192,193]))),"ogc-feature":()=>sr().then(()=>ht(()=>import("./OGCFeatureLayerView2D-DWMV6LhB.js"),__vite__mapDeps([225,200,71,170,83,74,137,129,192,193,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,85,122,147,154,144,124,12,168,169,181,201,197,199,195]))),"open-street-map":bg,"oriented-imagery":Tf,route:()=>sr().then(()=>ht(()=>import("./RouteLayerView2D-D1IPiUON.js"),__vite__mapDeps([226,227,83,192,193,170,74,184,185,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,181,91,182,34,32,127,11,72,31,28,19,71,183]))),stream:()=>sr().then(()=>ht(()=>import("./StreamLayerView2D-BMC1PqzZ.js"),__vite__mapDeps([228,129,200,71,170,83,74,137,192,193,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,85,122,147,154,144,124,12,168,169,181,201,197,199,195]))),"subtype-group":()=>sr().then(()=>ht(()=>import("./SubtypeGroupLayerView2D-BHccqcGi.js"),__vite__mapDeps([229,200,71,170,83,74,137,129,192,193,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,85,122,147,154,144,124,12,168,169,181,201,197,199,195]))),tile:bg,"vector-tile":()=>sr().then(()=>ht(()=>import("./VectorTileLayerView2D-BqM7G4-c.js"),__vite__mapDeps([230,71,80,74,61,179,169,84,75,166,114,171,73,170,83,78,24,22,25,187,27,115,192,193]))),video:()=>sr().then(()=>ht(()=>import("./VideoLayerView2D-9hPOZs0X.js"),__vite__mapDeps([231,232,192,193,170,83,74,184,185,186,76,77,78,22,79,80,73,75,81,38,82,43,84,187,171,166,114,24,25,181,91,182,34,32,127,11,72,31,28,19,71,183]))),wcs:()=>sr().then(()=>ht(()=>import("./ImageryTileLayerView2D-BawVA14J.js"),__vite__mapDeps([213,214,212,75,74,166,98,171,73,170,83,114,78,24,22,25,192,193,215,187,216,102,199,195]))),"web-tile":bg,wfs:Tf,wms:()=>sr().then(()=>ht(()=>import("./WMSLayerView2D-viidgZbE.js"),__vite__mapDeps([233,203,171,73,74,75,166,170,83,114,78,24,22,25,192,193,204,191,195,234]))),wmts:()=>sr().then(()=>ht(()=>import("./WMTSLayerView2D-BnsRV5hS.js"),__vite__mapDeps([235,190,191,170,83,74,171,73,75,166,114,78,24,22,25,187,192,193,195]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Boe(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Je(`${i}:view-not-supported`,`${t} is not supported in 2D`)}const qR={hasLayerViewModule:e=>GR[e.type]!=null,importLayerView:e=>{const t=GR[e.type];if(t==null)throw Boe(e);return t(e)}};function Uoe(e,t){const{spatialReference:i}=t,r=[t.x,t.y];let s=Number.POSITIVE_INFINITY,n=0,c=0;const o=[0,0],p=e.type==="extent"?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(const g of p)for(let S=0;S<g.length-1;S++){UJ(o,r,g,S);const M=Zx(r,o);M<s&&(s=M,n=o[0],c=o[1])}return{coordinate:new ri({x:n,y:c,spatialReference:i}),distance:s}}var pM;let zd=pM=class extends qA(zt){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ah(this.geometry,this.spatialReference)}catch(e){return _t.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(this.normalizedGeometry==null)return e;const i=e.targetGeometry;if(this.normalizedGeometry.type==="extent"?gx(this.normalizedGeometry,i):hN(this.normalizedGeometry,i))return e;const{coordinate:r}=Uoe(this.normalizedGeometry,i);return r&&(e.targetGeometry=r),e}clone(){var e,t;return new pM({geometry:(e=this.geometry)==null?void 0:e.clone(),spatialReference:(t=this.spatialReference)==null?void 0:t.clone()})}};v([I({constructOnly:!0})],zd.prototype,"geometry",void 0),v([I({readOnly:!0})],zd.prototype,"normalizedGeometry",null),v([I({constructOnly:!0})],zd.prototype,"spatialReference",void 0),zd=pM=v([me("esri.views.2d.constraints.GeometryConstraint")],zd);var fM;let i0=fM=class extends qA(zt){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new fM({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};v([I()],i0.prototype,"enabled",void 0),v([I()],i0.prototype,"rotationEnabled",void 0),i0=fM=v([me("esri.views.2d.constraints.RotationConstraint")],i0);const bB=i0;var mM;let Hn=mM=class extends qA(zt){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:r,minZoom:s,maxZoom:n}=this,c=-1,o=-1,p=!1,g=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!(t!=null&&t.length))return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);t=t.map(S=>S.clone()),t.sort((S,M)=>M.scale-S.scale),t.forEach((S,M)=>S.level=M);for(const S of t)!p&&i>0&&i>=S.scale&&(c=S.level,p=!0),!g&&r>0&&r>=S.scale&&(o=e?e.level:-1,g=!0),e=S;s===-1&&(s=i===0?0:c),n===-1&&(n=r===0?t.length-1:o),s=Math.max(s,0),s=Math.min(s,t.length-1),n=Math.max(n,0),n=Math.min(n,t.length-1),s>n&&([s,n]=[n,s]),i=t[s].scale,r=t[n].scale,t.splice(0,s),t.splice(n-s+1,t.length),t.forEach((S,M)=>{this._lodByScale[S.scale]=S,this._scales[M]=S.scale}),this._set("effectiveLODs",t),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,r=this.effectiveMaxScale,s=e.targetGeometry,n=t&&t.targetGeometry,c=r!==0&&e.scale<r,o=i!==0&&e.scale>i;if(c||o){const p=o?i:r;if(t&&n){const g=(p-t.scale)/(e.scale-t.scale);s.x=n.x+(s.x-n.x)*g,s.y=n.y+(s.y-n.y)*g}e.scale=p}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.round(e-.5),r=Math.round(e);return t[r]+(r-e)*(t[i]-t[r])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,r;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let s=0;s<t.length-1;s++){if(i=t[s],r=t[s+1],r===e)return s+this.effectiveMinZoom+1;if(i>e&&r<e)return s+this.effectiveMinZoom+1-(e-r)/(i-r)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new mM({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t,this._scales[0])),this._lodByScale[e].scale}};v([I({readOnly:!0})],Hn.prototype,"effectiveLODs",void 0),v([I({readOnly:!0})],Hn.prototype,"effectiveMinZoom",void 0),v([I({readOnly:!0})],Hn.prototype,"effectiveMaxZoom",void 0),v([I({readOnly:!0})],Hn.prototype,"effectiveMinScale",void 0),v([I({readOnly:!0})],Hn.prototype,"effectiveMaxScale",void 0),v([I()],Hn.prototype,"lods",void 0),v([I()],Hn.prototype,"minZoom",void 0),v([I()],Hn.prototype,"maxZoom",void 0),v([I()],Hn.prototype,"minScale",void 0),v([I()],Hn.prototype,"maxScale",void 0),v([I()],Hn.prototype,"snapToZoom",void 0),Hn=mM=v([me("esri.views.2d.constraints.ZoomConstraint")],Hn);const wB=Hn,joe={base:null,key:"type",typeMap:{extent:Bi,polygon:mh}};let Rr=class extends zt{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ut}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){var t,i,r;return`${(t=this._zoom)==null?void 0:t.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _geometry(){var i,r;const t=this._get("_geometry");return t&&this.geometry===t.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===t.spatialReference?t:new zd({geometry:this.geometry,spatialReference:(r=this.view)==null?void 0:r.constraintsInfo.spatialReference})}get _rotation(){return new bB({rotationEnabled:this.rotationEnabled})}get _zoom(){var p;const t=this._get("_zoom"),i=this.lods||((p=this.view)==null?void 0:p.constraintsInfo.lods),r=this.minZoom,s=this.maxZoom,n=this.minScale,c=this.maxScale,o=this.snapToZoom;return t&&t.lods===i&&t.minZoom===r&&t.maxZoom===s&&t.minScale===n&&t.maxScale===c&&t.snapToZoom===o?t:new wB({lods:i,minZoom:r,maxZoom:s,minScale:n,maxScale:c,snapToZoom:o})}canZoomInTo(t){const i=this.effectiveMaxScale;return i===0||t>=i}canZoomOutTo(t){const i=this.effectiveMinScale;return i===0||t<=i}constrain(t,i){return this._zoom.constrain(t,i),this._rotation.constrain(t,i),this._geometry.constrain(t,i),this.customConstraints.forEach(r=>r.constrain(t,i)),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach(i=>{var r;return(r=i.applyPanConstraint)==null?void 0:r.call(i,t)}),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};v([I({readOnly:!0})],Rr.prototype,"effectiveLODs",null),v([I({readOnly:!0})],Rr.prototype,"effectiveMinScale",null),v([I({readOnly:!0})],Rr.prototype,"effectiveMaxScale",null),v([I({readOnly:!0})],Rr.prototype,"effectiveMinZoom",null),v([I({readOnly:!0})],Rr.prototype,"effectiveMaxZoom",null),v([I({types:joe,value:null})],Rr.prototype,"geometry",null),v([I({type:[$c]})],Rr.prototype,"lods",void 0),v([I()],Rr.prototype,"minScale",void 0),v([I()],Rr.prototype,"maxScale",void 0),v([I()],Rr.prototype,"minZoom",void 0),v([I()],Rr.prototype,"maxZoom",void 0),v([I()],Rr.prototype,"rotationEnabled",void 0),v([I()],Rr.prototype,"snapToZoom",void 0),v([I({type:Ut})],Rr.prototype,"customConstraints",void 0),v([I()],Rr.prototype,"view",void 0),v([I({readOnly:!0})],Rr.prototype,"version",null),v([I({type:zd,readOnly:!0})],Rr.prototype,"_geometry",null),v([I({type:bB})],Rr.prototype,"_rotation",null),v([I({readOnly:!0,type:wB})],Rr.prototype,"_zoom",null),Rr=v([me("esri.views.2d.MapViewConstraints")],Rr);const xB=Rr;let zl=class Pd{static getId(t,i,r,s){return typeof t=="object"?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${i}/${r}/${s}`}constructor(t,i,r,s){this.set(t,i,r,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(t){this.set(t)}get hash(){const t=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|t<<8|r}acquire(t,i,r,s){this.set(t,i,r,s)}contains(t){const i=t.level-this.level;return i>=0&&this.row===t.row>>i&&this.col===t.col>>i&&this.world===t.world}containsChild(t){const i=t.level-this.level;return i>0&&this.row===t.row>>i&&this.col===t.col>>i&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new Pd(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,i,r,s){if(t==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof t=="object")this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if(typeof t=="string"){const[n,c,o,p]=t.split("/");this.level=parseFloat(n),this.row=parseFloat(c),this.col=parseFloat(o),this.world=parseFloat(p)}else this.level=+t,this.row=+i,this.col=+r,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Pd(this.level-1,this.row>>1,this.col>>1,this.world)}getNeighborId(t,i){return`${this.level}/${this.row+i}/${this.col+t}/${this.world}`}getChildKeys(){const t=this.level+1,i=this.row<<1,r=this.col<<1,s=this.world;return[new Pd(t,i,r,s),new Pd(t,i,r+1,s),new Pd(t,i+1,r,s),new Pd(t,i+1,r+1,s)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}};zl.pool=new Ip(zl,null,null,25,50);function Tu(e,t){return[e,t]}function id(e,t,i){return e[0]=t,e[1]=i,e}function Voe(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}const Sa=new zl("0/0/0/0");let Goe=class SB{static create(t,i,r=null){const s=to(t.spatialReference),n=i.origin||Tu(t.origin.x,t.origin.y),c=Tu(t.size[0]*i.resolution,t.size[1]*i.resolution),o=Tu(-1/0,-1/0),p=Tu(1/0,1/0),g=Tu(1/0,1/0);r!=null&&(id(o,Math.max(0,Math.floor((r.xmin-n[0])/c[0])),Math.max(0,Math.floor((n[1]-r.ymax)/c[1]))),id(p,Math.max(0,Math.floor((r.xmax-n[0])/c[0])),Math.max(0,Math.floor((n[1]-r.ymin)/c[1]))),id(g,p[0]-o[0]+1,p[1]-o[1]+1));const{cols:S,rows:M}=i;let A,O,z,V;return!r&&S&&M&&(id(o,S[0],M[0]),id(p,S[1],M[1]),id(g,S[1]-S[0]+1,M[1]-M[0]+1)),t.isWrappable?(A=Tu(Math.ceil(Math.round((s.valid[1]-s.valid[0])/i.resolution)/t.size[0]),g[1]),O=Tu(Math.floor((s.origin[0]-n[0])/c[0]),o[1]),z=Tu(A[0]+O[0]-1,p[1]),V=!0):(O=o,z=p,A=g,V=!1),new SB(i.level,i.resolution,i.scale,n,o,p,g,c,O,z,A,V)}constructor(t,i,r,s,n,c,o,p,g,S,M,A){this.level=t,this.resolution=i,this.scale=r,this.origin=s,this.first=n,this.last=c,this.size=o,this.norm=p,this.worldStart=g,this.worldEnd=S,this.worldSize=M,this.wrap=A}normalizeCol(t){if(!this.wrap)return t;const i=this.worldSize[0];return t<0?i-1-Math.abs((t+1)%i):t%i}denormalizeCol(t,i){return this.wrap?this.worldSize[0]*i+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,i,r=!1){Sa.set(i);const s=r?Sa.col:this.denormalizeCol(Sa.col,Sa.world),n=Sa.row;return Voe(t,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),t}getTileCoords(t,i,r=!1){Sa.set(i);const s=r?Sa.col:this.denormalizeCol(Sa.col,Sa.world);return Array.isArray(t)?id(t,this.getXForColumn(s),this.getYForRow(Sa.row)):(t.x=this.getXForColumn(s),t.y=this.getYForRow(Sa.row)),t}},r_=class{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}*keys(){const t=this.lodInfo;for(const{row:i,colFrom:r,colTo:s}of this.spans)for(let n=r;n<=s;n++){const c=t.getWorldForColumn(n);yield new zl(t.level,i,t.normalizeCol(n),c)}}forEach(t,i){const{spans:r,lodInfo:s}=this,{level:n}=s;if(r.length!==0)for(const{row:c,colFrom:o,colTo:p}of r)for(let g=o;g<=p;g++)t.call(i,n,c,s.normalizeCol(g),s.getWorldForColumn(g))}};r_.pool=new Ip(r_);let eT=class{constructor(t,i,r){this.row=t,this.colFrom=i,this.colTo=r}};const cr=new zl("0/0/0/0");let qoe=class TB{static create(t,i){t[1]>i[1]&&([t,i]=[i,t]);const[r,s]=t,[n,c]=i,o=n-r,p=c-s,g=p!==0?o/p:0,S=(Math.ceil(s)-s)*g,M=(Math.floor(s)-s)*g;return new TB(r,Math.floor(s),Math.ceil(c),g,o<0?S:M,o<0?M:S,o<0?n:r,o<0?r:n)}constructor(t,i,r,s,n,c,o,p){this.x=t,this.ymin=i,this.ymax=r,this.invM=s,this.leftAdjust=n,this.rightAdjust=c,this.leftBound=o,this.rightBound=p}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const ho=[[0,0],[0,0],[0,0],[0,0]],Hoe=1e-6;let Woe=class{constructor(t,i=null,r=t.lods[0].level,s=t.lods[t.lods.length-1].level){this.tileInfo=t,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=t.lods.filter(o=>o.level>=r&&o.level<=s);this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const c=this._lodInfos=n.map(o=>Goe.create(t,o,i));n.forEach((o,p)=>{this._infoByLevel[o.level]=c[p],this._infoByScale[o.scale]=c[p],this.scales[p]=o.scale},this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel[typeof t=="number"?t:t.level]}getTileBounds(t,i,r=!1){cr.set(i);const s=this._infoByLevel[cr.level];return s?s.getTileBounds(t,cr,r):t}getTileCoords(t,i,r=!1){cr.set(i);const s=this._infoByLevel[cr.level];return s?s.getTileCoords(t,cr,r):t}getTileCoverage(t,i=192,r=!0,s="closest"){if(!r&&(t.scale>this.minScale||t.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),c=r_.pool.acquire(n),o=this._wrap;let p,g,S,M=1/0,A=-1/0;const O=c.spans;ho[0][0]=ho[0][1]=ho[1][1]=ho[3][0]=-i,ho[1][0]=ho[2][0]=t.size[0]+i,ho[2][1]=ho[3][1]=t.size[1]+i;for(const ie of ho)t.toMap(ie,ie),ie[0]=n.getColumnForX(ie[0]),ie[1]=n.getRowForY(ie[1]);const z=[];let V=3;for(let ie=0;ie<4;ie++){if(ho[ie][1]===ho[V][1]){V=ie;continue}const ve=qoe.create(ho[ie],ho[V]);M=Math.min(ve.ymin,M),A=Math.max(ve.ymax,A),z[ve.ymin]===void 0&&(z[ve.ymin]=[]),z[ve.ymin].push(ve),V=ie}if(M==null||A==null||A-M>100)return null;let W=[];for(p=M;p<A;){z[p]!=null&&(W=W.concat(z[p])),g=1/0,S=-1/0;for(let ie=W.length-1;ie>=0;ie--){const ve=W[ie];g=Math.min(g,ve.getLeftCol()),S=Math.max(S,ve.getRightCol())}if(g=Math.floor(g),S=Math.floor(S),p>=n.first[1]&&p<=n.last[1])if(o)if(n.size[0]<n.worldSize[0]){const ie=Math.floor(S/n.worldSize[0]);for(let ve=Math.floor(g/n.worldSize[0]);ve<=ie;ve++)O.push(new eT(p,Math.max(n.getFirstColumnForWorld(ve),g),Math.min(n.getLastColumnForWorld(ve),S)))}else O.push(new eT(p,g,S));else g>n.last[0]||S<n.first[0]||(g=Math.max(g,n.first[0]),S=Math.min(S,n.last[0]),O.push(new eT(p,g,S)));p+=1;for(let ie=W.length-1;ie>=0;ie--){const ve=W[ie];ve.ymax>=p?ve.incrRow():W.splice(ie,1)}}return c}getTileParentId(t){cr.set(t);const i=this._infoByLevel[cr.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD(cr,this._lodInfos[r],cr),cr.id)}getTileResolution(t){const i=this._infoByLevel[typeof t=="object"?t.level:t];return i?i.resolution:-1}getTileScale(t){const i=this._infoByLevel[t.level];return i?i.scale:-1}intersects(t,i){cr.set(i);const r=this._infoByLevel[cr.level],s=t.lodInfo;if(s.resolution>r.resolution){this._getTileIdAtLOD(cr,s,cr);const c=s.denormalizeCol(cr.col,cr.world);for(const o of t.spans)if(o.row===cr.row&&o.colFrom<=c&&o.colTo>=c)return!0}if(s.resolution<r.resolution){const[c,o,p,g]=t.spans.reduce((V,W)=>(V[0]=Math.min(V[0],W.row),V[1]=Math.max(V[1],W.row),V[2]=Math.min(V[2],W.colFrom),V[3]=Math.max(V[3],W.colTo),V),[1/0,-1/0,1/0,-1/0]),S=r.denormalizeCol(cr.col,cr.world),M=s.getColumnForX(r.getXForColumn(S)),A=s.getRowForY(r.getYForRow(cr.row)),O=s.getColumnForX(r.getXForColumn(S+1))-1,z=s.getRowForY(r.getYForRow(cr.row+1))-1;return!(M>g||O<p||A>o||z<c)}const n=s.denormalizeCol(cr.col,cr.world);return t.spans.some(c=>c.row===cr.row&&c.colFrom<=n&&c.colTo>=n)}normalizeBounds(t,i,r){if(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],this._wrap){const s=to(this.tileInfo.spatialReference),n=-r*(s.valid[1]-s.valid[0]);t[0]+=n,t[2]+=n}return t}getSmallestInfoForScale(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(t>i[r]+Hoe)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(t){const i=this.scales;return this._infoByScale[t]||(t=i.reduce((r,s)=>Math.abs(s-t)<Math.abs(r-t)?s:r,i[0])),this._infoByScale[t]}scaleToLevel(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let r=i.length-1;r>=0;r--)if(t<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-t)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,i,r){const s=this._infoByLevel[r.level];return t.set(r),i.resolution<s.resolution?null:(i.resolution===s.resolution||(t.level=i.level,t.col=Math.floor(r.col*s.resolution/i.resolution+.01),t.row=Math.floor(r.row*s.resolution/i.resolution+.01)),t)}},Zoe=class{constructor(t,i){this.item=t,this.controller=i,this.promise=null}},Yoe=class{constructor(t){this._schedule=null,this._task=null,this._deferreds=new vb,this._controllers=new vb,this._processingItems=new vb,this._pausedSignal=MF(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new vw(t.peeker),this.process=t.process;const i=t.scheduler;t.priority&&i&&(this._task=i.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule=gr(this._schedule),this._task=gr(this._task)}get updating(){var t;return!!((t=this._task)!=null&&t.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(t){const i=this._controllers.get(t);i&&i.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach(i=>t.push(i)),this._controllers.clear(),t.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach((i,r)=>t(r))}get(t){const i=this._deferreds.get(t);return i?i.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,i){const r=this.get(t);if(r)return r;const s=new AbortController;let n=null;i&&(n=eo(i,()=>s.abort()));const c=()=>{const S=this._processingItems.get(t);S&&S.controller.abort(),o(),g.reject(Nr())},o=()=>{p.remove(),n!=null&&n.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},p=eA(s.signal,c),g=sa();return this._deferreds.set(t,g),this._controllers.set(t,s),g.promise.then(o,o),this._queue.push(t),this._scheduleNext(),g.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){var i;const t=this._queue.popLast();return t&&((i=this._deferreds.get(t))==null||i.reject(Nr("Removed from queue")),this._removeItem(t)),t}reset(){const t=[];this._processingItems.forEach(i=>t.push(i)),this._processingItems.clear();for(const i of t)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=d_(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(i))}_processError(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(i))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(t==null)return;let i;const r=new AbortController,s=new Zoe(t,r);this._processingItems.set(t,s);try{i=this.process(t,r.signal)}catch(n){this._processError(s,n)}wh(i)?(s.promise=i,i.then(n=>this._processResult(s,n),n=>this._processError(s,n))):this._processResult(s,i)}get test(){return{update:t=>this.runTask(t)}}};function Joe(e,t){return e.length=0,t.forEach(i=>e.push(i)),e}const tT=new Set,bv=[],Ef=new Map,HR=[0,0];let Gu=class extends zt{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:i,strategy:r}=this;this._queue=new Yoe({concurrency:t,process:(s,n)=>{const c=this._keyToItem.get(s);return i(c,{signal:n})},peeker:r==="scale-first"?s=>this._peekByScaleFirst(s):s=>this._peekByCenterFirst(s)})}destroy(){this.clear(),this._queue=nr(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}abort(t){const i=typeof t=="string"?t:t.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear()}has(t){return typeof t=="string"?this._keyToItem.has(t):this._keyToItem.has(t.id)}isOngoing(t){const i=typeof t=="string"?t:t.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(t){const i=t.key.id;if(this._queue.has(i))return this._queue.get(i);const r=this._queue.push(i),s=()=>{this._keyToItem.delete(i)};return this._keyToItem.set(i,t),r.then(s,s),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const i=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;t.forEach(S=>{const M=this._keyToItem.get(S),A=this.tileInfoView.getTileScale(M.key);Ef.has(A)||(Ef.set(A,[]),r=Math.max(A,r),s=Math.min(A,s)),Ef.get(A).push(M.key),tT.add(A)});let n=this.state.scale;Ef.has(n)||(Joe(bv,tT),bv.sort((S,M)=>S-M),n=bv.reduce((S,M)=>Math.abs(M-n)<Math.abs(S-n)?M:S,bv[0])),n=Math.min(n,r),n=Math.max(n,s);const c=Ef.get(n),o=i.getClosestInfoForScale(n),p=o.getColumnForX(this.state.center[0]),g=o.getRowForY(this.state.center[1]);return c.sort((S,M)=>{const A=o.denormalizeCol(S.col,S.world),O=o.denormalizeCol(M.col,M.world);return Math.sqrt((p-A)*(p-A)+(g-S.row)*(g-S.row))-Math.sqrt((p-O)*(p-O)+(g-M.row)*(g-M.row))}),tT.clear(),Ef.clear(),c[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const i=this.tileInfoView,r=this.state.center;let s,n=Number.POSITIVE_INFINITY;return t.forEach(c=>{const o=this._keyToItem.get(c);i.getTileCoords(HR,o.key);const p=Zx(HR,r);p<n&&(n=p,s=o.key)}),s.id}};v([I({constructOnly:!0})],Gu.prototype,"concurrency",void 0),v([I({constructOnly:!0})],Gu.prototype,"process",void 0),v([I()],Gu.prototype,"state",void 0),v([I({constructOnly:!0})],Gu.prototype,"strategy",void 0),v([I({constructOnly:!0})],Gu.prototype,"tileInfoView",void 0),Gu=v([me("esri.views.2d.tiling.TileQueue")],Gu);const D1e=Gu;let Koe=class{constructor(t,i,r){this.maxSize=t,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const i=this._tilePerId.get(t);if(!i)return;const r=i.key.level,s=this._tileKeysPerLevel[r];WR(this._tilePerId,t);for(let n=0;n<s.length;n++)if(s[n].id===t){s.splice(n,1);break}return i.visible=!0,i}add(t){t.visible=!1;const i=t.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,t);const s=i.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(i)}prune(t,i,r){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==t&&(s=this._pruneAroundCenterTile(s,i,r,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,i,r,t))}_pruneAroundCenterTile(t,i,r,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return t;const{size:c,origin:o}=this._tileInfoView.tileInfo,p=r*c[0],g=r*c[1],S=[0,0],M=[0,0];for(n.sort((A,O)=>(S[0]=o.x+p*(A.col+.5),S[1]=o.y-g*(A.row+.5),M[0]=o.x+p*(O.col+.5),M[1]=o.y-g*(O.row+.5),Nw(S,i)-Nw(M,i)));n.length>0;){const A=n.pop();if(this._removeTile(A.id),--t===this.maxSize)break}return t}_removeTile(t){const i=this._tilePerId.get(t);this._removedFunc&&i&&this._removedFunc(i),WR(this._tilePerId,t)}};function WR(e,t){e.delete(t)}const rd=new zl(0,0,0,0),dc=new Map,sd=[],iT=[];let z1e=class{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,t.resampling!=null&&(this.resampling=t.resampling),t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),t.buffer!=null&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new Koe(t.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(t){var ie,ve;const{resampling:i,tileIndex:r}=this,{scale:s,center:n,resolution:c}=t.state,{minScale:o,maxScale:p}=this.tileInfoView,g=!t.stationary&&s>this._previousScale;if(this._previousScale=s,!i&&(s>o||s<p))return this.tiles.length=0,void this.clear();const S=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.resampling,this.coveragePolicy);if(!S)return this.tiles.length=0,void this.clear();const{spans:M,lodInfo:A}=S,{level:O}=A;this.tiles.length=0,r.forEach(pe=>pe.visible=!0);let z=0,V=0;if(M.length>0)for(const{row:pe,colFrom:_e,colTo:Me}of M)for(let $e=_e;$e<=Me;$e++){z++;const Fe=rd.set(O,pe,A.normalizeCol($e),A.getWorldForColumn($e)).id;let Ge=r.get(Fe);if(Ge)Ge.isReady?(dc.set(Fe,Ge),V++):g||this._addParentTile(Fe,dc);else{if((ie=this._tileCache)!=null&&ie.has(Fe)){if(Ge=this._tileCache.pop(Fe),this.tileIndex.set(Fe,Ge),Ge.isReady){dc.set(Fe,Ge),V++;continue}}else Ge=this.acquireTile(rd),this.tileIndex.set(Fe,Ge);g||this._addParentTile(Fe,dc)}}const W=V===z;for(const[pe,_e]of r){if(dc.has(pe))continue;rd.set(pe);const Me=this.tileInfoView.intersects(S,rd),$e=this.cachePolicy==="purge"?rd.level!==O:rd.level>O;!Me||!g&&W?!$e&&Me||sd.push(_e):_e.isReady?$e&&this.cachePolicy==="purge"&&this._hasReadyAncestor(rd,O)?sd.push(_e):iT.push(_e):$e&&sd.push(_e)}for(const pe of iT)pe.isReady&&dc.set(pe.key.id,pe);for(const pe of sd)this._tileCache?this._tileCache.add(pe):this.releaseTile(pe),r.delete(pe.key.id);for(const pe of dc.values())this.tiles.push(pe);for(const pe of r.values())dc.has(pe.key.id)||(pe.visible=!1);(ve=this._tileCache)==null||ve.prune(O,n,c),r_.pool.release(S),iT.length=0,sd.length=0,dc.clear()}clear(){const{tileIndex:t}=this;for(const i of t.values())this.releaseTile(i);t.clear()}refresh(t){var i;for(const r of this.tileIndex.values())this.tiles.includes(r)?t(r):sd.push(r);for(const r of sd)this.releaseTile(r),this.tileIndex.delete(r.key.id);(i=this._tileCache)==null||i.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,i){var n;let r=t,s=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(s=this.tileIndex.get(r),s==null?void 0:s.isReady){i.has(s.key.id)||i.set(s.key.id,s);break}}else if((n=this._tileCache)!=null&&n.has(r)&&(s=this._tileCache.pop(r),this.tileIndex.set(r,s),s==null?void 0:s.isReady)){i.has(s.key.id)||i.set(s.key.id,s);break}}_hasReadyAncestor(t,i){const r=Xn();this.tileInfoView.getTileBounds(r,t,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=i&&s.key.level<t.level){const n=Xn();if(this.tileInfoView.getTileBounds(n,s.key,!0),tK(n,r))return!0}return!1}};function EB(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function Xoe(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Qoe(e,t,i,r,s,n){const c=new Float32Array(6);return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=s,c[5]=n,c}function eae(e,t){return new Float32Array(e,t,6)}function IB(e,t,i,r){const s=t[r],n=t[r+1];e[r]=i[0]*s+i[2]*n+i[4],e[r+1]=i[1]*s+i[3]*n+i[5]}function tae(e,t,i,r=0,s=0,n=2){const c=s||t.length/n;for(let o=r;o<c;o++)IB(e,t,i,o*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:Xoe,create:EB,createView:eae,fromValues:Qoe,transform:IB,transformMany:tae},Symbol.toStringTag,{value:"Module"}));function iae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function rae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function MB(e,t,i,r,s,n,c,o,p,g){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=c,e[6]=o,e[7]=p,e[8]=g,e}function AB(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function sae(e,t){if(e===t){const i=t[1],r=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function nae(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5],p=t[6],g=t[7],S=t[8],M=S*c-o*g,A=-S*n+o*p,O=g*n-c*p;let z=i*M+r*A+s*O;return z?(z=1/z,e[0]=M*z,e[1]=(-S*r+s*g)*z,e[2]=(o*r-s*c)*z,e[3]=A*z,e[4]=(S*i-s*p)*z,e[5]=(-o*i+s*n)*z,e[6]=O*z,e[7]=(-g*i+r*p)*z,e[8]=(c*i-r*n)*z,e):null}function oae(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5],p=t[6],g=t[7],S=t[8];return e[0]=c*S-o*g,e[1]=s*g-r*S,e[2]=r*o-s*c,e[3]=o*p-n*S,e[4]=i*S-s*p,e[5]=s*n-i*o,e[6]=n*g-c*p,e[7]=r*p-i*g,e[8]=i*c-r*n,e}function aae(e){const t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],c=e[5],o=e[6],p=e[7],g=e[8];return t*(g*n-c*p)+i*(-g*s+c*o)+r*(p*s-n*o)}function W3(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=t[6],S=t[7],M=t[8],A=i[0],O=i[1],z=i[2],V=i[3],W=i[4],ie=i[5],ve=i[6],pe=i[7],_e=i[8];return e[0]=A*r+O*c+z*g,e[1]=A*s+O*o+z*S,e[2]=A*n+O*p+z*M,e[3]=V*r+W*c+ie*g,e[4]=V*s+W*o+ie*S,e[5]=V*n+W*p+ie*M,e[6]=ve*r+pe*c+_e*g,e[7]=ve*s+pe*o+_e*S,e[8]=ve*n+pe*p+_e*M,e}function yM(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=t[6],S=t[7],M=t[8],A=i[0],O=i[1];return e[0]=r,e[1]=s,e[2]=n,e[3]=c,e[4]=o,e[5]=p,e[6]=A*r+O*c+g,e[7]=A*s+O*o+S,e[8]=A*n+O*p+M,e}function PB(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3],o=t[4],p=t[5],g=t[6],S=t[7],M=t[8],A=Math.sin(i),O=Math.cos(i);return e[0]=O*r+A*c,e[1]=O*s+A*o,e[2]=O*n+A*p,e[3]=O*c-A*r,e[4]=O*o-A*s,e[5]=O*p-A*n,e[6]=g,e[7]=S,e[8]=M,e}function lae(e,t,i){const r=i[0],s=i[1],n=i[2];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=n*t[6],e[7]=n*t[7],e[8]=n*t[8],e}function cae(e,t,i){const r=i[0],s=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e}function uae(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function hae(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function dae(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function pae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function fae(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=i+i,o=r+r,p=s+s,g=i*c,S=r*c,M=r*o,A=s*c,O=s*o,z=s*p,V=n*c,W=n*o,ie=n*p;return e[0]=1-M-z,e[3]=S-ie,e[6]=A+W,e[1]=S+ie,e[4]=1-g-z,e[7]=O-V,e[2]=A-W,e[5]=O+V,e[8]=1-g-M,e}function mae(e,t){const i=t[0],r=t[1],s=t[2],n=t[4],c=t[5],o=t[6],p=t[8],g=t[9],S=t[10],M=S*c-o*g,A=-S*n+o*p,O=g*n-c*p,z=i*M+r*A+s*O;if(!z)return null;const V=1/z;return e[0]=M*V,e[1]=(-S*r+s*g)*V,e[2]=(o*r-s*c)*V,e[3]=A*V,e[4]=(S*i-s*p)*V,e[5]=(-o*i+s*n)*V,e[6]=O*V,e[7]=(-g*i+r*p)*V,e[8]=(c*i-r*n)*V,e}function yae(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],c=t[4],o=t[5],p=t[6],g=t[7],S=t[8],M=t[9],A=t[10],O=t[11],z=t[12],V=t[13],W=t[14],ie=t[15],ve=i*o-r*c,pe=i*p-s*c,_e=i*g-n*c,Me=r*p-s*o,$e=r*g-n*o,Fe=s*g-n*p,Ge=S*V-M*z,et=S*W-A*z,at=S*ie-O*z,ct=M*W-A*V,nt=M*ie-O*V,Pt=A*ie-O*W;let ft=ve*Pt-pe*nt+_e*ct+Me*at-$e*et+Fe*Ge;return ft?(ft=1/ft,e[0]=(o*Pt-p*nt+g*ct)*ft,e[1]=(p*at-c*Pt-g*et)*ft,e[2]=(c*nt-o*at+g*Ge)*ft,e[3]=(s*nt-r*Pt-n*ct)*ft,e[4]=(i*Pt-s*at+n*et)*ft,e[5]=(r*at-i*nt-n*Ge)*ft,e[6]=(V*Fe-W*$e+ie*Me)*ft,e[7]=(W*_e-z*Fe-ie*pe)*ft,e[8]=(z*$e-V*_e+ie*ve)*ft,e):null}function gae(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function _ae(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function vae(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function bae(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function CB(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function wae(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function xae(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e}function Sae(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Tae(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],c=e[4],o=e[5],p=e[6],g=e[7],S=e[8],M=t[0],A=t[1],O=t[2],z=t[3],V=t[4],W=t[5],ie=t[6],ve=t[7],pe=t[8],_e=aa();return Math.abs(i-M)<=_e*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(r-A)<=_e*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(s-O)<=_e*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(n-z)<=_e*Math.max(1,Math.abs(n),Math.abs(z))&&Math.abs(c-V)<=_e*Math.max(1,Math.abs(c),Math.abs(V))&&Math.abs(o-W)<=_e*Math.max(1,Math.abs(o),Math.abs(W))&&Math.abs(p-ie)<=_e*Math.max(1,Math.abs(p),Math.abs(ie))&&Math.abs(g-ve)<=_e*Math.max(1,Math.abs(g),Math.abs(ve))&&Math.abs(S-pe)<=_e*Math.max(1,Math.abs(S),Math.abs(pe))}function Eae(e){const t=aa(),i=e[0],r=e[1],s=e[2],n=e[3],c=e[4],o=e[5],p=e[6],g=e[7],S=e[8];return Math.abs(1-(i*i+n*n+p*p))<=t&&Math.abs(1-(r*r+c*c+g*g))<=t&&Math.abs(1-(s*s+o*o+S*S))<=t}const Iae=W3,Mae=CB;Object.freeze(Object.defineProperty({__proto__:null,add:bae,adjoint:oae,copy:rae,determinant:aae,equals:Tae,exactEquals:Sae,frob:vae,fromMat2d:pae,fromMat4:iae,fromQuat:fae,fromRotation:hae,fromScaling:dae,fromTranslation:uae,identity:AB,invert:nae,isOrthoNormal:Eae,mul:Iae,multiply:W3,multiplyScalar:wae,multiplyScalarAndAdd:xae,normalFromMat4:yae,normalFromMat4Legacy:mae,projection:gae,rotate:PB,scale:lae,scaleByVec2:cae,set:MB,str:_ae,sub:Mae,subtract:CB,translate:yM,transpose:sae},Symbol.toStringTag,{value:"Module"}));function Tb(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function Aae(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Pae(e,t,i,r,s,n,c,o,p){const g=new Float32Array(9);return g[0]=e,g[1]=t,g[2]=i,g[3]=r,g[4]=s,g[5]=n,g[6]=c,g[7]=o,g[8]=p,g}function Cae(e,t){return new Float32Array(e,t,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:Aae,create:Tb,createView:Cae,fromValues:Pae},Symbol.toStringTag,{value:"Module"}));function $B(){return new Float32Array(2)}function $ae(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}function Om(e,t){const i=new Float32Array(2);return i[0]=e,i[1]=t,i}function kae(e,t){return new Float32Array(e,t,2)}function kB(){return $B()}function RB(){return Om(1,1)}function OB(){return Om(1,0)}function LB(){return Om(0,1)}const Rae=kB(),Oae=RB(),Lae=OB(),Dae=LB();Object.freeze(Object.defineProperty({__proto__:null,ONES:Oae,UNIT_X:Lae,UNIT_Y:Dae,ZEROS:Rae,clone:$ae,create:$B,createView:kae,fromValues:Om,ones:RB,unitX:OB,unitY:LB,zeros:kB},Symbol.toStringTag,{value:"Module"}));function Nae(e){return e instanceof Float32Array&&e.length>=2}function zae(e){return Array.isArray(e)&&e.length>=2}function wv(e){return Nae(e)||zae(e)}var gM;const on=[0,0];let qu=gM=class extends At{constructor(e){super(e),this._viewpoint2D={center:zr(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Bi,this.id=0,this.inverseTransform=Nc(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Nc(),this.transformNoRotation=Nc(),this.displayMat3=Tb(),this.displayViewMat3=Tb(),this.viewMat3=Tb(),this.viewMat2d=EB(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=Xa(i,e.viewpoint),this._set("size",t_(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new gM({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return wv(t)?La(e,t,this.inverseTransform):(on[0]=t,on[1]=i,La(e,on,this.inverseTransform))}toScreen(e,t,i){return wv(t)?La(e,t,this.transform):(on[0]=t,on[1]=i,La(e,on,this.transform))}toScreenNoRotation(e,t,i){return wv(t)?La(e,t,this.transformNoRotation):(on[0]=t,on[1]=i,La(e,on,this.transformNoRotation))}toScreenClosest(e,t,i){wv(t)?(on[0]=t[0],on[1]=t[1]):(on[0]=t,on[1]=i);const[r]=on,{center:s,extent:n,spatialReference:c,transform:o}=this;return(r<n.xmin||r>n.xmax)&&(on[0]=hB(r,s[0],c)),La(e,on,o)}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,s=this._get("size");return q3(e,i,s,t,0,r),e}_update(){const{center:e,spatialReference:t,scale:i,rotation:r}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),c=new $l({targetGeometry:new ri(e[0],e[1],t),scale:i,rotation:r});if(this._set("viewpoint",c),!n||!t||!i)return;this.resolution=Zm(c),this.rotation=r,this.scale=i,this.spatialReference=t,t_(this.center,e);const o=n[0]!==0?2/n[0]:0,p=n[1]!==0?-2/n[1]:0;MB(this.displayMat3,o,0,0,0,p,0,-1,1,1);const g=AB(this.viewMat3),S=Om(n[0]/2,n[1]/2),M=Om(-n[0]/2,-n[1]/2),A=NA(r);yM(g,g,S),PB(g,g,A),yM(g,g,M),W3(this.displayViewMat3,this.displayMat3,g);const O=U3(this.viewMat2d,S);return Wx(O,O,A),e_(O,O,M),xoe(this.extent,c,n),H3(this.transform,c,n,s),F3(this.inverseTransform,this.transform),Poe(this.transformNoRotation,c,n,s),this.worldScreenWidth=$oe(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};v([I({readOnly:!0})],qu.prototype,"id",void 0),v([I({value:1,json:{write:!0}})],qu.prototype,"pixelRatio",null),v([I({json:{write:!0}})],qu.prototype,"size",null),v([I()],qu.prototype,"spatialReference",void 0),v([I({type:$l,json:{write:!0}})],qu.prototype,"viewpoint",null),qu=gM=v([me("esri.views.2d.ViewState")],qu);const ZR=qu;var _M,vM;let kc=_M=class extends zt{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new _M({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};v([I()],kc.prototype,"left",void 0),v([I()],kc.prototype,"top",void 0),v([I()],kc.prototype,"right",void 0),v([I()],kc.prototype,"bottom",void 0),kc=_M=v([me("esri.views.2d.PaddedViewState.Padding")],kc);let Gf=vM=class extends ZR{constructor(...e){super(...e),this.paddedViewState=new ZR,this._updateContent=(()=>{const t=zr();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const s=this.paddedViewState;Es(t,r.left+r.right,r.top+r.bottom),i_(t,i,t),t_(s.size,t);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(ti(()=>[this.size,this.padding],()=>this._updateContent(),wp)),this.padding=new kc,this.size=[0,0]}set padding(e){this._set("padding",e||new kc)}set viewpoint(e){if(e){const t=e.clone();this.paddedViewState.viewpoint=e,Roe(t,e,this._get("size"),this._get("padding"));const i=this._viewpoint2D,r=t.targetGeometry;i.center[0]=r.x,i.center[1]=r.y,i.rotation=t.rotation,i.scale=t.scale,i.spatialReference=r.spatialReference,this._update()}}clone(){return new vM({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};v([I()],Gf.prototype,"paddedViewState",void 0),v([I({type:kc})],Gf.prototype,"padding",null),v([I()],Gf.prototype,"viewpoint",null),Gf=vM=v([me("esri.views.2d.PaddedViewState")],Gf);const Fae=Gf;let Mn=class extends zt{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ti(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},wp)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new ri({x:t[0],y:t[1],spatialReference:i})}set center(t){if(t==null)return;if(!this.ready)return void this._set("center",t);let i;try{i=this._project(t,this.state.spatialReference)}catch(s){return void _t.getLogger(this).error(new Je("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:s}))}const r=this.viewpoint;dM(r,r,i),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(t==null)return;if(!t.width||!t.height)return void _t.getLogger(this).error(new Je("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(t,this.state.spatialReference)}catch(s){return void _t.getLogger(this).error(new Je("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const r=this.viewpoint;Soe(r,r,i,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const i=this.viewpoint;Loe(i,i,t),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const i=this.viewpoint;VR(i,i,t),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(t){var n;if(t==null)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,r;try{i=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?r=new Je("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):t.targetGeometry==null&&(r=new Je("mapview:invalid-viewpoint","geometry not defined"))}catch(c){r=new Je("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:c})}if(r)return void _t.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const s=new $l({targetGeometry:new ri,scale:0,rotation:0});Xa(s,i),(n=this.constraints)==null||n.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get zoom(){var t;return this.ready?((t=this.constraints)==null?void 0:t.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(t){var s,n;if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const c=this._get("extent");return void(c&&(this._set("extent",void 0),this._set("center",c.center)))}const i=((s=this.constraints)==null?void 0:s.zoomToScale(t))??0;if(!i)return void this._set("zoom",-1);const r=this.viewpoint;VR(r,r,i),this.viewpoint=r,this._set("zoom",((n=this.constraints)==null?void 0:n.scaleToZoom(this.scale))??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:r}=this,s=this._get("center"),n=this._get("extent"),c=this._get("scale"),o=this._get("rotation"),p=this._get("viewpoint"),g=this._get("zoom"),S=g!=null&&r!=null&&r.zoomToScale(g)||void 0;let M,A,O;const z=p==null?void 0:p.rotation,V=p==null?void 0:p.targetGeometry;(V==null?void 0:V.type)==="extent"?M=V:(V==null?void 0:V.type)==="point"&&(A=V,O=p==null?void 0:p.scale);const W=n??M;return{center:s??A??(W==null?void 0:W.center),rotation:o??z,scale:(c??S??O??(W&&mm(W,[t[0]-i.left-i.right,t[1]-i.top-i.bottom])))||void 0}}startup(t,i,r,s){var c;const n=t.targetGeometry;try{this._project(t,r)}catch(o){_t.getLogger(this).warn(new jc("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:r,error:o})),t.targetGeometry=s||new ri({x:0,y:0,spatialReference:r})}(c=this.constraints)==null||c.fit(t),this._set("state",new Fae({padding:this.padding,size:i,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,i],spatialReference:r,rotation:s,scale:n}=this.state.paddedViewState,c=new ri({x:t,y:i,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",c),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(t){var p;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const g=i.viewpoint.clone();g.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=g}const r=i.clone(),[s,n]=i.center;let c=null;try{c=this._project(new ri({x:s,y:n,spatialReference:i.spatialReference}),t)}catch(g){SA()||_t.getLogger(this).warn(new jc("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:c==null?void 0:c.toJSON(),spatialReference:t,error:g}))}c||(c=new ri({x:0,y:0,spatialReference:t}));const o=dM(new $l({targetGeometry:new ri,scale:0,rotation:0}),i.viewpoint,c);r.viewpoint=o;try{const S=[i.size[0]/2,i.size[1]/2],M=[S[0]+20,S[1]],A=i.toMap([0,0],M),{x:O,y:z}=this._project(new ri({x:A[0],y:A[1],spatialReference:i.spatialReference}),t);A[0]=O,A[1]=z,r.toScreen(A,A);const V=koe(S,A,M),W=Math.hypot(A[0]-S[0],A[1]-S[1])/20;!Number.isFinite(W)||Math.abs(W)>4?(o.rotation=0,o.targetGeometry=new ri({x:0,y:0,spatialReference:t})):(o.scale*=W,o.scale>Le("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(V)?V:0)}catch{}(p=this._get("constraints"))==null||p.constrain(o,void 0),this._get("state").viewpoint=o}resize(t,i){var c;if(!this.ready)return;const r=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.concat();r.size=[t,i],Ooe(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=((c=this.constraints)==null?void 0:c.constrain(s,void 0))??s,this.state.viewpoint=s}toMap(t){if(!this.ready)return null;const i=[0,0],[r,s]=this.state.toMap(i,[t.x,t.y]),n=this.state.spatialReference;return new ri({x:r,y:s,spatialReference:n})}toScreen(t,i){if(!this.ready)return null;const r=this._project(t,this.state.spatialReference),s=[r.x,r.y];return(i==null?void 0:i.pickClosestTarget)===!1?this.state.toScreen(s,s):this.state.toScreenClosest(s,s),Ln(s[0],s[1])}_project(t,i){var n;const r=(t==null?void 0:t.targetGeometry)||t;if(!i)return t;if(!r)return null;if(i.imageCoordinateSystem||(n=r.spatialReference)!=null&&n.imageCoordinateSystem||Hs(i,r.spatialReference))return t;const s=Ah(r,i);if(!s)throw new Je("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:i});return Bae(t)?(t.targetGeometry=s,t):s}};function Bae(e){return(e==null?void 0:e.declaredClass)==="esri.Viewpoint"}v([I({type:ri})],Mn.prototype,"center",null),v([I()],Mn.prototype,"constraints",void 0),v([I({type:Bi})],Mn.prototype,"extent",null),v([I({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],Mn.prototype,"padding",null),v([I()],Mn.prototype,"ready",void 0),v([I()],Mn.prototype,"resizeAlign",void 0),v([I({readOnly:!0})],Mn.prototype,"resolution",null),v([I({type:Number})],Mn.prototype,"rotation",null),v([I({type:Number})],Mn.prototype,"scale",null),v([I({readOnly:!0})],Mn.prototype,"state",void 0),v([I({type:$l})],Mn.prototype,"viewpoint",null),v([I()],Mn.prototype,"zoom",null),Mn=v([me("esri.views.2d.ViewStateManager")],Mn);function Z3(e,t){switch(t){case"primary":return e.pointerType==="touch"||e.button===0;case"secondary":return e.pointerType!=="touch"&&e.button===2;case"tertiary":return e.pointerType!=="touch"&&e.button===1}}let YR=class extends ps{constructor(t,i){super(!0),this._view=t,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(t,i){Z3(t.data,"primary")&&(t.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}},Uae=class extends ps{constructor(t,i,r){super(!0),this.view=t,this.pointerType=i,this.registerIncoming("double-tap-drag",r,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(t){const{data:i}=t,{pointerType:r}=i;if(r!==this.pointerType)return;t.stopPropagation();const{action:s,delta:n}=i,{view:c}=this,{mapViewNavigation:o}=c;switch(s){case"begin":{const{scale:p}=c;this._startScale=p,this._currentScale=p,this._previousDelta=n,o.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const p=1.015**n.y,g=this._startScale*p,S=g/this._currentScale;o.setViewpointImmediate(S),this._currentScale=g;break}case"end":{const{constraints:p}=c,{effectiveLODs:g,snapToZoom:S}=p;if(!S||!g)return void o.end();const M=p.snapScale(this._currentScale),A=(n.y>0?Math.max(M,p.snapToPreviousScale(this._startScale)):Math.min(M,p.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(A);break}}}},Jx=class{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const i=t.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){var i,r;this._startEvent=t,(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}},jae=class extends ps{constructor(t,i,r){super(!0),this.view=t,this.pointerAction=i,this.registerIncoming("drag",r,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(t){super.onInstall(t),this._dragEventSeparator=new Jx({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&Z3(r.data,this.pointerAction)})}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Vae=class extends ps{constructor(t,i,r){super(!0),this._view=t,this.pointerAction=i;const s=this._view.mapViewNavigation;this._dragEventSeparator=new Jx({start:(n,c)=>{s.rotate.begin(this._view,c.data),c.stopPropagation()},update:(n,c)=>{s.rotate.update(this._view,c.data),c.stopPropagation()},end:(n,c)=>{s.rotate.end(),c.stopPropagation()},condition:(n,c)=>n===1&&Z3(c.data,this.pointerAction)}),this.registerIncoming("drag",r,n=>this._dragEventSeparator.handle(n))}};function Ta(e){let t=e*e;return e<0&&(t*=-1),t}function Gae(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function qae(e,t,i){const r=i,s=e.state,n=e.device,c=t.tiltDirection==="forward-down"?1:-1,o=1;return n.deviceType==="standard"?(r.translation[0]=Ta(s.axes[0]),r.translation[1]=Ta(s.axes[1]),r.translation[2]=Ta(s.buttons[7])-Ta(s.buttons[6]),r.heading=Ta(s.axes[2]),r.tilt=Ta(s.axes[3])):n.deviceType==="spacemouse"&&(r.translation[0]=1.2*Ta(s.axes[0]),r.translation[1]=1.2*Ta(s.axes[1]),r.translation[2]=2*-Ta(s.axes[2]),r.heading=1.2*Ta(s.axes[5]),r.tilt=1.2*Ta(s.axes[3])),r.tilt*=c,CN(r.translation,r.translation,o),r}function Hae(e){return e.translation[0]===0&&e.translation[1]===0&&e.translation[2]===0&&e.heading===0&&e.tilt===0&&e.zoom===0}let Wae=class extends ps{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new XM,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([ti(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=Sm({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},mn)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const i=this._view.navigation.gamepad.device;i&&t.data.device!==i||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,Gae(this._transformation)):(this._currentDevice=t.data.device,qae(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const i=this._transformation;if(Hae(i))return;const r=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=Yae*s*t;Yx(r,r,[i.translation[0]*n,-i.translation[1]*n]);const c=1+i.translation[2]*Jae*t,o=this._view.constraints.rotationEnabled?-i.heading*Zae*t:0,p=this._view.size,g=[p[0]/2,p[1]];gB(r,r,c,o,g,p);const S=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=S}};const Zae=.06,Yae=.7,Jae=6e-4;function DB(e){const t=()=>e(document.visibilityState==="visible");return document.addEventListener("visibilitychange",t),{remove:()=>document.addEventListener("visibilitychange",t)}}let Kae=class extends ps{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Ctrl"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const c=s.type==="key-down";if(this._pressedKeys[c?"add":"delete"](n),c){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const o=this._timeout===void 0,p=this._pressedKeys.size>0;o||p?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=DB(s=>s?null:this._stopMovement())}onUninstall(){var t;this._stopMovement(),(t=this._visibilityHandle)==null||t.remove()}get _direction(){return this._currentDirection}set _direction(t){const i=this._currentDirection!=null;if(t!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=t===void 0?void 0:setTimeout(()=>{this._timeout=void 0,t()},this._stickyKeyDuration)}},Xae=class extends ps{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",r,s=>this._handleKeyUp(s)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=DB(s=>s?null:this._handleStop())}onUninstall(){var t;(t=this._visibilityHandle)==null||t.remove(),this._handleStop()}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,i){const r=t.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[t.data.key];if(this._pressed=s!=null,this._pressed){if(t.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}};var nm;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(nm||(nm={}));let Qae=class extends ps{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,s=>this._handleKeyDown(s)),i.zoomIn.forEach(s=>this._keysToZoomAction[s]=nm.IN),i.zoomOut.forEach(s=>this._keysToZoomAction[s]=nm.OUT)}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const i=t.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=t.data;if(!(r in this._keysToZoomAction))return;const s=this._keysToZoomAction[r],{mapViewNavigation:n}=this.view;let c=null;switch(s){case nm.IN:c=n.zoomIn();break;case nm.OUT:c=n.zoomOut();break;default:return}n.begin(),c.then(()=>n.end()),t.stopPropagation()}};const ele=.6;let tle=class extends ps{constructor(t,i){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:s,deltaY:n}=t.data,c=1/ele**(1/60*n),o=i.zoom(c,[r,s]);o&&(this._canZoom=!1,o.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},ile=class extends ps{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new Jx({start:(r,s)=>{i.pinch.begin(this.view,s.data),s.stopPropagation()},update:(r,s)=>{i.pinch.update(this.view,s.data),s.stopPropagation()},end:(r,s)=>{i.pinch.end(this.view),s.stopPropagation()},condition:r=>r>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function JR(e){const t=e.native;return t?{buttons:t.buttons.map(i=>i.pressed?i.value||1:0),axes:t.axes.map(i=>nle(i,e.axisThreshold))}:{buttons:[],axes:[]}}function rle(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}function sle(e){for(let t=0;t<e.axes.length;t++)if(e.axes[t]!==0)return!1;for(let t=0;t<e.buttons.length;t++)if(e.buttons[t]!==0)return!1;return!0}function nle(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}let ole=class{constructor(t,i){this._element=t,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const c=n.gamepad,o=c.index,p=this._inputDevices[o];p&&(this._emitGamepadEvent(c,JR(p),!1),this._inputDevices.splice(o,1),this._latestUpdate.splice(o,1),this._input.gamepad.devices.remove(p),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=r&&s,this.supported&&(this._forEachGamepad(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const i=new z3(t);i.deviceType!=="unknown"&&(this._inputDevices[t.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Sm({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!i;this._forEachGamepad(s=>{const n=this._inputDevices[s.index];if(!n)return;const c=this._latestUpdate[s.index],o=JR(n),p=r||sle(o);c&&(c.timestamp===s.timestamp||!c.active&&p||rle(c.state,o))||this._emitGamepadEvent(s,o,!p)})}_forEachGamepad(t){const i=window.navigator.getGamepads();for(let r=0;r<i.length;r++){const s=i[r];this._validate(s)&&t(s)}}_emitGamepadEvent(t,i,r){const s=this._latestUpdate[t.index],n=s&&s.active;if(!n&&!r)return;const c=!n&&r?"start":n&&r?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[t.index],state:i,action:c})}_validate(t){if(!t||!t.connected)return!1;for(let i=0;i<t.axes.length;i++)if(isNaN(t.axes[i]))return!1;return!0}};const KR=Le("edge"),ale=Le("chrome"),lle=Le("ff"),cle=Le("safari"),XR="esri-view-surface",If={touchNone:`${XR}--touch-none`,touchPan:`${XR}--touch-pan`};let NB=class zB{constructor(t,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new ole(t,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(t=>{this._releasePointerCaptureSafe(t)}),this._gamepadSource=nr(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const i in this._active)if(!t||!t.has(i)){const r=this._active[i];this._element.removeEventListener(rT[i],r),delete this._active[i]}t&&t.forEach(i=>{if(!this._active[i]&&rT[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(rT[i],r),this._active[i]=r}}),this._gamepadSource.hasEventListeners=(t==null?void 0:t.has("gamepad"))??!1}setPointerCapture(t,i){i?this._setPointerCatpureSafe(t.pointerId):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?If.touchNone:If.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?If.touchPan:If.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(If.touchNone),this._element.classList.remove(If.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(t){try{this._element.setPointerCapture(t),this._activePointerCaptures.add(t)}catch{}}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch{}}_updateNormalizedPointerLikeEvent(t,i){const r=L8(this._element,t);return zB.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(t,i){const{key:r}=i;r&&t==="key-up"&&this._keyDownState.delete(r);const s={native:i,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&t==="key-down"&&this._keyDownState.add(s.key),this._callback(t,s)}_handlePointer(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(t,r)}_handlePointerPreventDefault(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(t,r)}_handleMouseWheel(t,i){let r=i.deltaY;switch(i.deltaMode){case 0:KR&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}KR?r*=.7:ale||cle?r*=.6:lle&&(r*=1.375);const s=100,n=Math.abs(r);n>s&&(r=r/n*200/(1+Math.exp(-.02*(n-s))));const c=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(t,c)}_handlePointerCaptureLost(t,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(t,i)}_handleDefault(t,i){const r={native:i};i.preventDefault(),this._callback(t,r)}_preventAltKeyDefault(t){t.key==="Alt"&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}};NB.test={disableSubpixelCoordinates:!1};const rT={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let ule=class extends ps{constructor(){super(!0),this.registerIncoming("context-menu",t=>{t.data.native.preventDefault()})}};const Vs={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Fw(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function hle(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}function dle(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:Ln()},e.length===0)return t;if(e.length===1)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(e.length===2){const[pe,_e]=e,[Me,$e]=[_e.x-pe.x,_e.y-pe.y];return t.radius=Math.sqrt(Me*Me+$e*$e)/2,t.center.x=(pe.x+_e.x)/2,t.center.y=(pe.y+_e.y)/2,t}let i=0,r=0;for(let pe=0;pe<e.length;pe++)i+=e[pe].x,r+=e[pe].y;i/=e.length,r/=e.length;const s=e.map(pe=>pe.x-i),n=e.map(pe=>pe.y-r);let c=0,o=0,p=0,g=0,S=0,M=0,A=0;for(let pe=0;pe<s.length;pe++){const _e=s[pe],Me=n[pe],$e=_e*_e,Fe=Me*Me;c+=$e,o+=Fe,p+=_e*Me,g+=$e*_e,S+=Fe*Me,M+=_e*Fe,A+=Me*$e}const O=.5*(g+M),z=.5*(S+A),V=c*o-p*p,W=(O*o-z*p)/V,ie=(c*z-p*O)/V,ve=Ln(W+i,ie+r);return{radius:Math.sqrt(W*W+ie*ie+(c+o)/e.length),center:ve}}function lp(e){const{native:t}=e,{pointerId:i,button:r,pointerType:s}=t;return s==="mouse"?`${i}:${r}`:`${s}`}let ple=class extends ps{constructor(t=Vs.maximumDoubleClickDelay,i=Vs.maximumDoubleClickDistance,r=Vs.maximumDoubleTouchDelay,s=Vs.maximumDoubleTouchDistance,n=Bm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=s,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Ln(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Jx({start:(c,o)=>this._dragStart(c,o),update:(c,o)=>this._dragUpdate(o),end:(c,o)=>this._dragEnd(o)}),this.registerIncoming("drag",c=>this._dragEventSeparator.handle(c)),this.registerIncoming("pointer-down",c=>this._handlePointerDown(c)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(t=>{t.doubleTapTimeout=gr(t.doubleTapTimeout)})}get hasPendingInputs(){return ax(this._pointerState,t=>t.doubleTapTimeout!=null)}_clearPointerDown(t){const i=this._pointerState.get(t);i&&(i.doubleTapTimeout=gr(i.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,i,r){const{button:s,buttons:n,pointer:c,pointers:o,pointerType:p,timestamp:g}=r;return{action:t,delta:i,button:s,buttons:n,pointer:c,pointers:o,pointerType:p,timestamp:g}}_dragStart(t,i){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:s}=i,{center:n}=r;this._dragStartCenter=n;const c=this._createDoubleTapDragData("begin",Ln(0,0),r);this._doubleTapDrag.emit(c,void 0,s),i.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:s}=i,n=Ln(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("update",n,i);this._doubleTapDrag.emit(c,void 0,r),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:s}=i,n=Ln(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("end",n,i);this._doubleTapDrag.emit(c,void 0,r),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:i}=t,r=lp(i),s=this._pointerState.get(r),{pointerType:n}=i.native;if(s){const c=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),Fw(s.event.data,i)>c?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:i}=t,{pointerType:r}=i.native,s=lp(i),n=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,c=this._clock.setTimeout(()=>this._clearPointerDown(s),n);this._pointerState.set(s,{event:t,doubleTapTimeout:c}),this.refreshHasPendingInputs()}},fle=class extends ps{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,i,r,s){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:s,pointers:mle(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(t){const i=t.native.pointerId,r=xv(this._activePointerMap).angle,s={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,s);const n=Eb(s,FB(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(r)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;const i=t.native.pointerId,r=this._activePointerMap.get(i);r?r.event=t:this._addPointer(t)}_removePointer(t){const i=xv(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(i)}_updatePointerAngles(t){const i=xv(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=Eb(r,i)-t,r.lastAngle=Eb(r,i)-t})}_emitEvent(t,i,r){const s=xv(this._activePointerMap);this._drag.emit(this._createPayload(t,i,s,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,r=t.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",t.data,t.timestamp)))}_handlePointerDrag(t){const i=t.data,r=i.currentEvent,s=t.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,s)):(this._addPointer(r),this._emitEvent("added",r,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function FB(e){const t=[];return e.forEach(i=>{t.push(Ln(i.event.x,i.event.y))}),dle(t)}function xv(e){const t=FB(e);let i=0;return e.forEach(r=>{let s=Eb(r,t),n=s-r.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=r.lastAngle+n,r.lastAngle=s;const c=s-r.initialAngle;i+=c}),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function mle(e){const t=new Map;return e.forEach((i,r)=>t.set(r,i.event)),t}function Eb(e,t){const i=e.event,r=i.x-t.center.x,s=i.y-t.center.y;return Math.atan2(s,r)}var QR;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(QR||(QR={}));let yle=class extends ps{constructor(t=Vs.maximumDoubleClickDelay,i=Vs.maximumDoubleClickDistance,r=Vs.maximumDoubleTouchDelay,s=Vs.maximumDoubleTouchDistance,n=Bm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=lp(i);if(!this._pointerState.has(r)){const s={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(r,s),this.startCapturingPointer(i.native)}}_handlePointerUp(t){const i=t.data,r=lp(i),s=this._pointerState.get(r);if(s&&s.downButton===i.native.button){const n=s.immediateDoubleClick,c=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),Fw(n,t.data)>c?this._startImmediateDoubleClick(t,s):(this._immediateDoubleClick.emit(t.data,void 0,n.modifiers),this._removeState(i))):Fw(s,t.data)>c?this._removeState(i):this._startImmediateDoubleClick(t,s)}}_startImmediateDoubleClick(t,i){const r=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(t.data),r)}}_removeState(t){const i=lp(t);this._pointerState.delete(i),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}},gle=class extends ps{constructor(t=Vs.maximumClickDelay,i=Vs.movementUntilMouseDrag,r=Vs.movementUntilPenDrag,s=Vs.movementUntilTouchDrag,n=Vs.holdDelay,c=Bm){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=s,this._holdDelay=n,this._clock=c,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",o=>{this._handlePointerLoss(o,"pointer-up")}),this.registerIncoming("pointer-capture-lost",o=>{this._handlePointerLoss(o,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",o=>{this._handlePointerLoss(o,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(t=>{t.holdTimeout=gr(t.holdTimeout)}),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=i.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const c=this._pointerState.get(r);if(c){if(!c.isDragging){const o=c.previousEvent;this._pointerHold.emit(o,void 0,t.modifiers),c.holdEmitted=!0}c.holdTimeout=null}},this._holdDelay));const n={startEvent:i,previousEvent:i,startTimestamp:t.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(r,n),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_createPointerDragData(t,i,r){return{action:t,startEvent:i.startEvent,previousEvent:i.previousEvent,currentEvent:r}}_handlePointerMove(t){const i=t.data,r=i.native.pointerId,s=this._pointerState.get(r);s&&(s.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",s,i),void 0,s.modifiers):hle(i,s.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(t),s.previousEvent=i)}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){const i=t.data,r=i.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=t.modifiers,s.isDragging=!0,r===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,i)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),t.timestamp))})}_handlePointerLoss(t,i){const r=t.data,s=r.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",n,i==="pointer-up"?r:n.previousEvent),void 0,n.modifiers):i==="pointer-up"&&n.downButton===r.native.button&&t.timestamp-n.startTimestamp<=this._maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(s),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}},_le=class extends ps{constructor(t=Vs.maximumDoubleClickDelay,i=Vs.maximumDoubleClickDistance,r=Vs.maximumDoubleTouchDelay,s=Vs.maximumDoubleTouchDistance,n=Bm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(t=>t.doubleClickTimer=gr(t.doubleClickTimer))}get hasPendingInputs(){return ax(this._pointerState,t=>t.doubleClickTimer!=null)}_clearDoubleClickTimer(t,i){const r=this._pointerState.get(t);r&&(r.doubleClickTimer=gr(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const i=this._pointerState.get(t);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_getPointerId(t){const{pointerId:i,pointerType:r,button:s}=t.native;return r==="mouse"?`${i}:${s}`:`${r}`}_handleImmediateClick(t){const i=t.data,{pointerType:r}=i.native,s=this._getPointerId(i);if(!this._pointerState.has(s))return void this._startClick(t);const n=this._pointerState.get(s),{data:c,modifiers:o}=n.event,p=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Fw(c,i)>p?(this._clearDoubleClickTimer(s,!0),this._startClick(t)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(c,void 0,o))}_handlePointerDown(t){const i=lp(t.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(t){const{data:i}=t,{native:{pointerType:r}}=i,s=lp(i),n=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,c=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),n);this._pointerState.set(s,{event:t,doubleClickTimer:c,pointerDownCount:1}),this.refreshHasPendingInputs()}};const Sv={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Cd=class extends zt{initialize(){const t=()=>{var i;return(i=this.view)==null?void 0:i.ready};this.addHandles([yh(()=>!t(),()=>this._disconnect()),yh(t,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerType}get latestPointerLocation(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerLocation}get multiTouchActive(){var t;return((t=this._inputManager)==null?void 0:t.multiTouchActive)??!1}isModifierKeyDown(t){var i;return((i=this._inputManager)==null?void 0:i.isModifierKeyDown(t))??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=nr(this._inputManager)}_connect(){const t=this.view.surface,i=new NB(t,this.view.input),r=[new yle,new gle,new _le,new fle(this.view.navigation),new ple],s=new Vo({eventSource:i,recognizers:r});s.installHandlers("prevent-context-menu",[new ule],ch.INTERNAL),s.installHandlers("navigation",[new ile(this.view),new Wae(this.view),new tle(this.view),new YR(this.view),new YR(this.view,[Sv.counter]),new jae(this.view,"primary"),new Kae(this.view,Sv.pan),new Qae(this.view,Sv.zoom),new Xae(this.view,Sv.rotate),new Vae(this.view,"secondary"),new Uae(this.view,"touch")],ch.INTERNAL),this.view.viewEvents.connect(s),this._source=i,this._inputManager=s,ti(()=>{var n,c;return(c=(n=this.view)==null?void 0:n.navigation)==null?void 0:c.browserTouchPanEnabled},n=>{this._source&&(this._source.browserTouchPanningEnabled=!n)},mn)}get test(){return{inputManager:this._inputManager}}};v([I()],Cd.prototype,"view",void 0),v([I()],Cd.prototype,"latestPointerType",null),v([I()],Cd.prototype,"latestPointerLocation",null),v([I()],Cd.prototype,"multiTouchActive",null),Cd=v([me("esri.views.2d.input.MapViewInputManager")],Cd);const vle=Cd;var ove=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ble(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var eO,tO,iO,BB={exports:{}};eO=BB,tO=function(){function e(s,n,c,o,p){t(s,n,c||0,o||s.length-1,p||r)}function t(s,n,c,o,p){for(;o>c;){if(o-c>600){var g=o-c+1,S=n-c+1,M=Math.log(g),A=.5*Math.exp(2*M/3),O=.5*Math.sqrt(M*A*(g-A)/g)*(S-g/2<0?-1:1);t(s,n,Math.max(c,Math.floor(n-S*A/g+O)),Math.min(o,Math.floor(n+(g-S)*A/g+O)),p)}var z=s[n],V=c,W=o;for(i(s,c,n),p(s[o],z)>0&&i(s,c,o);V<W;){for(i(s,V,W),V++,W--;p(s[V],z)<0;)V++;for(;p(s[W],z)>0;)W--}p(s[c],z)===0?i(s,c,W):i(s,++W,o),W<=n&&(c=W+1),n<=W&&(o=W-1)}}function i(s,n,c){var o=s[n];s[n]=s[c],s[c]=o}function r(s,n){return s<n?-1:s>n?1:0}return e},(iO=tO())!==void 0&&(eO.exports=iO);const wle=ble(BB.exports);function Bw(e,t){if(!(this instanceof Bw))return new Bw(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&(typeof t=="function"?this.toBBox=t:this._initFormat(t)),this.clear()}function xle(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function Mf(e,t){r0(e,0,e.children.length,t,e)}function r0(e,t,i,r,s){s||(s=qf(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,c=t;c<i;c++)n=e.children[c],s0(s,e.leaf?r(n):n);return s}function s0(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function rO(e,t){return e.minX-t.minX}function sO(e,t){return e.minY-t.minY}function sT(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Tv(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Sle(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Tle(e,t){var i=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),n=Math.min(e.maxY,t.maxY);return Math.max(0,s-i)*Math.max(0,n-r)}function nT(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Ev(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function qf(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function nO(e,t,i,r,s){for(var n,c=[t,i];c.length;)(i=c.pop())-(t=c.pop())<=r||(n=t+Math.ceil((i-t)/r/2)*r,wle(e,n,t,i,s),c.push(t,n,n,i))}Bw.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!Ev(e,t))return i;for(var s,n,c,o,p=[];t;){for(s=0,n=t.children.length;s<n;s++)c=t.children[s],Ev(e,o=t.leaf?r(c):c)&&(t.leaf?i.push(c):nT(e,o)?this._all(c,i):p.push(c));t=p.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!Ev(e,t))return!1;for(var r,s,n,c,o=[];t;){for(r=0,s=t.children.length;r<s;r++)if(n=t.children[r],Ev(e,c=t.leaf?i(n):n)){if(t.leaf||nT(e,c))return!0;o.push(n)}t=o.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var s=this.data;this.data=r,r=s}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e!=null&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=qf([]),this},remove:function(e,t){if(e==null)return this;for(var i,r,s,n,c=this.data,o=this.toBBox(e),p=[],g=[];c||p.length;){if(c||(c=p.pop(),r=p[p.length-1],i=g.pop(),n=!0),c.leaf&&(s=xle(e,c.children,t))!==-1)return c.children.splice(s,1),p.push(c),this._condense(p),this;n||c.leaf||!nT(c,o)?r?(i++,c=r.children[i],n=!1):c=null:(p.push(c),g.push(i),i=0,r=c,c=c.children[0])}return this},toBBox:function(e){return e},compareMinX:rO,compareMinY:sO,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var s,n=i-t+1,c=this._maxEntries;if(n<=c)return Mf(s=qf(e.slice(t,i+1)),this.toBBox),s;r||(r=Math.ceil(Math.log(n)/Math.log(c)),c=Math.ceil(n/Math.pow(c,r-1))),(s=qf([])).leaf=!1,s.height=r;var o,p,g,S,M=Math.ceil(n/c),A=M*Math.ceil(Math.sqrt(c));for(nO(e,t,i,A,this.compareMinX),o=t;o<=i;o+=A)for(nO(e,o,g=Math.min(o+A-1,i),M,this.compareMinY),p=o;p<=g;p+=M)S=Math.min(p+M-1,g),s.children.push(this._build(e,p,S,r-1));return Mf(s,this.toBBox),s},_chooseSubtree:function(e,t,i,r){for(var s,n,c,o,p,g,S,M;r.push(t),!t.leaf&&r.length-1!==i;){for(S=M=1/0,s=0,n=t.children.length;s<n;s++)p=sT(c=t.children[s]),(g=Sle(e,c)-p)<M?(M=g,S=p<S?p:S,o=c):g===M&&p<S&&(S=p,o=c);t=o||t.children[0]}return t},_insert:function(e,t,i){var r=this.toBBox,s=i?e:r(e),n=[],c=this._chooseSubtree(s,this.data,t,n);for(c.children.push(e),s0(c,s);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(s,n,t)},_split:function(e,t){var i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);var n=this._chooseSplitIndex(i,s,r),c=qf(i.children.splice(n,i.children.length-n));c.height=i.height,c.leaf=i.leaf,Mf(i,this.toBBox),Mf(c,this.toBBox),t?e[t-1].children.push(c):this._splitRoot(i,c)},_splitRoot:function(e,t){this.data=qf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Mf(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,s,n,c,o,p,g,S;for(p=g=1/0,r=t;r<=i-t;r++)c=Tle(s=r0(e,0,r,this.toBBox),n=r0(e,r,i,this.toBBox)),o=sT(s)+sT(n),c<p?(p=c,S=r,g=o<g?o:g):c===p&&o<g&&(g=o,S=r);return S},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:rO,s=e.leaf?this.compareMinY:sO;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,s)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var s,n,c=this.toBBox,o=r0(e,0,t,c),p=r0(e,i-t,i,c),g=Tv(o)+Tv(p);for(s=t;s<i-t;s++)n=e.children[s],s0(o,e.leaf?c(n):n),g+=Tv(o);for(s=i-t-1;s>=t;s--)n=e.children[s],s0(p,e.leaf?c(n):n),g+=Tv(p);return g},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)s0(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)e[i].children.length===0?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():Mf(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};let oO=class UB{constructor(t,i){this.key=new zl(0,0,0,0),this.bounds=Xn(),this.objectIds=new Set,this.key.set(i);const r=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Bi.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(t){return{$view:{scale:this.scale,timeZone:t}}}createChildTiles(){const t=this.key.getChildKeys(),i=kn.acquire();for(let r=0;r<t.length;r++)i[r]=new UB(this.tileInfoView,t[r]);return i}getQuantizationParameters(){return $8.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const nd={added:[],removed:[]},oT=new Set,Ele=new zl(0,0,0,0);function Ile(e,t){const i=to(t);if(!i)return null;const[r,s]=i.valid;return e[2]>s?[Xn([e[0],e[1],s,e[3]]),Xn([r,e[1],r+e[2]-s,e[3]])]:e[0]<r?[Xn([r,e[1],e[2],e[3]]),Xn([s-(r-e[0]),e[1],s,e[3]])]:null}let Mle=class extends xh{constructor(t){super(),this._tiles=new Map,this._index=Bw(9,Le("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||a6(t)===0||l6(t)===0)return[];const i=Ile(t,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const i={added:[],removed:[]};for(const r of t.added)if(!this.has(r)){const s=new oO(this.tileScheme,r);this._tiles.set(r,s),this._index.insert(s),i.added.push(s)}for(const r of t.removed)if(this.has(r)){const s=this.get(r);this._tiles.delete(r),this._index.remove(s),i.removed.push(s)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(t){const i=this.tileScheme.getTileCoverage(t,0);if(!i)return;const{spans:r,lodInfo:s}=i,{level:n}=s;if(r.length>0)for(const{row:c,colFrom:o,colTo:p}of r)for(let g=o;g<=p;g++){const S=Ele.set(n,c,s.normalizeCol(g),s.getWorldForColumn(g)).id;if(oT.add(S),!this.has(S)){const M=new oO(this.tileScheme,S);this._tiles.set(S,M),this._index.insert(M),this.tiles.push(M),nd.added.push(M)}}for(let c=this.tiles.length-1;c>=0;c--){const o=this.tiles[c];oT.has(o.id)||(this._tiles.delete(o.id),this.tiles.splice(c,1),this._index.remove(o),nd.removed.push(o))}(nd.added.length||nd.removed.length)&&this.emit("update",nd),r_.pool.release(i),oT.clear(),nd.added.length=0,nd.removed.length=0}},Hu=class extends zt{constructor(){super(...arguments),this.color=new Bt([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25,this.multiHighlightEnabled=!1}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.multiHighlightEnabled===t.multiHighlightEnabled}};v([I({type:Bt})],Hu.prototype,"color",void 0),v([I({type:Bt})],Hu.prototype,"haloColor",void 0),v([I()],Hu.prototype,"haloOpacity",void 0),v([I()],Hu.prototype,"fillOpacity",void 0),v([I()],Hu.prototype,"multiHighlightEnabled",void 0),Hu=v([me("esri.views.2d.support.HighlightOptions")],Hu);const jB=Hu;async function Ale(e,t,i){const r=N8(t)?D8(e,t):t;if(!e.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let s=new Set;const n=new Set;let c=!1,o=null,p=null;i!=null&&i.include?lO(i.include,aO(e,A=>{s.add(A),aT(A,O=>n.add(O))},(A,O)=>{n.add(A),s.add(O)},A=>{o||(o=new Set),o.add(A)},A=>s.add(A),()=>c=!0)):(c=!0,s=new Set(e.allLayerViews),s.forEach(A=>{aT(A,O=>n.add(O))})),i!=null&&i.exclude&&lO(i.exclude,aO(e,A=>{s.delete(A),aT(A,O=>n.delete(O))},A=>n.delete(A),A=>{p||(p=new Set),p.add(A)}));const g=e.allLayerViews.filter(A=>!A.suspended&&s.has(A)).reverse(),S=e.toMap(r);let M=[...c?e.graphicsView.hitTest(S).map(A=>({type:"graphic",graphic:A,layer:null,mapPoint:S})):[],...await Promise.all(g.map(A=>A.hitTest(S,r)).toArray())].filter(O0).flat().filter(O0);return M=M.filter(A=>{var O;return A.type!=="graphic"||((O=A.layer)==null?void 0:O.type)!=="subtype-group"||n.has(A.graphic.layer)}),o&&(M=M.filter(A=>!("graphic"in A)||!A.graphic||(o==null?void 0:o.has(bM(A.graphic))))),p&&(M=M.filter(A=>!("graphic"in A)||!A.graphic||!(p!=null&&p.has(bM(A.graphic))))),{screenPoint:r,results:M}}function aO(e,t,i,r,s,n){return c=>{if(c instanceof HI){if(c.layer===e)n==null||n();else{const o=e.allLayerViews.find(p=>p.layer===c.layer);o&&(s==null||s(o))}r(bM(c))}else if(c.type==="subtype-sublayer"){const o=e.allLayerViews.find(p=>p.layer===c.parent);o&&i(c,o)}else{const o=e.allLayerViews.find(p=>p.layer===c);o&&t(o)}}}function lO(e,t){if(e)if(Bb(e))for(const i of e)if(Bb(i))for(const r of i)t(r);else t(i);else t(e)}function bM(e){var i,r;const t=e.getObjectId();return t?`${((i=e.layer)==null?void 0:i.uid)??((r=e.sourceLayer)==null?void 0:r.uid)??"MapView"}/${t}`:`"MapView/${e.uid}`}function aT({layer:e},t){e.type==="subtype-group"&&e.sublayers.forEach(i=>{t(i)})}function Ple(e,t,i){const{ctx:r,canvas:s}=VB(e,i),n=r.getImageData(0,0,e.width,e.height),c=kle(s,t);return GB(s),{dataUrl:c,data:n}}function Cle(e,t){const{ctx:i,canvas:r}=VB(e,t),s=i.getImageData(0,0,e.width,e.height);return GB(r),s}function VB(e,t){const i=$le();t.premultipliedAlpha&&Nle(e),i.width=e.width,i.height=e.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(e,0,0),t.flipY&&Dle(r),{ctx:r,canvas:i}}function GB(e){e.width=0,e.height=0}function $le(){return lT==null&&(lT=document.createElement("canvas")),lT}let lT=null;function kle(e,t){const i=zle[t.format],r=t.quality/100;return e.toDataURL(i,r)}function Rle(e,t){const i=Lle(e),r=Ble[i];return{format:i,quality:Ol(t??r,0,100)}}function Ole(e,t){return t/Math.max(e[0],e[1])}function cve(e,t,i,r=0,s=0,n=e.width-r,c=e.height-s,o=!1){const{data:p}=e,{width:g,height:S,data:M}=t,A=n/g,O=c/S,z=Math.ceil(A/2),V=Math.ceil(O/2),W=e.width;for(let ie=0;ie<S;ie++)for(let ve=0;ve<g;ve++){const pe=4*(ve+(o?S-ie-1:ie)*g);let _e=0,Me=0,$e=0,Fe=0,Ge=0,et=0;const at=(ie+.5)*O;for(let ct=Math.floor(ie*O);ct<(ie+1)*O;ct++){const nt=Math.abs(at-(ct+.5))/V,Pt=(ve+.5)*A,ft=nt*nt;for(let vi=Math.floor(ve*A);vi<(ve+1)*A;vi++){const Li=Math.abs(Pt-(vi+.5))/z,Tt=Math.sqrt(ft+Li*Li);if(Tt>=1)continue;let Ft=2*Tt*Tt*Tt-3*Tt*Tt+1;const Hi=4*(r+vi+(s+ct)*W);et+=Ft*p[Hi+3],Me+=Ft,!i&&p[Hi+3]<255&&(Ft=Ft*p[Hi+3]/255),$e+=Ft*p[Hi],Fe+=Ft*p[Hi+1],Ge+=Ft*p[Hi+2],_e+=Ft}}M[pe]=$e/_e,M[pe+1]=Fe/_e,M[pe+2]=Ge/_e,M[pe+3]=et/Me}return t}function Lle(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return Fle}}function Dle(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}function Nle(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=t[r+3];if(s!==255&&s>0){const n=255/s;t[r]=t[r]*n,t[r+1]=t[r+1]*n,t[r+2]=t[r+2]*n}}}const zle={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},cO=98,Fle="png",Ble={png:100,jpg:cO,jpeg:cO},qB={flipY:!0,premultipliedAlpha:!0};async function Ule(e,t){const i=await HB(e,t),{format:r,quality:s}=Rle(t==null?void 0:t.format,t==null?void 0:t.quality);return Ple(i,{format:r,quality:s,rotation:0,disableDecorations:!1},qB)}async function jle(e,t){const i=await HB(e,t);return Cle(i,qB)}function HB(e,t){const i=qle(t||{},Gle(e.stage,e.size),e.size,e.padding),r=Vle(t,e.allLayerViews);return e.stage.takeScreenshot(i,r,e.backgroundColor,t==null?void 0:t.rotation)}function Vle(e={},t){if(!e.layers)return;const i=[];return e.layers.forEach(r=>{const s=t.find(n=>n.layer.id===r.id);s!=null&&s.container&&i.push(s.container)}),i}function Gle(e,t){return Math.min(4,Ole(t,Math.min(4096,e.context.parameters.maxTextureSize)))}function qle(e,t,i,r){e.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let s=null;e.width!=null&&e.height!=null?s=[e.width,e.height]:e.width==null&&e.height!=null?s=[e.height,e.height]:e.width!=null&&e.height==null?s=[e.width,e.width]:e.width==null&&e.height==null&&(s=null);const n=i[0]-(r.left+r.right),c=i[1]-(r.top+r.bottom);let o,p,g=e.area||{x:0,y:0,width:n,height:c};if(s){const S=n/c,M=s[0]/s[1];if(M>S){const A=g.width/M;g={x:g.x,y:Math.round(g.y+(g.height-A)/2),width:g.width,height:Math.round(A)}}else{const A=g.height*M;g={x:Math.round(g.x+(g.width-A)/2),y:g.y,width:Math.round(A),height:g.height}}}else s=[g.width,g.height];return s[0]>g.width?(o=Math.min(s[0]/g.width,t),p=s[0]/g.width/o):(o=1,p=s[0]/g.width),{cropArea:{x:Math.round((g.x+r.left)*o),y:Math.round((g.y+r.top)*o),width:Math.round(g.width*o),height:Math.round(g.height*o)},outputScale:p,resolutionScale:o}}const uO=160;let n0=class extends zt{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=uO&&this.clear()},uO))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};v([I()],n0.prototype,"_timer",void 0),v([I()],n0.prototype,"stationary",null),n0=v([me("esri.views.2d.support.StationaryManager")],n0);const Hle=e=>e.includes("Brush");let WB=class{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),Hle(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}};function hO(e,t={}){return e.getContext("webgl2",t)||null}let cT;function wM(){return cT||(cT=Yle()),cT}let Wle=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}};function Zle(e){if(typeof WebGL2RenderingContext>"u")return null;const t=document.createElement("canvas");if(!t)return null;let i=hO(t,{failIfMajorPerformanceCaveat:!0});if(i==null&&(i=hO(t),i!=null&&(e.majorPerformanceCaveat=!0)),i==null)return i;e.available=!0,e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return r&&(e.supportsHighPrecisionFragment=r.precision>0),i}function Yle(){const e=new Wle,t=Zle(e);return t==null||(e.supportsColorBufferFloat=t.getExtension("EXT_color_buffer_float")!==null,e.supportsColorBufferFloatBlend=t.getExtension("EXT_float_blend")!==null,e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||t.getExtension("EXT_color_buffer_half_float")!==null),e}function Jle(e){const t=wM();return t.available?e==="3d"&&t.majorPerformanceCaveat?new Je("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new Je("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Je("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Je("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Kle(e){return e&&"nodeType"in e}function Xle(e){return e&&typeof e.render=="function"}const dO={component:"esri-component"};let $d=class extends zt{constructor(){super(...arguments),this.widget=null}destroy(){var t;this.node=null,(t=this.widget)==null||t.destroy()}get id(){var t,i;return this._get("id")??((t=this.widget)==null?void 0:t.id)??((i=this.node)==null?void 0:i.id)}set id(t){this._set("id",t)}set node(t){const i=this._get("node");t!==i&&(t&&t.classList.add(dO.component),i&&i.classList.remove(dO.component),this._set("node",t))}castNode(t){var i;return(i=this.widget)==null||i.destroy(),t?typeof t=="string"||Kle(t)?(this._set("widget",null),h3(t)):(Xle(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};v([I()],$d.prototype,"id",null),v([I()],$d.prototype,"node",null),v([As("node")],$d.prototype,"castNode",null),v([I({readOnly:!0})],$d.prototype,"widget",void 0),$d=v([me("esri.views.ui.Component")],$d);const Ib=$d,ZB="calcite-mode-";function Qle(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function ece(){return Qle().startsWith("dark")}function tce(){return`${ZB}${ece()?"dark":"light"}`}function ice(e){rce(e),e.classList.add(tce())}function rce(e){Array.from(e.classList).forEach(t=>{t.startsWith(ZB)&&e.classList.remove(t)})}const sce={left:0,top:0,bottom:0,right:0},YB={bottom:30,top:15,right:15,left:15},pc="esri-ui",Gn={ui:pc,corner:`${pc}-corner`,innerContainer:`${pc}-inner-container`,manualContainer:`${pc}-manual-container`,cornerContainer:`${pc}-corner-container`,topLeft:`${pc}-top-left`,topRight:`${pc}-top-right`,bottomLeft:`${pc}-bottom-left`,bottomRight:`${pc}-bottom-right`};function nce(e){return e&&!e._started&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}function Iv(e){return e===0?"0":`${e}px`}function uT(e){const t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?e:null}function hT(e,{top:t,bottom:i,left:r,right:s}){e.style.top=t,e.style.bottom=i,e.style.left=r,e.style.right=s}let Sl=class extends xh.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=bo(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&hT(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&hT(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ti(()=>{var t;return[(t=this.view)==null?void 0:t.padding,this.container]},this._applyViewPadding,mn),ti(()=>this.padding,this._applyUIPadding,mn),ti(()=>[this.container,this._locale],([t,i])=>{t&&t.setAttribute("lang",i)},mn),AA(t=>{this._locale=t})])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(Gn.ui),ice(t),this._attachContainers(t)),i&&(i.classList.remove(Gn.ui),hT(i,{top:"",bottom:"",left:"",right:""}),sF(i)),this._set("container",t))}get height(){var n;const t=((n=this.view)==null?void 0:n.height)??0;if(t===0)return t;const i=this._getViewPadding(),{top:r,bottom:s}=i;return Math.max(t-r-s,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...YB,...t}}get width(){var n;const t=((n=this.view)==null?void 0:n.width)??0;if(t===0)return t;const i=this._getViewPadding(),{left:r,right:s}=i;return Math.max(t-r-s,0)}add(t,i){let r,s,n;if(Array.isArray(t))return void t.forEach(o=>this.add(o,i));const c=uT(t);c&&({index:r,position:i,component:t,key:s}=c),i&&typeof i=="object"&&({index:r,key:s,position:i,internal:n}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,r,s,n)}remove(t,i){var s;if(!t)return;if(Array.isArray(t))return t.map(n=>this.remove(n,i));const r=this._find(t);if(r){if(this._componentMap.has(r)&&((s=this._componentMap.get(r))==null?void 0:s.key)!==i)return;const n=this._components.indexOf(r),c=r.node.parentNode;return c==null||c.removeChild(r.node),this._componentMap.delete(r),this._components.splice(n,1)[0]}}empty(t,i={removeInternal:!1}){if(Array.isArray(t)){for(const n of t)this.empty(n,i);return}const r=this._positionNameToContainerLookup[t??"manual"],s=Array.prototype.slice.call(r.children).map(n=>this._findByNode(n)).filter(n=>{var c;return n==null?!1:!(((c=this._componentMap.get(n))==null?void 0:c.internal)??!1)||i.removeInternal});for(const n of s)this.remove(n)}move(t,i){if(Array.isArray(t)&&t.forEach(c=>this.move(c,i)),!t)return;let r;const s=uT(t)||uT(i);if(s&&(r=s.index,i=s.position,t=s.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:r})}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}getComponents(t,i={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap(r=>this._getComponentsAtPosition(r,i)):this._getComponentsAtPosition(t,i):this._components.filter(r=>{var s;return i.includeInternal||!((s=this._componentMap.get(r))!=null&&s.internal)}).map(({widget:r,node:s})=>r??s)}getPosition(t){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(t))return i;return null}_add(t,i,r,s,n){t instanceof Ib||(t=new Ib({node:t})),this._place({component:t,position:i,index:r}),this._components.push(t),this._componentMap.set(t,{key:s,internal:n})}_find(t){return t?t instanceof Ib?this._findByComponent(t):typeof t=="string"?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){var t;return((t=this.view)==null?void 0:t.padding)??sce}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(Gn.innerContainer,Gn.cornerContainer);const i=document.createElement("div");i.classList.add(Gn.innerContainer,Gn.manualContainer);const r=document.createElement("div");r.classList.add(Gn.topLeft,Gn.corner),t.appendChild(r);const s=document.createElement("div");s.classList.add(Gn.topRight,Gn.corner),t.appendChild(s);const n=document.createElement("div");n.classList.add(Gn.bottomLeft,Gn.corner),t.appendChild(n);const c=document.createElement("div");c.classList.add(Gn.bottomRight,Gn.corner),t.appendChild(c),this._innerContainer=t,this._manualContainer=i;const o=Gte();this._cornerNameToContainerLookup={"top-left":r,"top-right":s,"bottom-left":n,"bottom-right":c,"top-leading":o?s:r,"top-trailing":o?r:s,"bottom-leading":o?c:n,"bottom-trailing":o?n:c},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const i=t.position??"manual",{component:r,index:s}=t,n=this._positionNameToContainerLookup[i],c=s!=null&&s>-1;if(nce(r.widget)&&r.widget.startup(),!c)return void n.appendChild(r.node);const o=Array.from(n.children);if(s===0)return void(n.firstChild?Jk(r.node,n.firstChild):n.appendChild(r.node));s>=o.length?n.appendChild(r.node):Jk(r.node,o[s])}_toPixelPosition(t){return{top:Iv(t.top),left:Iv(t.left),right:Iv(t.right),bottom:Iv(t.bottom)}}_findByComponent(t){return this._components.find(i=>i===t)??null}_findById(t){return this._components.find(({id:i})=>i===t)??null}_findByNode(t){return this._components.find(({node:i})=>i===t)??null}_getComponentsAtPosition(t,i){const r=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(O0).filter(s=>{var n;return i.includeInternal||!((n=this._componentMap.get(s))!=null&&n.internal)}).map(({widget:s,node:n})=>s??n)}};v([I()],Sl.prototype,"_locale",void 0),v([I()],Sl.prototype,"container",null),v([I()],Sl.prototype,"height",null),v([I({value:YB})],Sl.prototype,"padding",null),v([As("padding")],Sl.prototype,"castPadding",null),v([I()],Sl.prototype,"view",void 0),v([I()],Sl.prototype,"width",null),Sl=v([me("esri.views.ui.UI")],Sl);const oce=Sl,ace="randomUUID"in crypto;function Y3(){if(ace)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=i=>e[i].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function mve(){return`{${Y3().toUpperCase()}}`}function yve(){return`{${Y3()}}`}const lce={handleInterceptedEvent:(e,t,i,r)=>(e.scheduleRender(),t.properties[`on${r.type}`].apply(t.properties.bind||i,[r]))},cce={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{t.charAt(0)==="-"?e.style.setProperty(t,i):e.style[t]=i}},uce=e=>({...cce,...e}),hce=(e,t)=>{const i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i},dce=(e,t)=>e.find(t),pO=(e,t,i=!1)=>{let r=e;return t.forEach((s,n)=>{const c=r!=null&&r.children?dce(r.children,o=>o.domNode===s):void 0;i&&!c&&n!==t.length-1||(r=c)}),r},pce=e=>{let t;const i={...lce,...e},r=uce(i),s=r.performanceLogger;let n,c=!0,o=!1;const p=[],g=[],S=(A,O,z)=>{var ie;let V;r.eventHandlerInterceptor=(ve,pe,_e,Me)=>function($e){let Fe;s("domEvent",$e);const Ge=hce($e.currentTarget,V.domNode),et=Ge.some(ct=>{var nt;return customElements.get((nt=ct==null?void 0:ct.tagName)==null?void 0:nt.toLowerCase())});if($e.eventPhase===Event.CAPTURING_PHASE||!et)Ge.reverse(),Fe=pO(V.getLastRender(),Ge);else{const ct=$e.composedPath(),nt=ct.slice(ct.indexOf($e.currentTarget),ct.indexOf(V.domNode)).reverse();Fe=pO(V.getLastRender(),nt,!0)}let at;return Fe&&(at=i.handleInterceptedEvent(t,Fe,this,$e)),s("domEventProcessed",$e),at},(ie=i.postProcessProjectionOptions)==null||ie.call(i,r);const W=z();V=A(O,W,r),r.eventHandlerInterceptor=void 0,p.push(V),g.push(z),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(V,W)};let M=()=>{if(n=void 0,c){c=!1,s("renderStart",void 0);for(let A=0;A<p.length;A++){const O=g[A]();s("rendered",void 0),p[A].update(O),s("patched",void 0)}s("renderDone",void 0),c=!0}};return i.modifyDoRenderImplementation&&(M=i.modifyDoRenderImplementation(M,p,g)),t={renderNow:M,scheduleRender:()=>{n||o||(n=requestAnimationFrame(M))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),o=!0},resume:()=>{o=!1,c=!0,t.scheduleRender()},append:(A,O)=>{S(ah.append,A,O)},insertBefore:(A,O)=>{S(ah.insertBefore,A,O)},merge:(A,O)=>{S(ah.merge,A,O)},replace:(A,O)=>{S(ah.replace,A,O)},detach:A=>{for(let O=0;O<g.length;O++)if(g[O]===A)return g.splice(O,1),p.splice(O,1)[0];throw new Error("renderFunction was not found")}},t};/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.7.1
 */const JB="calcite-mode-auto",KB="calcite-mode-dark",fce="calcite-mode-light",gve={autoMode:JB,darkMode:KB,lightMode:fce,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"},Fd={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1};let Hf,XB,Kx,QB=!1,Uw=!1,J3=!1,_o=!1,fO=null,xM=!1;const mce=e=>{const t=new URL(e,Ps.$resourcesUrl$);return t.origin!==P_.location.origin?t.href:t.pathname},yce=e=>Ps.$resourcesUrl$=e,Sp=(e,t="")=>()=>{},gce="slot-fb{display:contents}slot-fb[hidden]{display:none}",mO="http://www.w3.org/1999/xlink",yO={},_ce="http://www.w3.org/2000/svg",vce="http://www.w3.org/1999/xhtml",bce=e=>e!=null,K3=e=>(e=typeof e,e==="object"||e==="function");function wce(e){var t,i,r;return(r=(i=(t=e.head)===null||t===void 0?void 0:t.querySelector('meta[name="csp-nonce"]'))===null||i===void 0?void 0:i.getAttribute("content"))!==null&&r!==void 0?r:void 0}const eU=(e,t,...i)=>{let r=null,s=null,n=null,c=!1,o=!1;const p=[],g=M=>{for(let A=0;A<M.length;A++)r=M[A],Array.isArray(r)?g(r):r!=null&&typeof r!="boolean"&&((c=typeof e!="function"&&!K3(r))&&(r=String(r)),c&&o?p[p.length-1].$text$+=r:p.push(c?jw(null,r):r),o=c)};if(g(i),t){t.key&&(s=t.key),t.name&&(n=t.name);{const M=t.className||t.class;M&&(t.class=typeof M!="object"?M:Object.keys(M).filter(A=>M[A]).join(" "))}}if(typeof e=="function")return e(t===null?{}:t,p,Tce);const S=jw(e,null);return S.$attrs$=t,p.length>0&&(S.$children$=p),S.$key$=s,S.$name$=n,S},jw=(e,t)=>{const i={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},xce={},Sce=e=>e&&e.$tag$===xce,Tce={forEach:(e,t)=>e.map(gO).forEach(t),map:(e,t)=>e.map(gO).map(t).map(Ece)},gO=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),Ece=e=>{if(typeof e.vtag=="function"){const i=Object.assign({},e.vattrs);return e.vkey&&(i.key=e.vkey),e.vname&&(i.name=e.vname),eU(e.vtag,i,...e.vchildren||[])}const t=jw(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},Ice=e=>eue.map(t=>t(e)).find(t=>!!t),Mce=(e,t)=>e!=null&&!K3(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,Ace=e=>e,_ve=(e,t,i)=>{const r=Ace(e);return{emit:s=>Pce(r,t,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:s})}},Pce=(e,t,i)=>{const r=Ps.ce(t,i);return e.dispatchEvent(r),r},_O=new WeakMap,Cce=(e,t,i)=>{let r=Gw.get(e);rue&&i?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,Gw.set(e,r)},$ce=(e,t,i)=>{var r;const s=tU(t,i),n=Gw.get(s);if(e=e.nodeType===11?e:Ha,n)if(typeof n=="string"){e=e.head||e;let c=_O.get(e),o;if(c||_O.set(e,c=new Set),!c.has(s)){{o=Ha.createElement("style"),o.innerHTML=n;const p=(r=Ps.$nonce$)!==null&&r!==void 0?r:wce(Ha);p!=null&&o.setAttribute("nonce",p),e.insertBefore(o,e.querySelector("link"))}t.$flags$&4&&(o.innerHTML+=gce),c&&c.add(s)}}else e.adoptedStyleSheets.includes(n)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,n]);return s},kce=e=>{const t=e.$cmpMeta$,i=e.$hostElement$,r=t.$flags$,s=Sp("attachStyles",t.$tagName$),n=$ce(i.shadowRoot?i.shadowRoot:i.getRootNode(),t,e.$modeName$);r&10&&(i["s-sc"]=n,i.classList.add(n+"-h"),r&2&&i.classList.add(n+"-s")),s()},tU=(e,t)=>"sc-"+(t&&e.$flags$&32?e.$tagName$+"-"+t:e.$tagName$),vO=(e,t,i,r,s,n)=>{if(i!==r){let c=TO(e,t),o=t.toLowerCase();if(t==="class"){const p=e.classList,g=bO(i),S=bO(r);p.remove(...g.filter(M=>M&&!S.includes(M))),p.add(...S.filter(M=>M&&!g.includes(M)))}else if(t==="style"){for(const p in i)(!r||r[p]==null)&&(p.includes("-")?e.style.removeProperty(p):e.style[p]="");for(const p in r)(!i||r[p]!==i[p])&&(p.includes("-")?e.style.setProperty(p,r[p]):e.style[p]=r[p])}else if(t!=="key")if(t==="ref")r&&r(e);else if(!e.__lookupSetter__(t)&&t[0]==="o"&&t[1]==="n"){if(t[2]==="-"?t=t.slice(3):TO(P_,o)?t=o.slice(2):t=o[2]+t.slice(3),i||r){const p=t.endsWith(iU);t=t.replace(Oce,""),i&&Ps.rel(e,t,i,p),r&&Ps.ael(e,t,r,p)}}else{const p=K3(r);if((c||p&&r!==null)&&!s)try{if(e.tagName.includes("-"))e[t]=r;else{const S=r??"";t==="list"?c=!1:(i==null||e[t]!=S)&&(e[t]=S)}}catch{}let g=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(t=o,g=!0),r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&(g?e.removeAttributeNS(mO,t):e.removeAttribute(t)):(!c||n&4||s)&&!p&&(r=r===!0?"":r,g?e.setAttributeNS(mO,t,r):e.setAttribute(t,r))}}},Rce=/\s/,bO=e=>e?e.split(Rce):[],iU="Capture",Oce=new RegExp(iU+"$"),rU=(e,t,i,r)=>{const s=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,n=e&&e.$attrs$||yO,c=t.$attrs$||yO;for(r in n)r in c||vO(s,r,n[r],void 0,i,t.$flags$);for(r in c)vO(s,r,n[r],c[r],i,t.$flags$)},Vw=(e,t,i,r)=>{var s;const n=t.$children$[i];let c=0,o,p,g;if(QB||(J3=!0,n.$tag$==="slot"&&(Hf&&r.classList.add(Hf+"-s"),n.$flags$|=n.$children$?2:1)),n.$text$!==null)o=n.$elm$=Ha.createTextNode(n.$text$);else if(n.$flags$&1)o=n.$elm$=Ha.createTextNode("");else{if(_o||(_o=n.$tag$==="svg"),o=n.$elm$=Ha.createElementNS(_o?_ce:vce,n.$flags$&2?"slot-fb":n.$tag$),_o&&n.$tag$==="foreignObject"&&(_o=!1),rU(null,n,_o),bce(Hf)&&o["s-si"]!==Hf&&o.classList.add(o["s-si"]=Hf),n.$children$)for(c=0;c<n.$children$.length;++c)p=Vw(e,n,c,o),p&&o.appendChild(p);n.$tag$==="svg"?_o=!1:o.tagName==="foreignObject"&&(_o=!0)}return o["s-hn"]=Kx,n.$flags$&3&&(o["s-sr"]=!0,o["s-fs"]=(s=n.$attrs$)===null||s===void 0?void 0:s.slot,o["s-cr"]=XB,o["s-sn"]=n.$name$||"",g=e&&e.$children$&&e.$children$[i],g&&g.$tag$===n.$tag$&&e.$elm$&&s_(e.$elm$,!1)),o},s_=(e,t)=>{var i;Ps.$flags$|=1;const r=e.childNodes;for(let s=r.length-1;s>=0;s--){const n=r[s];n["s-hn"]!==Kx&&n["s-ol"]&&(oU(n).insertBefore(n,X3(n)),n["s-ol"].remove(),n["s-ol"]=void 0,n["s-sh"]=void 0,n.nodeType===1&&n.setAttribute("slot",(i=n["s-sn"])!==null&&i!==void 0?i:""),J3=!0),t&&s_(n,t)}Ps.$flags$&=-2},sU=(e,t,i,r,s,n)=>{let c=e["s-cr"]&&e["s-cr"].parentNode||e,o;for(c.shadowRoot&&c.tagName===Kx&&(c=c.shadowRoot);s<=n;++s)r[s]&&(o=Vw(null,i,s,e),o&&(r[s].$elm$=o,c.insertBefore(o,X3(t))))},nU=(e,t,i)=>{for(let r=t;r<=i;++r){const s=e[r];if(s){const n=s.$elm$;cU(s),n&&(Uw=!0,n["s-ol"]?n["s-ol"].remove():s_(n,!0),n.remove())}}},Lce=(e,t,i,r,s=!1)=>{let n=0,c=0,o=0,p=0,g=t.length-1,S=t[0],M=t[g],A=r.length-1,O=r[0],z=r[A],V,W;for(;n<=g&&c<=A;)if(S==null)S=t[++n];else if(M==null)M=t[--g];else if(O==null)O=r[++c];else if(z==null)z=r[--A];else if(Mv(S,O,s))Wf(S,O,s),S=t[++n],O=r[++c];else if(Mv(M,z,s))Wf(M,z,s),M=t[--g],z=r[--A];else if(Mv(S,z,s))(S.$tag$==="slot"||z.$tag$==="slot")&&s_(S.$elm$.parentNode,!1),Wf(S,z,s),e.insertBefore(S.$elm$,M.$elm$.nextSibling),S=t[++n],z=r[--A];else if(Mv(M,O,s))(S.$tag$==="slot"||z.$tag$==="slot")&&s_(M.$elm$.parentNode,!1),Wf(M,O,s),e.insertBefore(M.$elm$,S.$elm$),M=t[--g],O=r[++c];else{for(o=-1,p=n;p<=g;++p)if(t[p]&&t[p].$key$!==null&&t[p].$key$===O.$key$){o=p;break}o>=0?(W=t[o],W.$tag$!==O.$tag$?V=Vw(t&&t[c],i,o,e):(Wf(W,O,s),t[o]=void 0,V=W.$elm$),O=r[++c]):(V=Vw(t&&t[c],i,c,e),O=r[++c]),V&&oU(S.$elm$).insertBefore(V,X3(S.$elm$))}n>g?sU(e,r[A+1]==null?null:r[A+1].$elm$,i,r,c,A):c>A&&nU(t,n,g)},Mv=(e,t,i=!1)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:i?!0:e.$key$===t.$key$:!1,X3=e=>e&&e["s-ol"]||e,oU=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,Wf=(e,t,i=!1)=>{const r=t.$elm$=e.$elm$,s=e.$children$,n=t.$children$,c=t.$tag$,o=t.$text$;let p;o===null?(_o=c==="svg"?!0:c==="foreignObject"?!1:_o,c==="slot"||rU(e,t,_o),s!==null&&n!==null?Lce(r,s,t,n,i):n!==null?(e.$text$!==null&&(r.textContent=""),sU(r,null,t,n,0,n.length-1)):s!==null&&nU(s,0,s.length-1),_o&&c==="svg"&&(_o=!1)):(p=r["s-cr"])?p.parentNode.textContent=o:e.$text$!==o&&(r.data=o)},aU=e=>{const t=e.childNodes;for(const i of t)if(i.nodeType===1){if(i["s-sr"]){const r=i["s-sn"];i.hidden=!1;for(const s of t)if(s!==i){if(s["s-hn"]!==i["s-hn"]||r!==""){if(s.nodeType===1&&(r===s.getAttribute("slot")||r===s["s-sn"])){i.hidden=!0;break}}else if(s.nodeType===1||s.nodeType===3&&s.textContent.trim()!==""){i.hidden=!0;break}}}aU(i)}},Rc=[],lU=e=>{let t,i,r;for(const s of e.childNodes){if(s["s-sr"]&&(t=s["s-cr"])&&t.parentNode){i=t.parentNode.childNodes;const n=s["s-sn"];for(r=i.length-1;r>=0;r--)if(t=i[r],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==s["s-hn"]&&!Fd.experimentalSlotFixes)if(wO(t,n)){let c=Rc.find(o=>o.$nodeToRelocate$===t);Uw=!0,t["s-sn"]=t["s-sn"]||n,c?(c.$nodeToRelocate$["s-sh"]=s["s-hn"],c.$slotRefNode$=s):(t["s-sh"]=s["s-hn"],Rc.push({$slotRefNode$:s,$nodeToRelocate$:t})),t["s-sr"]&&Rc.map(o=>{wO(o.$nodeToRelocate$,t["s-sn"])&&(c=Rc.find(p=>p.$nodeToRelocate$===t),c&&!o.$slotRefNode$&&(o.$slotRefNode$=c.$slotRefNode$))})}else Rc.some(c=>c.$nodeToRelocate$===t)||Rc.push({$nodeToRelocate$:t})}s.nodeType===1&&lU(s)}},wO=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",cU=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(cU)},Dce=(e,t,i=!1)=>{var r,s,n,c;const o=e.$hostElement$,p=e.$cmpMeta$,g=e.$vnode$||jw(null,null),S=Sce(t)?t:eU(null,null,t);if(Kx=o.tagName,p.$attrsToReflect$&&(S.$attrs$=S.$attrs$||{},p.$attrsToReflect$.map(([M,A])=>S.$attrs$[A]=o[M])),i&&S.$attrs$)for(const M of Object.keys(S.$attrs$))o.hasAttribute(M)&&!["key","ref","style","class"].includes(M)&&(S.$attrs$[M]=o[M]);S.$tag$=null,S.$flags$|=4,e.$vnode$=S,S.$elm$=g.$elm$=o.shadowRoot||o,Hf=o["s-sc"],XB=o["s-cr"],QB=(p.$flags$&1)!==0,Uw=!1,Wf(g,S,i);{if(Ps.$flags$|=1,J3){lU(S.$elm$);for(const M of Rc){const A=M.$nodeToRelocate$;if(!A["s-ol"]){const O=Ha.createTextNode("");O["s-nr"]=A,A.parentNode.insertBefore(A["s-ol"]=O,A)}}for(const M of Rc){const A=M.$nodeToRelocate$,O=M.$slotRefNode$;if(O){const z=O.parentNode;let V=O.nextSibling;{let W=(r=A["s-ol"])===null||r===void 0?void 0:r.previousSibling;for(;W;){let ie=(s=W["s-nr"])!==null&&s!==void 0?s:null;if(ie&&ie["s-sn"]===A["s-sn"]&&z===ie.parentNode&&(ie=ie.nextSibling,!ie||!ie["s-nr"])){V=ie;break}W=W.previousSibling}}(!V&&z!==A.parentNode||A.nextSibling!==V)&&A!==V&&(!A["s-hn"]&&A["s-ol"]&&(A["s-hn"]=A["s-ol"].parentNode.nodeName),z.insertBefore(A,V),A.nodeType===1&&(A.hidden=(n=A["s-ih"])!==null&&n!==void 0?n:!1))}else A.nodeType===1&&(i&&(A["s-ih"]=(c=A.hidden)!==null&&c!==void 0?c:!1),A.hidden=!0)}}Uw&&aU(S.$elm$),Ps.$flags$&=-2,Rc.length=0}},Nce=(e,t)=>{},Q3=(e,t)=>(e.$flags$|=16,Nce(e,e.$ancestorComponent$),nue(()=>zce(e,t))),zce=(e,t)=>{const i=e.$hostElement$,r=Sp("scheduleUpdate",e.$cmpMeta$.$tagName$),s=i;let n;return t?n=ym(s,"componentWillLoad"):n=ym(s,"componentWillUpdate"),n=xO(n,()=>ym(s,"componentWillRender")),r(),xO(n,()=>Bce(e,s,t))},xO=(e,t)=>Fce(e)?e.then(t):t(),Fce=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",Bce=async(e,t,i)=>{const r=e.$hostElement$,s=Sp("update",e.$cmpMeta$.$tagName$);r["s-rc"],i&&kce(e);const n=Sp("render",e.$cmpMeta$.$tagName$);Uce(e,t,r,i),n(),s(),jce(e)},Uce=(e,t,i,r)=>{try{fO=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(Fd.hasRenderFn||Fd.reflect)&&(Fd.vdomRender||Fd.reflect)&&(Fd.hydrateServerSide||Dce(e,t,r))}catch(p){A_(p,e.$hostElement$)}return fO=null,null},jce=e=>{const t=e.$cmpMeta$.$tagName$,i=e.$hostElement$,r=Sp("postUpdate",t),s=i;e.$ancestorComponent$,ym(s,"componentDidRender"),e.$flags$&64?(ym(s,"componentDidUpdate"),r()):(e.$flags$|=64,ym(s,"componentDidLoad"),r())},vve=e=>{{const t=Ym(e),i=t.$hostElement$.isConnected;return i&&(t.$flags$&18)===2&&Q3(t,!1),i}},ym=(e,t,i)=>{if(e&&e[t])try{return e[t](i)}catch(r){A_(r)}},Vce=(e,t)=>Ym(e).$instanceValues$.get(t),Gce=(e,t,i,r)=>{const s=Ym(e),n=e,c=s.$instanceValues$.get(t),o=s.$flags$,p=n;i=Mce(i,r.$members$[t][0]);const g=Number.isNaN(c)&&Number.isNaN(i);if(i!==c&&!g){s.$instanceValues$.set(t,i);{if(r.$watchers$&&o&128){const M=r.$watchers$[t];M&&M.map(A=>{try{p[A](i,c,t)}catch(O){A_(O,n)}})}if((o&18)===2){if(p.componentShouldUpdate&&p.componentShouldUpdate(i,c,t)===!1)return;Q3(s,!1)}}}},qce=(e,t,i)=>{var r;const s=e.prototype;if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const n=Object.entries(t.$members$);n.map(([c,[o]])=>{(o&31||o&32)&&Object.defineProperty(s,c,{get(){return Vce(this,c)},set(p){Gce(this,c,p,t)},configurable:!0,enumerable:!0})});{const c=new Map;s.attributeChangedCallback=function(o,p,g){Ps.jmp(()=>{var S;const M=c.get(o);if(this.hasOwnProperty(M))g=this[M],delete this[M];else{if(s.hasOwnProperty(M)&&typeof this[M]=="number"&&this[M]==g)return;if(M==null){const A=Ym(this),O=A==null?void 0:A.$flags$;if(O&&!(O&8)&&O&128&&g!==p){const V=this,W=(S=t.$watchers$)===null||S===void 0?void 0:S[o];W==null||W.forEach(ie=>{V[ie]!=null&&V[ie].call(V,g,p,o)})}return}}this[M]=g===null&&typeof this[M]=="boolean"?!1:g})},e.observedAttributes=Array.from(new Set([...Object.keys((r=t.$watchers$)!==null&&r!==void 0?r:{}),...n.filter(([o,p])=>p[0]&15).map(([o,p])=>{var g;const S=p[1]||o;return c.set(S,o),p[0]&512&&((g=t.$attrsToReflect$)===null||g===void 0||g.push([o,S])),S})]))}}return e},Hce=async(e,t,i,r)=>{let s;if(!(t.$flags$&32)&&(t.$flags$|=32,s=e.constructor,customElements.whenDefined(i.$tagName$).then(()=>t.$flags$|=128),s.style)){let c=s.style;typeof c!="string"&&(c=c[t.$modeName$=Ice(e)]);const o=tU(i,t.$modeName$);if(!Gw.has(o)){const p=Sp("registerStyles",i.$tagName$);Cce(o,c,!!(i.$flags$&1)),p()}}t.$ancestorComponent$,Q3(t,!0)},SO=e=>{},Wce=e=>{if(!(Ps.$flags$&1)){const t=Ym(e),i=t.$cmpMeta$,r=Sp("connectedCallback",i.$tagName$);t.$flags$&1?(uU(e,t,i.$listeners$),t!=null&&t.$lazyInstance$?SO(t.$lazyInstance$):t!=null&&t.$onReadyPromise$&&t.$onReadyPromise$.then(()=>SO(t.$lazyInstance$))):(t.$flags$|=1,i.$flags$&12&&Zce(e),i.$members$&&Object.entries(i.$members$).map(([s,[n]])=>{if(n&31&&e.hasOwnProperty(s)){const c=e[s];delete e[s],e[s]=c}}),Hce(e,t,i)),r()}},Zce=e=>{const t=e["s-cr"]=Ha.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},Yce=async e=>{if(!(Ps.$flags$&1)){const t=Ym(e);t.$rmListeners$&&(t.$rmListeners$.map(i=>i()),t.$rmListeners$=void 0)}},bve=(e,t)=>{const i={$flags$:t[0],$tagName$:t[1]};i.$members$=t[2],i.$listeners$=t[3],i.$watchers$=e.$watchers$,i.$attrsToReflect$=[];const r=e.prototype.connectedCallback,s=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){Qce(this,i)},connectedCallback(){Wce(this),r&&r.call(this)},disconnectedCallback(){Yce(this),s&&s.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)})}}),e.is=i.$tagName$,qce(e,i)},wve=(e,t)=>t,uU=(e,t,i,r)=>{i&&i.map(([s,n,c])=>{const o=Kce(e,s),p=Jce(t,c),g=Xce(s);Ps.ael(o,n,p,g),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>Ps.rel(o,n,p,g))})},Jce=(e,t)=>i=>{try{Fd.lazyLoad||e.$hostElement$[t](i)}catch(r){A_(r)}},Kce=(e,t)=>t&4?Ha:t&8?P_:t&16?Ha.body:e,Xce=e=>tue?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0,hU=new WeakMap,Ym=e=>hU.get(e),Qce=(e,t)=>{const i={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return uU(e,i,t.$listeners$),hU.set(e,i)},TO=(e,t)=>t in e,A_=(e,t)=>(0,console.error)(e,t),Gw=new Map,eue=[],P_=typeof window<"u"?window:{},Ha=P_.document||{head:{}},xve=P_.HTMLElement||class{},Ps={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,i,r)=>e.addEventListener(t,i,r),rel:(e,t,i,r)=>e.removeEventListener(t,i,r),ce:(e,t)=>new CustomEvent(e,t)},tue=(()=>{let e=!1;try{Ha.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),iue=e=>Promise.resolve(e),rue=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),SM=[],dU=[],pU=(e,t)=>i=>{e.push(i),xM||(xM=!0,t&&Ps.$flags$&4?sue(TM):Ps.raf(TM))},EO=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(i){A_(i)}e.length=0},TM=()=>{EO(SM),EO(dU),(xM=SM.length>0)&&Ps.raf(TM)},sue=e=>iue().then(e),Sve=pU(SM,!1),nue=pU(dU,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.7.1
 */function IO(){const{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>e.contains(KB)||e.contains(JB)&&t?"dark":"light",r=c=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:c}})),s=c=>{n!==c&&r(c),n=c};let n=i();r(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",c=>s(c.matches?"dark":"light")),new MutationObserver(()=>s(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function oue(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?IO():document.addEventListener("DOMContentLoaded",()=>IO(),{once:!0}))}const aue=oue;aue();let fU;function lue(){try{mce(".")}catch{yce(Ko($i(fU)))}}function eP(e){var i;const t=[];for(const r of Object.keys(e))customElements.get(`calcite-${r}`)||t.push((i=e[r])==null?void 0:i.call(e));return t.length>0?Promise.all(t):null}fU="components/assets";const mU=Symbol("widget"),yU=Symbol("widget-test-data"),cue=[],uue={},qw=new WeakMap;function gU(e,t){let i=t.children;if(i!=null&&i.length)for(let s=0;s<i.length;++s)i[s]=gU(e,i[s]);else i=cue;const r=t.vnodeSelector;if(Hw(r)){const s=t.properties||uue,n=s.key||r;return{vnodeSelector:"div",properties:{key:n,afterCreate:hue,afterUpdate:due,afterRemoved:_U,parentWidget:e,widgetConstructor:r,widgetProperties:{...s,key:n,children:i}},children:void 0,text:void 0,domNode:null}}return t}function hue(e,t,i,{parentWidget:r,widgetConstructor:s,widgetProperties:n}){var o;const c=new s(n);c.container=e,qw.set(e,c),(o=c.afterCreate)==null||o.call(c,c,e),r.addHandles(Qi(()=>_U(e))),queueMicrotask(()=>{c[yU].projector.renderNow()})}function due(e,t,i,{widgetProperties:r}){var n;const s=qw.get(e);s&&(s.set(r),(n=s.afterUpdate)==null||n.call(s,s,e))}function _U(e){var i;const t=qw.get(e);t&&((i=t.afterRemoved)==null||i.call(t,t,e),t.destroy(),qw.delete(e))}function Hw(e){return typeof e=="function"&&e[mU]}const C_={arrowDown:"esri-icon-arrow-down",arrowUp:"esri-icon-arrow-up",basemap:"esri-icon-basemap",bookmark:"esri-icon-bookmark",calendar:"esri-icon-calendar",checkMark:"esri-icon-check-mark",checkboxUnchecked:"esri-icon-checkbox-unchecked",close:"esri-icon-close",collapse:"esri-icon-collapse",defaultAction:"esri-icon-default-action",description:"esri-icon-description",directions:"esri-icon-directions",dockBottom:"esri-icon-dock-bottom",dockLeft:"esri-icon-dock-left",dockRight:"esri-icon-dock-right",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",download:"esri-icon-download",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",edit:"esri-icon-edit",elevationProfile:"esri-icon-elevation-profile",environmentSettings:"esri-icon-environment-settings",erase:"esri-icon-erase",error:"esri-icon-error",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",gear:"esri-icon-gear",handleHorizontal:"esri-icon-handle-horizontal",handleVertical:"esri-icon-handle-vertical",home:"esri-icon-home",icon:"esri-icon",launchLinkExternal:"esri-icon-launch-link-external",layerList:"esri-icon-layer-list",layers:"esri-icon-layers",left:"esri-icon-left",leftArrows:"esri-icon-left-arrow",leftTriangleArrow:"esri-icon-left-triangle-arrow",lineOfSight:"esri-icon-line-of-sight",link:"esri-icon-link",linkExternal:"esri-icon-link-external",linkHorizontal:"esri-icon-link-horizontal",loadingIndicator:"esri-icon-loading-indicator",locate:"esri-icon-locate",locateCircled:"esri-icon-locate-circled",locked:"esri-icon-locked",mapPin:"esri-icon-map-pin",maximize:"esri-icon-maximize",measure:"esri-icon-measure",measureArea:"esri-icon-measure-area",measureBuildingHeightShadow:"esri-icon-measure-building-height-shadow",measureLine:"esri-icon-measure-line",menu:"esri-icon-menu",minimize:"esri-icon-minimize",minus:"esri-icon-minus",nonVisible:"esri-icon-non-visible",northNavigation:"esri-icon-north-navigation",noticeTriangle:"esri-icon-notice-triangle",organization:"esri-icon-organization",pan:"esri-icon-pan",pan2:"esri-icon-pan2",partlyCloudy:"esri-icon-partly-cloudy",pause:"esri-icon-pause",play:"esri-icon-play",playCircled:"esri-icon-play-circled",plus:"esri-icon-plus",polyline:"esri-icon-polyline",printer:"esri-icon-printer",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",rightArrow:"esri-icon-right-arrow",rightTriangleArrow:"esri-icon-right-triangle-arrow",rotate:"esri-icon-rotate",save:"esri-icon-save",search:"esri-icon-search",settings2:"esri-icon-settings2",slice:"esri-icon-slice",swap:"esri-icon-swap",table:"esri-icon-table",timeClock:"esri-icon-time-clock",tracking:"esri-icon-tracking",trash:"esri-icon-trash",unlockedLinkHorizontal:"esri-icon-unlocked-link-horizontal",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",vertexGps:"esri-icon-vertex-gps",visible:"esri-icon-visible",zoomInFixed:"esri-icon-zoom-in-fixed",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomOutFixed:"esri-icon-zoom-out-fixed",zoomToObject:"esri-icon-zoom-to-object"},MO=new Set;function pue(e){MO.add(e),e.finally(()=>MO.delete(e))}var vU;const fue="esri.widgets.Widget";let mue=0;const yue={widgetIcon:C_.checkboxUnchecked};function bU(e,t){for(const i in t)e[i]!=null&&(typeof e[i]=="object"&&typeof t[i]=="object"?bU(e[i],t==null?void 0:t[i]):e[i]=t[i]);return e}const gue=pce({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,i=/capture$/i;e.eventHandlerInterceptor=(r,s,n,c)=>{const o=t==null?void 0:t(r,s,n,c),p=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in n)||p){const g=r[2].toLowerCase()+r.slice(3),S=O=>o==null?void 0:o.call(n,O);n.addEventListener(g,S,p);const M=()=>n.removeEventListener(g,S,p),A=c.afterRemoved;c.afterRemoved=O=>{A==null||A(O),M()}}return o}},handleInterceptedEvent(e,t,i,r){const{eventPhase:s,type:n}=r,c=s===Event.CAPTURING_PHASE;let o=`on${n}${c?"capture":""}`;const p=t.properties;(p&&o in p||(o=`on${n[0].toUpperCase()}${n.slice(1)}${c?"Capture":""}`,p&&o in p))&&(vF(),e.scheduleRender(),p[o].call(p.bind||i,r))}});let dT=!1,ns=class extends _A(xh.EventedAccessor){constructor(t,i){super(t,i),this._attached=!1,this._projector=gue,this._readyForTrueRender=!1,this.iconClass=yue.widgetIcon,this.icon=null,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=gG(async()=>{var o;if((o=this._messageBundleProps)!=null&&o.length){const p=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:g,propertyName:S})=>{if(this.destroyed)return;let M=await OA(g);this.uiStrings&&Object.keys(this.uiStrings)&&(M=bU(He(M),this.uiStrings)),this[S]=M}));if(this.destroyed)return;for(const g of p)g.status==="rejected"&&_t.getLogger(this).error("widget-intl:locale-error",this.declaredClass,g.reason)}await this.loadLocale()}),lue();const r="esri-widget-uid-"+Y3(),s=this.render.bind(this);this._trackingTarget=new ox(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>{var M;if(!this._readyForTrueRender||this.destroyed)return null;const o=s();let p=o.properties;p||(o.properties=p={});const{key:g}=p;if(g||(p.key=r),Hw(o.vnodeSelector)){if(!this.visible)return{vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}}else this.visible?p.styles||(p.styles={}):(p.class="",p.styles={display:"none"}),p.styles.display||(p.styles.display="");let S=0;return(M=o.children)==null||M.forEach(A=>{if(Hw(A.vnodeSelector))return;let{properties:O}=A;O||(A.properties=O={}),O.key||(O.key=`${this.id}--${S++}`)}),gU(this,o)};this.render=()=>{if(dT)return n();let o=Bte(this)??null;if(o)return o;this._trackingTarget.clear(),dT=!0;try{o=Bc(this._trackingTarget,n)}catch(p){throw console.error(p),p}finally{dT=!1}return o&&Ute(this,o),o};const c=this.beforeFirstRender();c?this._resourcesFetch=c.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),pue(this._resourcesFetch)}normalizeCtorArgs(t,i){const r={...t};return i&&(r.container=i),r}postInitialize(){}beforeFirstRender(){var i;const t=this.loadDependencies();return(i=this._messageBundleProps)!=null&&i.length||t?Promise.all([t,this._loadLocale()]).then(()=>{}).catch(a$):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(nr(this._trackingTarget),nr(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,FS(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return h3(t)}get domNode(){return this.container}set domNode(t){this.container=t}get id(){var t;return this._get("id")||((t=this.container)==null?void 0:t.id)||Date.now().toString(16)+"-widget-"+mue++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get[(vU=mU,yU)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(FS(this),this._projector.scheduleRender())}own(t){D5(_t.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(t)}classes(...t){return Vte.apply(this,t)}renderNow(){FS(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this.addHandles(ti(()=>this.viewModel,(r,s)=>{s&&this.removeHandles("delegated-events"),r&&sx(r)&&this.addHandles(this._delegatedEventNames.map(n=>h_(r,n,c=>{this.emit(n,c)})),"delegated-events")},Fa)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(a$),this.scheduleRender()};this.addHandles([AA(t),ti(()=>this.uiStrings,t),yh(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0})])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=t==null?void 0:t.parentNode)==null||i.removeChild(t)}};ns[vU]=!0,v([I()],ns.prototype,"_readyForTrueRender",void 0),v([I({value:null})],ns.prototype,"container",null),v([As("container")],ns.prototype,"castContainer",null),v([I()],ns.prototype,"iconClass",void 0),v([I()],ns.prototype,"icon",void 0),v([I()],ns.prototype,"id",null),v([I()],ns.prototype,"label",null),v([I()],ns.prototype,"renderable",null),v([I()],ns.prototype,"uiStrings",void 0),v([I()],ns.prototype,"viewModel",void 0),v([I({value:!0})],ns.prototype,"visible",null),v([I()],ns.prototype,"key",void 0),v([I()],ns.prototype,"children",void 0),v([I()],ns.prototype,"afterCreate",void 0),v([I()],ns.prototype,"afterUpdate",void 0),v([I()],ns.prototype,"afterRemoved",void 0),ns=v([me(fue)],ns);const Xx=ns,_ue=new Map;function vue(e){return _ue.get(e)}function AO(e,t){return e&&"copyright"in e&&(!t||typeof e.originOf=="function"&&e.originOf("copyright")==="user")}function bue(e,t){return e.length!==t.length||e.some((i,r)=>i.text!==t[r].text)}function wg(e,t,i){!i||!t||e.find(r=>r.layerView===t&&r.text===i)||e.push({text:i,layerView:t})}function wue(e){return e.type==="bing-maps"}const fc=[];let Zf=class extends zt{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ut,this.view=null,this._allLayerViewsChange=i=>{var s;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const r=(s=this.view)==null?void 0:s.allLayerViews;r&&(this.addHandles(r.map(n=>ti(()=>{var c;return[n.suspended,(c=n.layer)==null?void 0:c.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),r.forEach(n=>{n.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(n.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),i!=null&&i.removed&&i.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.addHandles([bp(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),yh(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var t;return(t=this.view)!=null&&t.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,i=t==null?void 0:t.allLayerViews;if(fc.length=0,!t||!i)return void this._clear();i.forEach(s=>{var o,p;if(s.suspended||!((o=s.layer)!=null&&o.attributionVisible))return;const n=s.layer;if(AO(n,"user"))return void wg(fc,s,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(s)){const g=this._fetchedAttributionData.get(s);return void(g?wg(fc,s,this._getDynamicAttribution(g,t,n)):AO(n)&&wg(fc,s,n.copyright))}return void this._fetchAttributionData(s)}const c="portalItem"in n?(p=n.portalItem)==null?void 0:p.accessInformation:void 0;wg(fc,s,c||n.copyright)});const r=i.find(s=>{var n;return((n=s.layer)==null?void 0:n.type)==="integrated-mesh-3dtiles"});if(this.view&&r){const s=vue(this.view);if(s){const n=s.getAttributionText();for(let c=0;c<n.length;++c)wg(fc,r,n[c])}}bue(this.items,fc)&&(this.items.removeAll(),this.items.addMany(fc)),fc.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await wA(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const r=i.ok?this._createContributionIndex(i.value,wue(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,r)}this._updateAttributionItems()}_createContributionIndex(t,i){const r=t.contributors,s={};if(!r)return s;for(let n=0;n<r.length;n++){const c=r[n],o=c.coverageAreas;if(!o)return;for(const p of o){const g=p.bbox,S=p.zoomMin-(i&&p.zoomMin?1:0),M=p.zoomMax-(i&&p.zoomMax?1:0),A=new Bi({xmin:g[1],ymin:g[0],xmax:g[3],ymax:g[2],spatialReference:mi.WGS84}),O={extent:Dc(A),attribution:c.attribution||"",score:p.score!=null?p.score:100,id:n};for(let z=S;z<=M;z++)s[z]??(s[z]=[]),s[z].push(O)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(t,i,r){var S;const{extent:s,scale:n}=i;let c=((S=r.tileInfo)==null?void 0:S.scaleToZoom(n))??0;if(c=Math.min(t.maxKey??0,Math.round(c)),!s||c==null||c<=-1)return"";const o=t[c],p=yx(s.center.clone().normalize(),i.spatialReference),g=new Set;return o?o.filter(M=>{const A=M.id,O=!g.has(A)&&p&&M.extent&&gx(M.extent,p);return O&&g.add(A),O}).sort((M,A)=>A.score-M.score||M.objectId-A.objectId).map(M=>M.attribution).join(", "):""}};v([I({readOnly:!0,type:Ut})],Zf.prototype,"items",void 0),v([I({readOnly:!0})],Zf.prototype,"state",null),v([I()],Zf.prototype,"view",void 0),Zf=v([me("esri.widgets.Attribution.AttributionViewModel")],Zf);const wU=Zf,kl={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function xue(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${String(t)}'`);return{value:Tue(e[t])}}}function Sue(e){const t=e==null?void 0:e.type;return e instanceof KeyboardEvent||t==="keyup"||t==="keydown"||t==="keypress"}function Tue(e){return function(t,...i){Sue(t)?Zte(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...i)}}function Qx(e){return(t,i)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:i})}}var Eue=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},xU=function(e,t){for(var i=0,r=e.length;i<r;i++){var s=e[i];Array.isArray(s)?xU(s,t):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=Eue(s)),t.push(s))}},Iue=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:e,properties:t||void 0,children:void 0,text:i[0],domNode:null};var s=[];return xU(i,s),{vnodeSelector:e,properties:t||void 0,children:s,text:void 0,domNode:null}};function Qn(e,t,...i){return typeof e!="function"||Hw(e)?Iue(e,t,...i):e(t,...i)}function Ive(...e){return e}const Af="esri-attribution",od={base:Af,poweredBy:`${Af}__powered-by`,sources:`${Af}__sources`,open:`${Af}--open`,sourcesOpen:`${Af}__sources--open`,link:`${Af}__link`,widgetIcon:C_.description};let un=class extends Xx{constructor(t,i){super(t,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:s})=>this._checkSourceTextOverflow(s))),this.iconClass=od.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new wU}initialize(){this.addHandles(bp(()=>{var t;return(t=this.viewModel)==null?void 0:t.items},"change",()=>this.scheduleRender()))}destroy(){var t;(t=this._resizeObserver)==null||t.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((t,i)=>(t.includes(i.text)||t.push(i.text),t),[]).join(this.itemDelimiter)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[od.open]:this._isOpen};return Qn("div",{bind:this,class:this.classes(od.base,kl.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return Qn("div",{class:od.poweredBy},"Powered by"," ",Qn("a",{class:od.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,i=this._isInteractive,r=i?0:void 0,{attributionText:s}=this,n={[od.sourcesOpen]:t,[kl.interactive]:i};return Qn("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(od.sources,n),innerHTML:s,tabIndex:r})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let i=!1;const{clientHeight:r,clientWidth:s,scrollWidth:n}=t,c=n>s,o=this._attributionTextOverflowed!==c;if(this._attributionTextOverflowed=c,o&&(i=!0),this._isOpen){const p=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,p&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};v([I()],un.prototype,"_isOpen",void 0),v([I()],un.prototype,"_isInteractive",null),v([I()],un.prototype,"_attributionTextOverflowed",void 0),v([I()],un.prototype,"_prevSourceNodeHeight",void 0),v([I({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],un.prototype,"attributionText",null),v([I()],un.prototype,"iconClass",void 0),v([I()],un.prototype,"icon",void 0),v([I()],un.prototype,"itemDelimiter",void 0),v([I()],un.prototype,"label",null),v([I(),Qx("esri/widgets/Attribution/t9n/Attribution")],un.prototype,"messages",void 0),v([I()],un.prototype,"view",null),v([I({type:wU})],un.prototype,"viewModel",void 0),v([xue()],un.prototype,"_toggleState",null),un=v([me("esri.widgets.Attribution")],un);const Mue=un;function Aue(e){var t,i;return((t=e==null?void 0:e.spatialReference)==null?void 0:t.isWebMercator)||((i=e==null?void 0:e.spatialReference)==null?void 0:i.isGeographic)||!1}const Pue=e=>{let t=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return N5(r),this.goToOverride?this.goToOverride(r,i):r.goTo(i.target,i.options)}};return v([I()],t.prototype,"goToOverride",void 0),v([I()],t.prototype,"view",void 0),t=v([me("esri.widgets.support.GoTo")],t),t},Cue="esri.widgets.CompassViewModel";let kd=class extends Pue(zt){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(ti(()=>this.view,this._updateRotationWatcher,mn))}destroy(){this.view=null}get canShowNorth(){return Aue(this.view)}get state(){var t;return!((t=this.view)!=null&&t.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var i,r;if(!((i=this.view)!=null&&i.ready))return;const t={};((r=this.view)==null?void 0:r.type)==="2d"?t.rotation=0:t.heading=0,this.callGoTo({target:t})}_updateForRotation(t){t!=null&&(this.orientation={z:t})}_updateForCamera(t){if(!t)return;const i=-t.heading;this.orientation={x:0,y:0,z:i}}_updateRotationWatcher(t){this.removeAllHandles(),t&&this.addHandles(t.type==="2d"?ti(()=>t==null?void 0:t.rotation,this._updateForRotation,mn):ti(()=>t==null?void 0:t.camera,this._updateForCamera,mn))}};v([I({readOnly:!0})],kd.prototype,"canShowNorth",null),v([I()],kd.prototype,"orientation",void 0),v([I({readOnly:!0})],kd.prototype,"state",null),v([I()],kd.prototype,"view",void 0),kd=v([me(Cue)],kd);const SU=kd,PO="esri-compass",pT={base:PO,widgetIcon:C_.locateCircled,iconContainer:`${PO}__icon-container`};let Tl=class extends Xx{constructor(t,i){super(t,i),this.iconClass=pT.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new SU,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return eP({button:()=>ht(()=>import("./calcite-button-BA7HVptJ.js"),__vite__mapDeps([236,237,238,239,240,241,242,243,244,245,246,247])),icon:()=>ht(()=>import("./calcite-icon-CXYzQYRv.js"),__vite__mapDeps([248,246,238,239,245]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:i}=this.viewModel,r=i==="rotation"?"arrow-up":"compass-needle",s=this.icon??r,{messages:n}=this;return Qn("div",{class:this.classes(pT.base,kl.widget)},Qn("calcite-button",{class:kl.widgetButton,disabled:i==="disabled",kind:"neutral",label:n.reset,onclick:this._reset,round:!0,scale:"s",title:n.reset},Qn("div",{"aria-hidden":"true",class:pT.iconContainer,title:n.reset},Qn("calcite-icon",{icon:s,scale:"m",styles:this._toRotationTransform(t)}))))}};v([I()],Tl.prototype,"goToOverride",null),v([I()],Tl.prototype,"iconClass",void 0),v([I()],Tl.prototype,"icon",void 0),v([I()],Tl.prototype,"label",null),v([I(),Qx("esri/widgets/Compass/t9n/Compass")],Tl.prototype,"messages",void 0),v([I()],Tl.prototype,"view",null),v([I({type:SU})],Tl.prototype,"viewModel",void 0),Tl=v([me("esri.widgets.Compass")],Tl);const $ue=Tl,CO="esri-navigation-toggle",fT={base:CO,widgetIcon:C_.pan2,isLayoutHorizontal:`${CO}--horizontal`};let Yf=class extends zt{constructor(t){super(t),this.navigationMode="pan",this.view=null}initialize(){this.addHandles(yh(()=>{var t;return(t=this.view)==null?void 0:t.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var t,i;return(t=this.view)!=null&&t.ready&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){var i;const t=(i=this.view)==null?void 0:i.inputManager;t&&(t.primaryDragAction=this.navigationMode==="pan"?"pan":"rotate")}};v([I({readOnly:!0})],Yf.prototype,"state",null),v([I()],Yf.prototype,"navigationMode",void 0),v([I()],Yf.prototype,"view",void 0),Yf=v([me("esri.widgets.NavigationToggleViewModel")],Yf);const TU=Yf;let El=class extends Xx{constructor(t,i){super(t,i),this.iconClass=fT.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new TU,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var s;const r=((s=this.viewModel)==null?void 0:s.navigationMode)==="pan"?this._rotateButton:this._panButton;r==null||r.setFocus(),this.toggle()}}loadDependencies(){return eP({button:()=>ht(()=>import("./calcite-button-BA7HVptJ.js"),__vite__mapDeps([236,237,238,239,240,241,242,243,244,245,246,247]))})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){var s,n;const t=((s=this.viewModel)==null?void 0:s.state)==="disabled",i=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan",r=this.messages.toggle;return Qn("div",{class:this.classes(fT.base,kl.widget,{[fT.isLayoutHorizontal]:this.layout==="horizontal"})},Qn("calcite-button",{afterCreate:c=>{this._panButton=c},appearance:i?"outline-fill":"solid",class:kl.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?void 0:-1,title:r}),Qn("calcite-button",{afterCreate:c=>{this._rotateButton=c},appearance:i?"solid":"outline-fill",class:kl.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?-1:void 0,title:r}))}};v([I()],El.prototype,"iconClass",void 0),v([I()],El.prototype,"icon",void 0),v([I()],El.prototype,"label",null),v([I({value:"vertical"})],El.prototype,"layout",null),v([I(),Qx("esri/widgets/NavigationToggle/t9n/NavigationToggle")],El.prototype,"messages",void 0),v([I()],El.prototype,"view",null),v([I({type:TU})],El.prototype,"viewModel",void 0),El=v([me("esri.widgets.NavigationToggle")],El);const kue=El;let Rd=class extends zt{get canZoomIn(){var r,s,n;if(!((r=this.view)==null?void 0:r.ready))return!1;const i=(n=(s=this.view)==null?void 0:s.constraints)==null?void 0:n.effectiveMaxScale;return i===0||this._scale>i}get canZoomOut(){var s;const{view:t}=this;if(!(t==null?void 0:t.ready))return!1;const r=(s=t.constraints)==null?void 0:s.effectiveMinScale;return r===0||this._scale<r}get _scale(){var i,r,s;const t=(r=(i=this.view)==null?void 0:i.animation)==null?void 0:r.target;return(t&&"then"in t||t==null?void 0:t.scale)??((s=this.view)==null?void 0:s.scale)??0}};v([I({readOnly:!0})],Rd.prototype,"canZoomIn",null),v([I({readOnly:!0})],Rd.prototype,"canZoomOut",null),v([I()],Rd.prototype,"view",void 0),v([I()],Rd.prototype,"_scale",null),Rd=v([me("esri.widgets.Zoom.ZoomConditions2D")],Rd);const Rue=Rd;let Jf=class extends zt{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};v([I({readOnly:!0})],Jf.prototype,"canZoomIn",null),v([I({readOnly:!0})],Jf.prototype,"canZoomOut",null),v([I()],Jf.prototype,"view",void 0),Jf=v([me("esri.widgets.Zoom.ZoomConditions3D")],Jf);const Oue=Jf;let Wu=class extends zt{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var t;return this._zoomConditions!=null&&((t=this._zoomConditions)==null?void 0:t.canZoomOut)}get state(){var t;return(t=this.view)!=null&&t.ready?"ready":"disabled"}set view(t){t?t.type==="2d"?this._zoomConditions=new Rue({view:t}):t.type==="3d"&&(this._zoomConditions=new Oue({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;t.type==="2d"?t.mapViewNavigation.zoomIn():l$(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;t.type==="2d"?t.mapViewNavigation.zoomOut():l$(t.goTo({zoomFactor:.5}))}};v([I()],Wu.prototype,"_zoomConditions",void 0),v([I()],Wu.prototype,"canZoomIn",null),v([I()],Wu.prototype,"canZoomOut",null),v([I({readOnly:!0})],Wu.prototype,"state",null),v([I()],Wu.prototype,"view",null),Wu=v([me("esri.widgets.Zoom.ZoomViewModel")],Wu);const EU=Wu,mT={base:"esri-zoom",widgetIcon:C_.zoomInMagnifyingGlass,horizontalLayout:"esri-zoom--horizontal"};let Il=class extends Xx{constructor(t,i){super(t,i),this.iconClass=mT.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new EU,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return eP({button:()=>ht(()=>import("./calcite-button-BA7HVptJ.js"),__vite__mapDeps([236,237,238,239,240,241,242,243,244,245,246,247]))})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[mT.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:r}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return Qn("div",{class:this.classes(mT.base,kl.widget,t)},Qn("calcite-button",{class:kl.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),Qn("calcite-button",{class:kl.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};v([I()],Il.prototype,"iconClass",void 0),v([I()],Il.prototype,"icon",void 0),v([I()],Il.prototype,"label",null),v([I({value:"vertical"})],Il.prototype,"layout",null),v([I(),Qx("esri/widgets/Zoom/t9n/Zoom")],Il.prototype,"messages",void 0),v([I()],Il.prototype,"view",null),v([I({type:EU})],Il.prototype,"viewModel",void 0),Il=v([me("esri.widgets.Zoom")],Il);const Lue=Il;function Due(e){return(e==null?void 0:e.view)!==void 0}let Mb=class extends oce{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(r=>{const s=this._find(r),n=s==null?void 0:s.widget;Due(n)&&(n.view=i)})},this._componentsWatcher=(i,r)=>{this._removeComponents(r),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([ti(()=>this.components,this._componentsWatcher,mn),ti(()=>this.view,this._updateViewAwareWidgets,mn)])}_add(t,i,r,s,n){let c=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;c=this._createComponent(t)}super._add(c,i,r,s,n)}_removeComponents(t){t.forEach(i=>{const r=this._find(i);r&&(this.remove(r),r.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(t){this.constructed&&t.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(t){const i=this._createWidget(t);return new Ib({id:t,node:i})}_createWidget(t){const{view:i}=this;switch(t){case"attribution":return new Mue({view:i});case"compass":return new $ue({view:i});case"navigation-toggle":return new kue({view:i});case"zoom":return new Lue({view:i})}}};v([I()],Mb.prototype,"components",void 0),Mb=v([me("esri.views.ui.DefaultUI")],Mb);const IU=Mb;let Ab=class extends IU{constructor(t){super(t),this.components=["attribution","zoom"]}};v([I()],Ab.prototype,"components",void 0),Ab=v([me("esri.views.ui.2d.DefaultUI2D")],Ab);const MU=Ab;function $O(e){return e!=null&&typeof e=="object"&&"declaredClass"in e&&e.declaredClass==="esri.WebMap"}var EM;let Pb=EM=class extends At{constructor(e){super(e),this.color=new Bt([0,0,0,1])}clone(){return new EM(He({color:this.color}))}};v([I({type:Bt,json:{write:!0}})],Pb.prototype,"color",void 0),Pb=EM=v([me("esri.webmap.background.ColorBackground")],Pb);const Nue=Pb;let AU,PU,CU,$U,kU,RU;async function zue(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:s,Stage:n}]=await Promise.all([ht(()=>import("./webglDeps-DM1GBXs_.js"),__vite__mapDeps([164,75,74,165,166])),ht(()=>import("./mapViewDeps-ChYiU5J0.js"),__vite__mapDeps([167,76,77,78,22,79,80,73,74,75,81,38,82,43,83,84,127,11,168,169,170,171,166,114,24,25,164,165,172,88,173,72,34,32,31,28,19,71,174,175,176,177,178,179,61,180,181,182,183,184,185,186,187,91,188]))]);PU=e,CU=t,$U=i,kU=r,RU=s,AU=n}let Jt=class extends Wee(Sie(cie(ane))){constructor(t){super(t),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new G0({getCollections:()=>{var i,r;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new Sb({view:this}),this.graphicsView=null,this.stateManager=new Mn({constraints:new xB({view:this})}),this.stationaryManager=new n0,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new Foe(this),this.floors=new Ut,this.highlightOptions=new jB,this.inputManager=new vle({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new WB,this.type="2d",this.ui=new MU,this.test={takeScreenshot:async i=>jle(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ti(()=>this.viewpoint,()=>this.stationaryManager.flip(),wp),this.on("resize",i=>this.stateManager.resize(i.width,i.height))]),cee()}destroy(){this._set("preconditionsReady",!1),this.frameTask=nr(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Mle(this.featuresTilingScheme)}get constraintsInfo(){var r,s;const t=(r=this.defaultsFromMap)==null?void 0:r.tileInfo,i=this.spatialReference;return{lods:(s=t==null?void 0:t.spatialReference)!=null&&s.equals(i)?t.lods:null,spatialReference:i}}get state(){return this.stateManager.state}get initialExtentRequired(){var o;if(!this.stateManager)return!1;const{scale:t,constraints:i,center:r,viewpoint:s,extent:n}=this;let c=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!n&&(i!=null&&i.effectiveLODs||(c=-1),(!r||t===0&&c===-1)&&((s==null?void 0:s.targetGeometry)==null||s.targetGeometry.type!=="extent"&&!s.scale))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const i=t.targetGeometry,r=this.spatialReference;return Zz(i.spatialReference,r)}set animation(t){const i=this._get("animation");if(t===i)return;if(i&&i.stop(),t!==this.animationManager.animation&&this.animationManager.stop(),!t||t.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",t),this.frameTask.animationInProgress=!0;const r=()=>{var s;this.destroyed||(t===this._get("animation")&&(this._set("animation",null),(s=this.frameTask)==null||s.requestFrame()),this.frameTask.animationInProgress=!1)};t.when(r,r)}get background(){return $O(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){var t;return((t=this.stateManager)==null?void 0:t.center)??null}set center(t){this.stateManager.center=t}get constraints(){var t;return(t=this.stateManager)==null?void 0:t.constraints}set constraints(t){t.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=t,i==null||i.destroy()}get extent(){var t;return((t=this.stateManager)==null?void 0:t.extent)??null}set extent(t){this.stateManager.extent=t}get padding(){var t;return(t=this.stateManager)==null?void 0:t.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){var t;return((t=this.stage)==null?void 0:t.renderRequested)??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(t){this.stateManager.resizeAlign=t}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(t){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=t,this.constraints.rotationEnabled=i}get scale(){var t;return((t=this.stateManager)==null?void 0:t.scale)??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get updating(){var i,r,s;const t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(Le("esri-2d-log-updating")){const n=this.allLayerViews.reduce((c,o)=>({...c,[`${o.layer.id}(${o.layer.type})`]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${t}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(i=this.layerViewManager)==null?void 0:i.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(s=this.graphicsView)==null?void 0:s.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(t){this.stateManager.viewpoint=t,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){var t;return((t=this.mapViewNavigation)==null?void 0:t.interacting)??!1}goTo(t,i){return this.goToManager.goTo(t,i)}async hitTest(t,i){return Ale(this,t,i)}async takeScreenshot(t){return Ule(this._getScreenshotView(t),t)}toMap(t){if(!this.ready)return null;const i=N8(t)?D8(this,t):t;return this.stateManager.toMap(i)}toScreen(t,i){return this.stateManager.toScreen(t,i)}on(t,i,r,s){return this.inputManager&&this.viewEvents.on(t,i,r,s)||super.on(t,i)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise(t=>{this.ready?t(this):this._resolveWhenReady.push(t)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var t,i,r;return this.map&&"initialViewProperties"in this.map&&((i=(t=this.map)==null?void 0:t.initialViewProperties)==null?void 0:i.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}getDefaultTimeZone(){return $O(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(t){return qR.hasLayerViewModule(t)}importLayerView(t){return qR.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(_t.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(t){var g;const i=this.toMap(t),r=await this.hitTest(t),s=this.allLayerViews.toArray().reverse(),n=new globalThis.Map(s.map(S=>[S.layer.uid,S])),c=[];let o=0,p=0;for(;o<r.results.length||p<s.length;){const S=r.results.at(o);if(S&&S.type!=="graphic"){++o;continue}const M=n.get((g=(S==null?void 0:S.layer)??(S==null?void 0:S.graphic.layer))==null?void 0:g.uid);if((!S||M)&&p<s.length&&s.at(p)!==M){const A=s.at(p);"fetchPopupFeaturesAtLocation"in A&&c.push({mapPoint:i,layerView:A}),++p}else S&&(c.push({graphic:S.graphic,layerView:M}),++o)}return{hits:c,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=Jle(this.type);if(Le("safari")&&Le("safari")<9&&(t=new Je("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Le("safari")})),t!=null)throw _t.getLogger(this).warn("#validate()",t.message),t}loadAsyncDependencies(){return zue()}_getDefaultViewpoint(){var W;const{constraints:t,initialExtent:i,map:r,padding:s,size:n}=this;if(!t)return null;const c=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,o=this.stateManager.getUserStartupOptions(this.size),p=c==null?void 0:c.viewpoint,g=((W=p==null?void 0:p.targetGeometry)==null?void 0:W.extent)??i,S=g==null?void 0:g.center,M=(p==null?void 0:p.rotation)??0,A=(p==null?void 0:p.scale)||g&&mm(g,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),O=o.center??S,z=o.rotation??M,V=o.scale??A;return O&&V?new $l({targetGeometry:O,scale:V,rotation:z}):null}_startup(){var o;this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,(o=this.defaultsFromMap.extent)==null?void 0:o.center),this.graphics.owner=this;const i=new AU(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=i,this._magnifierView=new RU,this._magnifierView.magnifier=this.magnifier;const r=new $U({view:this});this._set("labelManager",r);const s=new zoe({view:this});this._set("animationManager",s);const n=new kU({view:this,animationManager:s});this._set("mapViewNavigation",n),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",p=>this.fatalError=p.error),ti(()=>this.stationary,p=>i.stationary=p,Fa),ti(()=>this.background,p=>{i.backgroundColor=p==null?void 0:p.color,this._magnifierView.backgroundColor=p==null?void 0:p.color},Fa),ti(()=>this.magnifier,p=>this._magnifierView.magnifier=p,Fa),ti(()=>this.renderingOptions,p=>i.renderingOptions=p,Fa),ti(()=>this.highlightOptions,p=>i.highlightOptions=p,Fa),ti(()=>this.state.id,()=>i.state=this.state,Fa)],"map-view"),this._updateStageChildren();const c=this._resolveWhenReady;this._resolveWhenReady=[],c.forEach(p=>p(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this.stage.addChild(i.container)});const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const t=new Woe(xp.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const i=new PU({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new CU(t)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){var c;const{allLayerViews:i,padding:r,size:s,stage:n}=this;return{allLayerViews:i,backgroundColor:t!=null&&t.ignoreBackground?null:(c=this.background)==null?void 0:c.color,padding:r,size:s,stage:n}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Jt.type="2d",v([I({readOnly:!0})],Jt.prototype,"animationManager",void 0),v([I({constructOnly:!0})],Jt.prototype,"deactivatedWebGLExtensions",void 0),v([I({constructOnly:!0})],Jt.prototype,"debugWebGLExtensions",void 0),v([I({readOnly:!0})],Jt.prototype,"featuresTilingScheme",void 0),v([I({readOnly:!0})],Jt.prototype,"fullOpacity",void 0),v([I()],Jt.prototype,"goToManager",void 0),v([I({readOnly:!0})],Jt.prototype,"graphicsTileStore",null),v([I()],Jt.prototype,"graphicsView",void 0),v([I()],Jt.prototype,"stateManager",void 0),v([I()],Jt.prototype,"constraintsInfo",null),v([I({readOnly:!0})],Jt.prototype,"state",null),v([I()],Jt.prototype,"initialExtentRequired",null),v([I()],Jt.prototype,"labelManager",void 0),v([I({readOnly:!0})],Jt.prototype,"mapViewNavigation",void 0),v([I({constructOnly:!0})],Jt.prototype,"renderCanvas",void 0),v([I()],Jt.prototype,"renderingOptions",void 0),v([I({constructOnly:!0})],Jt.prototype,"supersampleScreenshotsEnabled",void 0),v([I({readOnly:!0})],Jt.prototype,"supportsGround",void 0),v([I()],Jt.prototype,"_defaultsFromMapSettings",null),v([I({readOnly:!0})],Jt.prototype,"typeSpecificPreconditionsReady",null),v([I()],Jt.prototype,"animation",null),v([I({type:Nue})],Jt.prototype,"background",null),v([I()],Jt.prototype,"center",null),v([I({type:xB})],Jt.prototype,"constraints",null),v([I()],Jt.prototype,"extent",null),v([I()],Jt.prototype,"floors",void 0),v([I({type:jB})],Jt.prototype,"highlightOptions",void 0),v([I({readOnly:!0})],Jt.prototype,"inputManager",void 0),v([I()],Jt.prototype,"map",void 0),v([I()],Jt.prototype,"padding",null),v([I({readOnly:!0})],Jt.prototype,"rendering",null),v([I()],Jt.prototype,"resizeAlign",null),v([I({readOnly:!0})],Jt.prototype,"resolution",null),v([I()],Jt.prototype,"rotation",null),v([I()],Jt.prototype,"scale",null),v([I({constructOnly:!0})],Jt.prototype,"spatialReferenceLocked",void 0),v([I()],Jt.prototype,"stationary",null),v([I({type:WB,readOnly:!0})],Jt.prototype,"timeline",void 0),v([I({readOnly:!0})],Jt.prototype,"type",void 0),v([I({readOnly:!0})],Jt.prototype,"updating",null),v([I()],Jt.prototype,"viewpoint",null),v([I()],Jt.prototype,"zoom",null),v([I({readOnly:!0})],Jt.prototype,"navigating",null),v([I(),As(e=>e instanceof IU?e:lx(MU,e))],Jt.prototype,"ui",void 0),Jt=v([me("esri.views.MapView")],Jt);const Fue=Jt;let Bue=class OU{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array($T),this._values=new Map,this.multipleOriginsSupported=!0}clone(t){const i=new OU,r=this._originStores[pi.DEFAULTS];r&&r.forEach((s,n)=>{i.set(n,He(s),pi.DEFAULTS)});for(let s=pi.SERVICE;s<$T;s++){const n=this._originStores[s];n&&n.forEach((c,o)=>{t&&t.has(o)||i.set(o,He(c),s)})}return i}get(t,i){const r=i===void 0?this._values:this._originStores[i];return r?r.get(t):void 0}keys(t){const i=t==null?this._values:this._originStores[t];return i?[...i.keys()]:[]}set(t,i,r=pi.USER){let s=this._originStores[r];if(s||(s=new Map,this._originStores[r]=s),s.set(t,i),!this._values.has(t)||this._propertyOriginMap.get(t)<=r){const n=this._values.get(t);return this._values.set(t,i),this._propertyOriginMap.set(t,r),n!==i}return!1}delete(t,i=pi.USER){const r=this._originStores[i];if(!r)return;const s=r.get(t);if(r.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===i){this._values.delete(t);for(let n=i-1;n>=0;n--){const c=this._originStores[n];if(c&&c.has(t)){this._values.set(t,c.get(t)),this._propertyOriginMap.set(t,n);break}}}return s}has(t,i){const r=i===void 0?this._values:this._originStores[i];return!!r&&r.has(t)}revert(t,i){for(;i>0&&!this.has(t,i);)--i;const r=this._originStores[i],s=r==null?void 0:r.get(t),n=this._values.get(t);return this._values.set(t,s),this._propertyOriginMap.set(t,i),n!==s}originOf(t){return this._propertyOriginMap.get(t)||pi.DEFAULTS}forEach(t){this._values.forEach(t)}};const LU=e=>{let t=class extends e{constructor(...i){super(...i);const r=So(this),s=r.store,n=new Bue;r.store=n,E4(r,s,n)}read(i,r){M4(this,i,r)}getAtOrigin(i,r){const s=yT(this),n=sh(r);if(typeof i=="string")return s.get(i,n);const c={};return i.forEach(o=>{c[o]=s.get(o,n)}),c}originOf(i){return jb(this.originIdOf(i))}originIdOf(i){return yT(this).originOf(i)}revert(i,r){const s=yT(this),n=sh(r),c=So(this);let o;o=typeof i=="string"?i==="*"?s.keys(n):[i]:i,o.forEach(p=>{c.invalidate(p),s.revert(p,n),c.commit(p)})}};return t=v([me("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function yT(e){return So(e).store}let kO=class extends LU(zt){};kO=v([me("esri.core.ReadOnlyMultiOriginJSONSupport")],kO);const Uue=e=>{let t=class extends e{constructor(...i){super(...i)}clear(i,r="user"){return gT(this).delete(i,sh(r))}write(i,r){return P4(this,i=i||{},r),i}setAtOrigin(i,r,s){So(this).setAtOrigin(i,r,sh(s))}removeOrigin(i){const r=gT(this),s=sh(i),n=r.keys(s);for(const c of n)r.originOf(c)===s&&r.set(c,r.get(c,s),pi.USER)}updateOrigin(i,r){const s=gT(this),n=sh(r),c=Va(this,i);for(let o=n+1;o<$T;++o)s.delete(i,o);s.set(i,c,n)}toJSON(i){return this.write({},i)}};return t=v([me("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function gT(e){return So(e).store}const DU=e=>{let t=class extends Uue(LU(e)){constructor(...i){super(...i)}};return t=v([me("esri.core.MultiOriginJSONSupport")],t),t};let RO=class extends DU(zt){};RO=v([me("esri.core.MultiOriginJSONSupport")],RO);function jue(e){return"portalItem"in e}const Vue=e=>{let t=class extends e{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):jue(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return v([I({type:String})],t.prototype,"apiKey",null),t=v([me("esri.layers.mixins.APIKeyMixin")],t),t};let Gue=class{constructor(t,i=0,r=t.lods[t.lods.length-1].level){this.tileInfo=t,this.minLOD=i,this.maxLOD=r,t.lodAt(i)||(this.minLOD=t.lods[0].level),t.lodAt(r)||(this.maxLOD=t.lods[t.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(t,i,r){var n;const s=(n=this.tileInfo)==null?void 0:n.lodAt(t);return!s||t<this.minLOD||t>this.maxLOD?"unavailable":s.cols&&s.rows?r>=s.cols[0]&&r<=s.cols[1]&&i>=s.rows[0]&&i<=s.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(t,i,r,s){await Hb(s);const n=this.getAvailability(t,i,r);if(n==="unavailable")throw new Je("tile-map:tile-unavailable","Tile is not available",{level:t,row:i,col:r});return n}async fetchAvailabilityUpsample(t,i,r,s,n){await Hb(n),s.level=t,s.row=i,s.col=r;const c=this.tileInfo;return c.updateTileInfo(s),this.fetchAvailability(t,i,r,n).catch(o=>{if(qs(o))throw o;if(c.upsampleTile(s))return this.fetchAvailabilityUpsample(s.level,s.row,s.col,s,n);throw o})}};var IM;(function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"})(IM||(IM={}));const MM=-3,que=MM-1;var Pc;(function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"})(Pc||(Pc={}));let jve=class{constructor(t,i,r){this.name=t,this._storage=i,this.id=Wue+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(t){return this._storage.getSize(this,t)}resetHitRate(){this._hit=this._miss=0}put(t,i,r,s=0){this._storage.put(this,t,i,r,s)}pop(t){const i=this._storage.pop(this,t);return i===void 0?++this._miss:++this._hit,i}get(t){const i=this._storage.get(this,t);return i===void 0?++this._miss:++this._hit,i}peek(t){return this._storage.peek(this,t)}updateSize(t,i,r){this._storage.updateSize(this,t,i,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}},Hue=class{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new D0,this._users=new D0}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,i){this._removeFuncs.push([t,i])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace(i=>i[0]!==t)}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,i){const r=this._db.get(t.id+i);return(r==null?void 0:r.size)??0}put(t,i,r,s,n){i=t.id+i;const c=this._db.get(i);if(c&&(this._size-=c.size,t.size-=c.size,this._db.delete(i),c.entry!==r&&this._notifyRemove(i,c.entry,c.size,Pc.ALL)),s>this._maxSize)return void this._notifyRemove(i,r,s,Pc.ALL);if(r===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return console.warn(`Refusing to cache entry with size ${s} for key ${i}`),void this._notifyRemove(i,r,0,Pc.ALL);const o=1+Math.max(n,que)-MM;this._db.set(i,new Zue(r,s,o)),this._size+=s,t.size+=s,this._checkSize()}updateSize(t,i,r,s){i=t.id+i;const n=this._db.get(i);if(n&&n.entry===r){for(this._size-=n.size,t.size-=n.size;s>this._maxSize;){const c=this._notifyRemove(i,r,s,Pc.SOME);if(!(c!=null&&c>0))return void this._db.delete(i);s=c}n.size=s,this._size+=s,t.size+=s,this._checkSize()}}pop(t,i){i=t.id+i;const r=this._db.get(i);if(r)return this._size-=r.size,t.size-=r.size,this._db.delete(i),++this._hit,r.entry;++this._miss}get(t,i){i=t.id+i;const r=this._db.get(i);if(r!==void 0)return this._db.delete(i),r.lives=r.lifetime,this._db.set(i,r),++this._hit,r.entry;++this._miss}peek(t,i){const r=this._db.get(t.id+i);return r?++this._hit:++this._miss,r==null?void 0:r.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach((c,o)=>{const p=c.lifetime;r[p]=(r[p]||0)+c.size,this._users.forAll(g=>{const{id:S,name:M}=g;if(o.startsWith(S)){const A=i[M]||0;i[M]=A+c.size}})});const s={};this._users.forAll(c=>{const o=c.name;if("hitRate"in c&&typeof c.hitRate=="number"&&!isNaN(c.hitRate)&&c.hitRate>0){const p=i[o]||0;i[o]=p,s[o]=Math.round(100*c.hitRate)+"%"}else s[o]="0%"});const n=Object.keys(i);n.sort((c,o)=>i[o]-i[c]),n.forEach(c=>t[c]=Math.round(i[c]/2**20)+"MB / "+s[c]);for(let c=r.length-1;c>=0;--c){const o=r[c];o&&(t["Priority "+(c+MM-1)]=Math.round(o/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll(t=>t.resetHitRate())}clear(t){const i=t.id;this._db.forEach((r,s)=>{s.startsWith(i)&&(this._size-=r.size,this._db.delete(s),this._notifyRemove(s,r.entry,r.size,Pc.ALL))}),t.size=0}clearAll(){this._db.forEach((t,i)=>this._notifyRemove(i,t.entry,t.size,Pc.ALL)),this._users.forAll(t=>t.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,i,r,s){let n;return this._removeFuncs.some(c=>{if(t.startsWith(c[0])){const o=c[1](i,s,r);return typeof o=="number"&&(n=o),!0}return!1}),n}_checkSize(){this._users.forAll(t=>this._checkSizeLimits(t)),this._checkSizeLimits()}_checkSizeLimits(t){const i=t??this;if(i.maxSize<0||i.size<=i.maxSize)return;const r=t==null?void 0:t.id;let s=!0;for(;s;){s=!1;for(const[n,c]of this._db)if(c.lifetime===0&&(!r||n.startsWith(r))){if(this._purgeItem(n,c,t),i.size<=.9*i.maxSize)return;s||(s=this._db.has(n))}}for(const[n,c]of this._db)if((!r||n.startsWith(r))&&(this._purgeItem(n,c,t),i.size<=.9*i.maxSize))return}_purgeItem(t,i,r=this._users.find(s=>t.startsWith(s.id))){if(this._db.delete(t),i.lives<=1){this._size-=i.size,r&&(r.size-=i.size);const s=this._notifyRemove(t,i.entry,i.size,Pc.SOME);s!=null&&s>0&&(this._size+=s,r&&(r.size+=s),i.lives=i.lifetime,i.size=s,this._db.set(t,i))}else--i.lives,this._db.set(t,i)}},Wue=0,Zue=class{constructor(t,i,r){this.entry=t,this.size=i,this.lifetime=r,this.lives=r}},Yue=class{constructor(t,i){this._storage=new Hue,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,i,r=1){this._storage.put(this,t,i,r,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}};function Jue(e,t=!1){return e<=P7?t?new Array(e).fill(0):new Array(e):new Uint32Array(e)}let OO=class AM{constructor(t){this._validateJSON(t);const{location:i,data:r}=t;this.location=Object.freeze(He(i));const s=this.location.width,n=this.location.height;let c=!0,o=!0;const p=Math.ceil(s*n/32),g=Jue(p);let S=0;for(let M=0;M<r.length;M++){const A=M%32;r[M]?(o=!1,g[S]|=1<<A):c=!1,A===31&&++S}o?(this._availability="unavailable",this.byteSize=40):c?(this._availability="available",this.byteSize=40):(this._availability=g,this.byteSize=40+M7(g))}getAvailability(t,i){if(this._availability==="unavailable"||this._availability==="available")return this._availability;const r=(t-this.location.top)*this.location.width+(i-this.location.left),s=r%32,n=r>>5,c=this._availability;return n<0||n>c.length?"unknown":c[n]&1<<s?"available":"unavailable"}static fromDefinition(t,i){const r=t.service.request||Xi,{row:s,col:n,width:c,height:o}=t,p={query:{f:"json"}};return i=i?{...p,...i}:p,r(Kue(t),i).then(g=>g.data).catch(g=>{if(g&&g.details&&g.details.httpStatus===422)return{location:{top:s,left:n,width:c,height:o},valid:!0,data:_7(c*o,0)};throw g}).then(g=>{if(g.location&&(g.location.top!==s||g.location.left!==n||g.location.width!==c||g.location.height!==o))throw new Je("tilemap:location-mismatch","Tilemap response for different location than requested",{response:g,definition:{top:s,left:n,width:c,height:o}});return AM.fromJSON(g)})}static fromJSON(t){return Object.freeze(new AM(t))}_validateJSON(t){if(!(t!=null&&t.location))throw new Je("tilemap:missing-location","Location missing from tilemap response");if(t.valid===!1)throw new Je("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new Je("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new Je("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new Je("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}};function LO(e){return`${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}function Kue(e){var r;let t;if((r=e.service.tileServers)!=null&&r.length){const s=e.service.tileServers;t=`${s&&s.length?s[e.row%s.length]:e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}else t=`${e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`;const i=e.service.query;return i&&(t=`${t}?${i}`),t}var Bd;let Wo=Bd=class extends zt{constructor(e){super(e),this._pendingTilemapRequests={},this.request=Xi,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new Yue(2*IM.MEGABYTES),this.addHandles(ti(()=>{const{layer:e}=this;return[e==null?void 0:e.parsedUrl,e==null?void 0:e.tileServers,e==null?void 0:e.apiKey,e==null?void 0:e.customParameters]},()=>this._initializeTilemapDefinition(),mn))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(e,t,i,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new Je("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const s=this._tmpTilemapDefinition,n=this._tilemapFromCache(e,t,i,s);if(n)return Promise.resolve(n);const c=r==null?void 0:r.signal;return r={...r,signal:null},new Promise((o,p)=>{eo(c,()=>p(Nr()));const g=LO(s);let S=this._pendingTilemapRequests[g];if(!S){S=OO.fromDefinition(s,r).then(A=>(this._tilemapCache.put(g,A,A.byteSize),A));const M=()=>{delete this._pendingTilemapRequests[g]};this._pendingTilemapRequests[g]=S,S.then(M,M)}S.then(o,p)})}getAvailability(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):"unknown"}fetchAvailability(e,t,i,r){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new Je("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})):this.fetchTilemap(e,t,i,r).catch(s=>s).then(s=>{if(s instanceof OO){const n=s.getAvailability(t,i);if(n==="unavailable")throw new Je("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return n}if(qs(s))throw s;return"unknown"})}fetchAvailabilityUpsample(e,t,i,r,s){r.level=e,r.row=t,r.col=i;const n=this.layer.tileInfo;n.updateTileInfo(r);const c=this.fetchAvailability(e,t,i,s).catch(o=>{if(qs(o))throw o;if(n.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,s);throw o});return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,s,c),c}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,s,n){if(!this._prefetchingEnabled||e==null)return;const c=`prefetch-${e}`;if(this.hasHandles(c))return;const o=new AbortController;n.then(()=>o.abort(),()=>o.abort());let p=!1;const g=Qi(()=>{p||(p=!0,o.abort())});if(this.addHandles(g,c),await TG(10,o.signal).catch(()=>{}),p||(p=!0,this.removeHandles(c)),ra(o))return;const S=new rF(e,t,i,r),M={...s,signal:o.signal},A=this.layer.tileInfo;for(let O=0;Bd._prefetches.length<Bd._maxPrefetch&&A.upsampleTile(S);++O){const z=this.fetchAvailability(S.level,S.row,S.col,M);Bd._prefetches.push(z);const V=()=>{Bd._prefetches.removeUnordered(z)};z.then(V,V)}}_initializeTilemapDefinition(){var r;if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:up({...e.query,...i,token:t??((r=e.query)==null?void 0:r.token)}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const s=LO(r);return this._tilemapCache.get(s)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};Wo._maxPrefetch=4,Wo._prefetches=new D0({initialSize:Bd._maxPrefetch}),v([I({constructOnly:!0})],Wo.prototype,"layer",void 0),v([I({constructOnly:!0})],Wo.prototype,"minLOD",void 0),v([I({constructOnly:!0})],Wo.prototype,"maxLOD",void 0),v([I({constructOnly:!0})],Wo.prototype,"request",void 0),v([I({constructOnly:!0})],Wo.prototype,"size",void 0),Wo=Bd=v([me("esri.layers.support.TilemapCache")],Wo);const Xue=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){var i,r;(r=(i=this.tilemapCache)==null?void 0:i.destroy)==null||r.call(i)}readMinScale(i,r){return r.minLOD!=null&&r.maxLOD!=null?i:0}readMaxScale(i,r){return r.minLOD!=null&&r.maxLOD!=null?i:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(i,r,s){var S;const n=(S=r.capabilities)==null?void 0:S.includes("Tilemap");let{minLOD:c,maxLOD:o,minScale:p,maxScale:g}=r;if(c==null&&o==null&&p!==0&&g!==0){const M=A=>Math.round(1e4*A)/1e4;p=M(p||r.tileInfo.lods[0].scale),g=M(g||r.tileInfo.lods[r.tileInfo.lods.length-1].scale);for(const A of r.tileInfo.lods){const O=M(A.scale);c=O>=p?A.level:c,o=O>=g?A.level:o}}if(n)return new Wo({layer:this,minLOD:c,maxLOD:o});if(r.tileInfo){const M=new xp;return M.read(r.tileInfo,s),new Gue(M,c,o)}return null}};return v([I({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),v([I()],t.prototype,"minScale",void 0),v([fi("service","minScale")],t.prototype,"readMinScale",null),v([I()],t.prototype,"maxScale",void 0),v([fi("service","maxScale")],t.prototype,"readMaxScale",null),v([I({type:mi})],t.prototype,"spatialReference",void 0),v([I({readOnly:!0})],t.prototype,"supportsBlankTile",null),v([I({type:xp})],t.prototype,"tileInfo",void 0),v([I()],t.prototype,"tilemapCache",void 0),v([fi("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),v([I()],t.prototype,"version",void 0),t=v([me("esri.layers.mixins.ArcGISCachedService")],t),t},Que=e=>{let t=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=Hx(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",ene(i,_t.getLogger(this)))}};return v([I()],t.prototype,"title",null),v([I({type:String})],t.prototype,"url",null),t=v([me("esri.layers.mixins.ArcGISService")],t),t};var DO,NO,NU={exports:{}};NO=function(){function e(s,n){function c(){this.constructor=s}c.prototype=n.prototype,s.prototype=new c}function t(s,n,c,o){var p=Error.call(this,s);return Object.setPrototypeOf&&Object.setPrototypeOf(p,t.prototype),p.expected=n,p.found=c,p.location=o,p.name="SyntaxError",p}function i(s,n,c){return c=c||" ",s.length>n?s:(n-=s.length,s+(c+=c.repeat(n)).slice(0,n))}function r(s,n){var c,o={},p=(n=n!==void 0?n:{}).grammarSource,g={start:Qr},S=Qr,M="none",A=")",O=",",z="(",V="%",W="px",ie="cm",ve="mm",pe="in",_e="pt",Me="pc",$e="deg",Fe="rad",Ge="grad",et="turn",at="#",ct=".",nt="e",Pt=/^[ \t\n\r]/,ft=/^[a-z\-]/,vi=/^[0-9a-fA-F]/,Li=/^[+\-]/,Tt=/^[0-9]/,Ft=kt("none"),Hi=Xt("none",!1),Fr=Xt(")",!1),Cr=Xt(",",!1),_r=kt("whitespace"),Cs=wi([" ","	",`
`,"\r"],!1,!1),fs=kt("function"),Zs=Xt("(",!1),yn=kt("identifier"),Kr=wi([["a","z"],"-"],!1,!1),ms=kt("percentage"),Ke=Xt("%",!1),oi=kt("length"),Di=Xt("px",!1),$s=Xt("cm",!1),Io=Xt("mm",!1),Mo=Xt("in",!1),vr=Xt("pt",!1),la=Xt("pc",!1),Oe=kt("angle"),ca=Xt("deg",!1),Vl=Xt("rad",!1),ai=Xt("grad",!1),Br=Xt("turn",!1),Bn=kt("number"),Qa=kt("color"),el=Xt("#",!1),ua=wi([["0","9"],["a","f"],["A","F"]],!1,!1),Ao=wi(["+","-"],!1,!1),ks=wi([["0","9"]],!1,!1),Gl=Xt(".",!1),Xe=Xt("e",!1),Rs=function(){return[]},ys=function(ae,De){return{type:"function",name:ae,parameters:De||[]}},ql=function(ae,De){return De.length>0?da(ae,De,3):[ae]},ha=function(ae){return{type:"quantity",value:ae.value,unit:ae.unit}},Ye=function(ae){return{type:"color",colorType:ae.type,value:ae.value}},Ht=function(ae){return ae},jt=function(){return Dt()},Ur=function(ae){return{value:ae,unit:"%"}},Ys=function(ae){return{value:ae,unit:"px"}},Gt=function(ae){return{value:ae,unit:"cm"}},Po=function(ae){return{value:ae,unit:"mm"}},io=function(ae){return{value:ae,unit:"in"}},se=function(ae){return{value:ae,unit:"pt"}},j=function(ae){return{value:ae,unit:"pc"}},H=function(ae){return{value:ae,unit:"deg"}},K=function(ae){return{value:ae,unit:"rad"}},te=function(ae){return{value:ae,unit:"grad"}},ye=function(ae){return{value:ae,unit:"turn"}},ge=function(ae){return{value:ae,unit:null}},Se=function(){return{type:"hex",value:Dt()}},he=function(ae){return{type:"function",value:ae}},Ie=function(){return{type:"named",value:Dt()}},Be=function(){return parseFloat(Dt())},ee=0,ke=0,gt=[{line:1,column:1}],xt=0,It=[],Ze=0;if("startRule"in n){if(!(n.startRule in g))throw new Error(`Can't start parsing from rule "`+n.startRule+'".');S=g[n.startRule]}function Dt(){return s.substring(ke,ee)}function Xt(ae,De){return{type:"literal",text:ae,ignoreCase:De}}function wi(ae,De,je){return{type:"class",parts:ae,inverted:De,ignoreCase:je}}function or(){return{type:"end"}}function kt(ae){return{type:"other",description:ae}}function Wi(ae){var De,je=gt[ae];if(je)return je;for(De=ae-1;!gt[De];)De--;for(je={line:(je=gt[De]).line,column:je.column};De<ae;)s.charCodeAt(De)===10?(je.line++,je.column=1):je.column++,De++;return gt[ae]=je,je}function br(ae,De,je){var Zt=Wi(ae),Mi=Wi(De),Ti={source:p,start:{offset:ae,line:Zt.line,column:Zt.column},end:{offset:De,line:Mi.line,column:Mi.column}};return je&&p&&typeof p.offset=="function"&&(Ti.start=p.offset(Ti.start),Ti.end=p.offset(Ti.end)),Ti}function Mt(ae){ee<xt||(ee>xt&&(xt=ee,It=[]),It.push(ae))}function Xr(ae,De,je){return new t(t.buildMessage(ae,De),ae,De,je)}function Qr(){var ae;return(ae=Os())===o&&(ae=kp()),ae}function Os(){var ae,De;return Ze++,ae=ee,pr(),s.substr(ee,4)===M?(De=M,ee+=4):(De=o,Ze===0&&Mt(Hi)),De!==o?(pr(),ke=ae,ae=Rs()):(ee=ae,ae=o),Ze--,ae===o&&Ze===0&&Mt(Ft),ae}function kp(){var ae,De;if(ae=[],(De=kh())!==o)for(;De!==o;)ae.push(De),De=kh();else ae=o;return ae}function kh(){var ae,De,je,Zt;return ae=ee,pr(),(De=Ls())!==o?(pr(),(je=Ei())===o&&(je=null),pr(),s.charCodeAt(ee)===41?(Zt=A,ee++):(Zt=o,Ze===0&&Mt(Fr)),Zt!==o?(pr(),ke=ae,ae=ys(De,je)):(ee=ae,ae=o)):(ee=ae,ae=o),ae}function Ei(){var ae,De,je,Zt,Mi,Ti,jr,yi;if(ae=ee,(De=Hl())!==o){for(je=[],Zt=ee,Mi=pr(),s.charCodeAt(ee)===44?(Ti=O,ee++):(Ti=o,Ze===0&&Mt(Cr)),Ti===o&&(Ti=null),jr=pr(),(yi=Hl())!==o?Zt=Mi=[Mi,Ti,jr,yi]:(ee=Zt,Zt=o);Zt!==o;)je.push(Zt),Zt=ee,Mi=pr(),s.charCodeAt(ee)===44?(Ti=O,ee++):(Ti=o,Ze===0&&Mt(Cr)),Ti===o&&(Ti=null),jr=pr(),(yi=Hl())!==o?Zt=Mi=[Mi,Ti,jr,yi]:(ee=Zt,Zt=o);ke=ae,ae=ql(De,je)}else ee=ae,ae=o;return ae}function Hl(){var ae,De;return ae=ee,(De=Rp())===o&&(De=es())===o&&(De=Js())===o&&(De=Op()),De!==o&&(ke=ae,De=ha(De)),(ae=De)===o&&(ae=ee,(De=Co())!==o&&(ke=ae,De=Ye(De)),ae=De),ae}function pr(){var ae,De;for(Ze++,ae=[],Pt.test(s.charAt(ee))?(De=s.charAt(ee),ee++):(De=o,Ze===0&&Mt(Cs));De!==o;)ae.push(De),Pt.test(s.charAt(ee))?(De=s.charAt(ee),ee++):(De=o,Ze===0&&Mt(Cs));return Ze--,De=o,Ze===0&&Mt(_r),ae}function Ls(){var ae,De,je;return Ze++,ae=ee,(De=gs())!==o?(s.charCodeAt(ee)===40?(je=z,ee++):(je=o,Ze===0&&Mt(Zs)),je!==o?(ke=ae,ae=Ht(De)):(ee=ae,ae=o)):(ee=ae,ae=o),Ze--,ae===o&&(De=o,Ze===0&&Mt(fs)),ae}function gs(){var ae,De,je;if(Ze++,ae=ee,De=[],ft.test(s.charAt(ee))?(je=s.charAt(ee),ee++):(je=o,Ze===0&&Mt(Kr)),je!==o)for(;je!==o;)De.push(je),ft.test(s.charAt(ee))?(je=s.charAt(ee),ee++):(je=o,Ze===0&&Mt(Kr));else De=o;return De!==o&&(ke=ae,De=jt()),Ze--,(ae=De)===o&&(De=o,Ze===0&&Mt(yn)),ae}function Rp(){var ae,De,je;return Ze++,ae=ee,pr(),(De=Si())!==o?(s.charCodeAt(ee)===37?(je=V,ee++):(je=o,Ze===0&&Mt(Ke)),je!==o?(ke=ae,ae=Ur(De)):(ee=ae,ae=o)):(ee=ae,ae=o),Ze--,ae===o&&Ze===0&&Mt(ms),ae}function es(){var ae,De,je;return Ze++,ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===W?(je=W,ee+=2):(je=o,Ze===0&&Mt(Di)),je!==o?(ke=ae,ae=Ys(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===ie?(je=ie,ee+=2):(je=o,Ze===0&&Mt($s)),je!==o?(ke=ae,ae=Gt(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===ve?(je=ve,ee+=2):(je=o,Ze===0&&Mt(Io)),je!==o?(ke=ae,ae=Po(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===pe?(je=pe,ee+=2):(je=o,Ze===0&&Mt(Mo)),je!==o?(ke=ae,ae=io(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===_e?(je=_e,ee+=2):(je=o,Ze===0&&Mt(vr)),je!==o?(ke=ae,ae=se(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,pr(),(De=Si())!==o?(s.substr(ee,2)===Me?(je=Me,ee+=2):(je=o,Ze===0&&Mt(la)),je!==o?(ke=ae,ae=j(De)):(ee=ae,ae=o)):(ee=ae,ae=o)))))),Ze--,ae===o&&Ze===0&&Mt(oi),ae}function Js(){var ae,De,je;return Ze++,ae=ee,(De=Si())!==o?(s.substr(ee,3)===$e?(je=$e,ee+=3):(je=o,Ze===0&&Mt(ca)),je!==o?(ke=ae,ae=H(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,(De=Si())!==o?(s.substr(ee,3)===Fe?(je=Fe,ee+=3):(je=o,Ze===0&&Mt(Vl)),je!==o?(ke=ae,ae=K(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,(De=Si())!==o?(s.substr(ee,4)===Ge?(je=Ge,ee+=4):(je=o,Ze===0&&Mt(ai)),je!==o?(ke=ae,ae=te(De)):(ee=ae,ae=o)):(ee=ae,ae=o),ae===o&&(ae=ee,(De=Si())!==o?(s.substr(ee,4)===et?(je=et,ee+=4):(je=o,Ze===0&&Mt(Br)),je!==o?(ke=ae,ae=ye(De)):(ee=ae,ae=o)):(ee=ae,ae=o)))),Ze--,ae===o&&(De=o,Ze===0&&Mt(Oe)),ae}function Op(){var ae,De;return Ze++,ae=ee,pr(),(De=Si())!==o?(ke=ae,ae=ge(De)):(ee=ae,ae=o),Ze--,ae===o&&Ze===0&&Mt(Bn),ae}function Co(){var ae,De,je,Zt;if(Ze++,ae=ee,s.charCodeAt(ee)===35?(De=at,ee++):(De=o,Ze===0&&Mt(el)),De!==o){if(je=[],vi.test(s.charAt(ee))?(Zt=s.charAt(ee),ee++):(Zt=o,Ze===0&&Mt(ua)),Zt!==o)for(;Zt!==o;)je.push(Zt),vi.test(s.charAt(ee))?(Zt=s.charAt(ee),ee++):(Zt=o,Ze===0&&Mt(ua));else je=o;je!==o?(ke=ae,ae=Se()):(ee=ae,ae=o)}else ee=ae,ae=o;return ae===o&&(ae=ee,(De=kh())!==o&&(ke=ae,De=he(De)),(ae=De)===o&&(ae=ee,(De=gs())!==o&&(ke=ae,De=Ie()),ae=De)),Ze--,ae===o&&(De=o,Ze===0&&Mt(Qa)),ae}function Si(){var ae,De,je,Zt,Mi,Ti,jr;for(ae=ee,Li.test(s.charAt(ee))?(s.charAt(ee),ee++):Ze===0&&Mt(Ao),De=ee,je=[],Tt.test(s.charAt(ee))?(Zt=s.charAt(ee),ee++):(Zt=o,Ze===0&&Mt(ks));Zt!==o;)je.push(Zt),Tt.test(s.charAt(ee))?(Zt=s.charAt(ee),ee++):(Zt=o,Ze===0&&Mt(ks));if(s.charCodeAt(ee)===46?(Zt=ct,ee++):(Zt=o,Ze===0&&Mt(Gl)),Zt!==o){if(Mi=[],Tt.test(s.charAt(ee))?(Ti=s.charAt(ee),ee++):(Ti=o,Ze===0&&Mt(ks)),Ti!==o)for(;Ti!==o;)Mi.push(Ti),Tt.test(s.charAt(ee))?(Ti=s.charAt(ee),ee++):(Ti=o,Ze===0&&Mt(ks));else Mi=o;Mi!==o?De=je=[je,Zt,Mi]:(ee=De,De=o)}else ee=De,De=o;if(De===o)if(De=[],Tt.test(s.charAt(ee))?(je=s.charAt(ee),ee++):(je=o,Ze===0&&Mt(ks)),je!==o)for(;je!==o;)De.push(je),Tt.test(s.charAt(ee))?(je=s.charAt(ee),ee++):(je=o,Ze===0&&Mt(ks));else De=o;if(De!==o){if(je=ee,s.charCodeAt(ee)===101?(Zt=nt,ee++):(Zt=o,Ze===0&&Mt(Xe)),Zt!==o){if(Li.test(s.charAt(ee))?(Mi=s.charAt(ee),ee++):(Mi=o,Ze===0&&Mt(Ao)),Mi===o&&(Mi=null),Ti=[],Tt.test(s.charAt(ee))?(jr=s.charAt(ee),ee++):(jr=o,Ze===0&&Mt(ks)),jr!==o)for(;jr!==o;)Ti.push(jr),Tt.test(s.charAt(ee))?(jr=s.charAt(ee),ee++):(jr=o,Ze===0&&Mt(ks));else Ti=o;Ti!==o?je=Zt=[Zt,Mi,Ti]:(ee=je,je=o)}else ee=je,je=o;je===o&&(je=null),ke=ae,ae=Be()}else ee=ae,ae=o;return ae}function Wl(ae,De){return ae.map(function(je){return je[De]})}function da(ae,De,je){return[ae].concat(Wl(De,je))}if((c=S())!==o&&ee===s.length)return c;throw c!==o&&ee<s.length&&Mt(or()),Xr(It,xt<s.length?s.charAt(xt):null,xt<s.length?br(xt,xt+1):br(xt,xt))}return e(t,Error),t.prototype.format=function(s){var n="Error: "+this.message;if(this.location){var c,o=null;for(c=0;c<s.length;c++)if(s[c].source===this.location.source){o=s[c].text.split(/\r\n|\n|\r/g);break}var p=this.location.start,g=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(p):p,S=this.location.source+":"+g.line+":"+g.column;if(o){var M=this.location.end,A=i("",g.line.toString().length," "),O=o[p.line-1],z=(p.line===M.line?M.column:O.length+1)-p.column||1;n+=`
 --> `+S+`
`+A+` |
`+g.line+" | "+O+`
`+A+" | "+i("",p.column-1," ")+i("",z,"^")}else n+=`
 at `+S}return n},t.buildMessage=function(s,n){var c={literal:function(O){return'"'+p(O.text)+'"'},class:function(O){var z=O.parts.map(function(V){return Array.isArray(V)?g(V[0])+"-"+g(V[1]):g(V)});return"["+(O.inverted?"^":"")+z.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(O){return O.description}};function o(O){return O.charCodeAt(0).toString(16).toUpperCase()}function p(O){return O.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(z){return"\\x0"+o(z)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(z){return"\\x"+o(z)})}function g(O){return O.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(z){return"\\x0"+o(z)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(z){return"\\x"+o(z)})}function S(O){return c[O.type](O)}function M(O){var z,V,W=O.map(S);if(W.sort(),W.length>0){for(z=1,V=1;z<W.length;z++)W[z-1]!==W[z]&&(W[V]=W[z],V++);W.length=V}switch(W.length){case 1:return W[0];case 2:return W[0]+" or "+W[1];default:return W.slice(0,-1).join(", ")+", or "+W[W.length-1]}}function A(O){return O?'"'+p(O)+'"':"end of input"}return"Expected "+M(s)+" but "+A(n)+" found."},{SyntaxError:t,parse:r}},(DO=NU).exports&&(DO.exports=NO());var ehe=NU.exports;function zU(e){if(!e||e.length===0)return null;if(typeof e=="string"){const i=zO(e);return i&&i.length!==0?i:null}const t=e.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new Je("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:zO(i.value)}});t.sort((i,r)=>r.effects.length-i.effects.length);for(let i=0;i<t.length-1;i++){if(!CJ(t[i].effects,t[i+1].effects))throw new Je("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[i].effects,b:t[i+1].effects});$J(t[i].effects,t[i+1].effects)}return t.sort((i,r)=>r.scale-i.scale),t}function zO(e){let t;if(!e)return[];try{t=ehe.parse(e)}catch(i){throw new Je("effect:invalid-syntax","Invalid effect syntax",{value:e,error:i})}return t.map(i=>the(i))}function the(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return ihe(e);case"opacity":return rhe(e);case"hue-rotate":return she(e);case"blur":return nhe(e);case"drop-shadow":return ohe(e);case"bloom":return ahe(e)}}catch(t){throw t.details.filter=e,t}throw new Je("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}function ihe(e){let t=1;return Jm(e.parameters,1),e.parameters.length===1&&(t=Da(e.parameters[0])),new gE(e.name,t)}function rhe(e){let t=1;return Jm(e.parameters,1),e.parameters.length===1&&(t=Da(e.parameters[0])),new e6(t)}function she(e){let t=0;return Jm(e.parameters,1),e.parameters.length===1&&(t=phe(e.parameters[0])),new XN(t)}function nhe(e){let t=0;return Jm(e.parameters,1),e.parameters.length===1&&(t=rP(e.parameters[0]),$_(t,e.parameters[0])),new WN(t)}function ohe(e){const t=[];let i=null;for(const r of e.parameters)if(r.type==="color"){if(t.length&&Object.freeze(t),i)throw new Je("effect:type-error","Accepts only one color",{});i=fhe(r)}else{const s=rP(r);if(Object.isFrozen(t))throw new Je("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(s),t.length===3&&$_(s,r)}if(t.length<2||t.length>3)throw new Je("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new JN(t[0],t[1],t[2]||0,i||FU("black"))}function ahe(e){let t=1,i=0,r=0;return Jm(e.parameters,3),e.parameters[0]&&(t=Da(e.parameters[0])),e.parameters[1]&&(i=rP(e.parameters[1]),$_(i,e.parameters[1])),e.parameters[2]&&(r=Da(e.parameters[2])),new qN(t,i,r)}function Jm(e,t){if(e.length>t)throw new Je("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function e2(e){if(e.type==="color")return"<color>";if(e.unit){if(e.unit in iP)return"<length>";if(e.unit in tP)return"<angle>";if(e.unit==="%")return"<percentage>"}return"<double>"}function $_(e,t){if(e<0)throw new Je("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}function lhe(e){if(e.type!=="quantity"||e.unit!==null)throw new Je("effect:type-error",`Expected <double>, Actual: ${e2(e)}`,{term:e})}function che(e){if(e.type!=="quantity"||e.unit!==null&&e.unit!=="%")throw new Je("effect:type-error",`Expected <double> or <percentage>, Actual: ${e2(e)}`,{term:e})}const tP={deg:1,grad:.9,rad:180/Math.PI,turn:360};function uhe(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&tP[e.unit]!=null))throw new Je("effect:type-error",`Expected <angle>, Actual: ${e2(e)}`,{term:e})}const iP={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function hhe(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&iP[e.unit]!=null))throw new Je("effect:type-error",`Expected <length>, Actual: ${e2(e)}`,{term:e})}function Da(e){che(e);const t=e.value;return $_(t,e),e.unit==="%"?.01*t:t}function dhe(e){return lhe(e),$_(e.value,e),e.value}function phe(e){return uhe(e),e.value*tP[e.unit]||0}function rP(e){return hhe(e),e.value*iP[e.unit]||0}function fhe(e){switch(e.colorType){case"hex":return MZ(e.value);case"named":return FU(e.value);case"function":return ghe(e.value)}}function FU(e){if(!vN(e))throw new Je("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return IZ(e)}const mhe=/^rgba?/i,yhe=/^hsla?/i;function ghe(e){if(Jm(e.parameters,4),mhe.test(e.name))return[Da(e.parameters[0]),Da(e.parameters[1]),Da(e.parameters[2]),e.parameters[3]?Da(e.parameters[3]):1];if(yhe.test(e.name))return bN(dhe(e.parameters[0]),Da(e.parameters[1]),Da(e.parameters[2]),e.parameters[3]?Da(e.parameters[3]):1);throw new Je("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}function _he(e,t,i){var r;try{return whe(e)}catch(s){(r=i==null?void 0:i.messages)==null||r.push(s)}return null}function vhe(e,t,i,r){try{const s=bhe(e);Ep(i,s,t)}catch(s){r.messages&&r.messages.push(s)}}function bhe(e){const t=zU(e);return t?kJ(t)?t.map(i=>i.toJSON()):t.map(({scale:i,effects:r})=>({scale:i,value:r.map(s=>s.toJSON())})):null}function whe(e){if(!e||e.length===0)return null;if(xhe(e)){const t=[];for(const i of e)t.push({scale:i.scale,value:FO(i.value)});return t}return FO(e)}function xhe(e){const t=e[0];return!!t&&"scale"in t}function FO(e){if(!(e!=null&&e.length))return"";const t=[];for(const i of e){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[mc(i,"amount")];break;case"blur":r=[mc(i,"radius","pt")];break;case"hue-rotate":r=[mc(i,"angle","deg")];break;case"drop-shadow":r=[mc(i,"xoffset","pt"),mc(i,"yoffset","pt"),mc(i,"blurRadius","pt"),She(i,"color")];break;case"bloom":r=[mc(i,"strength"),mc(i,"radius","pt"),mc(i,"threshold")]}const s=`${i.type}(${r.filter(Boolean).join(" ")})`;zU(s),t.push(s)}return t.join(" ")}function mc(e,t,i){if(e[t]==null)throw new Je("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return i?e[t]+i:""+e[t]}function She(e,t){if(e[t]==null)throw new Je("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const i=e[t];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const BO={read:{reader:_he},write:{allowNull:!0,writer:vhe}},The=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return v([I({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),v([I({json:{read:!1,write:!1,origins:{"web-map":BO,"portal-item":BO}}})],t.prototype,"effect",void 0),t=v([me("esri.layers.mixins.BlendLayer")],t),t},Ehe=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return v([I({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],t.prototype,"customParameters",void 0),t=v([me("esri.layers.mixins.CustomParametersMixin")],t),t},Ja=(e=>e)(["operational-layers","basemap","ground"]),UO={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},jO={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},VO={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},Ihe={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0,IntegratedMesh3DTilesLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":UO,"web-map/basemap":jO,"web-map/tables":VO,"link-chart/operational-layers":{...UO,LinkChartLayer:!0},"link-chart/basemap":jO,"link-chart/tables":VO,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISImageServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,IntegratedMesh3DTilesLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0}};function Mhe(e){if(!e)return e;const{start:t,end:i}=e;return new x_({start:t!=null?ap(t,-t.getTimezoneOffset(),"minutes"):t,end:i!=null?ap(i,-i.getTimezoneOffset(),"minutes"):i})}function Ahe(e){if(!e)return e;const{start:t,end:i}=e;return new x_({start:t!=null?ap(t,t.getTimezoneOffset(),"minutes"):t,end:i!=null?ap(i,i.getTimezoneOffset(),"minutes"):i})}var PM;let o0=PM=class extends At{constructor(e){super(e)}async collectRequiredFields(e,t){return bh(e,t,this.expression)}clone(){return new PM({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};v([I({type:String,json:{write:!0}})],o0.prototype,"expression",void 0),v([I({type:String,json:{write:!0}})],o0.prototype,"title",void 0),o0=PM=v([me("esri.layers.support.FeatureExpressionInfo")],o0);const GO=o0,BU={unknown:1,inches:Bo(1,"meters","inches"),feet:Bo(1,"meters","feet"),"us-feet":Bo(1,"meters","us-feet"),yards:Bo(1,"meters","yards"),miles:Bo(1,"meters","miles"),"nautical-miles":Bo(1,"meters","nautical-miles"),millimeters:Bo(1,"meters","millimeters"),centimeters:Bo(1,"meters","centimeters"),decimeters:Bo(1,"meters","decimeters"),meters:Bo(1,"meters","meters"),kilometers:Bo(1,"meters","kilometers"),"decimal-degrees":1/dW(1,"meters",Ar.radius)};function Wve(e){return 1/(BU[e]||1)}function Phe(){const e=Object.keys(BU);return e.sort(),e}const Che=Phe();var CM;const Av=Fn()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),qO=new Ms({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Ic=CM=class extends At{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return e??(t.featureExpression&&t.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(e,t,i,r){t[i]=e.write({},r),e.expression==="0"&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new CM({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&z7(this.featureExpressionInfo,e.featureExpressionInfo)}};v([I({type:GO,json:{write:!0}})],Ic.prototype,"featureExpressionInfo",void 0),v([fi("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Ic.prototype,"readFeatureExpressionInfo",null),v([ci("featureExpressionInfo",{featureExpressionInfo:{type:GO},"featureExpression.value":{type:[0]}})],Ic.prototype,"writeFeatureExpressionInfo",null),v([I({type:Av.apiValues,nonNullable:!0,json:{type:Av.jsonValues,read:Av.read,write:{writer:Av.write,isRequired:!0}}})],Ic.prototype,"mode",null),v([I({type:Number,json:{write:!0}})],Ic.prototype,"offset",void 0),v([I({type:Che,json:{type:String,read:qO.read,write:qO.write}})],Ic.prototype,"unit",null),Ic=CM=v([me("esri.layers.support.ElevationInfo")],Ic);const $he=Ic,Zve={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:Ja}}},Yve={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,i){t[i]=!e}}}},Jve={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:Ja}}},Kve={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:vp}}},Xve={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:Ja}}},Qve={value:null,type:$he,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:Ja}}};function ebe(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const UU={write:{enabled:!0,layerContainerTypes:Ja},read:!0},$M={type:Number,json:{origins:{"web-document":UU,"portal-item":{write:!0}}}},tbe={...$M,json:{...$M.json,origins:{"web-document":{...UU,write:{enabled:!0,layerContainerTypes:Ja,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,i)=>{var r;return i&&i.origin!=="service"||!t.drawingInfo||t.drawingInfo.transparency===void 0?(r=t.layerDefinition)!=null&&r.drawingInfo&&t.layerDefinition.drawingInfo.transparency!==void 0?yw(t.layerDefinition.drawingInfo.transparency):void 0:yw(t.drawingInfo.transparency)}}}},ibe={type:x_,readOnly:!0,get(){var p,g,S;const e=((p=this.layer)==null?void 0:p.timeInfo)!=null?this.layer:((g=this.i3slayer)==null?void 0:g.timeInfo)!=null?this.i3slayer:null;if(e==null)return null;const{datesInUnknownTimezone:t,timeOffset:i,useViewTime:r}=e,s=(S=this.view)==null?void 0:S.timeExtent;let n=e.timeExtent;t&&(n=Ahe(n));let c=r?s&&n?s.intersection(n):s||n:n;if(!c||c.isEmpty||c.isAllTime)return c;i&&(c=c.offset(-i.value,i.unit)),t&&(c=Mhe(c));const o=this._get("timeExtent");return c.equals(o)?o:c}},rbe={type:Bi,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const i=Bi.fromJSON(e);return t.spatialReference!=null&&typeof t.spatialReference=="object"&&(i.spatialReference=mi.fromJSON(t.spatialReference)),i}}}},read:!1}},sbe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},nbe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:Ja}}},name:"layerDefinition.minScale",write:!0}},obe={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:Ja}}},name:"layerDefinition.maxScale",write:!0}},khe={json:{write:{ignoreOrigin:!0,layerContainerTypes:Ja},origins:{"web-map":{read:!1,write:!1}}}},Rhe=e=>{let t=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,r,s){var n;return((n=s==null?void 0:s.portalItem)==null?void 0:n.type)==="Group Layer"?void 0:i}writeListMode(i,r,s,n){(n&&n.layerContainerType==="ground"||i&&kq(this,s,{},n))&&(r[s]=i)}writeOperationalLayerType(i,r,s,n){i&&(n==null?void 0:n.layerContainerType)!=="tables"&&(r.layerType=i)}writeTitle(i,r){r.title=i??"Layer"}read(i,r){r&&(r.layer=this),Pq(this,i,s=>super.read(i,s),r)}write(i,r){var c,o;if(!this.persistenceEnabled)return null;if(r!=null&&r.origin){const p=`${r.origin}/${r.layerContainerType||"operational-layers"}`,g=Ihe[p];let S=!!(g!=null&&g[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&p==="web-scene/operational-layers"&&(S=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&p==="web-map/operational-layers"&&(S=!1),!S)return(c=r.messages)==null||c.push(new Je("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${p}'`,{layer:this})),null}const s=super.write(i,{...r,layer:this}),n=!!r&&!!r.messages&&!!r.messages.filter(p=>p instanceof Je&&p.name==="web-document-write:property-required").length;return hx(s==null?void 0:s.url)?((o=r==null?void 0:r.messages)==null||o.push(new Je("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:s}beforeSave(){}};return v([I({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),v([fi("id",["id"])],t.prototype,"readId",null),v([I(khe)],t.prototype,"listMode",void 0),v([ci("listMode")],t.prototype,"writeListMode",null),v([I({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:Ja}}}}})],t.prototype,"operationalLayerType",void 0),v([ci("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),v([I($M)],t.prototype,"opacity",void 0),v([I({type:Boolean,readOnly:!1})],t.prototype,"persistenceEnabled",void 0),v([I({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),v([ci("title"),ci(["web-scene"],"title")],t.prototype,"writeTitle",null),v([I({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:Ja}}},name:"visibility",write:!0}})],t.prototype,"visible",void 0),t=v([me("esri.layers.mixins.OperationalLayer")],t),t};async function Ohe(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return Qf(e);const i=mi.WGS84;return await u3(t,i),Ah(e,i)}function Lhe(e,t){if(!jU(e,t)){const i=e.typeKeywords;i?i.push(t):e.typeKeywords=[t]}}function jU(e,t){var i;return!!((i=e.typeKeywords)!=null&&i.includes(t))}function abe(e){return jU(e,Nhe.HOSTED_SERVICE)}function Dhe(e,t){const i=e.typeKeywords;if(i){const r=i.indexOf(t);r>-1&&i.splice(r,1)}}function lbe(e,t,i){i?Lhe(e,t):Dhe(e,t)}async function cbe(e){const t=e.clone().normalize();let i;if(t.length>1)for(const r of t)i?r.width>i.width&&(i=r):i=r;else i=t[0];return Ohe(i)}const Nhe={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function HO(e){var p;const{portal:t,isOrgItem:i,itemControl:r}=e,s=(p=t.user)==null?void 0:p.privileges;let n=!s||s.includes("features:user:edit"),c=!!i&&!!(s!=null&&s.includes("features:user:fullEdit"));const o=r==="update"||r==="admin";return o?c=n=!0:c&&(n=!0),{features:{edit:n,fullEdit:c},content:{updateItem:o}}}const zhe=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=nr(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,r,s){if(r.itemId)return new m0({id:r.itemId,portal:s==null?void 0:s.portal})}writePortalItem(i,r){i!=null&&i.id&&(r.itemId=i.id)}async loadFromPortal(i,r){var s;if((s=this.portalItem)!=null&&s.id)try{const{load:n}=await ht(()=>import("./layersLoader-yL6SG8Ib.js"),__vite__mapDeps([249,8,5,3,4,2,6]));return dr(r),await n({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},r)}catch(n){throw qs(n)||_t.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(r=>(Na(r),!0)))}async setUserPrivileges(i,r){if(!Pi.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(r);if(this.url)try{const{features:{edit:s,fullEdit:n},content:{updateItem:c}}=await this._fetchUserPrivileges(i,r);this._set("userHasEditingPrivileges",s),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",c)}catch(s){Na(s)}}async _fetchUserPrivileges(i,r){let s=this.portalItem;if(!i||!s||!s.loaded||s.sourceUrl)return this._fetchFallbackUserPrivileges(r);const n=i===s.id;if(n&&s.portal.user)return HO(s);let c,o;if(n)c=s.portal.url;else try{c=await uZ(this.url,r)}catch(M){Na(M)}if(!c||!Kq(c,s.portal.url))return this._fetchFallbackUserPrivileges(r);try{const M=r!=null?r.signal:null;o=await(_i==null?void 0:_i.getCredential(`${c}/sharing`,{prompt:!1,signal:M}))}catch(M){Na(M)}const p=!0,g=!1,S=!1;if(!o)return{features:{edit:p,fullEdit:g},content:{updateItem:S}};try{if(n?await s.reload():(s=new m0({id:i,portal:{url:c}}),await s.load(r)),s.portal.user)return HO(s)}catch(M){Na(M)}return{features:{edit:p,fullEdit:g},content:{updateItem:S}}}async _fetchFallbackUserPrivileges(i){let r=!0;try{r=await this._fetchUserHasEditingPrivileges(i)}catch(s){Na(s)}return{features:{edit:r,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const r=this.url?_i==null?void 0:_i.findCredential(this.url):null;if(!r)return!0;const s=Pv.credential===r?Pv.user:await this._fetchEditingUser(i);return Pv.credential=r,Pv.user=s,(s==null?void 0:s.privileges)==null||s.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var S,M;const r=(M=(S=this.portalItem)==null?void 0:S.portal)==null?void 0:M.user;if(r)return r;const s=_i.findServerInfo(this.url??"");if(!(s!=null&&s.owningSystemUrl))return null;const n=`${s.owningSystemUrl}/sharing/rest`,c=Wa.getDefault();if(c&&c.loaded&&ta(c.restUrl)===ta(n))return c.user;const o=`${n}/community/self`,p=i!=null?i.signal:null,g=await wA(Xi(o,{authMode:"no-prompt",query:{f:"json"},signal:p}));return g.ok?CA.fromJSON(g.value.data):null}read(i,r){r&&(r.layer=this),super.read(i,r)}write(i,r){var c;const s=r==null?void 0:r.portal,n=((c=this.portalItem)==null?void 0:c.id)&&(this.portalItem.portal||Wa.getDefault());return s&&n&&!O4(n.restUrl,s.restUrl)?(r.messages&&r.messages.push(new Je("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...r,layer:this})}};return v([I({type:m0})],t.prototype,"portalItem",null),v([fi("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),v([ci("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),v([I({clonable:!1})],t.prototype,"resourceReferences",void 0),v([I({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),v([I({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),v([I({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=v([me("esri.layers.mixins.PortalLayer")],t),t},Pv={credential:null,user:null},Fhe=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&Bhe(i,r.effectiveScaleRange);const s=this._get("effectiveScaleRange");return s&&s.minScale===i.minScale&&s.maxScale===i.maxScale?s:i}};return v([I({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),v([I({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),v([I({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=v([me("esri.layers.mixins.ScaleRangeLayer")],t),t};function Bhe(e,t){return e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale,e}let Cv=null;function Uhe(e){if(Cv)return Cv;const t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return Cv=new Promise(i=>{const r=new Image;r.onload=()=>{r.onload=r.onerror=null,i(r.width>0&&r.height>0)},r.onerror=()=>{r.onload=r.onerror=null,i(!1)},r.src="data:image/webp;base64,"+t[e]}),Cv}const WO=1.15;let ZO=class{constructor(t,i){this._spriteSource=t,this._maxTextureSize=i,this.devicePixelRatio=1,this._spriteImageFormat="png",this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded",t.type==="url"&&t.spriteFormat&&(this._spriteImageFormat=t.spriteFormat),t.pixelRatio&&(this.devicePixelRatio=t.pixelRatio),this.baseURL=t.spriteUrl}get spriteNames(){const t=[];for(const i in this._spritesData)t.push(i);return t.sort(),t}getSpriteInfo(t){return this._spritesData?this._spritesData[t]:null}async load(t){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(t),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"}async _loadSprites(t){this._isRetina=this.devicePixelRatio>WO;const{width:i,height:r,data:s,json:n}=await this._getSpriteData(this._spriteSource,t),c=Object.keys(n);if(!c||c.length===0||!s)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=n,this.width=i,this.height=r;const o=Math.max(this._maxTextureSize,4096);if(i>o||r>o){const g=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${o} pixels}`;throw _t.getLogger("esri.layers.support.SpriteSource").error(g),new Je("SpriteSource",g)}let p;for(let g=0;g<s.length;g+=4)p=s[g+3]/255,s[g]=s[g]*p,s[g+1]=s[g+1]*p,s[g+2]=s[g+2]*p;this.image=s}async _getSpriteData(t,i){if(t.type==="image"){let S,M;if(this.devicePixelRatio<WO){if(!t.spriteSource1x)throw new Je("SpriteSource","no image data provided for low resolution sprites!");S=t.spriteSource1x.image,M=t.spriteSource1x.json}else{if(!t.spriteSource2x)throw new Je("SpriteSource","no image data provided for high resolution sprites!");S=t.spriteSource2x.image,M=t.spriteSource2x.json}return"width"in S&&"height"in S&&"data"in S&&(E7(S.data)||ZM(S.data))?{width:S.width,height:S.height,data:new Uint8Array(S.data),json:M}:{...YO(S),json:M}}const r=Mr(this.baseURL),s=r.query?"?"+up(r.query):"",n=this._isRetina?"@2x":"",c=`${r.path}${n}.${this._spriteImageFormat}${s}`,o=`${r.path}${n}.json${s}`,[p,g]=await Promise.all([Xi(o,i),Xi(c,{responseType:"image",...i})]);return{...YO(g.data),json:p.data}}};function YO(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(r.data)}}let jhe=class{constructor(t){this.url=t}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||(this._tileIndexPromise=Xi(this.url).then(t=>t.data.index)),this._tileIndexPromise}async dataKey(t,i){const r=await this.fetchTileIndex();return dr(i),this._getIndexedDataKey(r,t)}_getIndexedDataKey(t,i){const r=[i];if(i.level<0||i.row<0||i.col<0||i.row>>i.level>0||i.col>>i.level>0)return null;let s=i;for(;s.level!==0;)s=new zl(s.level-1,s.row>>1,s.col>>1,s.world),r.push(s);let n,c,o=t,p=r.pop();if(o===1)return p;for(;r.length;)if(n=r.pop(),c=(1&n.col)+((1&n.row)<<1),o){if(o[c]===0){p=null;break}if(o[c]===1){p=n;break}p=n,o=o[c]}return p}},Vhe=class{constructor(t,i){this._tilemap=t,this._tileIndexUrl=i}destroy(){this._tilemap=nr(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(t){return this._tileIndexPromise||(this._tileIndexPromise=Xi(this._tileIndexUrl,{query:{...t==null?void 0:t.query}}).then(i=>i.data.index)),this._tileIndexPromise}dataKey(t,i){const{level:r,row:s,col:n}=t,c=new zl(t);return this._tilemap.fetchAvailabilityUpsample(r,s,n,c,i).then(()=>(c.world=t.world,c)).catch(o=>{if(qs(o))throw o;return null})}},Ghe=class{constructor(t){this._tileUrl=t,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(t){var r;(this._promise==null||ra((r=this._abortController)==null?void 0:r.signal))&&(this._promise=this._makeRequest(this._tileUrl));const i=this._abortOptions;return i.push(t),eo(t,()=>{i.every(s=>ra(s))&&this._abortController.abort()}),this._promise.then(s=>He(s))}async _makeRequest(t){this._abortController=new AbortController;const{data:i}=await Xi(t,{responseType:"array-buffer",signal:this._abortController.signal});return i}};const JO=new Map;function qhe(e,t,i,r,s){const n=Mr(e),c=n.query;if(c)for(const[p,g]of Object.entries(c))switch(g){case"{x}":c[p]=r.toString();break;case"{y}":c[p]=i.toString();break;case"{z}":c[p]=t.toString()}const o=n.path;return Hhe(Al(o.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,i.toString()).replaceAll(/\{x\}/gi,r.toString()),{...n.query}),s)}function Hhe(e,t){return rA(JO,e,()=>new Ghe(e)).getData(t).finally(()=>JO.delete(e))}let Whe=class{constructor(t,i,r){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=t,this.sourceUrl=i;const s=Mr(this.sourceUrl),n=He(r),c=n.tiles;if(s)for(let A=0;A<c.length;A++){const O=Mr(c[A]);O&&(Nn(O.path)||(O.path=hp(s.path,O.path)),c[A]=Al(O.path,{...s.query,...O.query}))}this.tileServers=c;const o=r.capabilities&&r.capabilities.split(",").map(A=>A.toLowerCase().trim()),p=(r==null?void 0:r.exportTilesAllowed)===!0,g=(o==null?void 0:o.includes("tilemap"))===!0,S=p&&r.hasOwnProperty("maxExportTilesCount")?r.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:p,supportsTileMap:g},exportTiles:p?{maxExportTilesCount:+S}:null},this.tileInfo=xp.fromJSON(n.tileInfo);const M=r.tileMap?Al(hp(s.path,r.tileMap),s.query??{}):null;g?(this.type="vector-tile",this.tilemap=new Vhe(new Wo({layer:{parsedUrl:s,tileInfo:this.tileInfo},minLOD:n.minLOD??this.tileInfo.lods[0].level,maxLOD:n.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),M)):M&&(this.tilemap=new jhe(M)),this.fullExtent=Bi.fromJSON(r.fullExtent),this.initialExtent=Bi.fromJSON(r.initialExtent)}destroy(){var t;(t=this.tilemap)==null||t.destroy()}async getRefKey(t,i){var r;return await((r=this.tilemap)==null?void 0:r.dataKey(t,i))??t}requestTile(t,i,r,s){const n=this.tileServers[i%this.tileServers.length];return qhe(n,t,i,r,s)}isCompatibleWith(t){const i=this.tileInfo,r=t.tileInfo;if(!i.spatialReference.equals(r.spatialReference)||!i.origin.equals(r.origin)||Math.round(i.dpi)!==Math.round(r.dpi))return!1;const s=i.lods,n=r.lods,c=Math.min(s.length,n.length);for(let o=0;o<c;o++){const p=s[o],g=n[o];if(p.level!==g.level||Math.round(p.scale)!==Math.round(g.scale))return!1}return!0}};async function Zhe(e,t){const i={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[r,s]=typeof e=="string"?[e,null]:[null,e.jsonUrl];return await tp(i,"esri",e,s,t),{layerDefinition:i.validatedSource,url:r,serviceUrl:i.sourceUrl,style:i.style,styleUrl:i.styleUrl,spriteUrl:i.style.sprite&&Lm(i.styleBase,i.style.sprite),spriteFormat:i.spriteFormat,glyphsUrl:i.style.glyphs&&Lm(i.styleBase,i.style.glyphs),sourceNameToSource:i.sourceNameToSource,primarySourceName:i.primarySourceName}}function Lm(...e){let t;for(const i of e)i!=null&&(na(i)?t&&(t=t.split("://")[0]+":"+i.trim()):t=Nn(i)?i:hp(t,i));return t?dx(t):void 0}async function tp(e,t,i,r,s){let n,c,o;if(dr(s),typeof i=="string"){const g=ta(i);o=await Xi(g,{...s,responseType:"json",query:{f:"json",...s==null?void 0:s.query}}),o.ssl&&(n&&(n=n.replace(/^http:/i,"https:")),c&&(c=c.replace(/^http:/i,"https:"))),n=g,c=g}else i!=null&&(o={data:i},n=i.jsonUrl||null,c=r);const p=o==null?void 0:o.data;if(GU(p))return e.styleUrl=n||null,Jhe(e,p,c,s);if(Yhe(p))return e.sourceUrl?KO(e,p,c,!1,t,s):(e.sourceUrl=n||null,KO(e,p,c,!0,t,s));throw new Error("You must specify the URL or the JSON for a service or for a style.")}function VU(e){return typeof e=="object"&&!!e&&"tilejson"in e&&e.tilejson!=null}function GU(e){return!!e&&"sources"in e&&!!e.sources}function Yhe(e){return!GU(e)}async function Jhe(e,t,i,r){const s=i?aH(i):k4();e.styleBase=s,e.style=t,t["sprite-format"]&&t["sprite-format"].toLowerCase()==="webp"&&(e.spriteFormat="webp");const n=[];if(t.sources&&t.sources.esri){const c=t.sources.esri;c.url?await tp(e,"esri",Lm(s,c.url),void 0,r):n.push(tp(e,"esri",c,s,r))}for(const c of Object.keys(t.sources))c!=="esri"&&t.sources[c].type==="vector"&&(t.sources[c].url?n.push(tp(e,c,Lm(s,t.sources[c].url),void 0,r)):t.sources[c].tiles&&n.push(tp(e,c,t.sources[c],s,r)));await Promise.all(n)}async function KO(e,t,i,r,s,n){const c=i?dx(i)+"/":k4(),o=Khe(t),p=new Whe(s,Al(c,(n==null?void 0:n.query)??{}),o);if(!r&&e.primarySourceName in e.sourceNameToSource){const g=e.sourceNameToSource[e.primarySourceName];if(!g.isCompatibleWith(p))return;p.fullExtent!=null&&(g.fullExtent!=null?g.fullExtent.union(p.fullExtent):g.fullExtent=p.fullExtent.clone()),g.tileInfo&&p.tileInfo&&g.tileInfo.lods.length<p.tileInfo.lods.length&&(g.tileInfo=p.tileInfo)}if(r&&(e.sourceBase=c,e.source=t,e.validatedSource=o,e.primarySourceName=s),e.sourceNameToSource[s]=p,!VU(e)&&"defaultStyles"in t&&!e.style){if(t.defaultStyles==null)throw new Error;return typeof t.defaultStyles=="string"?tp(e,"",Lm(c,t.defaultStyles,"root.json"),void 0,n):tp(e,"",t.defaultStyles,Lm(c,"root.json"),n)}}function Khe(e){if(e.hasOwnProperty("tileInfo"))return e;const t={xmin:-20037507067161843e-9,ymin:-20037507067161843e-9,xmax:20037507067161843e-9,ymax:20037507067161843e-9,spatialReference:{wkid:102100,latestWkid:3857}};let i=null;if(VU(e)){const{bounds:S}=e;if(S){const M=Dc({x:S[0],y:S[1],spatialReference:He(uw)}),A=Dc({x:S[2],y:S[3],spatialReference:He(uw)});i={xmin:M.x,ymin:M.y,xmax:A.x,ymax:A.y,spatialReference:He(hw)}}}i===null&&(i=t);const r=512;let s=78271.51696400007,n=2958287637957775e-7;const c=[],o=e.hasOwnProperty("maxzoom")&&e.maxzoom!=null?+e.maxzoom:22,p=0,g=0;for(let S=0;S<=o;S++)c.push({level:S,scale:n,resolution:s}),s/=2,n/=2;return{capabilities:"TilesOnly",initialExtent:i,fullExtent:t,minScale:p,maxScale:g,tiles:e.tiles,tileInfo:{rows:r,cols:r,dpi:96,format:"pbf",origin:{x:-20037508342787e-6,y:20037508342787e-6},lods:c,spatialReference:He(hw)}}}function Xhe(e,t){return{...qU(e,t),readResourcePaths:[]}}function mbe(e,t,i){const r=Mr(e.itemUrl);return{...qU(e,t),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:r?{rootPath:r.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function qU(e,t){return{origin:t,url:Mr(e.itemUrl),portal:e.portal||Wa.getDefault(),portalItem:e}}const $v=1e-6;function Qhe(e,t){if(e===t)return!0;if(e==null&&t!=null||e!=null&&t==null||e==null||t==null||!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const i=e.origin,r=t.origin;if(Math.abs(i.x-r.x)>=$v||Math.abs(i.y-r.y)>=$v)return!1;let s,n;e.lods[0].scale>t.lods[0].scale?(s=e,n=t):(n=e,s=t);for(let c=s.lods[0].scale;c>=n.lods[n.lods.length-1].scale-$v;c/=2)if(Math.abs(c-n.lods[0].scale)<$v)return!0;return!1}function ede(e,t){if(e===t)return e;if(e==null&&t!=null)return t;if(e!=null&&t==null)return e;if(e==null||t==null)return null;const i=e.size[0],r=e.format,s=e.dpi,n=new ri({x:e.origin.x,y:e.origin.y}),c=e.spatialReference,o=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],p=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],g=o.scale,S=o.resolution,M=p.scale,A=[];let O=g,z=S,V=0;for(;O>M;)A.push(new $c({level:V,resolution:z,scale:O})),V++,O/=2,z/=2;return new xp({size:[i,i],dpi:s,format:r||"pbf",origin:n,lods:A,spatialReference:c})}var kM,RM,XO,QO,eL,tL,iL,rL,sL,nL,oL,aL,lL,cL,uL,hL,dL,pL,fL,mL,yL,gL,_L,vL,bL,wL,xL,SL,TL,EL,IL,ML,AL,PL,CL,$L,kL,RL,OL,LL,DL,NL,zL,FL,BL,UL,jL,VL,GL,qL,HL,WL,ZL,YL,JL,KL,XL,QL,eD,tD,iD;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(kM||(kM={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(RM||(RM={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(XO||(XO={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(QO||(QO={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(eL||(eL={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(tL||(tL={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(iL||(iL={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(rL||(rL={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(sL||(sL={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(nL||(nL={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(oL||(oL={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(aL||(aL={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(lL||(lL={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(cL||(cL={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(uL||(uL={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(hL||(hL={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(dL||(dL={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(pL||(pL={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(fL||(fL={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(mL||(mL={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(yL||(yL={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(gL||(gL={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(_L||(_L={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(vL||(vL={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(bL||(bL={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(wL||(wL={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(xL||(xL={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(SL||(SL={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(TL||(TL={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(EL||(EL={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(IL||(IL={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(ML||(ML={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(AL||(AL={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(PL||(PL={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(CL||(CL={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}($L||($L={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(kL||(kL={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(RL||(RL={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(OL||(OL={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(LL||(LL={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(DL||(DL={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(NL||(NL={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(zL||(zL={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(FL||(FL={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(BL||(BL={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(UL||(UL={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(jL||(jL={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(VL||(VL={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(GL||(GL={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(qL||(qL={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(HL||(HL={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(WL||(WL={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(ZL||(ZL={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(YL||(YL={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(JL||(JL={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(KL||(KL={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(XL||(XL={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(QL||(QL={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(eD||(eD={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(tD||(tD={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(iD||(iD={}));var Lr,Ud,OM,Rl,LM,Ww,DM,jd,NM;(function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"})(Lr||(Lr={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.NONE=1]="NONE"}(Ud||(Ud={})),function(e){e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.LINE_CENTER=2]="LINE_CENTER"}(OM||(OM={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT",e[e.AUTO=2]="AUTO"}(Rl||(Rl={})),function(e){e[e.AUTO=0]="AUTO",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT"}(LM||(LM={})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(Ww||(Ww={})),function(e){e[e.NONE=0]="NONE",e[e.UPPERCASE=1]="UPPERCASE",e[e.LOWERCASE=2]="LOWERCASE"}(DM||(DM={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT"}(jd||(jd={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(NM||(NM={}));let Yr=class{};Yr.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:Ud.VISIBLE}},Yr.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:Ud.VISIBLE}},Yr.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:Ud.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:kM.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:RM.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},Yr.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:Ud.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:OM.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:Ww.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:Rl.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:Ww.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:LM.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:Rl.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:DM.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[NM.HORIZONTAL]}},Yr.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:Ud.VISIBLE}},Yr.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},Yr.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:jd.MAP}},Yr.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:jd.MAP},"line-width":{type:"number",minimum:0,default:1}},Yr.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:jd.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:jd.MAP}},Yr.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},Yr.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:jd.MAP}};var rD,Vc,sD;(function(e){e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"})(rD||(rD={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.OUTLINE=2]="OUTLINE",e[e.LINE=3]="LINE",e[e.ICON=4]="ICON",e[e.CIRCLE=5]="CIRCLE",e[e.TEXT=6]="TEXT",e[e.TILEINFO=7]="TILEINFO"}(Vc||(Vc={})),function(e){e[e.PAINTER_CHANGED=0]="PAINTER_CHANGED",e[e.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",e[e.LAYER_CHANGED=2]="LAYER_CHANGED",e[e.LAYER_REMOVED=3]="LAYER_REMOVED",e[e.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(sD||(sD={}));const tde=512;var Yo,Ts;(function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"})(Yo||(Yo={}));let js=class Cb{constructor(t,i){this.x=t,this.y=i}clone(){return new Cb(this.x,this.y)}equals(t,i){return t===this.x&&i===this.y}isEqual(t){return t.x===this.x&&t.y===this.y}setCoords(t,i){return this.x=t,this.y=i,this}normalize(){const t=this.x,i=this.y,r=Math.sqrt(t*t+i*i);return this.x/=r,this.y/=r,this}rightPerpendicular(){const t=this.x;return this.x=this.y,this.y=-t,this}leftPerpendicular(){const t=this.x;return this.x=-this.y,this.y=t,this}move(t,i){return this.x+=t,this.y+=i,this}assign(t){return this.x=t.x,this.y=t.y,this}assignAdd(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}assignSub(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}rotate(t,i){const r=this.x,s=this.y;return this.x=r*t-s*i,this.y=r*i+s*t,this}scale(t){return this.x*=t,this.y*=t,this}length(){const t=this.x,i=this.y;return Math.sqrt(t*t+i*i)}sub(t){return this.x-=t.x,this.y-=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}static distance(t,i){const r=i.x-t.x,s=i.y-t.y;return Math.sqrt(r*r+s*s)}static add(t,i){return new Cb(t.x+i.x,t.y+i.y)}static sub(t,i){return new Cb(t.x-i.x,t.y-i.y)}},kv=class{constructor(t,i,r){this.ratio=t,this.x=i,this.y=r}},_be=class{constructor(t,i,r,s=8,n=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=s,this._pixelMargin=n,this._tileSize=tde*s,this._dz=t,this._yPos=i,this._xPos=r}setPixelMargin(t){t!==this._pixelMargin&&(this._pixelMargin=t,this.setExtent(this._extent))}setExtent(t){this._extent=t,this._finalRatio=this._tileSize/t*(1<<this._dz);let i=this._pixelRatio*this._pixelMargin;i/=this._finalRatio;const r=t>>this._dz;i>r&&(i=r),this._margin=i,this._xmin=r*this._xPos-i,this._ymin=r*this._yPos-i,this._xmax=this._xmin+r+2*i,this._ymax=this._ymin+r+2*i}reset(t){this._type=t,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(t,i){this._pushLine(),this._prevIsIn=this._isIn(t,i),this._moveTo(t,i,this._prevIsIn),this._prevPt=new js(t,i),this._firstPt=new js(t,i),this._dist=0}lineTo(t,i){const r=this._isIn(t,i),s=new js(t,i),n=js.distance(this._prevPt,s);let c,o,p,g,S,M,A,O;if(r)this._prevIsIn?this._lineTo(t,i,!0):(c=this._prevPt,o=s,p=this._intersect(o,c),this._start=this._dist+n*(1-this._r),this._lineTo(p.x,p.y,!0),this._lineTo(o.x,o.y,!0));else if(this._prevIsIn)o=this._prevPt,c=s,p=this._intersect(o,c),this._lineTo(p.x,p.y,!0),this._lineTo(c.x,c.y,!1);else{const z=this._prevPt,V=s;if(z.x<=this._xmin&&V.x<=this._xmin||z.x>=this._xmax&&V.x>=this._xmax||z.y<=this._ymin&&V.y<=this._ymin||z.y>=this._ymax&&V.y>=this._ymax)this._lineTo(V.x,V.y,!1);else{const W=[];if((z.x<this._xmin&&V.x>this._xmin||z.x>this._xmin&&V.x<this._xmin)&&(g=(this._xmin-z.x)/(V.x-z.x),O=z.y+g*(V.y-z.y),O<=this._ymin?M=!1:O>=this._ymax?M=!0:W.push(new kv(g,this._xmin,O))),(z.x<this._xmax&&V.x>this._xmax||z.x>this._xmax&&V.x<this._xmax)&&(g=(this._xmax-z.x)/(V.x-z.x),O=z.y+g*(V.y-z.y),O<=this._ymin?M=!1:O>=this._ymax?M=!0:W.push(new kv(g,this._xmax,O))),(z.y<this._ymin&&V.y>this._ymin||z.y>this._ymin&&V.y<this._ymin)&&(g=(this._ymin-z.y)/(V.y-z.y),A=z.x+g*(V.x-z.x),A<=this._xmin?S=!1:A>=this._xmax?S=!0:W.push(new kv(g,A,this._ymin))),(z.y<this._ymax&&V.y>this._ymax||z.y>this._ymax&&V.y<this._ymax)&&(g=(this._ymax-z.y)/(V.y-z.y),A=z.x+g*(V.x-z.x),A<=this._xmin?S=!1:A>=this._xmax?S=!0:W.push(new kv(g,A,this._ymax))),W.length===0)S?M?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):M?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(W.length>1&&W[0].ratio>W[1].ratio)this._start=this._dist+n*W[1].ratio,this._lineTo(W[1].x,W[1].y,!0),this._lineTo(W[0].x,W[0].y,!0);else{this._start=this._dist+n*W[0].ratio;for(let ie=0;ie<W.length;ie++)this._lineTo(W[ie].x,W[ie].y,!0)}this._lineTo(V.x,V.y,!1)}}this._dist+=n,this._prevIsIn=r,this._prevPt=s}close(){if(this._line.length>2){const t=this._firstPt,i=this._prevPt;t.x===i.x&&t.y===i.y||this.lineTo(t.x,t.y);const r=this._line;let s=r.length;for(;s>=4&&(r[0].x===r[1].x&&r[0].x===r[s-2].x||r[0].y===r[1].y&&r[0].y===r[s-2].y);)r.pop(),r[0].x=r[s-2].x,r[0].y=r[s-2].y,--s}}result(t=!0){return this._pushLine(),this._lines.length===0?null:(this._type===Yo.Polygon&&t&&ide.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==Yo.LineString)throw new Error("Only valid for lines");this._pushLine();const t=this._lines,i=t.length;if(i===0)return null;const r=[];for(let s=0;s<i;s++)r.push({line:t[s],start:this._starts[s]||0});return r}_isIn(t,i){return t>=this._xmin&&t<=this._xmax&&i>=this._ymin&&i<=this._ymax}_intersect(t,i){let r,s,n;if(i.x>=this._xmin&&i.x<=this._xmax)s=i.y<=this._ymin?this._ymin:this._ymax,n=(s-t.y)/(i.y-t.y),r=t.x+n*(i.x-t.x);else if(i.y>=this._ymin&&i.y<=this._ymax)r=i.x<=this._xmin?this._xmin:this._xmax,n=(r-t.x)/(i.x-t.x),s=t.y+n*(i.y-t.y);else{s=i.y<=this._ymin?this._ymin:this._ymax,r=i.x<=this._xmin?this._xmin:this._xmax;const c=(r-t.x)/(i.x-t.x),o=(s-t.y)/(i.y-t.y);c<o?(n=c,s=t.y+c*(i.y-t.y)):(n=o,r=t.x+o*(i.x-t.x))}return this._r=n,new js(r,s)}_pushLine(){this._line&&(this._type===Yo.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Yo.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Yo.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(t,i,r){this._type!==Yo.Polygon?r&&(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.push(new js(t,i))):(r||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),i<this._ymin&&(i=this._ymin),i>this._ymax&&(i=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.push(new js(t,i)),this._isH=!1,this._isV=!1)}_lineTo(t,i,r){let s,n;if(this._type!==Yo.Polygon)if(r){if(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(s=this._line[this._line.length-1],s.equals(t,i)))return;this._line.push(new js(t,i))}else this._line&&this._line.length>0&&this._pushLine();else if(r||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),i<this._ymin&&(i=this._ymin),i>this._ymax&&(i=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){s=this._line[this._line.length-1];const c=s.x===t,o=s.y===i;if(c&&o)return;this._isH&&c||this._isV&&o?(s.x=t,s.y=i,n=this._line[this._line.length-2],n.x===t&&n.y===i?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(n=this._line[this._line.length-2],this._isH=n.x===t,this._isV=n.y===i)):(this._isH=n.x===t,this._isV=n.y===i)):(this._line.push(new js(t,i)),this._isH=c,this._isV=o)}else this._line.push(new js(t,i))}},bbe=class{setExtent(t){this._ratio=t===4096?1:4096/t}get validateTessellation(){return this._ratio<1}reset(t){this._lines=[],this._line=null}moveTo(t,i){this._line&&this._lines.push(this._line),this._line=[];const r=this._ratio;this._line.push(new js(t*r,i*r))}lineTo(t,i){const r=this._ratio;this._line.push(new js(t*r,i*r))}close(){const t=this._line;t&&!t[0].isEqual(t[t.length-1])&&t.push(t[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}};(function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"})(Ts||(Ts={}));let ide=class Zu{static simplify(t,i,r){if(!r)return;const s=-i,n=t+i,c=-i,o=t+i,p=[],g=[],S=r.length;for(let A=0;A<S;++A){const O=r[A];if(!O||O.length<2)continue;let z,V=O[0];const W=O.length;for(let ie=1;ie<W;++ie)z=O[ie],V.x===z.x&&(V.x<=s&&(V.y>z.y?(p.push(A),p.push(ie),p.push(Ts.sideLeft),p.push(-1)):(g.push(A),g.push(ie),g.push(Ts.sideLeft),g.push(-1))),V.x>=n&&(V.y<z.y?(p.push(A),p.push(ie),p.push(Ts.sideRight),p.push(-1)):(g.push(A),g.push(ie),g.push(Ts.sideRight),g.push(-1)))),V.y===z.y&&(V.y<=c&&(V.x<z.x?(p.push(A),p.push(ie),p.push(Ts.sideTop),p.push(-1)):(g.push(A),g.push(ie),g.push(Ts.sideTop),g.push(-1))),V.y>=o&&(V.x>z.x?(p.push(A),p.push(ie),p.push(Ts.sideBottom),p.push(-1)):(g.push(A),g.push(ie),g.push(Ts.sideBottom),g.push(-1)))),V=z}if(p.length===0||g.length===0)return;Zu.fillParent(r,g,p),Zu.fillParent(r,p,g);const M=[];Zu.calcDeltas(M,g,p),Zu.calcDeltas(M,p,g),Zu.addDeltas(M,r)}static fillParent(t,i,r){const s=r.length,n=i.length;for(let c=0;c<n;c+=4){const o=i[c],p=i[c+1],g=i[c+2],S=t[o][p-1],M=t[o][p];let A=8092,O=-1;for(let z=0;z<s;z+=4){if(r[z+2]!==g)continue;const V=r[z],W=r[z+1],ie=t[V][W-1],ve=t[V][W];switch(g){case Ts.sideLeft:case Ts.sideRight:if(Rv(S.y,ie.y,ve.y)&&Rv(M.y,ie.y,ve.y)){const pe=Math.abs(ve.y-ie.y);pe<A&&(A=pe,O=z)}break;case Ts.sideTop:case Ts.sideBottom:if(Rv(S.x,ie.x,ve.x)&&Rv(M.x,ie.x,ve.x)){const pe=Math.abs(ve.x-ie.x);pe<A&&(A=pe,O=z)}}}i[c+3]=O}}static calcDeltas(t,i,r){const s=i.length;for(let n=0;n<s;n+=4){const c=[],o=Zu.calcDelta(n,i,r,c);t.push(i[n]),t.push(i[n+1]),t.push(i[n+2]),t.push(o)}}static calcDelta(t,i,r,s){const n=i[t+3];if(n===-1)return 0;const c=s.length;return c>1&&s[c-2]===n?0:(s.push(n),Zu.calcDelta(n,r,i,s)+1)}static addDeltas(t,i){const r=t.length;let s=0;for(let n=0;n<r;n+=4){const c=t[n+3];c>s&&(s=c)}for(let n=0;n<r;n+=4){const c=i[t[n]],o=t[n+1],p=s-t[n+3];switch(t[n+2]){case Ts.sideLeft:c[o-1].x-=p,c[o].x-=p,o===1&&(c[c.length-1].x-=p),o===c.length-1&&(c[0].x-=p);break;case Ts.sideRight:c[o-1].x+=p,c[o].x+=p,o===1&&(c[c.length-1].x+=p),o===c.length-1&&(c[0].x+=p);break;case Ts.sideTop:c[o-1].y-=p,c[o].y-=p,o===1&&(c[c.length-1].y-=p),o===c.length-1&&(c[0].y-=p);break;case Ts.sideBottom:c[o-1].y+=p,c[o].y+=p,o===1&&(c[c.length-1].y+=p),o===c.length-1&&(c[0].y+=p)}}}};const Rv=(e,t,i)=>e>=t&&e<=i||e>=i&&e<=t,xbe=Number.POSITIVE_INFINITY,sP=Math.PI,Sbe=2*sP,rde=128/sP,sde=256/360,Tbe=sP/180,nde=1/Math.LN2;function HU(e,t){return(e%=t)>=0?e:e+t}function Ebe(e){return HU(e*rde,256)}function Ibe(e){return HU(e*sde,256)}function Mbe(e){return Math.log(e)*nde}function An(e,t,i){return e*(1-i)+t*i}const ode=8,ade=14,lde=16;function Abe(e){return ode+Math.max((e-ade)*lde,0)}function cde(e,t,i){let r,s,n,c=0;for(const o of i){r=o.length;for(let p=1;p<r;++p)s=o[p-1],n=o[p],s.y>t!=n.y>t&&((n.x-s.x)*(t-s.y)-(n.y-s.y)*(e-s.x)>0?c++:c--)}return c!==0}function WU(e,t,i,r){let s,n,c,o;const p=r*r;for(const g of i){const S=g.length;if(!(S<2)){s=g[0].x,n=g[0].y;for(let M=1;M<S;++M){if(c=g[M].x,o=g[M].y,VJ(e,t,s,n,c,o)<p)return!0;s=c,n=o}}}return!1}function Pbe(e,t,i,r,s,n,c){const o=Math.max(r,Math.min(t,n))-t,p=Math.max(s,Math.min(i,c))-i;return o*o+p*p<=e*e}function ude(e,t){if(t===0||Number.isNaN(t))return e;const i=[],r=new js(0,0),s=new js(0,0),n=new js(0,0);for(let c=0;c<e.length;c++){const o=e[c],p=[];for(let g=0;g<o.length;g++){const S=o[g-1],M=o[g],A=o[g+1];g===0?r.setCoords(0,0):r.assignSub(M,S).normalize().rightPerpendicular(),g===o.length-1?s.setCoords(0,0):s.assignSub(A,M).normalize().rightPerpendicular(),n.assignAdd(r,s).normalize();const O=n.x*s.x+n.y*s.y;O!==0&&n.scale(1/O),p.push(js.add(M,n.scale(t)))}i.push(p)}return i}function nP(e,t,i,r){const s=new js(e[0],e[1]);if(s.scale(r),t==="viewport"){const n=-i*(Math.PI/180),c=Math.cos(n),o=Math.sin(n);s.rotate(c,o)}return s}let hde=class{constructor(t){this._array=[],t<=0&&console.error("strideInBytes must be positive!"),this._stride=t}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(t,i){return 65535&t|i<<16}static i8888to32(t,i,r,s){return 255&t|(255&i)<<8|(255&r)<<16|s<<24}static i8816to32(t,i,r){return 255&t|(255&i)<<8|r<<16}};var St,Vd;(function(e){e[e.R8_SIGNED=0]="R8_SIGNED",e[e.R8_UNSIGNED=1]="R8_UNSIGNED",e[e.R16_SIGNED=2]="R16_SIGNED",e[e.R16_UNSIGNED=3]="R16_UNSIGNED",e[e.R8G8_SIGNED=4]="R8G8_SIGNED",e[e.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",e[e.R16G16_SIGNED=6]="R16G16_SIGNED",e[e.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",e[e.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",e[e.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",e[e.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",e[e.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",e[e.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"})(St||(St={})),function(e){e[e.UNIFORM=0]="UNIFORM",e[e.DATA_DRIVEN=1]="DATA_DRIVEN",e[e.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",e[e.UNUSED=3]="UNUSED"}(Vd||(Vd={}));var nD,oD,aD,lD,cD,uD,hD,di,dD,pD,fD,mD,yD,gD,_D,vD,bD,wD,xD,SD;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT"})(nD||(nD={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(oD||(oD={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(aD||(aD={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(lD||(lD={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(cD||(cD={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(uD||(uD={})),function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"}(hD||(hD={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(di||(di={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(dD||(dD={})),function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"}(pD||(pD={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(fD||(fD={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(mD||(mD={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(yD||(yD={})),function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"}(gD||(gD={})),function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"}(_D||(_D={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(vD||(vD={})),function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(bD||(bD={})),function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"}(wD||(wD={})),function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"}(xD||(xD={})),function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(SD||(SD={}));const $be=33984;var TD,ED,ID;(function(e){e[e.Texture=0]="Texture",e[e.BufferObject=1]="BufferObject",e[e.VertexArrayObject=2]="VertexArrayObject",e[e.Shader=3]="Shader",e[e.Program=4]="Program",e[e.FramebufferObject=5]="FramebufferObject",e[e.Renderbuffer=6]="Renderbuffer",e[e.TransformFeedback=7]="TransformFeedback",e[e.Sync=8]="Sync",e[e.UNCOUNTED=9]="UNCOUNTED",e[e.LinesOfCode=9]="LinesOfCode",e[e.Uniform=10]="Uniform",e[e.COUNT=11]="COUNT"})(TD||(TD={})),function(e){e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(ED||(ED={})),function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"}(ID||(ID={}));const kbe=33306;var MD,AD,PD,CD,$D,kD,RD;(function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(MD||(MD={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(AD||(AD={})),function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"}(PD||(PD={})),function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"}(CD||(CD={})),function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"}($D||($D={})),function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(kD||(kD={})),function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(RD||(RD={}));let Gs=class{constructor(t,i,r,s,n,c=!1,o=0){this.name=t,this.count=i,this.type=r,this.offset=s,this.stride=n,this.normalized=c,this.divisor=o}},$h=class zM{constructor(t){this._locations=new Map,this._key=t}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return this._locations.size===0&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(t,i,r,s,n){const c=this.getUniforms();for(const o of c){const{name:p,type:g,getValue:S}=o,M=S(r,i,s,n);if(M!==null)switch(g){case"float":t.setUniform1f(p,M);break;case"vec2":t.setUniform2fv(p,M);break;case"vec4":t.setUniform4fv(p,M)}}}encodeAttributes(t,i,r,s){var S;const n=this.attributesInfo(),c=this.getEncodingInfos(),o=[];let p=0,g=0;for(const M of Object.keys(c)){const A=c[M],{type:O,precisionFactor:z,isLayout:V}=n[M],W=V?r.getLayoutProperty(M):r.getPaintProperty(M),ie=(S=W.interpolator)==null?void 0:S.getInterpolationRange(i);let ve=0;for(const pe of A){const{offset:_e,bufferElementsToAdd:Me}=pe;if(Me>0){for(let Fe=0;Fe<Me;Fe++)o.push(0);p+=g,g=pe.bufferElementsToAdd}const $e=s??W.getValue(ie?ie[ve]:i,t);switch(O){case St.R8_SIGNED:case St.R8_UNSIGNED:o[p]|=this._encodeByte($e*(z||1),8*_e);break;case St.R16_SIGNED:case St.R16_UNSIGNED:o[p]|=this._encodeShort($e*(z||1),8*_e);break;case St.R8G8_SIGNED:case St.R8G8_UNSIGNED:o[p]|=this._encodeByte($e*(z||1),8*_e),o[p]|=this._encodeByte($e*(z||1),8*_e+8);break;case St.R16G16_SIGNED:case St.R16G16_UNSIGNED:o[p]|=this._encodeShort($e*(z||1),8*_e),o[p]|=this._encodeShort($e*(z||1),8*_e+16);break;case St.R8G8B8A8_SIGNED:case St.R8G8B8A8_UNSIGNED:o[p]|=this._encodeByte($e*(z||1),8*_e),o[p]|=this._encodeByte($e*(z||1),8*_e+8),o[p]|=this._encodeByte($e*(z||1),8*_e+16),o[p]|=this._encodeByte($e*(z||1),8*_e+24);break;case St.R8G8B8A8_COLOR:o[p]=this._encodeColor($e);break;case St.R16G16B16A16_DASHARRAY:case St.R16G16B16A16_PATTERN:this._encodePattern(p,o,$e);break;default:throw new Error("Unsupported encoding type")}ve++}}return o}getAtributeState(t){let i=0;const r=3+2*t;return i|=this._bit(r),i|=this._bit(r+1)<<1,i}_buildAttributesInfo(){const t=[],i={},r={};let s=-1;const n=this.attributesInfo(),c=this.attributes();let o=-1;for(const M of c){o++;const A=this.getAtributeState(o);if(A===Vd.UNIFORM||A===Vd.UNUSED)continue;const O=n[M],z=[];i[M]=z;const V=O.type;for(let W=0;W<A;W++){const{dataType:ie,bytesPerElement:ve,count:pe,normalized:_e}=zM._encodingInfo[V],Me=ve*pe,$e=`${ie}-${_e===!0}`;let Fe=r[$e],Ge=0;if(!Fe||Fe.count+pe>4)s++,Fe={dataIndex:s,count:0,offset:0},pe!==4&&(r[$e]=Fe),t.push({location:-1,name:"a_data_"+s,count:pe,type:ie,normalized:_e}),Ge=Math.ceil(Math.max(Me/4,1));else{const et=t[Fe.dataIndex];et.count+=pe,Ge=Math.ceil(Math.max(et.count*ve/4,1))-Math.ceil(Math.max(Fe.offset/4,1))}z.push({dataIndex:Fe.dataIndex,offset:Fe.offset,bufferElementsToAdd:Ge}),Fe.offset+=Me,Fe.count+=pe}}for(const M of t)switch(M.type){case di.BYTE:case di.UNSIGNED_BYTE:M.count=4;break;case di.SHORT:case di.UNSIGNED_SHORT:M.count+=M.count%2}this._buildVertexBufferLayout(t);let p=0;const g=this._layoutInfo.geometry;for(const M of g)this._locations.set(M.name,p++);const S=this._layoutInfo.opacity;if(S)for(const M of S)this._locations.set(M.name,p++);this._buildShaderInfo(t,i),this._propertyEncodingInfo=i}_buildVertexBufferLayout(t){const i={},r=this.geometryInfo();let s=r[0].stride;if(t.length===0)i.geometry=r;else{const n=[];let c=s;for(const o of t)s+=OD(o.type)*o.count;for(const o of r)n.push(new Gs(o.name,o.count,o.type,o.offset,s,o.normalized));for(const o of t)n.push(new Gs(o.name,o.count,o.type,c,s,o.normalized)),c+=OD(o.type)*o.count;i.geometry=n}this.opacityInfo()&&(i.opacity=this.opacityInfo()),this._layoutInfo=i,this._stride=s}_buildShaderInfo(t,i){let r=`
`,s=`
`;const n=[];for(const g of t)r+=`attribute ${this._getType(g.count)} ${g.name};
`;const c=this.attributes(),o=this.attributesInfo();let p=-1;for(const g of c){p++;const{name:S,type:M,precisionFactor:A,isLayout:O}=o[g],z=A&&A!==1?" * "+1/A:"",{bytesPerElement:V,count:W}=zM._encodingInfo[M],ie=ve=>`a_data_${ve.dataIndex}${dde(W,ve.offset,V)}`;switch(this.getAtributeState(p)){case Vd.UNIFORM:{const ve=this._getType(W),pe=`u_${S}`;n.push({name:pe,type:ve,getValue:(_e,Me,$e,Fe)=>{const Ge=O?_e.getLayoutValue(g,Me):_e.getPaintValue(g,Me);if(M===St.R16G16B16A16_DASHARRAY){const et=_e.getDashKey(Ge,_e.getLayoutValue("line-cap",Me)),at=Fe.getMosaicItemPosition(et,!1);if(at==null)return null;const{tl:ct,br:nt}=at;return[ct[0],nt[1],nt[0],ct[1]]}if(M===St.R16G16B16A16_PATTERN){const et=Fe.getMosaicItemPosition(Ge,!g.includes("line-"));if(et==null)return null;const{tl:at,br:ct}=et;return[at[0],ct[1],ct[0],at[1]]}if(M===St.R8G8B8A8_COLOR){const et=Ge[3];return[et*Ge[0],et*Ge[1],et*Ge[2],et]}return Ge}}),r+=`uniform ${ve} ${pe};
`,s+=`${ve} ${S} = ${pe};
`}break;case Vd.DATA_DRIVEN:{const ve=ie(i[g][0]);s+=`${this._getType(W)} ${S} = ${ve}${z};
`}break;case Vd.INTERPOLATED_DATA_DRIVEN:{const ve=`u_t_${S}`;n.push({name:ve,type:"float",getValue:(Me,$e,Fe,Ge)=>(O?Me.getLayoutProperty(g):Me.getPaintProperty(g)).interpolator.interpolationUniformValue(Fe,$e)}),r+=`uniform float ${ve};
`;const pe=ie(i[g][0]),_e=ie(i[g][1]);s+=`${this._getType(W)} ${S} = mix(${pe}${z}, ${_e}${z}, ${ve});
`}}}this._shaderHeader=r,this._shaderMain=s,this._uniforms=n}_bit(t){return(this._key&1<<t)>>t}_getType(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(t){const i=255*t[3];return hde.i8888to32(t[0]*i,t[1]*i,t[2]*i,i)}_encodePattern(t,i,r){if(!(r!=null&&r.rect))return;const s=2,n=r.rect,c=r.width,o=r.height;i[t]=this._encodeShort(n.x+s,0),i[t]|=this._encodeShort(n.y+s+o,16),i[t+1]=this._encodeShort(n.x+s+c,0),i[t+1]|=this._encodeShort(n.y+s,16)}_encodeByte(t,i){return(255&t)<<i}_encodeShort(t,i){return(65535&t)<<i}};$h._encodingInfo={[St.R8_SIGNED]:{dataType:di.BYTE,bytesPerElement:1,count:1,normalized:!1},[St.R8_UNSIGNED]:{dataType:di.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[St.R16_SIGNED]:{dataType:di.SHORT,bytesPerElement:2,count:1,normalized:!1},[St.R16_UNSIGNED]:{dataType:di.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[St.R8G8_SIGNED]:{dataType:di.BYTE,bytesPerElement:1,count:2,normalized:!1},[St.R8G8_UNSIGNED]:{dataType:di.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[St.R16G16_SIGNED]:{dataType:di.SHORT,bytesPerElement:2,count:2,normalized:!1},[St.R16G16_UNSIGNED]:{dataType:di.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[St.R8G8B8A8_SIGNED]:{dataType:di.BYTE,bytesPerElement:1,count:4,normalized:!1},[St.R8G8B8A8_UNSIGNED]:{dataType:di.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[St.R8G8B8A8_COLOR]:{dataType:di.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[St.R16G16B16A16_DASHARRAY]:{dataType:di.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[St.R16G16B16A16_PATTERN]:{dataType:di.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const OD=e=>{switch(e){case di.FLOAT:case di.INT:case di.UNSIGNED_INT:return 4;case di.SHORT:case di.UNSIGNED_SHORT:return 2;case di.BYTE:case di.UNSIGNED_BYTE:return 1}},dde=(e,t,i)=>{const r=t/i;if(e===1)switch(r){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(e===2)switch(r){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(e===3)switch(r){case 0:return".xyz";case 1:return".yzw"}return""};let gm=class $b extends $h{constructor(t){super(t)}geometryInfo(){return $b.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return $b.ATTRIBUTES}attributesInfo(){return $b.ATTRIBUTES_INFO}};gm.ATTRIBUTES=[],gm.GEOMETRY_LAYOUT=[new Gs("a_pos",2,di.BYTE,0,2)],gm.ATTRIBUTES_INFO={};let _m=class kb extends $h{constructor(t){super(t)}geometryInfo(){return kb.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return kb.ATTRIBUTES}attributesInfo(){return kb.ATTRIBUTES_INFO}};_m.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],_m.GEOMETRY_LAYOUT=[new Gs("a_pos",2,di.SHORT,0,4)],_m.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:St.R8_UNSIGNED},"circle-color":{name:"color",type:St.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:St.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:St.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:St.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:St.R8_UNSIGNED,precisionFactor:32}};let vm=class Rb extends $h{constructor(t){super(t)}geometryInfo(){return Rb.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return Rb.ATTRIBUTES}attributesInfo(){return Rb.ATTRIBUTES_INFO}};vm.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],vm.GEOMETRY_LAYOUT=[new Gs("a_pos",2,di.SHORT,0,4)],vm.ATTRIBUTES_INFO={"fill-color":{name:"color",type:St.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:St.R16G16B16A16_PATTERN,isOptional:!0}};let Ml=class Kf extends $h{constructor(t,i){super(t),this._usefillColor=i}geometryInfo(){return Kf.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?Kf.ATTRIBUTES_FILL:Kf.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?Kf.ATTRIBUTES_INFO_FILL:Kf.ATTRIBUTES_INFO_OUTLINE}};Ml.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],Ml.ATTRIBUTES_FILL=["fill-color","fill-opacity"],Ml.GEOMETRY_LAYOUT=[new Gs("a_pos",2,di.SHORT,0,8),new Gs("a_offset",2,di.BYTE,4,8),new Gs("a_xnormal",2,di.BYTE,6,8)],Ml.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:St.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100}},Ml.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:St.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100}};let bm=class Ob extends $h{constructor(t){super(t)}geometryInfo(){return Ob.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return Ob.ATTRIBUTES}attributesInfo(){return Ob.ATTRIBUTES_INFO}};bm.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],bm.GEOMETRY_LAYOUT=[new Gs("a_pos",2,di.SHORT,0,16),new Gs("a_extrude_offset",4,di.BYTE,4,16),new Gs("a_dir_normal",4,di.BYTE,8,16),new Gs("a_accumulatedDistance",2,di.UNSIGNED_SHORT,12,16)],bm.ATTRIBUTES_INFO={"line-width":{name:"width",type:St.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:St.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:St.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:St.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:St.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:St.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:St.R16G16B16A16_DASHARRAY,isOptional:!0}};const ZU=[new Gs("a_pos",2,di.SHORT,0,16),new Gs("a_vertexOffset",2,di.SHORT,4,16),new Gs("a_texAngleRange",4,di.UNSIGNED_BYTE,8,16),new Gs("a_levelInfo",4,di.UNSIGNED_BYTE,12,16)],YU=[new Gs("a_opacityInfo",1,di.UNSIGNED_BYTE,0,1)];let C0=class FM extends $h{constructor(t){super(t)}geometryInfo(){return ZU}opacityInfo(){return YU}attributes(){return FM.ATTRIBUTES}attributesInfo(){return FM.ATTRIBUTES_INFO}};C0.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],C0.ATTRIBUTES_INFO={"icon-color":{name:"color",type:St.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:St.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:St.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:St.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:St.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};let $0=class BM extends $h{constructor(t){super(t)}geometryInfo(){return ZU}opacityInfo(){return YU}attributes(){return BM.ATTRIBUTES}attributesInfo(){return BM.ATTRIBUTES_INFO}};$0.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],$0.ATTRIBUTES_INFO={"text-color":{name:"color",type:St.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:St.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:St.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:St.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:St.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:St.R8_UNSIGNED,isLayout:!0}};function pde(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function fde(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function mde(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}function yde(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function JU(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function KU(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function XU(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function gde(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function _de(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function vde(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e}function bde(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e}function wde(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function xde(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function Sde(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e}function QU(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(i*i+r*r+s*s+n*n)}function e9(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return i*i+r*r+s*s+n*n}function t9(e){const t=e[0],i=e[1],r=e[2],s=e[3];return Math.sqrt(t*t+i*i+r*r+s*s)}function i9(e){const t=e[0],i=e[1],r=e[2],s=e[3];return t*t+i*i+r*r+s*s}function Tde(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Ede(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Ide(e,t){const i=t[0],r=t[1],s=t[2],n=t[3];let c=i*i+r*r+s*s+n*n;return c>0&&(c=1/Math.sqrt(c),e[0]=i*c,e[1]=r*c,e[2]=s*c,e[3]=n*c),e}function Mde(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ade(e,t,i,r){const s=t[0],n=t[1],c=t[2],o=t[3];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e[2]=c+r*(i[2]-c),e[3]=o+r*(i[3]-o),e}function Pde(e,t){const i=wx;let r,s,n,c,o,p;t=t||1;do r=2*i()-1,s=2*i()-1,o=r*r+s*s;while(o>=1);do n=2*i()-1,c=2*i()-1,p=n*n+c*c;while(p>=1);const g=Math.sqrt((1-o)/p);return e[0]=t*r,e[1]=t*s,e[2]=t*n*g,e[3]=t*c*g,e}function Cde(e,t,i){const r=t[0],s=t[1],n=t[2],c=t[3];return e[0]=i[0]*r+i[4]*s+i[8]*n+i[12]*c,e[1]=i[1]*r+i[5]*s+i[9]*n+i[13]*c,e[2]=i[2]*r+i[6]*s+i[10]*n+i[14]*c,e[3]=i[3]*r+i[7]*s+i[11]*n+i[15]*c,e}function $de(e,t,i){const r=t[0],s=t[1],n=t[2],c=i[0],o=i[1],p=i[2],g=i[3],S=g*r+o*n-p*s,M=g*s+p*r-c*n,A=g*n+c*s-o*r,O=-c*r-o*s-p*n;return e[0]=S*g+O*-c+M*-p-A*-o,e[1]=M*g+O*-o+A*-c-S*-p,e[2]=A*g+O*-p+S*-o-M*-c,e[3]=t[3],e}function kde(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Rde(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Ode(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],c=t[0],o=t[1],p=t[2],g=t[3],S=aa();return Math.abs(i-c)<=S*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-o)<=S*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-p)<=S*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(n-g)<=S*Math.max(1,Math.abs(n),Math.abs(g))}const Lde=JU,Dde=KU,Nde=XU,zde=QU,Fde=e9,Bde=t9,Ude=i9;Object.freeze(Object.defineProperty({__proto__:null,add:yde,ceil:gde,copy:pde,copyVec3:fde,dist:zde,distance:QU,div:Nde,divide:XU,dot:Mde,equals:Ode,exactEquals:Rde,floor:_de,inverse:Ede,len:Bde,length:t9,lerp:Ade,max:bde,min:vde,mul:Dde,multiply:KU,negate:Tde,normalize:Ide,random:Pde,round:wde,scale:xde,scaleAndAdd:Sde,set:mde,sqrDist:Fde,sqrLen:Ude,squaredDistance:e9,squaredLength:i9,str:kde,sub:Lde,subtract:JU,transformMat4:Cde,transformQuat:$de},Symbol.toStringTag,{value:"Module"}));function oP(){return[0,0,0,0]}function jde(e){return[e[0],e[1],e[2],e[3]]}function Km(e,t,i,r){return[e,t,i,r]}function Vde(e,t=oP()){const i=Math.min(4,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function Gde(e,t){return new Float64Array(e,t,4)}function r9(){return oP()}function s9(){return Km(1,1,1,1)}function n9(){return Km(1,0,0,0)}function o9(){return Km(0,1,0,0)}function a9(){return Km(0,0,1,0)}function l9(){return Km(0,0,0,1)}const qde=r9(),Hde=s9(),Wde=n9(),Zde=o9(),Yde=a9(),Jde=l9();Object.freeze(Object.defineProperty({__proto__:null,ONES:Hde,UNIT_W:Jde,UNIT_X:Wde,UNIT_Y:Zde,UNIT_Z:Yde,ZEROS:qde,clone:jde,create:oP,createView:Gde,fromArray:Vde,fromValues:Km,ones:s9,unitW:l9,unitX:n9,unitY:o9,unitZ:a9,zeros:r9},Symbol.toStringTag,{value:"Module"}));function Kde(e){return"r"in e&&"g"in e&&"b"in e}function c9(e){return"h"in e&&"s"in e&&"v"in e}function u9(e){return"l"in e&&"a"in e&&"b"in e}function h9(e){return"l"in e&&"c"in e&&"h"in e}function Xde(e){return"x"in e&&"y"in e&&"z"in e}const Qde=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],epe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function d9(e,t){const i=[];let r,s;if(e[0].length!==t.length)throw new Error("dimensions do not match");const n=e.length,c=e[0].length;let o=0;for(r=0;r<n;r++){for(o=0,s=0;s<c;s++)o+=e[r][s]*t[s];i.push(o)}return i}function p9(e){const t=[e.r/255,e.g/255,e.b/255].map(r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4),i=d9(Qde,t);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function aP(e){const t=d9(epe,[e.x/100,e.y/100,e.z/100]).map(i=>{const r=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(r,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function f9(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map(i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function m9(e){const t=e.l,i=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function tpe(e){const t=e.l,i=e.a,r=e.b,s=Math.sqrt(i*i+r*r);let n=Math.atan2(r,i);return n=n>0?n:n+2*Math.PI,{l:t,c:s,h:n}}function ipe(e){const t=e.l,i=e.c,r=e.h;return{l:t,a:i*Math.cos(r),b:i*Math.sin(r)}}function rpe(e){return f9(p9(e))}function spe(e){return aP(m9(e))}function npe(e){return tpe(f9(p9(e)))}function ope(e){return aP(m9(ipe(e)))}function ape(e){const t=e.r,i=e.g,r=e.b,s=Math.max(t,i,r),n=s-Math.min(t,i,r);let c=s,o=n===0?0:s===t?(i-r)/n%6:s===i?(r-t)/n+2:(t-i)/n+4,p=n===0?0:n/c;return o<0&&(o+=6),o*=60,p*=100,c*=100/255,{h:o,s:p,v:c}}function lpe(e){const t=(e.h+360)%360/60,i=e.s/100,r=e.v/100*255,s=r*i,n=s*(1-Math.abs(t%2-1));let c;switch(Math.floor(t)){case 0:c={r:s,g:n,b:0};break;case 1:c={r:n,g:s,b:0};break;case 2:c={r:0,g:s,b:n};break;case 3:c={r:0,g:n,b:s};break;case 4:c={r:n,g:0,b:s};break;case 5:case 6:c={r:s,g:0,b:n};break;default:c={r:0,g:0,b:0}}return c.r=Math.round(c.r+r-s),c.g=Math.round(c.g+r-s),c.b=Math.round(c.b+r-s),c}function n_(e){return Kde(e)?e:h9(e)?ope(e):u9(e)?spe(e):Xde(e)?aP(e):c9(e)?lpe(e):e}function Obe(e){return c9(e)?e:ape(n_(e))}function LD(e){return u9(e)?e:rpe(n_(e))}function DD(e){return h9(e)?e:npe(n_(e))}var ND;(function(e){e[e.Low=160]="Low",e[e.High=225]="High"})(ND||(ND={}));const y9={kind:"null"},Ir={kind:"number"},To={kind:"string"},Ws={kind:"boolean"},Gc={kind:"color"},t2={kind:"object"},zc={kind:"value"};function k_(e,t){return{kind:"array",itemType:e,n:t}}const cpe=[y9,Ir,To,Ws,Gc,t2,k_(zc)];function Dm(e){if(e.kind==="array"){const t=Dm(e.itemType);return typeof e.n=="number"?`array<${t}, ${e.n}>`:e.itemType.kind==="value"?"array":`array<${t}>`}return e.kind}function i2(e){if(e===null)return y9;if(typeof e=="string")return To;if(typeof e=="boolean")return Ws;if(typeof e=="number")return Ir;if(e instanceof Bt)return Gc;if(Array.isArray(e)){let t;for(const i of e){const r=i2(i);if(t){if(t!==r){t=zc;break}}else t=r}return k_(t||zc,e.length)}return typeof e=="object"?t2:zc}function UM(e,t){if(t.kind==="array")return e.kind==="array"&&(e.n===0&&e.itemType.kind==="value"||UM(e.itemType,t.itemType))&&(typeof t.n!="number"||t.n===e.n);if(t.kind==="value"){for(const i of cpe)if(UM(e,i))return!0}return t.kind===e.kind}function jM(e){if(e===null)return"";const t=typeof e;return t==="string"?e:t==="number"||t==="boolean"?String(e):e instanceof Bt?e.toString():JSON.stringify(e)}let upe=class{constructor(t){this._parent=t,this._vars={}}add(t,i){this._vars[t]=i}get(t){return this._vars[t]?this._vars[t]:this._parent?this._parent.get(t):null}},hpe=class g9{constructor(){this.type=zc}static parse(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new g9}evaluate(t,i){return t==null?void 0:t.id}},dpe=class _9{constructor(){this.type=To}static parse(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new _9}evaluate(t,i){if(!t)return null;switch(t.type){case Yo.Point:return"Point";case Yo.LineString:return"LineString";case Yo.Polygon:return"Polygon";default:return null}}},ppe=class v9{constructor(){this.type=t2}static parse(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new v9}evaluate(t,i){return t==null?void 0:t.values}},b9=class w9{constructor(){this.type=Ir}static parse(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new w9}evaluate(t,i){return i}},oa=class x9{constructor(t,i,r){this._lhs=t,this._rhs=i,this._compare=r,this.type=Ws}static parse(t,i,r){if(t.length!==3&&t.length!==4)throw new Error(`"${t[0]}" expects 2 or 3 arguments`);if(t.length===4)throw new Error(`"${t[0]}" collator not supported`);return new x9(Wt(t[1],i),Wt(t[2],i),r)}evaluate(t,i){return this._compare(this._lhs.evaluate(t,i),this._rhs.evaluate(t,i))}},fpe=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r===s)}},mpe=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r!==s)}},ype=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r<s)}},gpe=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r<=s)}},_pe=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r>s)}},vpe=class extends oa{static parse(t,i){return oa.parse(t,i,(r,s)=>r>=s)}},bpe=class S9{constructor(t){this._arg=t,this.type=Ws}static parse(t,i){if(t.length!==2)throw new Error('"!" expects 1 argument');return new S9(Wt(t[1],i))}evaluate(t,i){return!this._arg.evaluate(t,i)}},wpe=class T9{constructor(t){this._args=t,this.type=Ws}static parse(t,i){const r=[];for(let s=1;s<t.length;s++)r.push(Wt(t[s],i));return new T9(r)}evaluate(t,i){for(const r of this._args)if(!r.evaluate(t,i))return!1;return!0}},xpe=class E9{constructor(t){this._args=t,this.type=Ws}static parse(t,i){const r=[];for(let s=1;s<t.length;s++)r.push(Wt(t[s],i));return new E9(r)}evaluate(t,i){for(const r of this._args)if(r.evaluate(t,i))return!0;return!1}},Spe=class I9{constructor(t){this._args=t,this.type=Ws}static parse(t,i){const r=[];for(let s=1;s<t.length;s++)r.push(Wt(t[s],i));return new I9(r)}evaluate(t,i){for(const r of this._args)if(r.evaluate(t,i))return!1;return!0}},Tpe=class M9{constructor(t,i,r){this.type=t,this._args=i,this._fallback=r}static parse(t,i,r){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');let s;const n=[];for(let o=1;o<t.length-1;o+=2){const p=Wt(t[o],i),g=Wt(t[o+1],i,r);s||(s=g.type),n.push({condition:p,output:g})}const c=Wt(t[t.length-1],i,r);return s||(s=c.type),new M9(s,n,c)}evaluate(t,i){for(const r of this._args)if(r.condition.evaluate(t,i))return r.output.evaluate(t,i);return this._fallback.evaluate(t,i)}},Epe=class A9{constructor(t,i){this.type=t,this._args=i}static parse(t,i){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');let r;const s=[];for(let n=1;n<t.length;n++){const c=Wt(t[n],i);r||(r=c.type),s.push(c)}return new A9(r,s)}evaluate(t,i){for(const r of this._args){const s=r.evaluate(t,i);if(s!==null)return s}return null}},Ipe=class P9{constructor(t,i,r,s,n){this.type=t,this._input=i,this._labels=r,this._outputs=s,this._fallback=n}static parse(t,i){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');let r;const s=Wt(t[1],i),n=[],c={};let o;for(let p=2;p<t.length-1;p+=2){let g=t[p];Array.isArray(g)||(g=[g]);for(const M of g){const A=typeof M;if(A!=="string"&&A!=="number")throw new Error('"match" requires string or number literal as labels');if(o){if(A!==o)throw new Error('"match" requires labels to have the same type')}else o=A;c[M]=n.length}const S=Wt(t[p+1],i);r||(r=S.type),n.push(S)}return new P9(r,s,c,n,Wt(t[t.length-1],i))}evaluate(t,i){const r=this._input.evaluate(t,i);return(this._outputs[this._labels[r]]||this._fallback).evaluate(t,i)}},Lb=class Od{constructor(t,i,r,s,n){this._operator=t,this.type=i,this.interpolation=r,this.input=s,this._stops=n}static parse(t,i,r){const s=t[0];if(t.length<5)throw new Error(`"${s}" expects at least 4 arguments`);const n=t[1];if(!Array.isArray(n)||n.length===0)throw new Error(`"${n}" is not a valid interpolation`);switch(n[0]){case"linear":if(n.length!==1)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(n.length!==2||typeof n[1]!="number")throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(n.length!==5)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let g=1;g<5;g++){const S=n[g];if(typeof S!="number"||S<0||S>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${t[0]}" unknown interpolation type "${n[0]}"`)}if(t.length%2!=1)throw new Error(`"${s}" expects an even number of arguments`);const c=Wt(t[2],i,Ir);let o;s==="interpolate-hcl"||s==="interpolate-lab"?o=Gc:r&&r.kind!=="value"&&(o=r);const p=[];for(let g=3;g<t.length;g+=2){const S=t[g];if(typeof S!="number")throw new Error(`"${s}" requires stop inputs as literal numbers`);if(p.length&&p[p.length-1][0]>=S)throw new Error(`"${s}" requires strictly ascending stop inputs`);const M=Wt(t[g+1],i,o);o||(o=M.type),p.push([S,M])}if(o&&o!==Gc&&o!==Ir&&(o.kind!=="array"||o.itemType!==Ir))throw new Error(`"${s}" cannot interpolate type ${Dm(o)}`);return new Od(s,o,n,c,p)}evaluate(t,i){const r=this._stops;if(r.length===1)return r[0][1].evaluate(t,i);const s=this.input.evaluate(t,i);if(s<=r[0][0])return r[0][1].evaluate(t,i);if(s>=r[r.length-1][0])return r[r.length-1][1].evaluate(t,i);let n=0;for(;++n<r.length&&!(s<r[n][0]););const c=r[n-1][0],o=r[n][0],p=Od.interpolationRatio(this.interpolation,s,c,o),g=r[n-1][1].evaluate(t,i),S=r[n][1].evaluate(t,i);if(this._operator==="interpolate"){if(this.type.kind==="array"&&Array.isArray(g)&&Array.isArray(S))return g.map((M,A)=>An(M,S[A],p));if(this.type.kind==="color"&&g instanceof Bt&&S instanceof Bt){const M=new Bt(g),A=new Bt(S);return new Bt([An(M.r,A.r,p),An(M.g,A.g,p),An(M.b,A.b,p),An(M.a,A.a,p)])}if(this.type.kind==="number"&&typeof g=="number"&&typeof S=="number")return An(g,S,p);throw new Error(`"${this._operator}" cannot interpolate type ${Dm(this.type)}`)}if(this._operator==="interpolate-hcl"){const M=DD(g),A=DD(S),O=A.h-M.h,z=n_({h:M.h+p*(O>180||O<-180?O-360*Math.round(O/360):O),c:An(M.c,A.c,p),l:An(M.l,A.l,p)});return new Bt({a:An(g.a,S.a,p),...z})}if(this._operator==="interpolate-lab"){const M=LD(g),A=LD(S),O=n_({l:An(M.l,A.l,p),a:An(M.a,A.a,p),b:An(M.b,A.b,p)});return new Bt({a:An(g.a,S.a,p),...O})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(t,i){const r=this._stops;if(r.length===1||t>=r[r.length-1][0])return 0;let s=0;for(;++s<r.length&&!(t<r[s][0]););const n=r[s-1][0],c=r[s][0];return Od.interpolationRatio(this.interpolation,i,n,c)}getInterpolationRange(t){const i=this._stops;if(i.length===1){const n=i[0][0];return[n,n]}const r=i[i.length-1][0];if(t>=r)return[r,r];let s=0;for(;++s<i.length&&!(t<i[s][0]););return[i[s-1][0],i[s][0]]}static interpolationRatio(t,i,r,s){let n=0;return t[0]==="linear"?n=Od._exponentialInterpolationRatio(i,1,r,s):t[0]==="exponential"?n=Od._exponentialInterpolationRatio(i,t[1],r,s):t[0]==="cubic-bezier"&&(n=ih(t[1],t[2],t[3],t[4])(Od._exponentialInterpolationRatio(i,1,r,s),1e-5)),n<0?n=0:n>1&&(n=1),n}static _exponentialInterpolationRatio(t,i,r,s){const n=s-r;if(n===0)return 0;const c=t-r;return i===1?c/n:(i**c-1)/(i**n-1)}},Mpe=class C9{constructor(t,i,r){this.type=t,this._input=i,this._stops=r}static parse(t,i){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');const r=Wt(t[1],i,Ir);let s;const n=[];n.push([-1/0,Wt(t[2],i)]);for(let c=3;c<t.length;c+=2){const o=t[c];if(typeof o!="number")throw new Error('"step" requires stop inputs as literal numbers');if(n.length&&n[n.length-1][0]>=o)throw new Error('"step" requires strictly ascending stop inputs');const p=Wt(t[c+1],i);s||(s=p.type),n.push([o,p])}return new C9(s,r,n)}evaluate(t,i){const r=this._stops;if(r.length===1)return r[0][1].evaluate(t,i);const s=this._input.evaluate(t,i);let n=0;for(;++n<r.length&&!(s<r[n][0]););return this._stops[n-1][1].evaluate(t,i)}},Ape=class $9{constructor(t,i){this.type=t,this._output=i}static parse(t,i,r){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');const s=new upe(i);for(let c=1;c<t.length-1;c+=2){const o=t[c];if(typeof o!="string")throw new Error(`"let" requires a string to define variable names - found ${o}`);s.add(o,Wt(t[c+1],i))}const n=Wt(t[t.length-1],s,r);return new $9(n.type,n)}evaluate(t,i){return this._output.evaluate(t,i)}},Ppe=class k9{constructor(t,i){this.type=t,this.output=i}static parse(t,i,r){if(t.length!==2||typeof t[1]!="string")throw new Error('"var" requires just one literal string argument');const s=i.get(t[1]);if(!s)throw new Error(`${t[1]} must be defined before being used in a "var" expression`);return new k9(r||zc,s)}evaluate(t,i){return this.output.evaluate(t,i)}},Cpe=class R9{constructor(t,i,r){this.type=t,this._index=i,this._array=r}static parse(t,i){if(t.length!==3)throw new Error('"at" expects 2 arguments');const r=Wt(t[1],i,Ir),s=Wt(t[2],i);return new R9(s.type.itemType,r,s)}evaluate(t,i){const r=this._index.evaluate(t,i),s=this._array.evaluate(t,i);if(r<0||r>=s.length)throw new Error('"at" index out of bounds');if(r!==Math.floor(r))throw new Error('"at" index must be an integer');return s[r]}};class Zw{constructor(t,i){this._key=t,this._obj=i,this.type=zc}static parse(t,i){let r,s;switch(t.length){case 2:return r=Wt(t[1],i),new Zw(r);case 3:return r=Wt(t[1],i),s=Wt(t[2],i),new Zw(r,s);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(t,i){const r=this._key.evaluate(t,i);return this._obj?this._obj.evaluate(t,i)[r]:t==null?void 0:t.values[r]}}class Yw{constructor(t,i){this._key=t,this._obj=i,this.type=Ws}static parse(t,i){let r,s;switch(t.length){case 2:return r=Wt(t[1],i),new Yw(r);case 3:return r=Wt(t[1],i),s=Wt(t[2],i),new Yw(r,s);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(t,i){const r=this._key.evaluate(t,i);return this._obj?r in this._obj.evaluate(t,i):!!(t!=null&&t.values[r])}}let $pe=class O9{constructor(t,i){this._key=t,this._vals=i,this.type=Ws}static parse(t,i){if(t.length!==3)throw new Error('"in" expects 2 arguments');return new O9(Wt(t[1],i),Wt(t[2],i))}evaluate(t,i){const r=this._key.evaluate(t,i);return this._vals.evaluate(t,i).includes(r)}};class Jw{constructor(t,i,r){this._item=t,this._array=i,this._from=r,this.type=Ir}static parse(t,i){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const r=Wt(t[1],i),s=Wt(t[2],i);if(t.length===4){const n=Wt(t[3],i,Ir);return new Jw(r,s,n)}return new Jw(r,s)}evaluate(t,i){const r=this._item.evaluate(t,i),s=this._array.evaluate(t,i);if(this._from){const n=this._from.evaluate(t,i);if(n!==Math.floor(n))throw new Error('"index-of" index must be an integer');return s.indexOf(r,n)}return s.indexOf(r)}}let kpe=class L9{constructor(t){this._arg=t,this.type=Ir}static parse(t,i){if(t.length!==2)throw new Error('"length" expects 2 arguments');const r=Wt(t[1],i);return new L9(r)}evaluate(t,i){const r=this._arg.evaluate(t,i);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Error('"length" expects string or array')}},Rpe=class VM{constructor(t,i,r,s){this.type=t,this._array=i,this._from=r,this._to=s}static parse(t,i){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');const r=Wt(t[1],i),s=Wt(t[2],i,Ir);if(s.type!==Ir)throw new Error('"slice" index must return a number');if(t.length===4){const n=Wt(t[3],i,Ir);if(n.type!==Ir)throw new Error('"slice" index must return a number');return new VM(r.type,r,s,n)}return new VM(r.type,r,s)}evaluate(t,i){const r=this._array.evaluate(t,i);if(!Array.isArray(r)&&typeof r!="string")throw new Error('"slice" input must be an array or a string');const s=this._from.evaluate(t,i);if(s<0||s>=r.length)throw new Error('"slice" index out of bounds');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer');if(this._to){const n=this._to.evaluate(t,i);if(n<0||n>=r.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');return r.slice(s,n)}return r.slice(s)}},Ope=class D9{constructor(){this.type=Ws}static parse(t){if(t.length!==1)throw new Error('"has-id" expects no arguments');return new D9}evaluate(t,i){return(t==null?void 0:t.id)!==void 0}},xo=class N9{constructor(t,i){this._args=t,this._calculate=i,this.type=Ir}static parse(t,i,r){const s=t.slice(1).map(n=>Wt(n,i));return new N9(s,r)}evaluate(t,i){let r;return this._args&&(r=this._args.map(s=>s.evaluate(t,i))),this._calculate(r)}},Lpe=class extends xo{static parse(t,i){switch(t.length){case 2:return xo.parse(t,i,r=>-r[0]);case 3:return xo.parse(t,i,r=>r[0]-r[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},Dpe=class extends xo{static parse(t,i){return xo.parse(t,i,r=>{let s=1;for(const n of r)s*=n;return s})}},Npe=class extends xo{static parse(t,i){if(t.length===3)return xo.parse(t,i,r=>r[0]/r[1]);throw new Error('"/" expects 2 arguments')}};class zpe extends xo{static parse(t,i){if(t.length===3)return xo.parse(t,i,r=>r[0]%r[1]);throw new Error('"%" expects 2 arguments')}}let Fpe=class extends xo{static parse(t,i){if(t.length===3)return xo.parse(t,i,r=>r[0]**r[1]);throw new Error('"^" expects 1 or 2 arguments')}},Bpe=class extends xo{static parse(t,i){return xo.parse(t,i,r=>{let s=0;for(const n of r)s+=n;return s})}};class Tr{constructor(t,i){this._args=t,this._calculate=i,this.type=Ir}static parse(t,i){const r=t.slice(1).map(s=>Wt(s,i));return new Tr(r,Tr.ops[t[0]])}evaluate(t,i){let r;return this._args&&(r=this._args.map(s=>s.evaluate(t,i))),this._calculate(r)}}Tr.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])};class lP{constructor(t){this._args=t,this.type=To}static parse(t,i){return new lP(t.slice(1).map(r=>Wt(r,i)))}evaluate(t,i){return this._args.map(r=>r.evaluate(t,i)).join("")}}class Nm{constructor(t,i){this._arg=t,this._calculate=i,this.type=To}static parse(t,i){if(t.length!==2)throw new Error(`${t[0]} expects 1 argument`);const r=Wt(t[1],i);return new Nm(r,Nm.ops[t[0]])}evaluate(t,i){return this._calculate(this._arg.evaluate(t,i))}}Nm.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()};let Upe=class z9{constructor(t){this._args=t,this.type=Gc}static parse(t,i){if(t.length!==4)throw new Error('"rgb" expects 3 arguments');const r=t.slice(1).map(s=>Wt(s,i));return new z9(r)}evaluate(t,i){const r=this._validate(this._args[0].evaluate(t,i)),s=this._validate(this._args[1].evaluate(t,i)),n=this._validate(this._args[2].evaluate(t,i));return new Bt({r,g:s,b:n})}_validate(t){if(typeof t!="number"||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}},jpe=class F9{constructor(t){this._args=t,this.type=Gc}static parse(t,i){if(t.length!==5)throw new Error('"rgba" expects 4 arguments');const r=t.slice(1).map(s=>Wt(s,i));return new F9(r)}evaluate(t,i){const r=this._validate(this._args[0].evaluate(t,i)),s=this._validate(this._args[1].evaluate(t,i)),n=this._validate(this._args[2].evaluate(t,i)),c=this._validateAlpha(this._args[3].evaluate(t,i));return new Bt({r,g:s,b:n,a:c})}_validate(t){if(typeof t!="number"||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}_validateAlpha(t){if(typeof t!="number"||t<0||t>1)throw new Error(`${t}: invalid alpha color component`);return t}};class cP{constructor(t){this._color=t,this.type=k_(Ir,4)}static parse(t,i){if(t.length!==2)throw new Error('"to-rgba" expects 1 argument');const r=Wt(t[1],i);return new cP(r)}evaluate(t,i){return new Bt(this._color.evaluate(t,i)).toRgba()}}class Gd{constructor(t,i){this.type=t,this._args=i}static parse(t,i){const r=t[0];if(t.length<2)throw new Error(`${r} expects at least one argument`);let s,n=1;if(r==="array"){if(t.length>2){switch(t[1]){case"string":s=To;break;case"number":s=Ir;break;case"boolean":s=Ws;break;default:throw new Error('"array" type argument must be string, number or boolean')}n++}else s=zc;let o;if(t.length>3){if(o=t[2],o!==null&&(typeof o!="number"||o<0||o!==Math.floor(o)))throw new Error('"array" length argument must be a positive integer literal');n++}s=k_(s,o)}else switch(r){case"string":s=To;break;case"number":s=Ir;break;case"boolean":s=Ws;break;case"object":s=t2}const c=[];for(;n<t.length;n++){const o=Wt(t[n],i);c.push(o)}return new Gd(s,c)}evaluate(t,i){let r;for(const s of this._args){const n=s.evaluate(t,i);if(r=i2(n),UM(r,this.type))return n}throw new Error(`Expected ${Dm(this.type)} but got ${Dm(r)}`)}}let lh=class Db{constructor(t,i){this.type=t,this._args=i}static parse(t,i){const r=t[0],s=Db.types[r];if(s===Ws||s===To){if(t.length!==2)throw new Error(`${r} expects one argument`)}else if(t.length<2)throw new Error(`${r} expects at least one argument`);const n=[];for(let c=1;c<t.length;c++){const o=Wt(t[c],i);n.push(o)}return new Db(s,n)}evaluate(t,i){if(this.type===Ws)return!!this._args[0].evaluate(t,i);if(this.type===To)return jM(this._args[0].evaluate(t,i));if(this.type===Ir){for(const r of this._args){const s=Number(r.evaluate(t,i));if(!isNaN(s))return s}return null}if(this.type===Gc){for(const r of this._args)try{const s=Db.toColor(r.evaluate(t,i));if(s instanceof Bt)return s}catch{}return null}}static toBoolean(t){return!!t}static toString(t){return jM(t)}static toNumber(t){const i=Number(t);if(isNaN(i))throw new Error(`"${t}" is not a number`);return i}static toColor(t){if(t instanceof Bt)return t;if(typeof t=="string"){const i=Bt.fromString(t);if(i)return i;throw new Error(`"${t}" is not a color`)}if(Array.isArray(t))return Bt.fromArray(t);throw new Error(`"${t}" is not a color`)}};lh.types={"to-boolean":Ws,"to-color":Gc,"to-number":Ir,"to-string":To};class uP{constructor(t){this._val=t,this.type=i2(t)}static parse(t){if(t.length!==2)throw new Error('"literal" expects 1 argument');return new uP(t[1])}evaluate(t,i){return this._val}}class hP{constructor(t){this._arg=t,this.type=To}static parse(t,i){if(t.length!==2)throw new Error('"typeof" expects 1 argument');return new hP(Wt(t[1],i))}evaluate(t,i){return Dm(i2(this._arg.evaluate(t,i)))}}function Wt(e,t,i){const r=typeof e;if(r==="string"||r==="boolean"||r==="number"||e===null){if(i)switch(i.kind){case"string":r!=="string"&&(e=lh.toString(e));break;case"number":r!=="number"&&(e=lh.toNumber(e));break;case"color":e=lh.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||e.length===0)throw new Error("Expression must be a non empty array");const s=e[0];if(typeof s!="string")throw new Error("First element of expression must be a string");const n=B9[s];if(n===void 0)throw new Error(`Invalid expression operator "${s}"`);if(!n)throw new Error(`Unimplemented expression operator "${s}"`);return n.parse(e,t,i)}const B9={array:Gd,boolean:Gd,collator:null,format:null,image:null,literal:uP,number:Gd,"number-format":null,object:Gd,string:Gd,"to-boolean":lh,"to-color":lh,"to-number":lh,"to-string":lh,typeof:hP,accumulated:null,"feature-state":null,"geometry-type":dpe,id:hpe,"line-progress":null,properties:ppe,at:Cpe,get:Zw,has:Yw,in:$pe,"index-of":Jw,length:kpe,slice:Rpe,"!":bpe,"!=":mpe,"<":ype,"<=":gpe,"==":fpe,">":_pe,">=":vpe,all:wpe,any:xpe,case:Tpe,coalesce:Epe,match:Ipe,within:null,interpolate:Lb,"interpolate-hcl":Lb,"interpolate-lab":Lb,step:Mpe,let:Ape,var:Ppe,concat:lP,downcase:Nm,"is-supported-script":null,"resolved-locale":null,upcase:Nm,rgb:Upe,rgba:jpe,"to-rgba":cP,"-":Lpe,"*":Dpe,"/":Npe,"%":zpe,"^":Fpe,"+":Bpe,abs:Tr,acos:Tr,asin:Tr,atan:Tr,ceil:Tr,cos:Tr,e:Tr,floor:Tr,ln:Tr,ln2:Tr,log10:Tr,log2:Tr,max:Tr,min:Tr,pi:Tr,round:Tr,sin:Tr,sqrt:Tr,tan:Tr,zoom:b9,"heatmap-density":null,"has-id":Ope,none:Spe};class Wn{constructor(t){this._expression=t}filter(t,i){if(!this._expression)return!0;try{return this._expression.evaluate(t,i)}catch(r){return console.log(r.message),!0}}static createFilter(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{const i=Wt(t,null,Ws);return new Wn(i)}catch(i){return console.log(i.message),null}}static isLegacyFilter(t){if(!Array.isArray(t)||t.length===0)return!0;switch(t[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return t.length===3&&typeof t[1]=="string"&&!Array.isArray(t[2]);case"in":return t.length>=3&&typeof t[1]=="string"&&!Array.isArray(t[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let i=1;i<t.length;i++)if(this.isLegacyFilter(t[i]))return!0;return!1;case"has":return t.length===2&&(t[1]==="$id"||t[1]==="$type");default:return!1}}static convertLegacyFilter(t){if(!Array.isArray(t)||t.length===0)return!0;const i=t[0];if(t.length===1)return i!=="any";switch(i){case"==":return Wn.convertComparison("==",t[1],t[2]);case"!=":return Wn.negate(Wn.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return Wn.convertComparison(i,t[1],t[2]);case"in":return Wn.convertIn(t[1],t.slice(2));case"!in":return Wn.negate(Wn.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return Wn.convertCombining(i,t.slice(1));case"has":return Wn.convertHas(t[1]);case"!has":return Wn.negate(Wn.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(t,i,r){switch(i){case"$type":return[t,["geometry-type"],r];case"$id":return[t,["id"],r];default:return[t,["get",i],r]}}static convertIn(t,i){switch(t){case"$type":return["in",["geometry-type"],["literal",i]];case"$id":return["in",["id"],["literal",i]];default:return["in",["get",t],["literal",i]]}}static convertHas(t){switch(t){case"$type":return!0;case"$id":return["has-id"];default:return["has",t]}}static convertCombining(t,i){return[t].concat(i.map(this.convertLegacyFilter))}static negate(t){return["!",t]}}class Kw{constructor(t,i){let r;switch(this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":r=!0;break;case"array":r=t.value==="number";break;default:r=!1}if(i==null&&(i=t.default),Array.isArray(i)&&i.length>0&&B9[i[0]]){const n={number:Ir,color:Gc,string:To,boolean:Ws,enum:To};try{const c=t.type==="array"?k_(n[t.value]||zc,t.length):n[t.type],o=Wt(i,null,c);this.getValue=this._buildExpression(o,t),this.isDataDriven=!0,o instanceof Lb&&o.input instanceof b9&&(this.interpolator=o)}catch(c){console.log(c.message),this.getValue=this._buildSimple(t.default)}return}r&&i.type==="interval"&&(r=!1);const s=(i==null?void 0:i.stops)&&i.stops.length>0;if(s)for(const n of i.stops)n[1]=this._validate(n[1],t);if(this.isDataDriven=!!i&&!!i.property,this.isDataDriven)if(i.default!==void 0&&(i.default=this._validate(i.default,t)),s)switch(i.type){case"identity":this.getValue=this._buildIdentity(i,t);break;case"categorical":this.getValue=this._buildCategorical(i,t);break;default:this.getValue=r?this._buildInterpolate(i,t):this._buildInterval(i,t)}else this.getValue=this._buildIdentity(i,t);else s?this.getValue=r?this._buildZoomInterpolate(i):this._buildZoomInterval(i):(i=this._validate(i,t),this.getValue=this._buildSimple(i))}_validate(t,i){if(i.type==="number"){if(i.minimum!=null&&t<i.minimum)return i.minimum;if(i.maximum!=null&&t>i.maximum)return i.maximum}else i.type==="color"?t=Kw._parseColor(t):i.type==="enum"?typeof t=="string"&&(t=i.values.indexOf(t)):i.type==="array"&&i.value==="enum"?t=t.map(r=>typeof r=="string"?i.values.indexOf(r):r):i.type==="string"&&(t=jM(t));return t}_buildSimple(t){return()=>t}_buildExpression(t,i){return(r,s)=>{try{const n=t.evaluate(s,r);return n===void 0?i.default:this._validate(n,i)}catch(n){return console.log(n.message),i.default}}}_buildIdentity(t,i){return(r,s)=>{let n;return s&&(n=s.values[t.property]),n!==void 0&&(n=this._validate(n,i)),n??(t.default!==void 0?t.default:i.default)}}_buildCategorical(t,i){return(r,s)=>{let n;return s&&(n=s.values[t.property]),n=this._categorical(n,t.stops),n!==void 0?n:t.default!==void 0?t.default:i.default}}_buildInterval(t,i){return(r,s)=>{let n;return s&&(n=s.values[t.property]),typeof n=="number"?this._interval(n,t.stops):t.default!==void 0?t.default:i.default}}_buildInterpolate(t,i){return(r,s)=>{let n;return s&&(n=s.values[t.property]),typeof n=="number"?this._interpolate(n,t.stops,t.base||1):t.default!==void 0?t.default:i.default}}_buildZoomInterpolate(t){return i=>this._interpolate(i,t.stops,t.base||1)}_buildZoomInterval(t){return i=>this._interval(i,t.stops)}_categorical(t,i){const r=i.length;for(let s=0;s<r;s++)if(i[s][0]===t)return i[s][1]}_interval(t,i){const r=i.length;let s=0;for(let n=0;n<r&&i[n][0]<=t;n++)s=n;return i[s][1]}_interpolate(t,i,r){let s,n;const c=i.length;for(let o=0;o<c;o++){const p=i[o];if(!(p[0]<=t)){n=p;break}s=p}if(s&&n){const o=n[0]-s[0],p=t-s[0],g=r===1?p/o:(r**p-1)/(r**o-1);if(Array.isArray(s[1])){const S=s[1],M=n[1],A=[];for(let O=0;O<S.length;O++)A.push(An(S[O],M[O],g));return A}return An(s[1],n[1],g)}return s?s[1]:n?n[1]:void 0}static _isEmpty(t){for(const i in t)if(t.hasOwnProperty(i))return!1;return!0}static _parseColor(t){return Array.isArray(t)?t:(typeof t=="string"&&(t=new Bt(t)),t instanceof Bt&&!this._isEmpty(t)?Bt.toUnitRGBA(t):void 0)}}const Wbe=1e-30,Zbe=512,Ybe=128,Jbe=511,Kbe=16777216,Xbe=8,Qbe=29,ewe=24,twe=4,iwe=0,rwe=0,swe=0,nwe=1,owe=2,awe=3,lwe=4,cwe=5,uwe=6,hwe=12,dwe=5,pwe=6,fwe=5,mwe=6;var zD;(function(e){e[e.FilterFlags=0]="FilterFlags",e[e.Animation=1]="Animation",e[e.GPGPU=2]="GPGPU",e[e.VV=3]="VV",e[e.DD0=4]="DD0",e[e.DD1=5]="DD1",e[e.DD2=6]="DD2"})(zD||(zD={}));const Vpe=3,Gpe=1<<Vpe,ywe=Gpe<<1,qpe=1.05,gwe=1,_we=5,vwe=6,bwe=1.15,Hpe=2,wwe=128-2*Hpe,xwe=2,Swe=10,Twe=1024,Ewe=128,Iwe=4,Mwe=1,Awe=1<<20,Pwe=.75,Cwe=10,$we=.75,kwe=256,zm=8;var k0;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(k0||(k0={}));class Rwe{constructor(t,i,r,s,n,c){this.layer=t,this.feature=i,this.bounds=r,this.normalizationRatio=s,this.normalizationOffsetX=n,this.normalizationOffsetY=c}}class R_{constructor(t,i,r,s){switch(this.type=t,this.typeName=i.type,this.id=i.id,this.source=i.source,this.sourceLayer=i["source-layer"],this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,this.filter=i.filter,this.layout=i.layout,this.paint=i.paint,this.z=r,this.uid=s,t){case Lr.BACKGROUND:this._layoutDefinition=Yr.backgroundLayoutDefinition,this._paintDefinition=Yr.backgroundPaintDefinition;break;case Lr.FILL:this._layoutDefinition=Yr.fillLayoutDefinition,this._paintDefinition=Yr.fillPaintDefinition;break;case Lr.LINE:this._layoutDefinition=Yr.lineLayoutDefinition,this._paintDefinition=Yr.linePaintDefinition;break;case Lr.SYMBOL:this._layoutDefinition=Yr.symbolLayoutDefinition,this._paintDefinition=Yr.symbolPaintDefinition;break;case Lr.CIRCLE:this._layoutDefinition=Yr.circleLayoutDefinition,this._paintDefinition=Yr.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return this._featureFilter!==void 0?this._featureFilter:this._featureFilter=Wn.createFilter(this.filter)}getLayoutProperty(t){return this._layoutProperties[t]}getPaintProperty(t){return this._paintProperties[t]}getLayoutValue(t,i,r){let s;const n=this._layoutProperties[t];return n&&(s=n.getValue(i,r)),s===void 0&&(s=this._layoutDefinition[t].default),s}getPaintValue(t,i,r){let s;const n=this._paintProperties[t];return n&&(s=n.getValue(i,r)),s===void 0&&(s=this._paintDefinition[t].default),s}isPainterDataDriven(){const t=this._paintProperties;if(t){for(const i in t)if(t[i].isDataDriven)return!0}return!1}isIntersectingFeature(t,i,r,s,n,c,o){return!1}getFeatureInflatedBounds(t,i,r,s){return null}_parseLayout(t){const i={};for(const r in t){const s=this._layoutDefinition[r];s&&(i[r]=new Kw(s,t[r]))}return i}_parsePaint(t){const i={};for(const r in t){const s=this._paintDefinition[r];s&&(i[r]=new Kw(s,t[r]))}return i}computeAttributesKey(t,i,r,s){let n=0,c=0;for(const o of i){let p=3;if(!o||o!==s){const g=r[o],{isLayout:S,isOptional:M}=g,A=S?this.getLayoutProperty(o):this.getPaintProperty(o);p=A!=null&&A.interpolator?2:A!=null&&A.isDataDriven?1:M&&!A?3:0}c|=p<<n,n+=2}return c<<3|t}}class FD extends R_{constructor(t,i,r,s){super(t,i,r,s),this.backgroundMaterial=new gm(this.computeAttributesKey(Vc.BACKGROUND,gm.ATTRIBUTES,gm.ATTRIBUTES_INFO))}}class BD extends R_{constructor(t,i,r,s){super(t,i,r,s);const n=this.getPaintProperty("fill-color"),c=this.getPaintProperty("fill-opacity"),o=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=n==null?void 0:n.isDataDriven,this.hasDataDrivenOpacity=c==null?void 0:c.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||(o==null?void 0:o.isDataDriven);const p=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!p,this.hasDataDrivenOutlineColor=p==null?void 0:p.isDataDriven,this.hasDataDrivenOutline=p?p.isDataDriven:!!n&&n.isDataDriven,this.hasDataDrivenOutline=(p?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new vm(this.computeAttributesKey(Vc.FILL,vm.ATTRIBUTES,vm.ATTRIBUTES_INFO)),this.outlineMaterial=new Ml(this.computeAttributesKey(Vc.OUTLINE,this.outlineUsesFillColor?Ml.ATTRIBUTES_FILL:Ml.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?Ml.ATTRIBUTES_INFO_FILL:Ml.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(t,i,r,s){const n=dP(t);if(!n)return null;const c=this.getPaintValue("fill-translate",i,t),o=s*Math.max(c[0],c[1]);return n[0]-=o,n[2]-=o,n[1]+=o,n[3]+=o,n}isIntersectingFeature(t,i,r,s,n,c,o){const p=s.getGeometry();if(!p)return!1;const g=zm/o.normalizationRatio;t=t/o.normalizationRatio+o.normalizationOffsetX,i=i/o.normalizationRatio+o.normalizationOffsetY;const S=nP(this.getPaintValue("fill-translate",n,s),this.getPaintValue("fill-translate-anchor",n,s),c,zm);return t-=g*S.x,i-=g*S.y,!!cde(t,i,p)||WU(t,i,p,g*r)}}let UD=class extends R_{constructor(t,i,r,s){var c,o,p,g,S,M,A,O,z;super(t,i,r,s);const n=this.getPaintProperty("line-pattern");if(this.lineMaterial=new bm(this.computeAttributesKey(Vc.LINE,bm.ATTRIBUTES,bm.ATTRIBUTES_INFO,n?"line-dasharray":"")),this.hasDataDrivenLine=((c=this.getPaintProperty("line-blur"))==null?void 0:c.isDataDriven)||((o=this.getPaintProperty("line-color"))==null?void 0:o.isDataDriven)||((p=this.getPaintProperty("line-gap-width"))==null?void 0:p.isDataDriven)||((g=this.getPaintProperty("line-offset"))==null?void 0:g.isDataDriven)||((S=this.getPaintProperty("line-opacity"))==null?void 0:S.isDataDriven)||((M=this.getPaintProperty("line-pattern"))==null?void 0:M.isDataDriven)||((A=this.getPaintProperty("line-dasharray"))==null?void 0:A.isDataDriven)||((O=this.getLayoutProperty("line-cap"))==null?void 0:O.isDataDriven)||((z=this.getPaintProperty("line-width"))==null?void 0:z.isDataDriven),this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const V=this.getPaintProperty("line-width");if(!V||typeof V=="number"&&.5*V<qpe){const W=this.getPaintProperty("line-offset");(!W||typeof W=="number"&&W===0)&&(this.canUseThinTessellation=!0)}}}getDashKey(t,i){let r;switch(i){case k0.BUTT:r="Butt";break;case k0.ROUND:r="Round";break;case k0.SQUARE:r="Square";break;default:r="Butt"}return`dasharray-[${t.toString()}]-${r}`}getFeatureInflatedBounds(t,i,r,s){const n=dP(t);if(!n)return null;const c=this.getPaintValue("line-translate",i,t),o=s*Math.max(c[0],c[1]);n[0]-=o,n[2]-=o,n[1]+=o,n[3]+=o;const p=s*Math.abs(this.getPaintValue("line-offset",i,t)||0),g=s*(this.getPaintValue("line-width",i,t)/2);return n[0]-=p+g,n[1]-=p+g,n[2]+=p+g,n[3]+=p+g,n}isIntersectingFeature(t,i,r,s,n,c,o){let p=s.getGeometry();if(!p)return!1;const g=zm/o.normalizationRatio;t=t/o.normalizationRatio+o.normalizationOffsetX,i=i/o.normalizationRatio+o.normalizationOffsetY;const S=nP(this.getPaintValue("line-translate",n,s),this.getPaintValue("line-translate-anchor",n,s),c,zm);t-=g*S.x,i-=g*S.y;const M=g*this.getPaintValue("line-offset",n,s)||0;M!==0&&(p=ude(p,-M));const A=this.getPaintValue("line-width",n,s);return WU(t,i,p,g*(r+A/2))}};class jD extends R_{constructor(t,i,r,s){var n,c,o,p,g,S,M,A,O,z,V,W;super(t,i,r,s),this.iconMaterial=new C0(this.computeAttributesKey(Vc.ICON,C0.ATTRIBUTES,C0.ATTRIBUTES_INFO)),this.textMaterial=new $0(this.computeAttributesKey(Vc.TEXT,$0.ATTRIBUTES,$0.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=((n=this.getPaintProperty("icon-color"))==null?void 0:n.isDataDriven)||((c=this.getPaintProperty("icon-halo-blur"))==null?void 0:c.isDataDriven)||((o=this.getPaintProperty("icon-halo-color"))==null?void 0:o.isDataDriven)||((p=this.getPaintProperty("icon-halo-width"))==null?void 0:p.isDataDriven)||((g=this.getPaintProperty("icon-opacity"))==null?void 0:g.isDataDriven)||((S=this.getLayoutProperty("icon-size"))==null?void 0:S.isDataDriven),this.hasDataDrivenText=((M=this.getPaintProperty("text-color"))==null?void 0:M.isDataDriven)||((A=this.getPaintProperty("text-halo-blur"))==null?void 0:A.isDataDriven)||((O=this.getPaintProperty("text-halo-color"))==null?void 0:O.isDataDriven)||((z=this.getPaintProperty("text-halo-width"))==null?void 0:z.isDataDriven)||((V=this.getPaintProperty("text-opacity"))==null?void 0:V.isDataDriven)||((W=this.getLayoutProperty("text-size"))==null?void 0:W.isDataDriven)}}let VD=class extends R_{constructor(t,i,r,s){super(t,i,r,s),this.circleMaterial=new _m(this.computeAttributesKey(Vc.CIRCLE,_m.ATTRIBUTES,_m.ATTRIBUTES_INFO))}getFeatureInflatedBounds(t,i,r,s){const n=dP(t);if(!n)return null;const c=this.getPaintValue("circle-translate",i,t),o=Math.max(c[0],c[1]);n[0]-=o,n[2]-=o,n[1]+=o,n[3]+=o;const p=s*(zm*(this.getPaintValue("circle-radius",i,t)+this.getPaintValue("circle-stroke-width",i,t))/2);return n[0]-=p,n[1]-=p,n[2]+=p,n[3]+=p,n}isIntersectingFeature(t,i,r,s,n,c,o){const p=s.getGeometry();if(!p)return!1;const g=zm/o.normalizationRatio;t=t/o.normalizationRatio+o.normalizationOffsetX,i=i/o.normalizationRatio+o.normalizationOffsetY,r*=g;const S=nP(this.getPaintValue("circle-translate",n,s),this.getPaintValue("circle-translate-anchor",n,s),c,g),M=g*(this.getPaintValue("circle-radius",n,s)+this.getPaintValue("circle-stroke-width",n,s));let A,O;for(const z of p)if(z){for(const V of z)if(A=V.x+S.x,O=V.y+S.y,Math.sqrt((t-A)*(t-A)+(i-O)*(i-O))-r<=M)return!0}return!1}};class Dwe{constructor(t,i,r){let s;this.allowOverlap=t.getLayoutValue("icon-allow-overlap",i),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",i),this.keepUpright=t.getLayoutValue("icon-keep-upright",i),this.optional=t.getLayoutValue("icon-optional",i),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",i),this.rotationAlignment===Rl.AUTO&&(this.rotationAlignment=r?Rl.MAP:Rl.VIEWPORT),s=t.getLayoutProperty("icon-anchor"),s!=null&&s.isDataDriven?this._anchorProp=s:this.anchor=t.getLayoutValue("icon-anchor",i),s=t.getLayoutProperty("icon-offset"),s!=null&&s.isDataDriven?this._offsetProp=s:this.offset=t.getLayoutValue("icon-offset",i),s=t.getLayoutProperty("icon-padding"),s!=null&&s.isDataDriven?this._paddingProp=s:this.padding=t.getLayoutValue("icon-padding",i),s=t.getLayoutProperty("icon-rotate"),s!=null&&s.isDataDriven?this._rotateProp=s:this.rotate=t.getLayoutValue("icon-rotate",i),s=t.getLayoutProperty("icon-size"),s!=null&&s.isDataDriven?this._sizeProp=s:this.size=t.getLayoutValue("icon-size",i)}update(t,i){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,i)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,i)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,i)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,i)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,i))}}class Nwe{constructor(t,i,r){let s;this.allowOverlap=t.getLayoutValue("text-allow-overlap",i),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",i),this.keepUpright=t.getLayoutValue("text-keep-upright",i),this.optional=t.getLayoutValue("text-optional",i),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",i),this.rotationAlignment===Rl.AUTO&&(this.rotationAlignment=r?Rl.MAP:Rl.VIEWPORT),s=t.getLayoutProperty("text-anchor"),s!=null&&s.isDataDriven?this._anchorProp=s:this.anchor=t.getLayoutValue("text-anchor",i),s=t.getLayoutProperty("text-justify"),s!=null&&s.isDataDriven?this._justifyProp=s:this.justify=t.getLayoutValue("text-justify",i),s=t.getLayoutProperty("text-letter-spacing"),s!=null&&s.isDataDriven?this._letterSpacingProp=s:this.letterSpacing=t.getLayoutValue("text-letter-spacing",i),s=t.getLayoutProperty("text-line-height"),s!=null&&s.isDataDriven?this._lineHeightProp=s:this.lineHeight=t.getLayoutValue("text-line-height",i),s=t.getLayoutProperty("text-max-angle"),s!=null&&s.isDataDriven?this._maxAngleProp=s:this.maxAngle=t.getLayoutValue("text-max-angle",i),s=t.getLayoutProperty("text-max-width"),s!=null&&s.isDataDriven?this._maxWidthProp=s:this.maxWidth=t.getLayoutValue("text-max-width",i),s=t.getLayoutProperty("text-offset"),s!=null&&s.isDataDriven?this._offsetProp=s:this.offset=t.getLayoutValue("text-offset",i),s=t.getLayoutProperty("text-padding"),s!=null&&s.isDataDriven?this._paddingProp=s:this.padding=t.getLayoutValue("text-padding",i),s=t.getLayoutProperty("text-rotate"),s!=null&&s.isDataDriven?this._rotateProp=s:this.rotate=t.getLayoutValue("text-rotate",i),s=t.getLayoutProperty("text-size"),s!=null&&s.isDataDriven?this._sizeProp=s:this.size=t.getLayoutValue("text-size",i),s=t.getLayoutProperty("text-writing-mode"),s!=null&&s.isDataDriven?this._writingModeProp=s:this.writingMode=t.getLayoutValue("text-writing-mode",i)}update(t,i){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,i)),this._justifyProp&&(this.justify=this._justifyProp.getValue(t,i)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(t,i)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(t,i)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(t,i)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(t,i)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,i)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,i)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,i)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,i)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(t,i))}}function dP(e){const t=e==null?void 0:e.getGeometry();if(t==null)return null;let i=1/0,r=1/0,s=-1/0,n=-1/0;for(const c of t)if(c)for(const o of c)i=Math.min(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.x),n=Math.max(n,o.y);return eK(i,r,s,n)}class om{constructor(t){if(this._style=t,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,t.layers||(t.layers=[]),this.version=parseFloat(t.version),this.layers=t.layers.map((i,r,s)=>this._create(i,r,s)).filter(i=>!!i),this.layers)for(let i=0;i<this.layers.length;i++){const r=this.layers[i];this._layerByName[r.id]=r,this._uidToLayer.set(r.uid,r),r.type===Lr.BACKGROUND&&this.backgroundBucketIds.push(r.id)}this._identifyRefLayers()}isPainterDataDriven(t){const i=this._layerByName[t];return!!i&&i.isPainterDataDriven()}getStyleLayerId(t){return t>=this.layers.length?null:this.layers[t].id}getStyleLayerByUID(t){return this._uidToLayer.get(t)??null}getStyleLayerIndex(t){const i=this._layerByName[t];return i?this.layers.indexOf(i):-1}setStyleLayer(t,i){if(!(t!=null&&t.id))return;const r=this._style;i!=null&&i>=this.layers.length&&(i=this.layers.length-1);let s,n=!0;const c=this._layerByName[t.id];if(c){const o=this.layers.indexOf(c);i||(i=o),i===o?(n=!1,s=om._recreateLayer(t,c),this.layers[i]=s,r.layers[i]=t):(this.layers.splice(o,1),r.layers.splice(o,1),s=this._create(t,i,this.layers),this.layers.splice(i,0,s),r.layers.splice(i,0,t))}else s=this._create(t,i,this.layers),!i||i>=this.layers.length?(this.layers.push(s),r.layers.push(t)):(this.layers.splice(i,0,s),r.layers.splice(i,0,t));this._layerByName[t.id]=s,this._uidToLayer.set(s.uid,s),n&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(t){const i=this._layerByName[t];return i?{type:i.typeName,id:i.id,source:i.source,"source-layer":i.sourceLayer,minzoom:i.minzoom,maxzoom:i.maxzoom,filter:i.filter,layout:i.layout,paint:i.paint}:null}deleteStyleLayer(t){const i=this._layerByName[t];if(i){delete this._layerByName[t],this._uidToLayer.delete(i.uid);const r=this.layers.indexOf(i);this.layers.splice(r,1),this._style.layers.splice(r,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(t){return this._layerByName[t]}getLayoutProperties(t){const i=this._layerByName[t];return i?i.layout:null}getPaintProperties(t){const i=this._layerByName[t];return i?i.paint:null}setPaintProperties(t,i){const r=this._layerByName[t];if(!r)return;const s={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:r.layout,paint:i},n=om._recreateLayer(s,r),c=this.layers.indexOf(r);this.layers[c]=n,this._style.layers[c].paint=i,this._layerByName[r.id]=n,this._uidToLayer.set(r.uid,n)}setLayoutProperties(t,i){const r=this._layerByName[t];if(!r)return;const s={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:i,paint:r.paint},n=om._recreateLayer(s,r),c=this.layers.indexOf(r);this.layers[c]=n,this._style.layers[c].layout=i,this._layerByName[r.id]=n,this._uidToLayer.set(r.uid,n)}setStyleLayerVisibility(t,i){const r=this._layerByName[t];if(!r)return;const s=r.layout||{};s.visibility=i;const n={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:s,paint:r.paint},c=om._recreateLayer(n,r),o=this.layers.indexOf(r);this.layers[o]=c,this._style.layers[o].layout=s,this._layerByName[r.id]=c,this._uidToLayer.set(r.uid,c)}getStyleLayerVisibility(t){const i=this._layerByName[t];if(!i)return"none";const r=i.layout;return(r==null?void 0:r.visibility)??"visible"}_recomputeZValues(){const t=this.layers,i=1/(t.length+1);for(let r=0;r<t.length;r++)t[r].z=1-(1+r)*i}_identifyRefLayers(){const t=[],i=[];let r=0;for(const s of this.layers){const n=s.layout;if(s.type===Lr.FILL){const c=s;let o=s.source+"|"+s.sourceLayer;o+="|"+((n==null?void 0:n.visibility)??""),o+="|"+s.minzoom,o+="|"+s.maxzoom,o+="|"+JSON.stringify(s.filter),(c.hasDataDrivenFill||c.hasDataDrivenOutline)&&(o+="|"+r),t.push({key:o,layer:s})}else if(s.type===Lr.LINE){const c=s,o=s.paint,p=o!=null&&(o["line-pattern"]!=null||o["line-dasharray"]!=null);let g=s.source+"|"+s.sourceLayer;g+="|"+((n==null?void 0:n.visibility)??""),g+="|"+s.minzoom,g+="|"+s.maxzoom,g+="|"+JSON.stringify(s.filter),g+="|"+(n!==void 0?n["line-cap"]:""),g+="|"+(n!==void 0?n["line-join"]:""),(c.hasDataDrivenLine||p)&&(g+="|"+r),i.push({key:g,layer:s})}++r}this._assignRefLayers(t),this._assignRefLayers(i)}_assignRefLayers(t){let i,r;t.sort((n,c)=>n.key<c.key?-1:n.key>c.key?1:0);const s=t.length;for(let n=0;n<s;n++){const c=t[n];if(c.key===i)c.layer.refLayerId=r;else if(i=c.key,r=c.layer.id,c.layer.type===Lr.FILL){if(!c.layer.getPaintProperty("fill-outline-color"))for(let o=n+1;o<s;o++){const p=t[o];if(p.key!==i)break;if(p.layer.getPaintProperty("fill-outline-color")){t[n]=p,t[o]=c,r=p.layer.id;break}}}else if(c.layer.type===Lr.LINE){let o=c.layer;for(let p=n+1;p<s;p++){const g=t[p];if(g.key!==i)break;const S=g.layer;(o.canUseThinTessellation&&!S.canUseThinTessellation||!o.canUseThinTessellation&&(S.getPaintProperty("line-pattern")||S.getPaintProperty("line-dasharray")))&&(o=S,t[n]=g,t[p]=c,r=g.layer.id)}}}}_create(t,i,r){const s=1-(1+i)*(1/(r.length+1)),n=this._runningId++;switch(t.type){case"background":return new FD(Lr.BACKGROUND,t,s,n);case"fill":return new BD(Lr.FILL,t,s,n);case"line":return new UD(Lr.LINE,t,s,n);case"symbol":return new jD(Lr.SYMBOL,t,s,n);case"raster":return console.warn(`Unsupported vector tile raster layer ${t.id}`),null;case"circle":return new VD(Lr.CIRCLE,t,s,n)}return null}static _recreateLayer(t,i){switch(t.type){case"background":return new FD(Lr.BACKGROUND,t,i.z,i.uid);case"fill":return new BD(Lr.FILL,t,i.z,i.uid);case"line":return new UD(Lr.LINE,t,i.z,i.uid);case"symbol":return new jD(Lr.SYMBOL,t,i.z,i.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${t.id}`),null;case"circle":return new VD(Lr.CIRCLE,t,i.z,i.uid)}return null}}let Gi=class extends The(Fhe(Xue(Que(Rhe(zhe(Ehe(Vue(DU(M6))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.style=null,this.tilemapCache=null,this.type="vector-tile",this.url=null,this.path=null}normalizeCtorArgs(e,t){return typeof e=="string"?{url:e,...t}:e}destroy(){var e;if(this.sourceNameToSource)for(const t of Object.values(this.sourceNameToSource))t==null||t.destroy();(e=this.primarySource)==null||e.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){const t=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).catch(Na).then(async()=>{var r;if(!((r=this.portalItem)!=null&&r.id))return;const i=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await Xi(i,{...e,query:{f:"json",...this.customParameters,token:this.apiKey}})).data&&this.read({url:i},Xhe(this.portalItem,"portal-item"))}).catch(Na).then(()=>this._loadStyle(e));return this.addResolvingPromise(t),Promise.resolve(this)}get attributionDataUrl(){const e=this.currentStyleInfo,t=(e==null?void 0:e.serviceUrl)&&Mr(e.serviceUrl);if(!t)return null;const i=this._getDefaultAttribution(t.path);return i?Al(i,{...this.customParameters,token:this.apiKey}):null}get capabilities(){const e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){var e;return((e=this.primarySource)==null?void 0:e.fullExtent)||null}get initialExtent(){var e;return((e=this.primarySource)==null?void 0:e.initialExtent)||null}get parsedUrl(){return this.serviceUrl?Mr(this.serviceUrl):null}get serviceUrl(){var e;return((e=this.currentStyleInfo)==null?void 0:e.serviceUrl)||null}get spatialReference(){var e;return((e=this.tileInfo)==null?void 0:e.spatialReference)??null}get styleUrl(){var e;return((e=this.currentStyleInfo)==null?void 0:e.styleUrl)||null}writeStyleUrl(e,t){e&&na(e)&&(e=`https:${e}`);const i=HT(e);t.styleUrl=kA(e,i)}get tileInfo(){var i;const e=[];for(const r in this.sourceNameToSource)e.push(this.sourceNameToSource[r]);let t=((i=this.primarySource)==null?void 0:i.tileInfo)||new xp;if(e.length>1)for(let r=0;r<e.length;r++)Qhe(t,e[r].tileInfo)&&(t=ede(t,e[r].tileInfo));return t}readTilemapCache(e,t){var r;return((r=t.capabilities)==null?void 0:r.includes("Tilemap"))?new Wo({layer:this}):null}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){var i,r;if(!this._spriteSourceMap.has(e)){const s=wM().maxTextureSize,n=(i=this.currentStyleInfo)!=null&&i.spriteUrl?Al(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,c=new ZO({type:"url",spriteUrl:n,pixelRatio:e,spriteFormat:(r=this.currentStyleInfo)==null?void 0:r.spriteFormat},s);await c.load(t),this._spriteSourceMap.set(e,c)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;const i=wM().maxTextureSize,r=e.spriteUrl,s=r?Al(r,{...this.customParameters,token:this.apiKey}):null;if(!s&&e.type==="url")return null;const n=new ZO(e,i);try{await n.load(t);const c=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(c,n),s&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=s),this.emit("spriteSource-change",{spriteSource:n}),n}catch(c){Na(c)}return null}async loadStyle(e,t){var r;const i=e||this.style||this.url;return this._loadingTask&&typeof i=="string"&&this.url===i||((r=this._loadingTask)==null||r.abort(),this._loadingTask=px(s=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(i,{signal:s})),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){var t;return He((t=this.styleRepository)==null?void 0:t.getPaintProperties(e))}setPaintProperties(e,t){const i=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const r=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layer:e,paint:t,isDataDriven:i||r})}getStyleLayer(e){return He(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layer:e})}getLayoutProperties(e){return He(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(e,t){return t!=null&&t.origin&&!this.styleUrl?(t.messages&&t.messages.push(new Je("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}getTileUrl(e,t,i){return null}async _getSourceAndStyle(e,t){if(!e)throw new Error("invalid style!");const i=await Zhe(e,{...t,query:{...this.customParameters,token:this.apiKey}});i.spriteFormat==="webp"&&(await Uhe("lossy")||(i.spriteFormat="png")),this._set("currentStyleInfo",{...i}),typeof e=="string"?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",i.sourceNameToSource),this._set("primarySource",i.sourceNameToSource[i.primarySourceName]),this._set("styleRepository",new om(i.style)),this.read(i.layerDefinition,{origin:"service"}),this.emit("load-style")}_getDefaultAttribution(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i),i=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"];if(!t)return;const r=t[2]&&t[2].toLowerCase();if(!r)return;const s=t[1]||"";for(const n of i)if(n.toLowerCase().includes(r))return ta(`//static.arcgis.com/attribution/Vector${s}/${n}`)}async _loadStyle(e){var t;return((t=this._loadingTask)==null?void 0:t.promise)??this.loadStyle(null,e)}};v([I({readOnly:!0})],Gi.prototype,"attributionDataUrl",null),v([I({type:["show","hide"]})],Gi.prototype,"listMode",void 0),v([I({json:{read:!0,write:!0}})],Gi.prototype,"blendMode",void 0),v([I({readOnly:!0,json:{read:!1}})],Gi.prototype,"capabilities",null),v([I({readOnly:!0})],Gi.prototype,"currentStyleInfo",void 0),v([I({json:{read:!1},readOnly:!0,type:Bi})],Gi.prototype,"fullExtent",null),v([I({json:{read:!1},readOnly:!0,type:Bi})],Gi.prototype,"initialExtent",null),v([I({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Gi.prototype,"isReference",void 0),v([I({type:["VectorTileLayer"]})],Gi.prototype,"operationalLayerType",void 0),v([I({readOnly:!0})],Gi.prototype,"parsedUrl",null),v([I()],Gi.prototype,"style",void 0),v([I({readOnly:!0})],Gi.prototype,"serviceUrl",null),v([I({type:mi,readOnly:!0})],Gi.prototype,"spatialReference",null),v([I({readOnly:!0})],Gi.prototype,"styleRepository",void 0),v([I({readOnly:!0})],Gi.prototype,"sourceNameToSource",void 0),v([I({readOnly:!0})],Gi.prototype,"primarySource",void 0),v([I({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],Gi.prototype,"styleUrl",null),v([ci(["portal-item","web-document"],"styleUrl")],Gi.prototype,"writeStyleUrl",null),v([I({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:xp})],Gi.prototype,"tileInfo",null),v([I()],Gi.prototype,"tilemapCache",void 0),v([fi("service","tilemapCache",["capabilities","tileInfo"])],Gi.prototype,"readTilemapCache",null),v([I({json:{read:!1},readOnly:!0,value:"vector-tile"})],Gi.prototype,"type",void 0),v([I({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],Gi.prototype,"url",void 0),v([I({readOnly:!0})],Gi.prototype,"version",void 0),v([fi("version",["version","currentVersion"])],Gi.prototype,"readVersion",null),v([I({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Gi.prototype,"path",void 0),Gi=v([me("esri.layers.VectorTileLayer")],Gi);const Nb=Gi,zwe=Object.freeze(Object.defineProperty({__proto__:null,default:Nb},Symbol.toStringTag,{value:"Module"}));function Wpe(e){let t;return{c(){t=Pn("div"),os(t,"id","viewDiv"),os(t,"class","h-full")},m(i,r){Xo(i,t,r)},p:Dn,i:Dn,o:Dn,d(i){i&&vo(t)}}}function Zpe(e){let t=zb(lm),i=zb(IT),r;return qM(()=>{const s=new Nb({url:i}),n=new A6({basemap:{baseLayers:[s]}});r=new Fue({container:"viewDiv",map:n,center:t.center,zoom:t.zoom}),r.when(()=>{r.watch(["center","zoom"],()=>{lm.set({center:[r.center.longitude,r.center.latitude],zoom:r.zoom})})});const c=lm.subscribe(p=>{yh(()=>r.ready,()=>{(r.center.longitude!==p.center[0]||r.center.latitude!==p.center[1]||r.zoom!==p.zoom)&&r.goTo({center:p.center,zoom:p.zoom})})}),o=IT.subscribe(p=>{const g=r.map.basemap.baseLayers.getItemAt(0);if(g instanceof Nb&&g.url!==p){const S=new Nb({url:p});S.load().then(()=>{r.map.basemap.baseLayers.removeAll(),r.map.basemap.baseLayers.add(S)}).catch(M=>{console.error("Failed to load basemap:",M)})}});return()=>{c(),o()}}),[]}class Ype extends Bl{constructor(t){super(),Fl(this,t,Zpe,Wpe,Ka,{})}}const U9=Symbol.for("svelte-maplibre");function O_(){return a7(U9)}function Jpe(e){let t=new WeakMap;return i=>{var c;let r=t.get(i.originalEvent);if(r!==void 0)return r;let n=(c=i.target.queryRenderedFeatures(i.point).find(o=>{var p;return(p=e.get(o.layer.id))==null?void 0:p.interactive}))==null?void 0:c.layer.id;return t.set(i.originalEvent,n),n}}function Kpe(){let e=new Map;return o7(U9,{map:Jo(null),source:uS(null),layer:uS(null),popupTarget:uS(null),cluster:Jo(),loadedImages:Jo(new Set),minzoom:Jo(0),maxzoom:Jo(24),layerEvent:Jo(null),layerInfo:e,eventTopMost:Jpe(e)})}var Xpe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qpe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j9={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.2/LICENSE.txt
 */(function(e,t){(function(i,r){e.exports=r()})(Xpe,function(){var i={},r={};function s(c,o,p){if(r[c]=p,c==="index"){var g="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",S={};return r.shared(S),r.index(i,S),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([g],{type:"text/javascript"}))),i}}s("shared",["exports"],function(c){function o(u,a,h,f){return new(h||(h=Promise))(function(b,T){function E(L){try{k(f.next(L))}catch(N){T(N)}}function P(L){try{k(f.throw(L))}catch(N){T(N)}}function k(L){var N;L.done?b(L.value):(N=L.value,N instanceof h?N:new h(function(F){F(N)})).then(E,P)}k((f=f.apply(u,a||[])).next())})}function p(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var g=S;function S(u,a){this.x=u,this.y=a}S.prototype={clone:function(){return new S(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,a){return this.clone()._rotateAround(u,a)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var a=u.x-this.x,h=u.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,a){return Math.atan2(this.x*a-this.y*u,this.x*u+this.y*a)},_matMult:function(u){var a=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=a,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var a=Math.cos(u),h=Math.sin(u),f=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=f,this},_rotateAround:function(u,a){var h=Math.cos(u),f=Math.sin(u),b=a.y+f*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-f*(this.y-a.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},S.convert=function(u){return u instanceof S?u:Array.isArray(u)?new S(u[0],u[1]):u};var M=p(g),A=O;function O(u,a,h,f){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=h,this.p2y=f}O.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,f=0;f<8;f++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<a)return h;var T=this.sampleCurveDerivativeX(h);if(Math.abs(T)<1e-6)break;h-=b/T}var E=0,P=1;for(h=u,f=0;f<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<a));f++)u>b?E=h:P=h,h=.5*(P-E)+E;return h},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};var z=p(A);let V,W;function ie(){return V==null&&(V=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),V}function ve(){if(W==null&&(W=!1,ie())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let f=0;f<5*5;f++){const b=4*f;a.fillStyle=`rgb(${b},${b+1},${b+2})`,a.fillRect(f%5,Math.floor(f/5),1,1)}const h=a.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&h[f]!==f){W=!0;break}}}return W||!1}function pe(u,a,h,f){const b=new z(u,a,h,f);return function(T){return b.solve(T)}}const _e=pe(.25,.1,.25,1);function Me(u,a,h){return Math.min(h,Math.max(a,u))}function $e(u,a,h){const f=h-a,b=((u-a)%f+f)%f+a;return b===a?h:b}function Fe(u,...a){for(const h of a)for(const f in h)u[f]=h[f];return u}let Ge=1;function et(u,a,h){const f={};for(const b in u)f[b]=a.call(h||this,u[b],b,u);return f}function at(u,a,h){const f={};for(const b in u)a.call(h||this,u[b],b,u)&&(f[b]=u[b]);return f}function ct(u){return Array.isArray(u)?u.map(ct):typeof u=="object"&&u?et(u,ct):u}const nt={};function Pt(u){nt[u]||(typeof console<"u"&&console.warn(u),nt[u]=!0)}function ft(u,a,h){return(h.y-u.y)*(a.x-u.x)>(a.y-u.y)*(h.x-u.x)}function vi(u){let a=0;for(let h,f,b=0,T=u.length,E=T-1;b<T;E=b++)h=u[b],f=u[E],a+=(f.x-h.x)*(h.y+f.y);return a}function Li(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let Tt=null;function Ft(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const Hi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Fr(u,a,h,f,b){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(u,{timestamp:0});try{const E=T==null?void 0:T.format;if(!E||!E.startsWith("BGR")&&!E.startsWith("RGB"))throw new Error(`Unrecognized format ${E}`);const P=E.startsWith("BGR"),k=new Uint8ClampedArray(f*b*4);if(yield T.copyTo(k,function(L,N,F,G,Z){const J=4*Math.max(-N,0),Q=(Math.max(0,F)-F)*G*4+J,oe=4*G,ue=Math.max(0,N),Te=Math.max(0,F);return{rect:{x:ue,y:Te,width:Math.min(L.width,N+G)-ue,height:Math.min(L.height,F+Z)-Te},layout:[{offset:Q,stride:oe}]}}(u,a,h,f,b)),P)for(let L=0;L<k.length;L+=4){const N=k[L];k[L]=k[L+2],k[L+2]=N}return k}finally{T.close()}})}let Cr,_r;const Cs="AbortError";function fs(){return new Error(Cs)}const Zs={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function yn(u){return Zs.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const Kr="global-dispatcher";class ms extends Error{constructor(a,h,f,b){super(`AJAXError: ${h} (${a}): ${f}`),this.status=a,this.statusText=h,this.url=f,this.body=b}}const Ke=()=>Li(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,oi=function(u,a){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const f=yn(u.url);if(f)return f(u,a);if(Li(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:u,targetMapId:Kr},a)}if(!(/^file:/.test(h=u.url)||/^file:/.test(Ke())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,b){return o(this,void 0,void 0,function*(){const T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Ke(),signal:b.signal});f.type==="json"&&T.headers.set("Accept","application/json");const E=yield fetch(T);if(!E.ok){const L=yield E.blob();throw new ms(E.status,E.statusText,f.url,L)}let P;P=f.type==="arrayBuffer"||f.type==="image"?E.arrayBuffer():f.type==="json"?E.json():E.text();const k=yield P;if(b.signal.aborted)throw fs();return{data:k,cacheControl:E.headers.get("Cache-Control"),expires:E.headers.get("Expires")}})}(u,a);if(Li(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:u,mustQueue:!0,targetMapId:Kr},a)}var h;return function(f,b){return new Promise((T,E)=>{const P=new XMLHttpRequest;P.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(P.responseType="arraybuffer");for(const k in f.headers)P.setRequestHeader(k,f.headers[k]);f.type==="json"&&(P.responseType="text",P.setRequestHeader("Accept","application/json")),P.withCredentials=f.credentials==="include",P.onerror=()=>{E(new Error(P.statusText))},P.onload=()=>{if(!b.signal.aborted)if((P.status>=200&&P.status<300||P.status===0)&&P.response!==null){let k=P.response;if(f.type==="json")try{k=JSON.parse(P.response)}catch(L){return void E(L)}T({data:k,cacheControl:P.getResponseHeader("Cache-Control"),expires:P.getResponseHeader("Expires")})}else{const k=new Blob([P.response],{type:P.getResponseHeader("Content-Type")});E(new ms(P.status,P.statusText,f.url,k))}},b.signal.addEventListener("abort",()=>{P.abort(),E(fs())}),P.send(f.body)})}(u,a)};function Di(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const a=new URL(u),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function $s(u,a,h){h[u]&&h[u].indexOf(a)!==-1||(h[u]=h[u]||[],h[u].push(a))}function Io(u,a,h){if(h&&h[u]){const f=h[u].indexOf(a);f!==-1&&h[u].splice(f,1)}}class Mo{constructor(a,h={}){Fe(this,h),this.type=a}}class vr extends Mo{constructor(a,h={}){super("error",Fe({error:a},h))}}class la{on(a,h){return this._listeners=this._listeners||{},$s(a,h,this._listeners),this}off(a,h){return Io(a,h,this._listeners),Io(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},$s(a,h,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,h){typeof a=="string"&&(a=new Mo(a,h||{}));const f=a.type;if(this.listens(f)){a.target=this;const b=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const P of b)P.call(this,a);const T=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const P of T)Io(f,P,this._oneTimeListeners),P.call(this,a);const E=this._eventedParent;E&&(Fe(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(a))}else a instanceof vr&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var Oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ca=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Vl(u,a){const h={};for(const f in u)f!=="ref"&&(h[f]=u[f]);return ca.forEach(f=>{f in a&&(h[f]=a[f])}),h}function ai(u,a){if(Array.isArray(u)){if(!Array.isArray(a)||u.length!==a.length)return!1;for(let h=0;h<u.length;h++)if(!ai(u[h],a[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&a!==null){if(typeof a!="object"||Object.keys(u).length!==Object.keys(a).length)return!1;for(const h in u)if(!ai(u[h],a[h]))return!1;return!0}return u===a}function Br(u,a){u.push(a)}function Bn(u,a,h){Br(h,{command:"addSource",args:[u,a[u]]})}function Qa(u,a,h){Br(a,{command:"removeSource",args:[u]}),h[u]=!0}function el(u,a,h,f){Qa(u,h,f),Bn(u,a,h)}function ua(u,a,h){let f;for(f in u[h])if(Object.prototype.hasOwnProperty.call(u[h],f)&&f!=="data"&&!ai(u[h][f],a[h][f]))return!1;for(f in a[h])if(Object.prototype.hasOwnProperty.call(a[h],f)&&f!=="data"&&!ai(u[h][f],a[h][f]))return!1;return!0}function Ao(u,a,h,f,b,T){u=u||{},a=a||{};for(const E in u)Object.prototype.hasOwnProperty.call(u,E)&&(ai(u[E],a[E])||h.push({command:T,args:[f,E,a[E],b]}));for(const E in a)Object.prototype.hasOwnProperty.call(a,E)&&!Object.prototype.hasOwnProperty.call(u,E)&&(ai(u[E],a[E])||h.push({command:T,args:[f,E,a[E],b]}))}function ks(u){return u.id}function Gl(u,a){return u[a.id]=a,u}class Xe{constructor(a,h,f,b){this.message=(a?`${a}: `:"")+f,b&&(this.identifier=b),h!=null&&h.__line__&&(this.line=h.__line__)}}function Rs(u,...a){for(const h of a)for(const f in h)u[f]=h[f];return u}class ys extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class ql{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[f,b]of h)this.bindings[f]=b}concat(a){return new ql(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const ha={kind:"null"},Ye={kind:"number"},Ht={kind:"string"},jt={kind:"boolean"},Ur={kind:"color"},Ys={kind:"object"},Gt={kind:"value"},Po={kind:"collator"},io={kind:"formatted"},se={kind:"padding"},j={kind:"resolvedImage"},H={kind:"variableAnchorOffsetCollection"};function K(u,a){return{kind:"array",itemType:u,N:a}}function te(u){if(u.kind==="array"){const a=te(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}const ye=[ha,Ye,Ht,jt,Ur,io,Ys,K(Gt),se,j,H];function ge(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!ge(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(const h of ye)if(!ge(h,a))return null}}return`Expected ${te(u)} but found ${te(a)} instead.`}function Se(u,a){return a.some(h=>h.kind===u.kind)}function he(u,a){return a.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function Ie(u,a){return u.kind==="array"&&a.kind==="array"?u.itemType.kind===a.itemType.kind&&typeof u.N=="number":u.kind===a.kind}const Be=.96422,ee=.82521,ke=4/29,gt=6/29,xt=3*gt*gt,It=gt*gt*gt,Ze=Math.PI/180,Dt=180/Math.PI;function Xt(u){return(u%=360)<0&&(u+=360),u}function wi([u,a,h,f]){let b,T;const E=kt((.2225045*(u=or(u))+.7168786*(a=or(a))+.0606169*(h=or(h)))/1);u===a&&a===h?b=T=E:(b=kt((.4360747*u+.3850649*a+.1430804*h)/Be),T=kt((.0139322*u+.0971045*a+.7141733*h)/ee));const P=116*E-16;return[P<0?0:P,500*(b-E),200*(E-T),f]}function or(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function kt(u){return u>It?Math.pow(u,1/3):u/xt+ke}function Wi([u,a,h,f]){let b=(u+16)/116,T=isNaN(a)?b:b+a/500,E=isNaN(h)?b:b-h/200;return b=1*Mt(b),T=Be*Mt(T),E=ee*Mt(E),[br(3.1338561*T-1.6168667*b-.4906146*E),br(-.9787684*T+1.9161415*b+.033454*E),br(.0719453*T-.2289914*b+1.4052427*E),f]}function br(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Mt(u){return u>gt?u*u*u:xt*(u-ke)}function Xr(u){return parseInt(u.padEnd(2,u),16)/255}function Qr(u,a){return Os(a?u/100:u,0,1)}function Os(u,a,h){return Math.min(Math.max(a,u),h)}function kp(u){return!u.some(Number.isNaN)}const kh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ei{constructor(a,h,f,b=1,T=!0){this.r=a,this.g=h,this.b=f,this.a=b,T||(this.r*=b,this.g*=b,this.b*=b,b||this.overwriteGetter("rgb",[a,h,f,b]))}static parse(a){if(a instanceof Ei)return a;if(typeof a!="string")return;const h=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const b=kh[f];if(b){const[E,P,k]=b;return[E/255,P/255,k/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const E=f.length<6?1:2;let P=1;return[Xr(f.slice(P,P+=E)),Xr(f.slice(P,P+=E)),Xr(f.slice(P,P+=E)),Xr(f.slice(P,P+E)||"ff")]}if(f.startsWith("rgb")){const E=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[P,k,L,N,F,G,Z,J,Q,oe,ue,Te]=E,de=[N||" ",Z||" ",oe].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const we=[L,G,Q].join(""),Ne=we==="%%%"?100:we===""?255:0;if(Ne){const ze=[Os(+k/Ne,0,1),Os(+F/Ne,0,1),Os(+J/Ne,0,1),ue?Qr(+ue,Te):1];if(kp(ze))return ze}}return}}const T=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[E,P,k,L,N,F,G,Z,J]=T,Q=[k||" ",N||" ",G].join("");if(Q==="  "||Q==="  /"||Q===",,"||Q===",,,"){const oe=[+P,Os(+L,0,100),Os(+F,0,100),Z?Qr(+Z,J):1];if(kp(oe))return function([ue,Te,de,we]){function Ne(ze){const lt=(ze+ue/30)%12,vt=Te*Math.min(de,1-de);return de-vt*Math.max(-1,Math.min(lt-3,9-lt,1))}return ue=Xt(ue),Te/=100,de/=100,[Ne(0),Ne(8),Ne(4),we]}(oe)}}}(a);return h?new Ei(...h,!1):void 0}get rgb(){const{r:a,g:h,b:f,a:b}=this,T=b||1/0;return this.overwriteGetter("rgb",[a/T,h/T,f/T,b])}get hcl(){return this.overwriteGetter("hcl",function(a){const[h,f,b,T]=wi(a),E=Math.sqrt(f*f+b*b);return[Math.round(1e4*E)?Xt(Math.atan2(b,f)*Dt):NaN,E,h,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",wi(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,f,b]=this.rgb;return`rgba(${[a,h,f].map(T=>Math.round(255*T)).join(",")},${b})`}}Ei.black=new Ei(0,0,0,1),Ei.white=new Ei(1,1,1,1),Ei.transparent=new Ei(0,0,0,0),Ei.red=new Ei(1,0,0,1);class Hl{constructor(a,h,f){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pr{constructor(a,h,f,b,T){this.text=a,this.image=h,this.scale=f,this.fontStack=b,this.textColor=T}}class Ls{constructor(a){this.sections=a}static fromString(a){return new Ls([new pr(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof Ls?a:Ls.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class gs{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof gs)return a;if(typeof a=="number")return new gs([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new gs(a)}}toString(){return JSON.stringify(this.values)}}const Rp=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class es{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof es)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){const f=a[h],b=a[h+1];if(typeof f!="string"||!Rp.has(f)||!Array.isArray(b)||b.length!==2||typeof b[0]!="number"||typeof b[1]!="number")return}return new es(a)}}toString(){return JSON.stringify(this.values)}}class Js{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Js({name:a,available:!1}):null}}function Op(u,a,h,f){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,a,h,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,a,h,f]:[u,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Co(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Ei||u instanceof Hl||u instanceof Ls||u instanceof gs||u instanceof es||u instanceof Js)return!0;if(Array.isArray(u)){for(const a of u)if(!Co(a))return!1;return!0}if(typeof u=="object"){for(const a in u)if(!Co(u[a]))return!1;return!0}return!1}function Si(u){if(u===null)return ha;if(typeof u=="string")return Ht;if(typeof u=="boolean")return jt;if(typeof u=="number")return Ye;if(u instanceof Ei)return Ur;if(u instanceof Hl)return Po;if(u instanceof Ls)return io;if(u instanceof gs)return se;if(u instanceof es)return H;if(u instanceof Js)return j;if(Array.isArray(u)){const a=u.length;let h;for(const f of u){const b=Si(f);if(h){if(h===b)continue;h=Gt;break}h=b}return K(h||Gt,a)}return Ys}function Wl(u){const a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof Ei||u instanceof Ls||u instanceof gs||u instanceof es||u instanceof Js?u.toString():JSON.stringify(u)}class da{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Co(a[1]))return h.error("invalid value");const f=a[1];let b=Si(f);const T=h.expectedType;return b.kind!=="array"||b.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(b=T),new da(b,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ae{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const De={string:Ht,number:Ye,boolean:jt,object:Ys};class je{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let f,b=1;const T=a[0];if(T==="array"){let P,k;if(a.length>2){const L=a[1];if(typeof L!="string"||!(L in De)||L==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);P=De[L],b++}else P=Gt;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);k=a[2],b++}f=K(P,k)}else{if(!De[T])throw new Error(`Types doesn't contain name = ${T}`);f=De[T]}const E=[];for(;b<a.length;b++){const P=h.parse(a[b],b,Gt);if(!P)return null;E.push(P)}return new je(f,E)}evaluate(a){for(let h=0;h<this.args.length;h++){const f=this.args[h].evaluate(a);if(!ge(this.type,Si(f)))return f;if(h===this.args.length-1)throw new ae(`Expected value to be of type ${te(this.type)}, but found ${te(Si(f))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Zt={"to-boolean":jt,"to-color":Ur,"to-number":Ye,"to-string":Ht};class Mi{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const f=a[0];if(!Zt[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&a.length!==2)return h.error("Expected one argument.");const b=Zt[f],T=[];for(let E=1;E<a.length;E++){const P=h.parse(a[E],E,Gt);if(!P)return null;T.push(P)}return new Mi(b,T)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,f;for(const b of this.args){if(h=b.evaluate(a),f=null,h instanceof Ei)return h;if(typeof h=="string"){const T=a.parseColor(h);if(T)return T}else if(Array.isArray(h)&&(f=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Op(h[0],h[1],h[2],h[3]),!f))return new Ei(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new ae(f||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const f of this.args){h=f.evaluate(a);const b=gs.parse(h);if(b)return b}throw new ae(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const f of this.args){h=f.evaluate(a);const b=es.parse(h);if(b)return b}throw new ae(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const f of this.args){if(h=f.evaluate(a),h===null)return 0;const b=Number(h);if(!isNaN(b))return b}throw new ae(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Ls.fromString(Wl(this.args[0].evaluate(a)));case"resolvedImage":return Js.fromString(Wl(this.args[0].evaluate(a)));default:return Wl(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Ti=["Unknown","Point","LineString","Polygon"];class jr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ti[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache[a];return h||(h=this._parseColorCache[a]=Ei.parse(a)),h}}class yi{constructor(a,h,f=[],b,T=new ql,E=[]){this.registry=a,this.path=f,this.key=f.map(P=>`[${P}]`).join(""),this.scope=T,this.errors=E,this.expectedType=b,this._isConstant=h}parse(a,h,f,b,T={}){return h?this.concat(h,f,b)._parse(a,T):this._parse(a,T)}_parse(a,h){function f(b,T,E){return E==="assert"?new je(T,[b]):E==="coerce"?new Mi(T,[b]):b}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const b=a[0];if(typeof b!="string")return this.error(`Expression name must be a string, but found ${typeof b} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[b];if(T){let E=T.parse(a,this);if(!E)return null;if(this.expectedType){const P=this.expectedType,k=E.type;if(P.kind!=="string"&&P.kind!=="number"&&P.kind!=="boolean"&&P.kind!=="object"&&P.kind!=="array"||k.kind!=="value")if(P.kind!=="color"&&P.kind!=="formatted"&&P.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string")if(P.kind!=="padding"||k.kind!=="value"&&k.kind!=="number"&&k.kind!=="array")if(P.kind!=="variableAnchorOffsetCollection"||k.kind!=="value"&&k.kind!=="array"){if(this.checkSubtype(P,k))return null}else E=f(E,P,h.typeAnnotation||"coerce");else E=f(E,P,h.typeAnnotation||"coerce");else E=f(E,P,h.typeAnnotation||"coerce");else E=f(E,P,h.typeAnnotation||"assert")}if(!(E instanceof da)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const P=new jr;try{E=new da(E.type,E.evaluate(P))}catch(k){return this.error(k.message),null}}return E}return this.error(`Unknown expression "${b}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,f){const b=typeof a=="number"?this.path.concat(a):this.path,T=f?this.scope.concat(f):this.scope;return new yi(this.registry,this._isConstant,b,h||null,T,this.errors)}error(a,...h){const f=`${this.key}${h.map(b=>`[${b}]`).join("")}`;this.errors.push(new ys(f,a))}checkSubtype(a,h){const f=ge(a,h);return f&&this.error(f),f}}class Lp{constructor(a,h,f){this.type=Po,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return h.error("Collator options argument must be an object.");const b=h.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,jt);if(!b)return null;const T=h.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,jt);if(!T)return null;let E=null;return f.locale&&(E=h.parse(f.locale,1,Ht),!E)?null:new Lp(b,T,E)}evaluate(a){return new Hl(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}const $o=8192;function Xm(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function Rh(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function N_(u,a){const h=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,b=Math.pow(2,a.z);return[Math.round(h*b*$o),Math.round(f*b*$o)]}function n2(u,a,h){const f=u[0]-a[0],b=u[1]-a[1],T=u[0]-h[0],E=u[1]-h[1];return f*E-T*b==0&&f*T<=0&&b*E<=0}function Dp(u,a){let h=!1;for(let E=0,P=a.length;E<P;E++){const k=a[E];for(let L=0,N=k.length;L<N-1;L++){if(n2(u,k[L],k[L+1]))return!1;(b=k[L])[1]>(f=u)[1]!=(T=k[L+1])[1]>f[1]&&f[0]<(T[0]-b[0])*(f[1]-b[1])/(T[1]-b[1])+b[0]&&(h=!h)}}var f,b,T;return h}function z_(u,a){for(let h=0;h<a.length;h++)if(Dp(u,a[h]))return!0;return!1}function F_(u,a,h,f){const b=f[0]-h[0],T=f[1]-h[1],E=(u[0]-h[0])*T-b*(u[1]-h[1]),P=(a[0]-h[0])*T-b*(a[1]-h[1]);return E>0&&P<0||E<0&&P>0}function o2(u,a,h){for(const L of h)for(let N=0;N<L.length-1;++N)if((P=[(E=L[N+1])[0]-(T=L[N])[0],E[1]-T[1]])[0]*(k=[(b=a)[0]-(f=u)[0],b[1]-f[1]])[1]-P[1]*k[0]!=0&&F_(f,b,T,E)&&F_(T,E,f,b))return!0;var f,b,T,E,P,k;return!1}function B_(u,a){for(let h=0;h<u.length;++h)if(!Dp(u[h],a))return!1;for(let h=0;h<u.length-1;++h)if(o2(u[h],u[h+1],a))return!1;return!0}function a2(u,a){for(let h=0;h<a.length;h++)if(B_(u,a[h]))return!0;return!1}function Np(u,a,h){const f=[];for(let b=0;b<u.length;b++){const T=[];for(let E=0;E<u[b].length;E++){const P=N_(u[b][E],h);Xm(a,P),T.push(P)}f.push(T)}return f}function Qm(u,a,h){const f=[];for(let b=0;b<u.length;b++){const T=Np(u[b],a,h);f.push(T)}return f}function U_(u,a,h,f){if(u[0]<h[0]||u[0]>h[2]){const b=.5*f;let T=u[0]-h[0]>b?-f:h[0]-u[0]>b?f:0;T===0&&(T=u[0]-h[2]>b?-f:h[2]-u[0]>b?f:0),u[0]+=T}Xm(a,u)}function j_(u,a,h,f){const b=Math.pow(2,f.z)*$o,T=[f.x*$o,f.y*$o],E=[];for(const P of u)for(const k of P){const L=[k.x+T[0],k.y+T[1]];U_(L,a,h,b),E.push(L)}return E}function zp(u,a,h,f){const b=Math.pow(2,f.z)*$o,T=[f.x*$o,f.y*$o],E=[];for(const k of u){const L=[];for(const N of k){const F=[N.x+T[0],N.y+T[1]];Xm(a,F),L.push(F)}E.push(L)}if(a[2]-a[0]<=b/2){(P=a)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(const k of E)for(const L of k)U_(L,a,h,b)}var P;return E}class Zl{constructor(a,h){this.type=jt,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Co(a[1])){const f=a[1];if(f.type==="FeatureCollection"){const b=[];for(const T of f.features){const{type:E,coordinates:P}=T.geometry;E==="Polygon"&&b.push(P),E==="MultiPolygon"&&b.push(...P)}if(b.length)return new Zl(f,{type:"MultiPolygon",coordinates:b})}else if(f.type==="Feature"){const b=f.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Zl(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Zl(f,f)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,f){const b=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=h.canonicalID();if(f.type==="Polygon"){const P=Np(f.coordinates,T,E),k=j_(h.geometry(),b,T,E);if(!Rh(b,T))return!1;for(const L of k)if(!Dp(L,P))return!1}if(f.type==="MultiPolygon"){const P=Qm(f.coordinates,T,E),k=j_(h.geometry(),b,T,E);if(!Rh(b,T))return!1;for(const L of k)if(!z_(L,P))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,f){const b=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=h.canonicalID();if(f.type==="Polygon"){const P=Np(f.coordinates,T,E),k=zp(h.geometry(),b,T,E);if(!Rh(b,T))return!1;for(const L of k)if(!B_(L,P))return!1}if(f.type==="MultiPolygon"){const P=Qm(f.coordinates,T,E),k=zp(h.geometry(),b,T,E);if(!Rh(b,T))return!1;for(const L of k)if(!a2(L,P))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Fp{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const f=a[1];return h.scope.has(f)?new Fp(f,h.scope.get(f)):h.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class Un{constructor(a,h,f,b){this.name=a,this.type=h,this._evaluate=f,this.args=b}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const f=a[0],b=Un.definitions[f];if(!b)return h.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(b)?b[0]:b.type,E=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,P=E.filter(([L])=>!Array.isArray(L)||L.length===a.length-1);let k=null;for(const[L,N]of P){k=new yi(h.registry,Oh,h.path,null,h.scope);const F=[];let G=!1;for(let Z=1;Z<a.length;Z++){const J=a[Z],Q=Array.isArray(L)?L[Z-1]:L.type,oe=k.parse(J,1+F.length,Q);if(!oe){G=!0;break}F.push(oe)}if(!G)if(Array.isArray(L)&&L.length!==F.length)k.error(`Expected ${L.length} arguments, but found ${F.length} instead.`);else{for(let Z=0;Z<F.length;Z++){const J=Array.isArray(L)?L[Z]:L.type,Q=F[Z];k.concat(Z+1).checkSubtype(J,Q.type)}if(k.errors.length===0)return new Un(f,T,N,F)}}if(P.length===1)h.errors.push(...k.errors);else{const L=(P.length?P:E).map(([F])=>{return G=F,Array.isArray(G)?`(${G.map(te).join(", ")})`:`(${te(G.type)}...)`;var G}).join(" | "),N=[];for(let F=1;F<a.length;F++){const G=h.parse(a[F],1+N.length);if(!G)return null;N.push(te(G.type))}h.error(`Expected arguments of type ${L}, but found (${N.join(", ")}) instead.`)}return null}static register(a,h){Un.definitions=h;for(const f in h)a[f]=Un}}function Oh(u){if(u instanceof Fp)return Oh(u.boundExpression);if(u instanceof Un&&u.name==="error"||u instanceof Lp||u instanceof Zl)return!1;const a=u instanceof Mi||u instanceof je;let h=!0;return u.eachChild(f=>{h=a?h&&Oh(f):h&&f instanceof da}),!!h&&Lh(u)&&Bp(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Lh(u){if(u instanceof Un&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Zl)return!1;let a=!0;return u.eachChild(h=>{a&&!Lh(h)&&(a=!1)}),a}function Dh(u){if(u instanceof Un&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(h=>{a&&!Dh(h)&&(a=!1)}),a}function Bp(u,a){if(u instanceof Un&&a.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(f=>{h&&!Bp(f,a)&&(h=!1)}),h}function Nh(u,a){const h=u.length-1;let f,b,T=0,E=h,P=0;for(;T<=E;)if(P=Math.floor((T+E)/2),f=u[P],b=u[P+1],f<=a){if(P===h||a<b)return P;T=P+1}else{if(!(f>a))throw new ae("Input is not a number.");E=P-1}return 0}class qc{constructor(a,h,f){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[b,T]of f)this.labels.push(b),this.outputs.push(T)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const f=h.parse(a[1],1,Ye);if(!f)return null;const b=[];let T=null;h.expectedType&&h.expectedType.kind!=="value"&&(T=h.expectedType);for(let E=1;E<a.length;E+=2){const P=E===1?-1/0:a[E],k=a[E+1],L=E,N=E+1;if(typeof P!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(b.length&&b[b.length-1][0]>=P)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const F=h.parse(k,N,T);if(!F)return null;T=T||F.type,b.push([P,F])}return new qc(T,f,b)}evaluate(a){const h=this.labels,f=this.outputs;if(h.length===1)return f[0].evaluate(a);const b=this.input.evaluate(a);if(b<=h[0])return f[0].evaluate(a);const T=h.length;return b>=h[T-1]?f[T-1].evaluate(a):f[Nh(h,b)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function l2(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var c2=V_;function V_(u,a,h,f){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=h,this.p2y=f}V_.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,f=0;f<8;f++){var b=this.sampleCurveX(h)-u;if(Math.abs(b)<a)return h;var T=this.sampleCurveDerivativeX(h);if(Math.abs(T)<1e-6)break;h-=b/T}var E=0,P=1;for(h=u,f=0;f<20&&(b=this.sampleCurveX(h),!(Math.abs(b-u)<a));f++)u>b?E=h:P=h,h=.5*(P-E)+E;return h},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};var u2=l2(c2);function Yl(u,a,h){return u+h*(a-u)}function Up(u,a,h){return u.map((f,b)=>Yl(f,a[b],h))}const gn={number:Yl,color:function(u,a,h,f="rgb"){switch(f){case"rgb":{const[b,T,E,P]=Up(u.rgb,a.rgb,h);return new Ei(b,T,E,P,!1)}case"hcl":{const[b,T,E,P]=u.hcl,[k,L,N,F]=a.hcl;let G,Z;if(isNaN(b)||isNaN(k))isNaN(b)?isNaN(k)?G=NaN:(G=k,E!==1&&E!==0||(Z=L)):(G=b,N!==1&&N!==0||(Z=T));else{let Te=k-b;k>b&&Te>180?Te-=360:k<b&&b-k>180&&(Te+=360),G=b+h*Te}const[J,Q,oe,ue]=function([Te,de,we,Ne]){return Te=isNaN(Te)?0:Te*Ze,Wi([we,Math.cos(Te)*de,Math.sin(Te)*de,Ne])}([G,Z??Yl(T,L,h),Yl(E,N,h),Yl(P,F,h)]);return new Ei(J,Q,oe,ue,!1)}case"lab":{const[b,T,E,P]=Wi(Up(u.lab,a.lab,h));return new Ei(b,T,E,P,!1)}}},array:Up,padding:function(u,a,h){return new gs(Up(u.values,a.values,h))},variableAnchorOffsetCollection:function(u,a,h){const f=u.values,b=a.values;if(f.length!==b.length)throw new ae(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${a.toString()}`);const T=[];for(let E=0;E<f.length;E+=2){if(f[E]!==b[E])throw new ae(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${f[E]}, to[${E}]: ${b[E]}`);T.push(f[E]);const[P,k]=f[E+1],[L,N]=b[E+1];T.push([Yl(P,L,h),Yl(k,N,h)])}return new es(T)}};class Ds{constructor(a,h,f,b,T){this.type=a,this.operator=h,this.interpolation=f,this.input=b,this.labels=[],this.outputs=[];for(const[E,P]of T)this.labels.push(E),this.outputs.push(P)}static interpolationFactor(a,h,f,b){let T=0;if(a.name==="exponential")T=Hc(h,a.base,f,b);else if(a.name==="linear")T=Hc(h,1,f,b);else if(a.name==="cubic-bezier"){const E=a.controlPoints;T=new u2(E[0],E[1],E[2],E[3]).solve(Hc(h,1,f,b))}return T}static parse(a,h){let[f,b,T,...E]=a;if(!Array.isArray(b)||b.length===0)return h.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){const L=b[1];if(typeof L!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:L}}else{if(b[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(b[0])}`,1,0);{const L=b.slice(1);if(L.length!==4||L.some(N=>typeof N!="number"||N<0||N>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:L}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(T=h.parse(T,2,Ye),!T)return null;const P=[];let k=null;f==="interpolate-hcl"||f==="interpolate-lab"?k=Ur:h.expectedType&&h.expectedType.kind!=="value"&&(k=h.expectedType);for(let L=0;L<E.length;L+=2){const N=E[L],F=E[L+1],G=L+3,Z=L+4;if(typeof N!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(P.length&&P[P.length-1][0]>=N)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const J=h.parse(F,Z,k);if(!J)return null;k=k||J.type,P.push([N,J])}return Ie(k,Ye)||Ie(k,Ur)||Ie(k,se)||Ie(k,H)||Ie(k,K(Ye))?new Ds(k,f,b,T,P):h.error(`Type ${te(k)} is not interpolatable.`)}evaluate(a){const h=this.labels,f=this.outputs;if(h.length===1)return f[0].evaluate(a);const b=this.input.evaluate(a);if(b<=h[0])return f[0].evaluate(a);const T=h.length;if(b>=h[T-1])return f[T-1].evaluate(a);const E=Nh(h,b),P=Ds.interpolationFactor(this.interpolation,b,h[E],h[E+1]),k=f[E].evaluate(a),L=f[E+1].evaluate(a);switch(this.operator){case"interpolate":return gn[this.type.kind](k,L,P);case"interpolate-hcl":return gn.color(k,L,P,"hcl");case"interpolate-lab":return gn.color(k,L,P,"lab")}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Hc(u,a,h,f){const b=f-h,T=u-h;return b===0?0:a===1?T/b:(Math.pow(a,T)-1)/(Math.pow(a,b)-1)}class bi{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expectected at least one argument.");let f=null;const b=h.expectedType;b&&b.kind!=="value"&&(f=b);const T=[];for(const P of a.slice(1)){const k=h.parse(P,1+T.length,f,void 0,{typeAnnotation:"omit"});if(!k)return null;f=f||k.type,T.push(k)}if(!f)throw new Error("No output type");const E=b&&T.some(P=>ge(b,P.type));return new bi(E?Gt:f,T)}evaluate(a){let h,f=null,b=0;for(const T of this.args)if(b++,f=T.evaluate(a),f&&f instanceof Js&&!f.available&&(h||(h=f.name),f=null,b===this.args.length&&(f=h)),f!==null)break;return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class jp{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let T=1;T<a.length-1;T+=2){const E=a[T];if(typeof E!="string")return h.error(`Expected string, but found ${typeof E} instead.`,T);if(/[^a-zA-Z0-9_]/.test(E))return h.error("Variable names must contain only alphanumeric characters or '_'.",T);const P=h.parse(a[T+1],T+1);if(!P)return null;f.push([E,P])}const b=h.parse(a[a.length-1],a.length-1,h.expectedType,f);return b?new jp(f,b):null}outputDefined(){return this.result.outputDefined()}}class ey{constructor(a,h,f){this.type=a,this.index=h,this.input=f}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,Ye),b=h.parse(a[2],2,K(h.expectedType||Gt));return f&&b?new ey(b.type.itemType,f,b):null}evaluate(a){const h=this.index.evaluate(a),f=this.input.evaluate(a);if(h<0)throw new ae(`Array index out of bounds: ${h} < 0.`);if(h>=f.length)throw new ae(`Array index out of bounds: ${h} > ${f.length-1}.`);if(h!==Math.floor(h))throw new ae(`Array index must be an integer, but found ${h} instead.`);return f[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class ty{constructor(a,h){this.type=jt,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,Gt),b=h.parse(a[2],2,Gt);return f&&b?Se(f.type,[jt,Ht,Ye,ha,Gt])?new ty(f,b):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(f.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!f)return!1;if(!he(h,["boolean","string","number","null"]))throw new ae(`Expected first argument to be of type boolean, string, number or null, but found ${te(Si(h))} instead.`);if(!he(f,["string","array"]))throw new ae(`Expected second argument to be of type array or string, but found ${te(Si(f))} instead.`);return f.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class Vp{constructor(a,h,f){this.type=Ye,this.needle=a,this.haystack=h,this.fromIndex=f}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,Gt),b=h.parse(a[2],2,Gt);if(!f||!b)return null;if(!Se(f.type,[jt,Ht,Ye,ha,Gt]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(f.type)} instead`);if(a.length===4){const T=h.parse(a[3],3,Ye);return T?new Vp(f,b,T):null}return new Vp(f,b)}evaluate(a){const h=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!he(h,["boolean","string","number","null"]))throw new ae(`Expected first argument to be of type boolean, string, number or null, but found ${te(Si(h))} instead.`);if(!he(f,["string","array"]))throw new ae(`Expected second argument to be of type array or string, but found ${te(Si(f))} instead.`);if(this.fromIndex){const b=this.fromIndex.evaluate(a);return f.indexOf(h,b)}return f.indexOf(h)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class iy{constructor(a,h,f,b,T,E){this.inputType=a,this.type=h,this.input=f,this.cases=b,this.outputs=T,this.otherwise=E}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let f,b;h.expectedType&&h.expectedType.kind!=="value"&&(b=h.expectedType);const T={},E=[];for(let L=2;L<a.length-1;L+=2){let N=a[L];const F=a[L+1];Array.isArray(N)||(N=[N]);const G=h.concat(L);if(N.length===0)return G.error("Expected at least one branch label.");for(const J of N){if(typeof J!="number"&&typeof J!="string")return G.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return G.error("Numeric branch labels must be integer values.");if(f){if(G.checkSubtype(f,Si(J)))return null}else f=Si(J);if(T[String(J)]!==void 0)return G.error("Branch labels must be unique.");T[String(J)]=E.length}const Z=h.parse(F,L,b);if(!Z)return null;b=b||Z.type,E.push(Z)}const P=h.parse(a[1],1,Gt);if(!P)return null;const k=h.parse(a[a.length-1],a.length-1,b);return k?P.type.kind!=="value"&&h.concat(1).checkSubtype(f,P.type)?null:new iy(f,b,P,T,E,k):null}evaluate(a){const h=this.input.evaluate(a);return(Si(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class ry{constructor(a,h,f){this.type=a,this.branches=h,this.otherwise=f}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let f;h.expectedType&&h.expectedType.kind!=="value"&&(f=h.expectedType);const b=[];for(let E=1;E<a.length-1;E+=2){const P=h.parse(a[E],E,jt);if(!P)return null;const k=h.parse(a[E+1],E+1,f);if(!k)return null;b.push([P,k]),f=f||k.type}const T=h.parse(a[a.length-1],a.length-1,f);if(!T)return null;if(!f)throw new Error("Can't infer output type");return new ry(f,b,T)}evaluate(a){for(const[h,f]of this.branches)if(h.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,f]of this.branches)a(h),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Gp{constructor(a,h,f,b){this.type=a,this.input=h,this.beginIndex=f,this.endIndex=b}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=h.parse(a[1],1,Gt),b=h.parse(a[2],2,Ye);if(!f||!b)return null;if(!Se(f.type,[K(Gt),Ht,Gt]))return h.error(`Expected first argument to be of type array or string, but found ${te(f.type)} instead`);if(a.length===4){const T=h.parse(a[3],3,Ye);return T?new Gp(f.type,f,b,T):null}return new Gp(f.type,f,b)}evaluate(a){const h=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!he(h,["string","array"]))throw new ae(`Expected first argument to be of type array or string, but found ${te(Si(h))} instead.`);if(this.endIndex){const b=this.endIndex.evaluate(a);return h.slice(f,b)}return h.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function G_(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function q_(u,a,h,f){return f.compare(a,h)===0}function Wc(u,a,h){const f=u!=="=="&&u!=="!=";return class V9{constructor(T,E,P){this.type=jt,this.lhs=T,this.rhs=E,this.collator=P,this.hasUntypedArgument=T.type.kind==="value"||E.type.kind==="value"}static parse(T,E){if(T.length!==3&&T.length!==4)return E.error("Expected two or three arguments.");const P=T[0];let k=E.parse(T[1],1,Gt);if(!k)return null;if(!G_(P,k.type))return E.concat(1).error(`"${P}" comparisons are not supported for type '${te(k.type)}'.`);let L=E.parse(T[2],2,Gt);if(!L)return null;if(!G_(P,L.type))return E.concat(2).error(`"${P}" comparisons are not supported for type '${te(L.type)}'.`);if(k.type.kind!==L.type.kind&&k.type.kind!=="value"&&L.type.kind!=="value")return E.error(`Cannot compare types '${te(k.type)}' and '${te(L.type)}'.`);f&&(k.type.kind==="value"&&L.type.kind!=="value"?k=new je(L.type,[k]):k.type.kind!=="value"&&L.type.kind==="value"&&(L=new je(k.type,[L])));let N=null;if(T.length===4){if(k.type.kind!=="string"&&L.type.kind!=="string"&&k.type.kind!=="value"&&L.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(N=E.parse(T[3],3,Po),!N)return null}return new V9(k,L,N)}evaluate(T){const E=this.lhs.evaluate(T),P=this.rhs.evaluate(T);if(f&&this.hasUntypedArgument){const k=Si(E),L=Si(P);if(k.kind!==L.kind||k.kind!=="string"&&k.kind!=="number")throw new ae(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${k.kind}, ${L.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const k=Si(E),L=Si(P);if(k.kind!=="string"||L.kind!=="string")return a(T,E,P)}return this.collator?h(T,E,P,this.collator.evaluate(T)):a(T,E,P)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const h2=Wc("==",function(u,a,h){return a===h},q_),d2=Wc("!=",function(u,a,h){return a!==h},function(u,a,h,f){return!q_(0,a,h,f)}),p2=Wc("<",function(u,a,h){return a<h},function(u,a,h,f){return f.compare(a,h)<0}),f2=Wc(">",function(u,a,h){return a>h},function(u,a,h,f){return f.compare(a,h)>0}),m2=Wc("<=",function(u,a,h){return a<=h},function(u,a,h,f){return f.compare(a,h)<=0}),y2=Wc(">=",function(u,a,h){return a>=h},function(u,a,h,f){return f.compare(a,h)>=0});class sy{constructor(a,h,f,b,T){this.type=Ht,this.number=a,this.locale=h,this.currency=f,this.minFractionDigits=b,this.maxFractionDigits=T}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const f=h.parse(a[1],1,Ye);if(!f)return null;const b=a[2];if(typeof b!="object"||Array.isArray(b))return h.error("NumberFormat options argument must be an object.");let T=null;if(b.locale&&(T=h.parse(b.locale,1,Ht),!T))return null;let E=null;if(b.currency&&(E=h.parse(b.currency,1,Ht),!E))return null;let P=null;if(b["min-fraction-digits"]&&(P=h.parse(b["min-fraction-digits"],1,Ye),!P))return null;let k=null;return b["max-fraction-digits"]&&(k=h.parse(b["max-fraction-digits"],1,Ye),!k)?null:new sy(f,T,E,P,k)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class qp{constructor(a){this.type=io,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return h.error("First argument must be an image or text section.");const b=[];let T=!1;for(let E=1;E<=a.length-1;++E){const P=a[E];if(T&&typeof P=="object"&&!Array.isArray(P)){T=!1;let k=null;if(P["font-scale"]&&(k=h.parse(P["font-scale"],1,Ye),!k))return null;let L=null;if(P["text-font"]&&(L=h.parse(P["text-font"],1,K(Ht)),!L))return null;let N=null;if(P["text-color"]&&(N=h.parse(P["text-color"],1,Ur),!N))return null;const F=b[b.length-1];F.scale=k,F.font=L,F.textColor=N}else{const k=h.parse(a[E],1,Gt);if(!k)return null;const L=k.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,b.push({content:k,scale:null,font:null,textColor:null})}}return new qp(b)}evaluate(a){return new Ls(this.sections.map(h=>{const f=h.content.evaluate(a);return Si(f)===j?new pr("",f,null,null,null):new pr(Wl(f),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor)}outputDefined(){return!1}}class ny{constructor(a){this.type=j,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const f=h.parse(a[1],1,Ht);return f?new ny(f):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),f=Js.fromString(h);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(h)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}}class oy{constructor(a){this.type=Ye,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=h.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${te(f.type)} instead.`):new oy(f):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string"||Array.isArray(h))return h.length;throw new ae(`Expected value to be of type string or array, but found ${te(Si(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const Zc={"==":h2,"!=":d2,">":f2,"<":p2,">=":y2,"<=":m2,array:je,at:ey,boolean:je,case:ry,coalesce:bi,collator:Lp,format:qp,image:ny,in:ty,"index-of":Vp,interpolate:Ds,"interpolate-hcl":Ds,"interpolate-lab":Ds,length:oy,let:jp,literal:da,match:iy,number:je,"number-format":sy,object:je,slice:Gp,step:qc,string:je,"to-boolean":Mi,"to-color":Mi,"to-number":Mi,"to-string":Mi,var:Fp,within:Zl};function H_(u,[a,h,f,b]){a=a.evaluate(u),h=h.evaluate(u),f=f.evaluate(u);const T=b?b.evaluate(u):1,E=Op(a,h,f,T);if(E)throw new ae(E);return new Ei(a/255,h/255,f/255,T,!1)}function W_(u,a){return u in a}function ay(u,a){const h=a[u];return h===void 0?null:h}function Jl(u){return{type:u}}function Z_(u){return{result:"success",value:u}}function Yc(u){return{result:"error",value:u}}function Jc(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function Y_(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function ly(u){return!!u.expression&&u.expression.interpolated}function xi(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Kc(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function g2(u){return u}function J_(u,a){const h=a.type==="color",f=u.stops&&typeof u.stops[0][0]=="object",b=f||!(f||u.property!==void 0),T=u.type||(ly(a)?"exponential":"interval");if(h||a.type==="padding"){const N=h?Ei.parse:gs.parse;(u=Rs({},u)).stops&&(u.stops=u.stops.map(F=>[F[0],N(F[1])])),u.default=N(u.default?u.default:a.default)}if(u.colorSpace&&(E=u.colorSpace)!=="rgb"&&E!=="hcl"&&E!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var E;let P,k,L;if(T==="exponential")P=K_;else if(T==="interval")P=wr;else if(T==="categorical"){P=_2,k=Object.create(null);for(const N of u.stops)k[N[0]]=N[1];L=typeof u.stops[0][0]}else{if(T!=="identity")throw new Error(`Unknown function type "${T}"`);P=gi}if(f){const N={},F=[];for(let J=0;J<u.stops.length;J++){const Q=u.stops[J],oe=Q[0].zoom;N[oe]===void 0&&(N[oe]={zoom:oe,type:u.type,property:u.property,default:u.default,stops:[]},F.push(oe)),N[oe].stops.push([Q[0].value,Q[1]])}const G=[];for(const J of F)G.push([N[J].zoom,J_(N[J],a)]);const Z={name:"linear"};return{kind:"composite",interpolationType:Z,interpolationFactor:Ds.interpolationFactor.bind(void 0,Z),zoomStops:G.map(J=>J[0]),evaluate:({zoom:J},Q)=>K_({stops:G,base:u.base},a,J).evaluate(J,Q)}}if(b){const N=T==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:Ds.interpolationFactor.bind(void 0,N),zoomStops:u.stops.map(F=>F[0]),evaluate:({zoom:F})=>P(u,a,F,k,L)}}return{kind:"source",evaluate(N,F){const G=F&&F.properties?F.properties[u.property]:void 0;return G===void 0?zh(u.default,a.default):P(u,a,G,k,L)}}}function zh(u,a,h){return u!==void 0?u:a!==void 0?a:h!==void 0?h:void 0}function _2(u,a,h,f,b){return zh(typeof h===b?f[h]:void 0,u.default,a.default)}function wr(u,a,h){if(xi(h)!=="number")return zh(u.default,a.default);const f=u.stops.length;if(f===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[f-1][0])return u.stops[f-1][1];const b=Nh(u.stops.map(T=>T[0]),h);return u.stops[b][1]}function K_(u,a,h){const f=u.base!==void 0?u.base:1;if(xi(h)!=="number")return zh(u.default,a.default);const b=u.stops.length;if(b===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[b-1][0])return u.stops[b-1][1];const T=Nh(u.stops.map(N=>N[0]),h),E=function(N,F,G,Z){const J=Z-G,Q=N-G;return J===0?0:F===1?Q/J:(Math.pow(F,Q)-1)/(Math.pow(F,J)-1)}(h,f,u.stops[T][0],u.stops[T+1][0]),P=u.stops[T][1],k=u.stops[T+1][1],L=gn[a.type]||g2;return typeof P.evaluate=="function"?{evaluate(...N){const F=P.evaluate.apply(void 0,N),G=k.evaluate.apply(void 0,N);if(F!==void 0&&G!==void 0)return L(F,G,E,u.colorSpace)}}:L(P,k,E,u.colorSpace)}function gi(u,a,h){switch(a.type){case"color":h=Ei.parse(h);break;case"formatted":h=Ls.fromString(h.toString());break;case"resolvedImage":h=Js.fromString(h.toString());break;case"padding":h=gs.parse(h);break;default:xi(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return zh(h,u.default,a.default)}Un.register(Zc,{error:[{kind:"error"},[Ht],(u,[a])=>{throw new ae(a.evaluate(u))}],typeof:[Ht,[Gt],(u,[a])=>te(Si(a.evaluate(u)))],"to-rgba":[K(Ye,4),[Ur],(u,[a])=>{const[h,f,b,T]=a.evaluate(u).rgb;return[255*h,255*f,255*b,T]}],rgb:[Ur,[Ye,Ye,Ye],H_],rgba:[Ur,[Ye,Ye,Ye,Ye],H_],has:{type:jt,overloads:[[[Ht],(u,[a])=>W_(a.evaluate(u),u.properties())],[[Ht,Ys],(u,[a,h])=>W_(a.evaluate(u),h.evaluate(u))]]},get:{type:Gt,overloads:[[[Ht],(u,[a])=>ay(a.evaluate(u),u.properties())],[[Ht,Ys],(u,[a,h])=>ay(a.evaluate(u),h.evaluate(u))]]},"feature-state":[Gt,[Ht],(u,[a])=>ay(a.evaluate(u),u.featureState||{})],properties:[Ys,[],u=>u.properties()],"geometry-type":[Ht,[],u=>u.geometryType()],id:[Gt,[],u=>u.id()],zoom:[Ye,[],u=>u.globals.zoom],"heatmap-density":[Ye,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ye,[],u=>u.globals.lineProgress||0],accumulated:[Gt,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ye,Jl(Ye),(u,a)=>{let h=0;for(const f of a)h+=f.evaluate(u);return h}],"*":[Ye,Jl(Ye),(u,a)=>{let h=1;for(const f of a)h*=f.evaluate(u);return h}],"-":{type:Ye,overloads:[[[Ye,Ye],(u,[a,h])=>a.evaluate(u)-h.evaluate(u)],[[Ye],(u,[a])=>-a.evaluate(u)]]},"/":[Ye,[Ye,Ye],(u,[a,h])=>a.evaluate(u)/h.evaluate(u)],"%":[Ye,[Ye,Ye],(u,[a,h])=>a.evaluate(u)%h.evaluate(u)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(u,[a,h])=>Math.pow(a.evaluate(u),h.evaluate(u))],sqrt:[Ye,[Ye],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[Ye,[Ye],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[Ye,[Ye],(u,[a])=>Math.log(a.evaluate(u))],log2:[Ye,[Ye],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[Ye,[Ye],(u,[a])=>Math.sin(a.evaluate(u))],cos:[Ye,[Ye],(u,[a])=>Math.cos(a.evaluate(u))],tan:[Ye,[Ye],(u,[a])=>Math.tan(a.evaluate(u))],asin:[Ye,[Ye],(u,[a])=>Math.asin(a.evaluate(u))],acos:[Ye,[Ye],(u,[a])=>Math.acos(a.evaluate(u))],atan:[Ye,[Ye],(u,[a])=>Math.atan(a.evaluate(u))],min:[Ye,Jl(Ye),(u,a)=>Math.min(...a.map(h=>h.evaluate(u)))],max:[Ye,Jl(Ye),(u,a)=>Math.max(...a.map(h=>h.evaluate(u)))],abs:[Ye,[Ye],(u,[a])=>Math.abs(a.evaluate(u))],round:[Ye,[Ye],(u,[a])=>{const h=a.evaluate(u);return h<0?-Math.round(-h):Math.round(h)}],floor:[Ye,[Ye],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[Ye,[Ye],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[jt,[Ht,Gt],(u,[a,h])=>u.properties()[a.value]===h.value],"filter-id-==":[jt,[Gt],(u,[a])=>u.id()===a.value],"filter-type-==":[jt,[Ht],(u,[a])=>u.geometryType()===a.value],"filter-<":[jt,[Ht,Gt],(u,[a,h])=>{const f=u.properties()[a.value],b=h.value;return typeof f==typeof b&&f<b}],"filter-id-<":[jt,[Gt],(u,[a])=>{const h=u.id(),f=a.value;return typeof h==typeof f&&h<f}],"filter->":[jt,[Ht,Gt],(u,[a,h])=>{const f=u.properties()[a.value],b=h.value;return typeof f==typeof b&&f>b}],"filter-id->":[jt,[Gt],(u,[a])=>{const h=u.id(),f=a.value;return typeof h==typeof f&&h>f}],"filter-<=":[jt,[Ht,Gt],(u,[a,h])=>{const f=u.properties()[a.value],b=h.value;return typeof f==typeof b&&f<=b}],"filter-id-<=":[jt,[Gt],(u,[a])=>{const h=u.id(),f=a.value;return typeof h==typeof f&&h<=f}],"filter->=":[jt,[Ht,Gt],(u,[a,h])=>{const f=u.properties()[a.value],b=h.value;return typeof f==typeof b&&f>=b}],"filter-id->=":[jt,[Gt],(u,[a])=>{const h=u.id(),f=a.value;return typeof h==typeof f&&h>=f}],"filter-has":[jt,[Gt],(u,[a])=>a.value in u.properties()],"filter-has-id":[jt,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[jt,[K(Ht)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[jt,[K(Gt)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[jt,[Ht,K(Gt)],(u,[a,h])=>h.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[jt,[Ht,K(Gt)],(u,[a,h])=>function(f,b,T,E){for(;T<=E;){const P=T+E>>1;if(b[P]===f)return!0;b[P]>f?E=P-1:T=P+1}return!1}(u.properties()[a.value],h.value,0,h.value.length-1)],all:{type:jt,overloads:[[[jt,jt],(u,[a,h])=>a.evaluate(u)&&h.evaluate(u)],[Jl(jt),(u,a)=>{for(const h of a)if(!h.evaluate(u))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],(u,[a,h])=>a.evaluate(u)||h.evaluate(u)],[Jl(jt),(u,a)=>{for(const h of a)if(h.evaluate(u))return!0;return!1}]]},"!":[jt,[jt],(u,[a])=>!a.evaluate(u)],"is-supported-script":[jt,[Ht],(u,[a])=>{const h=u.globals&&u.globals.isSupportedScript;return!h||h(a.evaluate(u))}],upcase:[Ht,[Ht],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[Ht,[Ht],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[Ht,Jl(Gt),(u,a)=>a.map(h=>Wl(h.evaluate(u))).join("")],"resolved-locale":[Ht,[Po],(u,[a])=>a.evaluate(u).resolvedLocale()]});class Fh{constructor(a,h){var f;this.expression=a,this._warningHistory={},this._evaluator=new jr,this._defaultValue=h?(f=h).type==="color"&&Kc(f.default)?new Ei(0,0,0,0):f.type==="color"?Ei.parse(f.default)||null:f.type==="padding"?gs.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?es.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,f,b,T,E){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=f,this._evaluator.canonical=b,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(a,h,f,b,T,E){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=f||null,this._evaluator.canonical=b,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new ae(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function Ui(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Zc}function Ni(u,a){const h=new yi(Zc,Oh,[],a?function(b){const T={color:Ur,string:Ht,number:Ye,enum:Ht,boolean:jt,formatted:io,padding:se,resolvedImage:j,variableAnchorOffsetCollection:H};return b.type==="array"?K(T[b.value]||Gt,b.length):T[b.type]}(a):void 0),f=h.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Z_(new Fh(f,a)):Yc(h.errors)}class Xc{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!Dh(h.expression)}evaluateWithoutErrorHandling(a,h,f,b,T,E){return this._styleExpression.evaluateWithoutErrorHandling(a,h,f,b,T,E)}evaluate(a,h,f,b,T,E){return this._styleExpression.evaluate(a,h,f,b,T,E)}}class Hp{constructor(a,h,f,b){this.kind=a,this.zoomStops=f,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!Dh(h.expression),this.interpolationType=b}evaluateWithoutErrorHandling(a,h,f,b,T,E){return this._styleExpression.evaluateWithoutErrorHandling(a,h,f,b,T,E)}evaluate(a,h,f,b,T,E){return this._styleExpression.evaluate(a,h,f,b,T,E)}interpolationFactor(a,h,f){return this.interpolationType?Ds.interpolationFactor(this.interpolationType,a,h,f):0}}function X_(u,a){const h=Ni(u,a);if(h.result==="error")return h;const f=h.value.expression,b=Lh(f);if(!b&&!Jc(a))return Yc([new ys("","data expressions not supported")]);const T=Bp(f,["zoom"]);if(!T&&!Y_(a))return Yc([new ys("","zoom expressions not supported")]);const E=Zp(f);return E||T?E instanceof ys?Yc([E]):E instanceof Ds&&!ly(a)?Yc([new ys("",'"interpolate" expressions cannot be used with this property')]):Z_(E?new Hp(b?"camera":"composite",h.value,E.labels,E instanceof Ds?E.interpolation:void 0):new Xc(b?"constant":"source",h.value)):Yc([new ys("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wp{constructor(a,h){this._parameters=a,this._specification=h,Rs(this,J_(this._parameters,this._specification))}static deserialize(a){return new Wp(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Zp(u){let a=null;if(u instanceof jp)a=Zp(u.result);else if(u instanceof bi){for(const h of u.args)if(a=Zp(h),a)break}else(u instanceof qc||u instanceof Ds)&&u.input instanceof Un&&u.input.name==="zoom"&&(a=u);return a instanceof ys||u.eachChild(h=>{const f=Zp(h);f instanceof ys?a=f:!a&&f?a=new ys("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new ys("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function cy(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const a of u.slice(1))if(!cy(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const Q_={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Yp(u){if(u==null)return{filter:()=>!0,needGeometry:!1};cy(u)||(u=Qc(u));const a=Ni(u,Q_);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,f,b)=>a.value.evaluate(h,f,{},b),needGeometry:uy(u)}}function e1(u,a){return u<a?-1:u>a?1:0}function uy(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let a=1;a<u.length;a++)if(uy(u[a]))return!0;return!1}function Qc(u){if(!u)return!0;const a=u[0];return u.length<=1?a!=="any":a==="=="?hy(u[1],u[2],"=="):a==="!="?Jp(hy(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?hy(u[1],u[2],a):a==="any"?(h=u.slice(1),["any"].concat(h.map(Qc))):a==="all"?["all"].concat(u.slice(1).map(Qc)):a==="none"?["all"].concat(u.slice(1).map(Qc).map(Jp)):a==="in"?t1(u[1],u.slice(2)):a==="!in"?Jp(t1(u[1],u.slice(2))):a==="has"?i1(u[1]):a==="!has"?Jp(i1(u[1])):a!=="within"||u;var h}function hy(u,a,h){switch(u){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,u,a]}}function t1(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",u,["literal",a.sort(e1)]]:["filter-in-small",u,["literal",a]]}}function i1(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Jp(u){return["!",u]}function dy(u){const a=typeof u;if(a==="number"||a==="boolean"||a==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let b="[";for(const T of u)b+=`${dy(T)},`;return`${b}]`}const h=Object.keys(u).sort();let f="{";for(let b=0;b<h.length;b++)f+=`${JSON.stringify(h[b])}:${dy(u[h[b]])},`;return`${f}}`}function v2(u){let a="";for(const h of ca)a+=`/${dy(u[h])}`;return a}function r1(u){const a=u.value;return a?[new Xe(u.key,a,"constants have been deprecated as of v8")]:[]}function fr(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function tl(u){if(Array.isArray(u))return u.map(tl);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const a={};for(const h in u)a[h]=tl(u[h]);return a}return fr(u)}function _n(u){const a=u.key,h=u.value,f=u.valueSpec||{},b=u.objectElementValidators||{},T=u.style,E=u.styleSpec,P=u.validateSpec;let k=[];const L=xi(h);if(L!=="object")return[new Xe(a,h,`object expected, ${L} found`)];for(const N in h){const F=N.split(".")[0],G=f[F]||f["*"];let Z;if(b[F])Z=b[F];else if(f[F])Z=P;else if(b["*"])Z=b["*"];else{if(!f["*"]){k.push(new Xe(a,h[N],`unknown property "${N}"`));continue}Z=P}k=k.concat(Z({key:(a&&`${a}.`)+N,value:h[N],valueSpec:G,style:T,styleSpec:E,object:h,objectKey:N,validateSpec:P},h))}for(const N in f)b[N]||f[N].required&&f[N].default===void 0&&h[N]===void 0&&k.push(new Xe(a,h,`missing required property "${N}"`));return k}function eu(u){const a=u.value,h=u.valueSpec,f=u.style,b=u.styleSpec,T=u.key,E=u.arrayElementValidator||u.validateSpec;if(xi(a)!=="array")return[new Xe(T,a,`array expected, ${xi(a)} found`)];if(h.length&&a.length!==h.length)return[new Xe(T,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Xe(T,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let P={type:h.value,values:h.values};b.$version<7&&(P.function=h.function),xi(h.value)==="object"&&(P=h.value);let k=[];for(let L=0;L<a.length;L++)k=k.concat(E({array:a,arrayIndex:L,value:a[L],valueSpec:P,validateSpec:u.validateSpec,style:f,styleSpec:b,key:`${T}[${L}]`}));return k}function py(u){const a=u.key,h=u.value,f=u.valueSpec;let b=xi(h);return b==="number"&&h!=h&&(b="NaN"),b!=="number"?[new Xe(a,h,`number expected, ${b} found`)]:"minimum"in f&&h<f.minimum?[new Xe(a,h,`${h} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&h>f.maximum?[new Xe(a,h,`${h} is greater than the maximum value ${f.maximum}`)]:[]}function fy(u){const a=u.valueSpec,h=fr(u.value.type);let f,b,T,E={};const P=h!=="categorical"&&u.value.property===void 0,k=!P,L=xi(u.value.stops)==="array"&&xi(u.value.stops[0])==="array"&&xi(u.value.stops[0][0])==="object",N=_n({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Z){if(h==="identity")return[new Xe(Z.key,Z.value,'identity function may not have a "stops" property')];let J=[];const Q=Z.value;return J=J.concat(eu({key:Z.key,value:Q,valueSpec:Z.valueSpec,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:F})),xi(Q)==="array"&&Q.length===0&&J.push(new Xe(Z.key,Q,"array must have at least one stop")),J},default:function(Z){return Z.validateSpec({key:Z.key,value:Z.value,valueSpec:a,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec})}}});return h==="identity"&&P&&N.push(new Xe(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||N.push(new Xe(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!ly(u.valueSpec)&&N.push(new Xe(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(k&&!Jc(u.valueSpec)?N.push(new Xe(u.key,u.value,"property functions not supported")):P&&!Y_(u.valueSpec)&&N.push(new Xe(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!L||u.value.property!==void 0||N.push(new Xe(u.key,u.value,'"property" property is required')),N;function F(Z){let J=[];const Q=Z.value,oe=Z.key;if(xi(Q)!=="array")return[new Xe(oe,Q,`array expected, ${xi(Q)} found`)];if(Q.length!==2)return[new Xe(oe,Q,`array length 2 expected, length ${Q.length} found`)];if(L){if(xi(Q[0])!=="object")return[new Xe(oe,Q,`object expected, ${xi(Q[0])} found`)];if(Q[0].zoom===void 0)return[new Xe(oe,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new Xe(oe,Q,"object stop key must have value")];if(T&&T>fr(Q[0].zoom))return[new Xe(oe,Q[0].zoom,"stop zoom values must appear in ascending order")];fr(Q[0].zoom)!==T&&(T=fr(Q[0].zoom),b=void 0,E={}),J=J.concat(_n({key:`${oe}[0]`,value:Q[0],valueSpec:{zoom:{}},validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:py,value:G}}))}else J=J.concat(G({key:`${oe}[0]`,value:Q[0],valueSpec:{},validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec},Q));return Ui(tl(Q[1]))?J.concat([new Xe(`${oe}[1]`,Q[1],"expressions are not allowed in function stops.")]):J.concat(Z.validateSpec({key:`${oe}[1]`,value:Q[1],valueSpec:a,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec}))}function G(Z,J){const Q=xi(Z.value),oe=fr(Z.value),ue=Z.value!==null?Z.value:J;if(f){if(Q!==f)return[new Xe(Z.key,ue,`${Q} stop domain type must match previous stop domain type ${f}`)]}else f=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean")return[new Xe(Z.key,ue,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&h!=="categorical"){let Te=`number expected, ${Q} found`;return Jc(a)&&h===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(Z.key,ue,Te)]}return h!=="categorical"||Q!=="number"||isFinite(oe)&&Math.floor(oe)===oe?h!=="categorical"&&Q==="number"&&b!==void 0&&oe<b?[new Xe(Z.key,ue,"stop domain values must appear in ascending order")]:(b=oe,h==="categorical"&&oe in E?[new Xe(Z.key,ue,"stop domain values must be unique")]:(E[oe]=!0,[])):[new Xe(Z.key,ue,`integer expected, found ${oe}`)]}}function tu(u){const a=(u.expressionContext==="property"?X_:Ni)(tl(u.value),u.valueSpec);if(a.result==="error")return a.value.map(f=>new Xe(`${u.key}${f.key}`,u.value,f.message));const h=a.value.expression||a.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new Xe(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Dh(h))return[new Xe(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!Dh(h))return[new Xe(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Bp(h,["zoom","feature-state"]))return[new Xe(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Lh(h))return[new Xe(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Kl(u){const a=u.key,h=u.value,f=u.valueSpec,b=[];return Array.isArray(f.values)?f.values.indexOf(fr(h))===-1&&b.push(new Xe(a,h,`expected one of [${f.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(f.values).indexOf(fr(h))===-1&&b.push(new Xe(a,h,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(h)} found`)),b}function iu(u){return cy(tl(u.value))?tu(Rs({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Bh(u)}function Bh(u){const a=u.value,h=u.key;if(xi(a)!=="array")return[new Xe(h,a,`array expected, ${xi(a)} found`)];const f=u.styleSpec;let b,T=[];if(a.length<1)return[new Xe(h,a,"filter array must have at least 1 element")];switch(T=T.concat(Kl({key:`${h}[0]`,value:a[0],valueSpec:f.filter_operator,style:u.style,styleSpec:u.styleSpec})),fr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&fr(a[1])==="$type"&&T.push(new Xe(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&T.push(new Xe(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(b=xi(a[1]),b!=="string"&&T.push(new Xe(`${h}[1]`,a[1],`string expected, ${b} found`)));for(let E=2;E<a.length;E++)b=xi(a[E]),fr(a[1])==="$type"?T=T.concat(Kl({key:`${h}[${E}]`,value:a[E],valueSpec:f.geometry_type,style:u.style,styleSpec:u.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&T.push(new Xe(`${h}[${E}]`,a[E],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let E=1;E<a.length;E++)T=T.concat(Bh({key:`${h}[${E}]`,value:a[E],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=xi(a[1]),a.length!==2?T.push(new Xe(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):b!=="string"&&T.push(new Xe(`${h}[1]`,a[1],`string expected, ${b} found`));break;case"within":b=xi(a[1]),a.length!==2?T.push(new Xe(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):b!=="object"&&T.push(new Xe(`${h}[1]`,a[1],`object expected, ${b} found`))}return T}function my(u,a){const h=u.key,f=u.validateSpec,b=u.style,T=u.styleSpec,E=u.value,P=u.objectKey,k=T[`${a}_${u.layerType}`];if(!k)return[];const L=P.match(/^(.*)-transition$/);if(a==="paint"&&L&&k[L[1]]&&k[L[1]].transition)return f({key:h,value:E,valueSpec:T.transition,style:b,styleSpec:T});const N=u.valueSpec||k[P];if(!N)return[new Xe(h,E,`unknown property "${P}"`)];let F;if(xi(E)==="string"&&Jc(N)&&!N.tokens&&(F=/^{([^}]+)}$/.exec(E)))return[new Xe(h,E,`"${P}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const G=[];return u.layerType==="symbol"&&(P==="text-field"&&b&&!b.glyphs&&G.push(new Xe(h,E,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&Kc(tl(E))&&fr(E.type)==="identity"&&G.push(new Xe(h,E,'"text-font" does not support identity functions'))),G.concat(f({key:u.key,value:E,valueSpec:N,style:b,styleSpec:T,expressionContext:"property",propertyType:a,propertyKey:P}))}function Kp(u){return my(u,"paint")}function yy(u){return my(u,"layout")}function gy(u){let a=[];const h=u.value,f=u.key,b=u.style,T=u.styleSpec;h.type||h.ref||a.push(new Xe(f,h,'either "type" or "ref" is required'));let E=fr(h.type);const P=fr(h.ref);if(h.id){const k=fr(h.id);for(let L=0;L<u.arrayIndex;L++){const N=b.layers[L];fr(N.id)===k&&a.push(new Xe(f,h.id,`duplicate layer id "${h.id}", previously used at line ${N.id.__line__}`))}}if("ref"in h){let k;["type","source","source-layer","filter","layout"].forEach(L=>{L in h&&a.push(new Xe(f,h[L],`"${L}" is prohibited for ref layers`))}),b.layers.forEach(L=>{fr(L.id)===P&&(k=L)}),k?k.ref?a.push(new Xe(f,h.ref,"ref cannot reference another ref layer")):E=fr(k.type):a.push(new Xe(f,h.ref,`ref layer "${P}" not found`))}else if(E!=="background")if(h.source){const k=b.sources&&b.sources[h.source],L=k&&fr(k.type);k?L==="vector"&&E==="raster"?a.push(new Xe(f,h.source,`layer "${h.id}" requires a raster source`)):L!=="raster-dem"&&E==="hillshade"?a.push(new Xe(f,h.source,`layer "${h.id}" requires a raster-dem source`)):L==="raster"&&E!=="raster"?a.push(new Xe(f,h.source,`layer "${h.id}" requires a vector source`)):L!=="vector"||h["source-layer"]?L==="raster-dem"&&E!=="hillshade"?a.push(new Xe(f,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!h.paint||!h.paint["line-gradient"]||L==="geojson"&&k.lineMetrics||a.push(new Xe(f,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Xe(f,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new Xe(f,h.source,`source "${h.source}" not found`))}else a.push(new Xe(f,h,'missing required property "source"'));return a=a.concat(_n({key:f,value:h,valueSpec:T.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${f}.type`,value:h.type,valueSpec:T.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:iu,layout:k=>_n({layer:h,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":L=>yy(Rs({layerType:E},L))}}),paint:k=>_n({layer:h,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":L=>Kp(Rs({layerType:E},L))}})}})),a}function ko(u){const a=u.value,h=u.key,f=xi(a);return f!=="string"?[new Xe(h,a,`string expected, ${f} found`)]:[]}const s1={promoteId:function({key:u,value:a}){if(xi(a)==="string")return ko({key:u,value:a});{const h=[];for(const f in a)h.push(...ko({key:`${u}.${f}`,value:a[f]}));return h}}};function n1(u){const a=u.value,h=u.key,f=u.styleSpec,b=u.style,T=u.validateSpec;if(!a.type)return[new Xe(h,a,'"type" is required')];const E=fr(a.type);let P;switch(E){case"vector":case"raster":return P=_n({key:h,value:a,valueSpec:f[`source_${E.replace("-","_")}`],style:u.style,styleSpec:f,objectElementValidators:s1,validateSpec:T}),P;case"raster-dem":return P=function(k){var L;const N=(L=k.sourceName)!==null&&L!==void 0?L:"",F=k.value,G=k.styleSpec,Z=G.source_raster_dem,J=k.style;let Q=[];const oe=xi(F);if(F===void 0)return Q;if(oe!=="object")return Q.push(new Xe("source_raster_dem",F,`object expected, ${oe} found`)),Q;const ue=fr(F.encoding)==="custom",Te=["redFactor","greenFactor","blueFactor","baseShift"],de=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const we in F)!ue&&Te.includes(we)?Q.push(new Xe(we,F[we],`In "${N}": "${we}" is only valid when "encoding" is set to "custom". ${de} encoding found`)):Z[we]?Q=Q.concat(k.validateSpec({key:we,value:F[we],valueSpec:Z[we],validateSpec:k.validateSpec,style:J,styleSpec:G})):Q.push(new Xe(we,F[we],`unknown property "${we}"`));return Q}({sourceName:h,value:a,style:u.style,styleSpec:f,validateSpec:T}),P;case"geojson":if(P=_n({key:h,value:a,valueSpec:f.source_geojson,style:b,styleSpec:f,validateSpec:T,objectElementValidators:s1}),a.cluster)for(const k in a.clusterProperties){const[L,N]=a.clusterProperties[k],F=typeof L=="string"?[L,["accumulated"],["get",k]]:L;P.push(...tu({key:`${h}.${k}.map`,value:N,validateSpec:T,expressionContext:"cluster-map"})),P.push(...tu({key:`${h}.${k}.reduce`,value:F,validateSpec:T,expressionContext:"cluster-reduce"}))}return P;case"video":return _n({key:h,value:a,valueSpec:f.source_video,style:b,validateSpec:T,styleSpec:f});case"image":return _n({key:h,value:a,valueSpec:f.source_image,style:b,validateSpec:T,styleSpec:f});case"canvas":return[new Xe(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Kl({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:b,validateSpec:T,styleSpec:f})}}function o1(u){const a=u.value,h=u.styleSpec,f=h.light,b=u.style;let T=[];const E=xi(a);if(a===void 0)return T;if(E!=="object")return T=T.concat([new Xe("light",a,`object expected, ${E} found`)]),T;for(const P in a){const k=P.match(/^(.*)-transition$/);T=T.concat(k&&f[k[1]]&&f[k[1]].transition?u.validateSpec({key:P,value:a[P],valueSpec:h.transition,validateSpec:u.validateSpec,style:b,styleSpec:h}):f[P]?u.validateSpec({key:P,value:a[P],valueSpec:f[P],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new Xe(P,a[P],`unknown property "${P}"`)])}return T}function a1(u){const a=u.value,h=u.styleSpec,f=h.sky,b=u.style,T=xi(a);if(a===void 0)return[];if(T!=="object")return[new Xe("sky",a,`object expected, ${T} found`)];let E=[];for(const P in a)E=E.concat(f[P]?ts({key:P,value:a[P],valueSpec:f[P],style:b,styleSpec:h}):[new Xe(P,a[P],`unknown property "${P}"`)]);return E}function l1(u){const a=u.value,h=u.styleSpec,f=h.terrain,b=u.style;let T=[];const E=xi(a);if(a===void 0)return T;if(E!=="object")return T=T.concat([new Xe("terrain",a,`object expected, ${E} found`)]),T;for(const P in a)T=T.concat(f[P]?u.validateSpec({key:P,value:a[P],valueSpec:f[P],validateSpec:u.validateSpec,style:b,styleSpec:h}):[new Xe(P,a[P],`unknown property "${P}"`)]);return T}function Uh(u){let a=[];const h=u.value,f=u.key;if(Array.isArray(h)){const b=[],T=[];for(const E in h)h[E].id&&b.includes(h[E].id)&&a.push(new Xe(f,h,`all the sprites' ids must be unique, but ${h[E].id} is duplicated`)),b.push(h[E].id),h[E].url&&T.includes(h[E].url)&&a.push(new Xe(f,h,`all the sprites' URLs must be unique, but ${h[E].url} is duplicated`)),T.push(h[E].url),a=a.concat(_n({key:`${f}[${E}]`,value:h[E],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return a}return ko({key:f,value:h})}const jh={"*":()=>[],array:eu,boolean:function(u){const a=u.value,h=u.key,f=xi(a);return f!=="boolean"?[new Xe(h,a,`boolean expected, ${f} found`)]:[]},number:py,color:function(u){const a=u.key,h=u.value,f=xi(h);return f!=="string"?[new Xe(a,h,`color expected, ${f} found`)]:Ei.parse(String(h))?[]:[new Xe(a,h,`color expected, "${h}" found`)]},constants:r1,enum:Kl,filter:iu,function:fy,layer:gy,object:_n,source:n1,light:o1,sky:a1,terrain:l1,string:ko,formatted:function(u){return ko(u).length===0?[]:tu(u)},resolvedImage:function(u){return ko(u).length===0?[]:tu(u)},padding:function(u){const a=u.key,h=u.value;if(xi(h)==="array"){if(h.length<1||h.length>4)return[new Xe(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const f={type:"number"};let b=[];for(let T=0;T<h.length;T++)b=b.concat(u.validateSpec({key:`${a}[${T}]`,value:h[T],validateSpec:u.validateSpec,valueSpec:f}));return b}return py({key:a,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const a=u.key,h=u.value,f=xi(h),b=u.styleSpec;if(f!=="array"||h.length<1||h.length%2!=0)return[new Xe(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let E=0;E<h.length;E+=2)T=T.concat(Kl({key:`${a}[${E}]`,value:h[E],valueSpec:b.layout_symbol["text-anchor"]})),T=T.concat(eu({key:`${a}[${E+1}]`,value:h[E+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:b}));return T},sprite:Uh};function ts(u){const a=u.value,h=u.valueSpec,f=u.styleSpec;return u.validateSpec=ts,h.expression&&Kc(fr(a))?fy(u):h.expression&&Ui(tl(a))?tu(u):h.type&&jh[h.type]?jh[h.type](u):_n(Rs({},u,{valueSpec:h.type?f[h.type]:h}))}function ru(u){const a=u.value,h=u.key,f=ko(u);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new Xe(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new Xe(h,a,'"glyphs" url must include a "{range}" token'))),f}function jn(u,a=Oe){let h=[];return h=h.concat(ts({key:"",value:u,valueSpec:a.$root,styleSpec:a,style:u,validateSpec:ts,objectElementValidators:{glyphs:ru,"*":()=>[]}})),u.constants&&(h=h.concat(r1({key:"constants",value:u.constants,style:u,styleSpec:a,validateSpec:ts}))),c1(h)}function Ro(u){return function(a){return u({...a,validateSpec:ts})}}function c1(u){return[].concat(u).sort((a,h)=>a.line-h.line)}function Ks(u){return function(...a){return c1(u.apply(this,a))}}jn.source=Ks(Ro(n1)),jn.sprite=Ks(Ro(Uh)),jn.glyphs=Ks(Ro(ru)),jn.light=Ks(Ro(o1)),jn.sky=Ks(Ro(a1)),jn.terrain=Ks(Ro(l1)),jn.layer=Ks(Ro(gy)),jn.filter=Ks(Ro(iu)),jn.paintProperty=Ks(Ro(Kp)),jn.layoutProperty=Ks(Ro(yy));const su=jn,_y=su.light,b2=su.paintProperty,vy=su.layoutProperty;function u1(u,a){let h=!1;if(a&&a.length)for(const f of a)u.fire(new vr(new Error(f.message))),h=!0;return h}class pa{constructor(a,h,f){const b=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const E=new Int32Array(this.arrayBuffer);a=E[0],this.d=(h=E[1])+2*(f=E[2]);for(let k=0;k<this.d*this.d;k++){const L=E[3+k],N=E[3+k+1];b.push(L===N?null:E.subarray(L,N))}const P=E[3+b.length+1];this.keys=E.subarray(E[3+b.length],P),this.bboxes=E.subarray(P),this.insert=this._insertReadonly}else{this.d=h+2*f;for(let E=0;E<this.d*this.d;E++)b.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=f,this.scale=h/a,this.uid=0;const T=f/h*a;this.min=-T,this.max=a+T}insert(a,h,f,b,T){this._forEachCell(h,f,b,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(b),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,f,b,T,E){this.cells[T].push(E)}query(a,h,f,b,T){const E=this.min,P=this.max;if(a<=E&&h<=E&&P<=f&&P<=b&&!T)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(a,h,f,b,this._queryCell,k,{},T),k}}_queryCell(a,h,f,b,T,E,P,k){const L=this.cells[T];if(L!==null){const N=this.keys,F=this.bboxes;for(let G=0;G<L.length;G++){const Z=L[G];if(P[Z]===void 0){const J=4*Z;(k?k(F[J+0],F[J+1],F[J+2],F[J+3]):a<=F[J+2]&&h<=F[J+3]&&f>=F[J+0]&&b>=F[J+1])?(P[Z]=!0,E.push(N[Z])):P[Z]=!1}}}}_forEachCell(a,h,f,b,T,E,P,k){const L=this._convertToCellCoord(a),N=this._convertToCellCoord(h),F=this._convertToCellCoord(f),G=this._convertToCellCoord(b);for(let Z=L;Z<=F;Z++)for(let J=N;J<=G;J++){const Q=this.d*J+Z;if((!k||k(this._convertFromCellCoord(Z),this._convertFromCellCoord(J),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(J+1)))&&T.call(this,a,h,f,b,Q,E,P,k))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,h=3+this.cells.length+1+1;let f=0;for(let E=0;E<this.cells.length;E++)f+=this.cells[E].length;const b=new Int32Array(h+f+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;let T=h;for(let E=0;E<a.length;E++){const P=a[E];b[3+E]=T,b.set(P,T),T+=P.length}return b[3+a.length]=T,b.set(this.keys,T),T+=this.keys.length,b[3+a.length+1]=T,b.set(this.bboxes,T),T+=this.bboxes.length,b.buffer}static serialize(a,h){const f=a.toArrayBuffer();return h&&h.push(f),{buffer:f}}static deserialize(a){return new pa(a.buffer)}}const il={};function pt(u,a,h={}){if(il[u])throw new Error(`${u} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:u,writeable:!1}),il[u]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}pt("Object",Object),pt("TransferableGridIndex",pa),pt("Color",Ei),pt("Error",Error),pt("AJAXError",ms),pt("ResolvedImage",Js),pt("StylePropertyFunction",Wp),pt("StyleExpression",Fh,{omit:["_evaluator"]}),pt("ZoomDependentExpression",Hp),pt("ZoomConstantExpression",Xc),pt("CompoundExpression",Un,{omit:["_evaluate"]});for(const u in Zc)Zc[u]._classRegistryKey||pt(`Expression_${u}`,Zc[u]);function by(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Xl(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error)return u;if(by(u)||Ft(u))return a&&a.push(u),u;if(ArrayBuffer.isView(u)){const h=u;return a&&a.push(h.buffer),h}if(u instanceof ImageData)return a&&a.push(u.data.buffer),u;if(Array.isArray(u)){const h=[];for(const f of u)h.push(Xl(f,a));return h}if(typeof u=="object"){const h=u.constructor,f=h._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${h.name}`);if(!il[f])throw new Error(`${f} is not registered.`);const b=h.serialize?h.serialize(u,a):{};if(h.serialize){if(a&&b===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in u){if(!u.hasOwnProperty(T)||il[f].omit.indexOf(T)>=0)continue;const E=u[T];b[T]=il[f].shallow.indexOf(T)>=0?E:Xl(E,a)}u instanceof Error&&(b.message=u.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(b.$name=f),b}throw new Error("can't serialize object of type "+typeof u)}function nu(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||by(u)||Ft(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(nu);if(typeof u=="object"){const a=u.$name||"Object";if(!il[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:h}=il[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(u);const f=Object.create(h.prototype);for(const b of Object.keys(u)){if(b==="$name")continue;const T=u[b];f[b]=il[a].shallow.indexOf(b)>=0?T:nu(T)}return f}throw new Error("can't deserialize object of type "+typeof u)}class wy{constructor(){this.first=!0}update(a,h){const f=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=f,!0))}}const ut={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function Vh(u){for(const a of u)if(Qp(a.charCodeAt(0)))return!0;return!1}function Xp(u){for(const a of u)if(!h1(a.charCodeAt(0)))return!1;return!0}function h1(u){return!(ut.Arabic(u)||ut["Arabic Supplement"](u)||ut["Arabic Extended-A"](u)||ut["Arabic Presentation Forms-A"](u)||ut["Arabic Presentation Forms-B"](u))}function Qp(u){return!(u!==746&&u!==747&&(u<4352||!(ut["Bopomofo Extended"](u)||ut.Bopomofo(u)||ut["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||ut["CJK Compatibility Ideographs"](u)||ut["CJK Compatibility"](u)||ut["CJK Radicals Supplement"](u)||ut["CJK Strokes"](u)||!(!ut["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||ut["CJK Unified Ideographs Extension A"](u)||ut["CJK Unified Ideographs"](u)||ut["Enclosed CJK Letters and Months"](u)||ut["Hangul Compatibility Jamo"](u)||ut["Hangul Jamo Extended-A"](u)||ut["Hangul Jamo Extended-B"](u)||ut["Hangul Jamo"](u)||ut["Hangul Syllables"](u)||ut.Hiragana(u)||ut["Ideographic Description Characters"](u)||ut.Kanbun(u)||ut["Kangxi Radicals"](u)||ut["Katakana Phonetic Extensions"](u)||ut.Katakana(u)&&u!==12540||!(!ut["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!ut["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||ut["Unified Canadian Aboriginal Syllabics"](u)||ut["Unified Canadian Aboriginal Syllabics Extended"](u)||ut["Vertical Forms"](u)||ut["Yijing Hexagram Symbols"](u)||ut["Yi Syllables"](u)||ut["Yi Radicals"](u))))}function xy(u){return!(Qp(u)||function(a){return!!(ut["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||ut["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||ut["Letterlike Symbols"](a)||ut["Number Forms"](a)||ut["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||ut["Control Pictures"](a)&&a!==9251||ut["Optical Character Recognition"](a)||ut["Enclosed Alphanumerics"](a)||ut["Geometric Shapes"](a)||ut["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||ut["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||ut["CJK Symbols and Punctuation"](a)||ut.Katakana(a)||ut["Private Use Area"](a)||ut["CJK Compatibility Forms"](a)||ut["Small Form Variants"](a)||ut["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function Sy(u){return u>=1424&&u<=2303||ut["Arabic Presentation Forms-A"](u)||ut["Arabic Presentation Forms-B"](u)}function Ty(u,a){return!(!a&&Sy(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||ut.Khmer(u))}function d1(u){for(const a of u)if(Sy(a.charCodeAt(0)))return!0;return!1}const Ql=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Zi{constructor(a,h){this.zoom=a,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wy,this.transition={})}isSupportedScript(a){return function(h,f){for(const b of h)if(!Ty(b.charCodeAt(0),f))return!1;return!0}(a,Ql.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,h=a-Math.floor(a),f=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*h}}}class ef{constructor(a,h){this.property=a,this.value=h,this.expression=function(f,b){if(Kc(f))return new Wp(f,b);if(Ui(f)){const T=X_(f,b);if(T.result==="error")throw new Error(T.value.map(E=>`${E.key}: ${E.message}`).join(", "));return T.value}{let T=f;return b.type==="color"&&typeof f=="string"?T=Ei.parse(f):b.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(T=es.parse(f)):T=gs.parse(f),{kind:"constant",evaluate:()=>T}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,h,f){return this.property.possiblyEvaluate(this,a,h,f)}}class tf{constructor(a){this.property=a,this.value=new ef(a,void 0)}transitioned(a,h){return new Iy(this.property,this.value,h,Fe({},a.transition,this.transition),a.now)}untransitioned(){return new Iy(this.property,this.value,null,{},0)}}class Ey{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return ct(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new tf(this._values[a].property)),this._values[a].value=new ef(this._values[a].property,h===null?void 0:ct(h))}getTransition(a){return ct(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new tf(this._values[a].property)),this._values[a].transition=ct(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const f=this.getValue(h);f!==void 0&&(a[h]=f);const b=this.getTransition(h);b!==void 0&&(a[`${h}-transition`]=b)}return a}transitioned(a,h){const f=new p1(this._properties);for(const b of Object.keys(this._values))f._values[b]=this._values[b].transitioned(a,h._values[b]);return f}untransitioned(){const a=new p1(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Iy{constructor(a,h,f,b,T){this.property=a,this.value=h,this.begin=T+b.delay||0,this.end=this.begin+b.duration||0,a.specification.transition&&(b.delay||b.duration)&&(this.prior=f)}possiblyEvaluate(a,h,f){const b=a.now||0,T=this.value.possiblyEvaluate(a,h,f),E=this.prior;if(E){if(b>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(b<this.begin)return E.possiblyEvaluate(a,h,f);{const P=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(a,h,f),T,function(k){if(k<=0)return 0;if(k>=1)return 1;const L=k*k,N=L*k;return 4*(k<.5?N:3*(k-L)+N-.75)}(P))}}return T}}class p1{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,f){const b=new Gh(this._properties);for(const T of Object.keys(this._values))b._values[T]=this._values[T].possiblyEvaluate(a,h,f);return b}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class w2{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return ct(this._values[a].value)}setValue(a,h){this._values[a]=new ef(this._values[a].property,h===null?void 0:ct(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const f=this.getValue(h);f!==void 0&&(a[h]=f)}return a}possiblyEvaluate(a,h,f){const b=new Gh(this._properties);for(const T of Object.keys(this._values))b._values[T]=this._values[T].possiblyEvaluate(a,h,f);return b}}class ro{constructor(a,h,f){this.property=a,this.value=h,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,f,b){return this.property.evaluate(this.value,this.parameters,a,h,f,b)}}class Gh{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class wt{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,f){const b=gn[this.specification.type];return b?b(a,h,f):a}}class $t{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,f,b){return new ro(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},f,b)}:a.expression,h)}interpolate(a,h,f){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new ro(this,{kind:"constant",value:void 0},a.parameters);const b=gn[this.specification.type];if(b){const T=b(a.value.value,h.value.value,f);return new ro(this,{kind:"constant",value:T},a.parameters)}return a}evaluate(a,h,f,b,T,E){return a.kind==="constant"?a.value:a.evaluate(h,f,b,T,E)}}class ec extends $t{possiblyEvaluate(a,h,f,b){if(a.value===void 0)return new ro(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){const T=a.expression.evaluate(h,null,{},f,b),E=a.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,P=this._calculate(E,E,E,h);return new ro(this,{kind:"constant",value:P},h)}if(a.expression.kind==="camera"){const T=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new ro(this,{kind:"constant",value:T},h)}return new ro(this,a.expression,h)}evaluate(a,h,f,b,T,E){if(a.kind==="source"){const P=a.evaluate(h,f,b,T,E);return this._calculate(P,P,P,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},f,b),a.evaluate({zoom:Math.floor(h.zoom)},f,b),a.evaluate({zoom:Math.floor(h.zoom)+1},f,b),h):a.value}_calculate(a,h,f,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:f,to:h}}interpolate(a){return a}}class My{constructor(a){this.specification=a}possiblyEvaluate(a,h,f,b){if(a.value!==void 0){if(a.expression.kind==="constant"){const T=a.expression.evaluate(h,null,{},f,b);return this._calculate(T,T,T,h)}return this._calculate(a.expression.evaluate(new Zi(Math.floor(h.zoom-1),h)),a.expression.evaluate(new Zi(Math.floor(h.zoom),h)),a.expression.evaluate(new Zi(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,f,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:f,to:h}}interpolate(a){return a}}class qh{constructor(a){this.specification=a}possiblyEvaluate(a,h,f,b){return!!a.expression.evaluate(h,null,{},f,b)}interpolate(){return!1}}class Xs{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in a){const f=a[h];f.specification.overridable&&this.overridableProperties.push(h);const b=this.defaultPropertyValues[h]=new ef(f,void 0),T=this.defaultTransitionablePropertyValues[h]=new tf(f);this.defaultTransitioningPropertyValues[h]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=b.possiblyEvaluate({})}}}pt("DataDrivenProperty",$t),pt("DataConstantProperty",wt),pt("CrossFadedDataDrivenProperty",ec),pt("CrossFadedProperty",My),pt("ColorRampProperty",qh);const f1="-transition";class so extends la{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new w2(h.layout)),h.paint)){this._transitionablePaint=new Ey(h.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gh(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,h,f={}){h!=null&&this._validate(vy,`layers.${this.id}.layout.${a}`,a,h,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(f1)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,f={}){if(h!=null&&this._validate(b2,`layers.${this.id}.paint.${a}`,a,h,f))return!1;if(a.endsWith(f1))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const b=this._transitionablePaint._values[a],T=b.property.specification["property-type"]==="cross-faded-data-driven",E=b.value.isDataDriven(),P=b.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const k=this._transitionablePaint._values[a].value;return k.isDataDriven()||E||T||this._handleOverridablePaintPropertyUpdate(a,P,k)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),at(a,(h,f)=>!(h===void 0||f==="layout"&&!Object.keys(h).length||f==="paint"&&!Object.keys(h).length))}_validate(a,h,f,b,T={}){return(!T||T.validate!==!1)&&u1(this,a.call(su,{key:h,layerType:this.type,objectKey:f,value:b,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof ro&&Jc(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const m1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ou{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ar{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function xr(u,a=1){let h=0,f=0;return{members:u.map(b=>{const T=m1[b.type].BYTES_PER_ELEMENT,E=h=y1(h,Math.max(a,T)),P=b.components||1;return f=Math.max(f,T),h+=T*P,{name:b.name,type:b.type,components:P,offset:E}}),size:y1(h,Math.max(f,a)),alignment:a}}function y1(u,a){return Math.ceil(u/a)*a}class Hh extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const b=2*a;return this.int16[b+0]=h,this.int16[b+1]=f,a}}Hh.prototype.bytesPerElement=4,pt("StructArrayLayout2i4",Hh);class rf extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,f)}emplace(a,h,f,b){const T=3*a;return this.int16[T+0]=h,this.int16[T+1]=f,this.int16[T+2]=b,a}}rf.prototype.bytesPerElement=6,pt("StructArrayLayout3i6",rf);class rl extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,f,b)}emplace(a,h,f,b,T){const E=4*a;return this.int16[E+0]=h,this.int16[E+1]=f,this.int16[E+2]=b,this.int16[E+3]=T,a}}rl.prototype.bytesPerElement=8,pt("StructArrayLayout4i8",rl);class Ay extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,h,f,b,T,E)}emplace(a,h,f,b,T,E,P){const k=6*a;return this.int16[k+0]=h,this.int16[k+1]=f,this.int16[k+2]=b,this.int16[k+3]=T,this.int16[k+4]=E,this.int16[k+5]=P,a}}Ay.prototype.bytesPerElement=12,pt("StructArrayLayout2i4i12",Ay);class Py extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,h,f,b,T,E)}emplace(a,h,f,b,T,E,P){const k=4*a,L=8*a;return this.int16[k+0]=h,this.int16[k+1]=f,this.uint8[L+4]=b,this.uint8[L+5]=T,this.uint8[L+6]=E,this.uint8[L+7]=P,a}}Py.prototype.bytesPerElement=8,pt("StructArrayLayout2i4ub8",Py);class Wh extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const b=2*a;return this.float32[b+0]=h,this.float32[b+1]=f,a}}Wh.prototype.bytesPerElement=8,pt("StructArrayLayout2f8",Wh);class Cy extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E,P,k,L,N){const F=this.length;return this.resize(F+1),this.emplace(F,a,h,f,b,T,E,P,k,L,N)}emplace(a,h,f,b,T,E,P,k,L,N,F){const G=10*a;return this.uint16[G+0]=h,this.uint16[G+1]=f,this.uint16[G+2]=b,this.uint16[G+3]=T,this.uint16[G+4]=E,this.uint16[G+5]=P,this.uint16[G+6]=k,this.uint16[G+7]=L,this.uint16[G+8]=N,this.uint16[G+9]=F,a}}Cy.prototype.bytesPerElement=20,pt("StructArrayLayout10ui20",Cy);class sf extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E,P,k,L,N,F,G){const Z=this.length;return this.resize(Z+1),this.emplace(Z,a,h,f,b,T,E,P,k,L,N,F,G)}emplace(a,h,f,b,T,E,P,k,L,N,F,G,Z){const J=12*a;return this.int16[J+0]=h,this.int16[J+1]=f,this.int16[J+2]=b,this.int16[J+3]=T,this.uint16[J+4]=E,this.uint16[J+5]=P,this.uint16[J+6]=k,this.uint16[J+7]=L,this.int16[J+8]=N,this.int16[J+9]=F,this.int16[J+10]=G,this.int16[J+11]=Z,a}}sf.prototype.bytesPerElement=24,pt("StructArrayLayout4i4ui4i24",sf);class $y extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,f)}emplace(a,h,f,b){const T=3*a;return this.float32[T+0]=h,this.float32[T+1]=f,this.float32[T+2]=b,a}}$y.prototype.bytesPerElement=12,pt("StructArrayLayout3f12",$y);class ky extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}ky.prototype.bytesPerElement=4,pt("StructArrayLayout1ul4",ky);class fa extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E,P,k,L){const N=this.length;return this.resize(N+1),this.emplace(N,a,h,f,b,T,E,P,k,L)}emplace(a,h,f,b,T,E,P,k,L,N){const F=10*a,G=5*a;return this.int16[F+0]=h,this.int16[F+1]=f,this.int16[F+2]=b,this.int16[F+3]=T,this.int16[F+4]=E,this.int16[F+5]=P,this.uint32[G+3]=k,this.uint16[F+8]=L,this.uint16[F+9]=N,a}}fa.prototype.bytesPerElement=20,pt("StructArrayLayout6i1ul2ui20",fa);class nf extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,h,f,b,T,E)}emplace(a,h,f,b,T,E,P){const k=6*a;return this.int16[k+0]=h,this.int16[k+1]=f,this.int16[k+2]=b,this.int16[k+3]=T,this.int16[k+4]=E,this.int16[k+5]=P,a}}nf.prototype.bytesPerElement=12,pt("StructArrayLayout2i2i2i12",nf);class Zh extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T){const E=this.length;return this.resize(E+1),this.emplace(E,a,h,f,b,T)}emplace(a,h,f,b,T,E){const P=4*a,k=8*a;return this.float32[P+0]=h,this.float32[P+1]=f,this.float32[P+2]=b,this.int16[k+6]=T,this.int16[k+7]=E,a}}Zh.prototype.bytesPerElement=16,pt("StructArrayLayout2f1f2i16",Zh);class of extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,f,b)}emplace(a,h,f,b,T){const E=12*a,P=3*a;return this.uint8[E+0]=h,this.uint8[E+1]=f,this.float32[P+1]=b,this.float32[P+2]=T,a}}of.prototype.bytesPerElement=12,pt("StructArrayLayout2ub2f12",of);class au extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,f)}emplace(a,h,f,b){const T=3*a;return this.uint16[T+0]=h,this.uint16[T+1]=f,this.uint16[T+2]=b,a}}au.prototype.bytesPerElement=6,pt("StructArrayLayout3ui6",au);class Ry extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue){const Te=this.length;return this.resize(Te+1),this.emplace(Te,a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue)}emplace(a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue,Te){const de=24*a,we=12*a,Ne=48*a;return this.int16[de+0]=h,this.int16[de+1]=f,this.uint16[de+2]=b,this.uint16[de+3]=T,this.uint32[we+2]=E,this.uint32[we+3]=P,this.uint32[we+4]=k,this.uint16[de+10]=L,this.uint16[de+11]=N,this.uint16[de+12]=F,this.float32[we+7]=G,this.float32[we+8]=Z,this.uint8[Ne+36]=J,this.uint8[Ne+37]=Q,this.uint8[Ne+38]=oe,this.uint32[we+10]=ue,this.int16[de+22]=Te,a}}Ry.prototype.bytesPerElement=48,pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ry);class lu extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue,Te,de,we,Ne,ze,lt,vt,ot,st,Qe,mt){const it=this.length;return this.resize(it+1),this.emplace(it,a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue,Te,de,we,Ne,ze,lt,vt,ot,st,Qe,mt)}emplace(a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q,oe,ue,Te,de,we,Ne,ze,lt,vt,ot,st,Qe,mt,it){const We=32*a,Et=16*a;return this.int16[We+0]=h,this.int16[We+1]=f,this.int16[We+2]=b,this.int16[We+3]=T,this.int16[We+4]=E,this.int16[We+5]=P,this.int16[We+6]=k,this.int16[We+7]=L,this.uint16[We+8]=N,this.uint16[We+9]=F,this.uint16[We+10]=G,this.uint16[We+11]=Z,this.uint16[We+12]=J,this.uint16[We+13]=Q,this.uint16[We+14]=oe,this.uint16[We+15]=ue,this.uint16[We+16]=Te,this.uint16[We+17]=de,this.uint16[We+18]=we,this.uint16[We+19]=Ne,this.uint16[We+20]=ze,this.uint16[We+21]=lt,this.uint16[We+22]=vt,this.uint32[Et+12]=ot,this.float32[Et+13]=st,this.float32[Et+14]=Qe,this.uint16[We+30]=mt,this.uint16[We+31]=it,a}}lu.prototype.bytesPerElement=64,pt("StructArrayLayout8i15ui1ul2f2ui64",lu);class sl extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}sl.prototype.bytesPerElement=4,pt("StructArrayLayout1f4",sl);class Oy extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,f)}emplace(a,h,f,b){const T=3*a;return this.uint16[6*a+0]=h,this.float32[T+1]=f,this.float32[T+2]=b,a}}Oy.prototype.bytesPerElement=12,pt("StructArrayLayout1ui2f12",Oy);class af extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,f){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,f)}emplace(a,h,f,b){const T=4*a;return this.uint32[2*a+0]=h,this.uint16[T+2]=f,this.uint16[T+3]=b,a}}af.prototype.bytesPerElement=8,pt("StructArrayLayout1ul2ui8",af);class tc extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const f=this.length;return this.resize(f+1),this.emplace(f,a,h)}emplace(a,h,f){const b=2*a;return this.uint16[b+0]=h,this.uint16[b+1]=f,a}}tc.prototype.bytesPerElement=4,pt("StructArrayLayout2ui4",tc);class Ly extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}Ly.prototype.bytesPerElement=2,pt("StructArrayLayout1ui2",Ly);class Dy extends ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,f,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,f,b)}emplace(a,h,f,b,T){const E=4*a;return this.float32[E+0]=h,this.float32[E+1]=f,this.float32[E+2]=b,this.float32[E+3]=T,a}}Dy.prototype.bytesPerElement=16,pt("StructArrayLayout4f16",Dy);class Ny extends ou{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new M(this.anchorPointX,this.anchorPointY)}}Ny.prototype.size=20;class g1 extends fa{get(a){return new Ny(this,a)}}pt("CollisionBoxArray",g1);class w extends ou{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class l extends Ry{get(a){return new w(this,a)}}pt("PlacedSymbolArray",l);class d extends ou{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}d.prototype.size=64;class m extends lu{get(a){return new d(this,a)}}pt("SymbolInstanceArray",m);class _ extends sl{getoffsetX(a){return this.float32[1*a+0]}}pt("GlyphOffsetArray",_);class x extends rf{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}pt("SymbolLineVertexArray",x);class C extends ou{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}C.prototype.size=12;class $ extends Oy{get(a){return new C(this,a)}}pt("TextAnchorOffsetArray",$);class R extends ou{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class D extends af{get(a){return new R(this,a)}}pt("FeatureIndexArray",D);class B extends Hh{}class U extends Hh{}class Y extends Hh{}class ne extends Ay{}class re extends Py{}class le extends Wh{}class X extends Cy{}class fe extends sf{}class Ae extends $y{}class ce extends ky{}class xe extends nf{}class Pe extends of{}class Ce extends au{}class Re extends tc{}const qe=xr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ue}=qe;class Ve{constructor(a=[]){this.segments=a}prepareSegment(a,h,f,b){let T=this.segments[this.segments.length-1];return a>Ve.MAX_VERTEX_ARRAY_LENGTH&&Pt(`Max vertices per segment is ${Ve.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!T||T.vertexLength+a>Ve.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==b)&&(T={vertexOffset:h.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},b!==void 0&&(T.sortKey=b),this.segments.push(T)),T}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,f,b){return new Ve([{vertexOffset:a,primitiveOffset:h,vertexLength:f,primitiveLength:b,vaos:{},sortKey:0}])}}function dt(u,a){return 256*(u=Me(Math.floor(u),0,255))+Me(Math.floor(a),0,255)}Ve.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pt("SegmentVector",Ve);const Vt=xr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var tt={exports:{}},Rt={exports:{}};Rt.exports=function(u,a){var h,f,b,T,E,P,k,L;for(f=u.length-(h=3&u.length),b=a,E=3432918353,P=461845907,L=0;L<f;)k=255&u.charCodeAt(L)|(255&u.charCodeAt(++L))<<8|(255&u.charCodeAt(++L))<<16|(255&u.charCodeAt(++L))<<24,++L,b=27492+(65535&(T=5*(65535&(b=(b^=k=(65535&(k=(k=(65535&k)*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*P+(((k>>>16)*P&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(k=0,h){case 3:k^=(255&u.charCodeAt(L+2))<<16;case 2:k^=(255&u.charCodeAt(L+1))<<8;case 1:b^=k=(65535&(k=(k=(65535&(k^=255&u.charCodeAt(L)))*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*P+(((k>>>16)*P&65535)<<16)&4294967295}return b^=u.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0};var Yt=Rt.exports,ui={exports:{}};ui.exports=function(u,a){for(var h,f=u.length,b=a^f,T=0;f>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(T)|(255&u.charCodeAt(++T))<<8|(255&u.charCodeAt(++T))<<16|(255&u.charCodeAt(++T))<<24))+((1540483477*(h>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),f-=4,++T;switch(f){case 3:b^=(255&u.charCodeAt(T+2))<<16;case 2:b^=(255&u.charCodeAt(T+1))<<8;case 1:b=1540483477*(65535&(b^=255&u.charCodeAt(T)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0};var Nt=Yt,Qt=ui.exports;tt.exports=Nt,tt.exports.murmur3=Nt,tt.exports.murmur2=Qt;var ei=p(tt.exports);class ir{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,f,b){this.ids.push(zi(a)),this.positions.push(h,f,b)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=zi(a);let f=0,b=this.ids.length-1;for(;f<b;){const E=f+b>>1;this.ids[E]>=h?b=E:f=E+1}const T=[];for(;this.ids[f]===h;)T.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return T}static serialize(a,h){const f=new Float64Array(a.ids),b=new Uint32Array(a.positions);return Qs(f,b,0,f.length-1),h&&h.push(f.buffer,b.buffer),{ids:f,positions:b}}static deserialize(a){const h=new ir;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function zi(u){const a=+u;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:ei(String(u))}function Qs(u,a,h,f){for(;h<f;){const b=u[h+f>>1];let T=h-1,E=f+1;for(;;){do T++;while(u[T]<b);do E--;while(u[E]>b);if(T>=E)break;$r(u,T,E),$r(a,3*T,3*E),$r(a,3*T+1,3*E+1),$r(a,3*T+2,3*E+2)}E-h<f-E?(Qs(u,a,h,E),h=E+1):(Qs(u,a,E+1,f),f=E)}}function $r(u,a,h){const f=u[a];u[a]=u[h],u[h]=f}pt("FeaturePositionMap",ir);class ji{constructor(a,h){this.gl=a.gl,this.location=h}}class _s extends ji{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class no extends ji{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class Oo extends ji{constructor(a,h){super(a,h),this.current=Ei.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const ic=new Float32Array(16);function rc(u){return[dt(255*u.r,255*u.g),dt(255*u.b,255*u.a)]}class Lo{constructor(a,h,f){this.value=a,this.uniformNames=h.map(b=>`u_${b}`),this.type=f}setUniform(a,h,f){a.set(f.constantOr(this.value))}getBinding(a,h,f){return this.type==="color"?new Oo(a,h):new _s(a,h)}}class oo{constructor(a,h){this.uniformNames=h.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,f,b){const T=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&a.set(T)}getBinding(a,h,f){return f.substr(0,9)==="u_pattern"?new no(a,h):new _s(a,h)}}class lr{constructor(a,h,f,b){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=h.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new b}populatePaintArray(a,h,f,b,T){const E=this.paintVertexArray.length,P=this.expression.evaluate(new Zi(0),h,{},b,[],T);this.paintVertexArray.resize(a),this._setPaintValue(E,a,P)}updatePaintArray(a,h,f,b){const T=this.expression.evaluate({zoom:0},f,b);this._setPaintValue(a,h,T)}_setPaintValue(a,h,f){if(this.type==="color"){const b=rc(f);for(let T=a;T<h;T++)this.paintVertexArray.emplace(T,b[0],b[1])}else{for(let b=a;b<h;b++)this.paintVertexArray.emplace(b,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Yi{constructor(a,h,f,b,T,E){this.expression=a,this.uniformNames=h.map(P=>`u_${P}_t`),this.type=f,this.useIntegerZoom=b,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=h.map(P=>({name:`a_${P}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(a,h,f,b,T){const E=this.expression.evaluate(new Zi(this.zoom),h,{},b,[],T),P=this.expression.evaluate(new Zi(this.zoom+1),h,{},b,[],T),k=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(k,a,E,P)}updatePaintArray(a,h,f,b){const T=this.expression.evaluate({zoom:this.zoom},f,b),E=this.expression.evaluate({zoom:this.zoom+1},f,b);this._setPaintValue(a,h,T,E)}_setPaintValue(a,h,f,b){if(this.type==="color"){const T=rc(f),E=rc(b);for(let P=a;P<h;P++)this.paintVertexArray.emplace(P,T[0],T[1],E[0],E[1])}else{for(let T=a;T<h;T++)this.paintVertexArray.emplace(T,f,b);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(b))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){const f=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,b=Me(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);a.set(b)}getBinding(a,h,f){return new _s(a,h)}}class mr{constructor(a,h,f,b,T,E){this.expression=a,this.type=h,this.useIntegerZoom=f,this.zoom=b,this.layerId=E,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(a,h,f){const b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(b,a,h.patterns&&h.patterns[this.layerId],f)}updatePaintArray(a,h,f,b,T){this._setPaintValues(a,h,f.patterns&&f.patterns[this.layerId],T)}_setPaintValues(a,h,f,b){if(!b||!f)return;const{min:T,mid:E,max:P}=f,k=b[T],L=b[E],N=b[P];if(k&&L&&N)for(let F=a;F<h;F++)this.zoomInPaintVertexArray.emplace(F,L.tl[0],L.tl[1],L.br[0],L.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],L.pixelRatio,k.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,L.tl[0],L.tl[1],L.br[0],L.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],L.pixelRatio,N.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Vt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Vt.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class cu{constructor(a,h,f){this.binders={},this._buffers=[];const b=[];for(const T in a.paint._values){if(!f(T))continue;const E=a.paint.get(T);if(!(E instanceof ro&&Jc(E.property.specification)))continue;const P=is(T,a.type),k=E.value,L=E.property.specification.type,N=E.property.useIntegerZoom,F=E.property.specification["property-type"],G=F==="cross-faded"||F==="cross-faded-data-driven";if(k.kind==="constant")this.binders[T]=G?new oo(k.value,P):new Lo(k.value,P,L),b.push(`/u_${T}`);else if(k.kind==="source"||G){const Z=vn(T,L,"source");this.binders[T]=G?new mr(k,L,N,h,Z,a.id):new lr(k,P,L,Z),b.push(`/a_${T}`)}else{const Z=vn(T,L,"composite");this.binders[T]=new Yi(k,P,L,N,h,Z),b.push(`/z_${T}`)}}this.cacheKey=b.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof lr||h instanceof Yi?h.maxValue:0}populatePaintArrays(a,h,f,b,T){for(const E in this.binders){const P=this.binders[E];(P instanceof lr||P instanceof Yi||P instanceof mr)&&P.populatePaintArray(a,h,f,b,T)}}setConstantPatternPositions(a,h){for(const f in this.binders){const b=this.binders[f];b instanceof oo&&b.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,f,b,T){let E=!1;for(const P in a){const k=h.getPositions(P);for(const L of k){const N=f.feature(L.index);for(const F in this.binders){const G=this.binders[F];if((G instanceof lr||G instanceof Yi||G instanceof mr)&&G.expression.isStateDependent===!0){const Z=b.paint.get(F);G.expression=Z.value,G.updatePaintArray(L.start,L.end,N,a[P],T),E=!0}}}}return E}defines(){const a=[];for(const h in this.binders){const f=this.binders[h];(f instanceof Lo||f instanceof oo)&&a.push(...f.uniformNames.map(b=>`#define HAS_UNIFORM_${b}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof lr||f instanceof Yi)for(let b=0;b<f.paintVertexAttributes.length;b++)a.push(f.paintVertexAttributes[b].name);else if(f instanceof mr)for(let b=0;b<Vt.members.length;b++)a.push(Vt.members[b].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof Lo||f instanceof oo||f instanceof Yi)for(const b of f.uniformNames)a.push(b)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){const f=[];for(const b in this.binders){const T=this.binders[b];if(T instanceof Lo||T instanceof oo||T instanceof Yi){for(const E of T.uniformNames)if(h[E]){const P=T.getBinding(a,h[E],E);f.push({name:E,property:b,binding:P})}}}return f}setUniforms(a,h,f,b){for(const{name:T,property:E,binding:P}of h)this.binders[E].setUniform(P,b,f.get(E),T)}updatePaintBuffers(a){this._buffers=[];for(const h in this.binders){const f=this.binders[h];if(a&&f instanceof mr){const b=a.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(f instanceof lr||f instanceof Yi)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(a){for(const h in this.binders){const f=this.binders[h];(f instanceof lr||f instanceof Yi||f instanceof mr)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof lr||h instanceof Yi||h instanceof mr)&&h.destroy()}}}class er{constructor(a,h,f=()=>!0){this.programConfigurations={};for(const b of a)this.programConfigurations[b.id]=new cu(b,h,f);this.needsUpload=!1,this._featureMap=new ir,this._bufferOffset=0}populatePaintArrays(a,h,f,b,T,E){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(a,h,b,T,E);h.id!==void 0&&this._featureMap.add(h.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,f,b){for(const T of f)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(a,this._featureMap,h,T,b)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function is(u,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}function vn(u,a,h){const f={color:{source:Wh,composite:Dy},number:{source:sl,composite:Wh}},b=function(T){return{"line-pattern":{source:X,composite:X},"fill-pattern":{source:X,composite:X},"fill-extrusion-pattern":{source:X,composite:X}}[T]}(u);return b&&b[h]||f[a][h]}pt("ConstantBinder",Lo),pt("CrossFadedConstantBinder",oo),pt("SourceExpressionBinder",lr),pt("CrossFadedCompositeBinder",mr),pt("CompositeExpressionBinder",Yi),pt("ProgramConfiguration",cu,{omit:["_buffers"]}),pt("ProgramConfigurationSet",er);const li=8192,zy=Math.pow(2,14)-1,_1=-zy-1;function sc(u){const a=li/u.extent,h=u.loadGeometry();for(let f=0;f<h.length;f++){const b=h[f];for(let T=0;T<b.length;T++){const E=b[T],P=Math.round(E.x*a),k=Math.round(E.y*a);E.x=Me(P,_1,zy),E.y=Me(k,_1,zy),(P<E.x||P>E.x+1||k<E.y||k>E.y+1)&&Pt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function nc(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?sc(u):[]}}function lf(u,a,h,f,b){u.emplaceBack(2*a+(f+1)/2,2*h+(b+1)/2)}class Fy{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new U,this.indexArray=new Ce,this.segments=new Ve,this.programConfigurations=new er(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){const b=this.layers[0],T=[];let E=null,P=!1;b.type==="circle"&&(E=b.layout.get("circle-sort-key"),P=!E.isConstant());for(const{feature:k,id:L,index:N,sourceLayerIndex:F}of a){const G=this.layers[0]._featureFilter.needGeometry,Z=nc(k,G);if(!this.layers[0]._featureFilter.filter(new Zi(this.zoom),Z,f))continue;const J=P?E.evaluate(Z,{},f):void 0,Q={id:L,properties:k.properties,type:k.type,sourceLayerIndex:F,index:N,geometry:G?Z.geometry:sc(k),patterns:{},sortKey:J};T.push(Q)}P&&T.sort((k,L)=>k.sortKey-L.sortKey);for(const k of T){const{geometry:L,index:N,sourceLayerIndex:F}=k,G=a[N].feature;this.addFeature(k,L,N,f),h.featureIndex.insert(G,L,N,F,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ue),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,f,b){for(const T of h)for(const E of T){const P=E.x,k=E.y;if(P<0||P>=li||k<0||k>=li)continue;const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),N=L.vertexLength;lf(this.layoutVertexArray,P,k,-1,-1),lf(this.layoutVertexArray,P,k,1,-1),lf(this.layoutVertexArray,P,k,1,1),lf(this.layoutVertexArray,P,k,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},b)}}function oc(u,a){for(let h=0;h<u.length;h++)if(cf(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(cf(u,a[h]))return!0;return!!Yh(u,a)}function v1(u,a,h){return!!cf(u,a)||!!Jh(a,u,h)}function By(u,a){if(u.length===1)return mP(a,u[0]);for(let h=0;h<a.length;h++){const f=a[h];for(let b=0;b<f.length;b++)if(cf(u,f[b]))return!0}for(let h=0;h<u.length;h++)if(mP(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(Yh(u,a[h]))return!0;return!1}function b1(u,a,h){if(u.length>1){if(Yh(u,a))return!0;for(let f=0;f<a.length;f++)if(Jh(a[f],u,h))return!0}for(let f=0;f<u.length;f++)if(Jh(u[f],a,h))return!0;return!1}function Yh(u,a){if(u.length===0||a.length===0)return!1;for(let h=0;h<u.length-1;h++){const f=u[h],b=u[h+1];for(let T=0;T<a.length-1;T++)if(w1(f,b,a[T],a[T+1]))return!0}return!1}function w1(u,a,h,f){return ft(u,h,f)!==ft(a,h,f)&&ft(u,a,h)!==ft(u,a,f)}function Jh(u,a,h){const f=h*h;if(a.length===1)return u.distSqr(a[0])<f;for(let b=1;b<a.length;b++)if(fP(u,a[b-1],a[b])<f)return!0;return!1}function fP(u,a,h){const f=a.distSqr(h);if(f===0)return u.distSqr(a);const b=((u.x-a.x)*(h.x-a.x)+(u.y-a.y)*(h.y-a.y))/f;return u.distSqr(b<0?a:b>1?h:h.sub(a)._mult(b)._add(a))}function mP(u,a){let h,f,b,T=!1;for(let E=0;E<u.length;E++){h=u[E];for(let P=0,k=h.length-1;P<h.length;k=P++)f=h[P],b=h[k],f.y>a.y!=b.y>a.y&&a.x<(b.x-f.x)*(a.y-f.y)/(b.y-f.y)+f.x&&(T=!T)}return T}function cf(u,a){let h=!1;for(let f=0,b=u.length-1;f<u.length;b=f++){const T=u[f],E=u[b];T.y>a.y!=E.y>a.y&&a.x<(E.x-T.x)*(a.y-T.y)/(E.y-T.y)+T.x&&(h=!h)}return h}function ij(u,a,h){const f=h[0],b=h[2];if(u.x<f.x&&a.x<f.x||u.x>b.x&&a.x>b.x||u.y<f.y&&a.y<f.y||u.y>b.y&&a.y>b.y)return!1;const T=ft(u,a,h[0]);return T!==ft(u,a,h[1])||T!==ft(u,a,h[2])||T!==ft(u,a,h[3])}function Uy(u,a,h){const f=a.paint.get(u).value;return f.kind==="constant"?f.value:h.programConfigurations.get(a.id).getMaxValue(u)}function x1(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function S1(u,a,h,f,b){if(!a[0]&&!a[1])return u;const T=M.convert(a)._mult(b);h==="viewport"&&T._rotate(-f);const E=[];for(let P=0;P<u.length;P++)E.push(u[P].sub(T));return E}let yP,gP;pt("CircleBucket",Fy,{omit:["layers"]});var rj={get paint(){return gP=gP||new Xs({"circle-radius":new $t(Oe.paint_circle["circle-radius"]),"circle-color":new $t(Oe.paint_circle["circle-color"]),"circle-blur":new $t(Oe.paint_circle["circle-blur"]),"circle-opacity":new $t(Oe.paint_circle["circle-opacity"]),"circle-translate":new wt(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $t(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $t(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $t(Oe.paint_circle["circle-stroke-opacity"])})},get layout(){return yP=yP||new Xs({"circle-sort-key":new $t(Oe.layout_circle["circle-sort-key"])})}},en=1e-6,uf=typeof Float32Array<"u"?Float32Array:Array;function x2(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function _P(u,a,h){var f=a[0],b=a[1],T=a[2],E=a[3],P=a[4],k=a[5],L=a[6],N=a[7],F=a[8],G=a[9],Z=a[10],J=a[11],Q=a[12],oe=a[13],ue=a[14],Te=a[15],de=h[0],we=h[1],Ne=h[2],ze=h[3];return u[0]=de*f+we*P+Ne*F+ze*Q,u[1]=de*b+we*k+Ne*G+ze*oe,u[2]=de*T+we*L+Ne*Z+ze*ue,u[3]=de*E+we*N+Ne*J+ze*Te,u[4]=(de=h[4])*f+(we=h[5])*P+(Ne=h[6])*F+(ze=h[7])*Q,u[5]=de*b+we*k+Ne*G+ze*oe,u[6]=de*T+we*L+Ne*Z+ze*ue,u[7]=de*E+we*N+Ne*J+ze*Te,u[8]=(de=h[8])*f+(we=h[9])*P+(Ne=h[10])*F+(ze=h[11])*Q,u[9]=de*b+we*k+Ne*G+ze*oe,u[10]=de*T+we*L+Ne*Z+ze*ue,u[11]=de*E+we*N+Ne*J+ze*Te,u[12]=(de=h[12])*f+(we=h[13])*P+(Ne=h[14])*F+(ze=h[15])*Q,u[13]=de*b+we*k+Ne*G+ze*oe,u[14]=de*T+we*L+Ne*Z+ze*ue,u[15]=de*E+we*N+Ne*J+ze*Te,u}Math.hypot||(Math.hypot=function(){for(var u=0,a=arguments.length;a--;)u+=arguments[a]*arguments[a];return Math.sqrt(u)});var jy,sj=_P;function T1(u,a,h){var f=a[0],b=a[1],T=a[2],E=a[3];return u[0]=h[0]*f+h[4]*b+h[8]*T+h[12]*E,u[1]=h[1]*f+h[5]*b+h[9]*T+h[13]*E,u[2]=h[2]*f+h[6]*b+h[10]*T+h[14]*E,u[3]=h[3]*f+h[7]*b+h[11]*T+h[15]*E,u}jy=new uf(4),uf!=Float32Array&&(jy[0]=0,jy[1]=0,jy[2]=0,jy[3]=0);class nj extends so{constructor(a){super(a,rj)}createBucket(a){return new Fy(a)}queryRadius(a){const h=a;return Uy("circle-radius",this,h)+Uy("circle-stroke-width",this,h)+x1(this.paint.get("circle-translate"))}queryIntersectsFeature(a,h,f,b,T,E,P,k){const L=S1(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,P),N=this.paint.get("circle-radius").evaluate(h,f)+this.paint.get("circle-stroke-width").evaluate(h,f),F=this.paint.get("circle-pitch-alignment")==="map",G=F?L:function(J,Q){return J.map(oe=>vP(oe,Q))}(L,k),Z=F?N*P:N;for(const J of b)for(const Q of J){const oe=F?Q:vP(Q,k);let ue=Z;const Te=T1([],[Q.x,Q.y,0,1],k);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ue*=Te[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ue*=E.cameraToCenterDistance/Te[3]),v1(G,oe,ue))return!0}return!1}}function vP(u,a){const h=T1([],[u.x,u.y,0,1],a);return new M(h[0]/h[3],h[1]/h[3])}class bP extends Fy{}let wP;pt("HeatmapBucket",bP,{omit:["layers"]});var oj={get paint(){return wP=wP||new Xs({"heatmap-radius":new $t(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $t(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qh(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(Oe.paint_heatmap["heatmap-opacity"])})}};function S2(u,{width:a,height:h},f,b){if(b){if(b instanceof Uint8ClampedArray)b=new Uint8Array(b.buffer);else if(b.length!==a*h*f)throw new RangeError(`mismatched image size. expected: ${b.length} but got: ${a*h*f}`)}else b=new Uint8Array(a*h*f);return u.width=a,u.height=h,u.data=b,u}function xP(u,{width:a,height:h},f){if(a===u.width&&h===u.height)return;const b=S2({},{width:a,height:h},f);T2(u,b,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,a),height:Math.min(u.height,h)},f),u.width=a,u.height=h,u.data=b.data}function T2(u,a,h,f,b,T){if(b.width===0||b.height===0)return a;if(b.width>u.width||b.height>u.height||h.x>u.width-b.width||h.y>u.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>a.width||b.height>a.height||f.x>a.width-b.width||f.y>a.height-b.height)throw new RangeError("out of range destination coordinates for image copy");const E=u.data,P=a.data;if(E===P)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<b.height;k++){const L=((h.y+k)*u.width+h.x)*T,N=((f.y+k)*a.width+f.x)*T;for(let F=0;F<b.width*T;F++)P[N+F]=E[L+F]}return a}class Vy{constructor(a,h){S2(this,a,1,h)}resize(a){xP(this,a,1)}clone(){return new Vy({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,f,b,T){T2(a,h,f,b,T,1)}}class ao{constructor(a,h){S2(this,a,4,h)}resize(a){xP(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,f,b,T){T2(a,h,f,b,T,4)}}function SP(u){const a={},h=u.resolution||256,f=u.clips?u.clips.length:1,b=u.image||new ao({width:h,height:f});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const T=(E,P,k)=>{a[u.evaluationKey]=k;const L=u.expression.evaluate(a);b.data[E+P+0]=Math.floor(255*L.r/L.a),b.data[E+P+1]=Math.floor(255*L.g/L.a),b.data[E+P+2]=Math.floor(255*L.b/L.a),b.data[E+P+3]=Math.floor(255*L.a)};if(u.clips)for(let E=0,P=0;E<f;++E,P+=4*h)for(let k=0,L=0;k<h;k++,L+=4){const N=k/(h-1),{start:F,end:G}=u.clips[E];T(P,L,F*(1-N)+G*N)}else for(let E=0,P=0;E<h;E++,P+=4)T(0,P,E/(h-1));return b}pt("AlphaImage",Vy),pt("RGBAImage",ao);class aj extends so{createBucket(a){return new bP(a)}constructor(a){super(a,oj),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=SP({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let TP;var lj={get paint(){return TP=TP||new Xs({"hillshade-illumination-direction":new wt(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(Oe.paint_hillshade["hillshade-accent-color"])})}};class cj extends so{constructor(a){super(a,lj)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const uj=xr([{name:"a_pos",components:2,type:"Int16"}],4),{members:hj}=uj;var E2={exports:{}};function E1(u,a,h){h=h||2;var f,b,T,E,P,k,L,N=a&&a.length,F=N?a[0]*h:u.length,G=EP(u,0,F,h,!0),Z=[];if(!G||G.next===G.prev)return Z;if(N&&(G=function(Q,oe,ue,Te){var de,we,Ne,ze=[];for(de=0,we=oe.length;de<we;de++)(Ne=EP(Q,oe[de]*Te,de<we-1?oe[de+1]*Te:Q.length,Te,!1))===Ne.next&&(Ne.steiner=!0),ze.push(vj(Ne));for(ze.sort(yj),de=0;de<ze.length;de++)ue=gj(ze[de],ue);return ue}(u,a,G,h)),u.length>80*h){f=T=u[0],b=E=u[1];for(var J=h;J<F;J+=h)(P=u[J])<f&&(f=P),(k=u[J+1])<b&&(b=k),P>T&&(T=P),k>E&&(E=k);L=(L=Math.max(T-f,E-b))!==0?32767/L:0}return Gy(G,Z,h,f,b,L,0),Z}function EP(u,a,h,f,b){var T,E;if(b===A2(u,a,h,f)>0)for(T=a;T<h;T+=f)E=AP(T,u[T],u[T+1],E);else for(T=h-f;T>=a;T-=f)E=AP(T,u[T],u[T+1],E);return E&&I1(E,E.next)&&(Hy(E),E=E.next),E}function Kh(u,a){if(!u)return u;a||(a=u);var h,f=u;do if(h=!1,f.steiner||!I1(f,f.next)&&Sr(f.prev,f,f.next)!==0)f=f.next;else{if(Hy(f),(f=a=f.prev)===f.next)break;h=!0}while(h||f!==a);return a}function Gy(u,a,h,f,b,T,E){if(u){!E&&T&&function(N,F,G,Z){var J=N;do J.z===0&&(J.z=I2(J.x,J.y,F,G,Z)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==N);J.prevZ.nextZ=null,J.prevZ=null,function(Q){var oe,ue,Te,de,we,Ne,ze,lt,vt=1;do{for(ue=Q,Q=null,we=null,Ne=0;ue;){for(Ne++,Te=ue,ze=0,oe=0;oe<vt&&(ze++,Te=Te.nextZ);oe++);for(lt=vt;ze>0||lt>0&&Te;)ze!==0&&(lt===0||!Te||ue.z<=Te.z)?(de=ue,ue=ue.nextZ,ze--):(de=Te,Te=Te.nextZ,lt--),we?we.nextZ=de:Q=de,de.prevZ=we,we=de;ue=Te}we.nextZ=null,vt*=2}while(Ne>1)}(J)}(u,f,b,T);for(var P,k,L=u;u.prev!==u.next;)if(P=u.prev,k=u.next,T?pj(u,f,b,T):dj(u))a.push(P.i/h|0),a.push(u.i/h|0),a.push(k.i/h|0),Hy(u),u=k.next,L=k.next;else if((u=k)===L){E?E===1?Gy(u=fj(Kh(u),a,h),a,h,f,b,T,2):E===2&&mj(u,a,h,f,b,T):Gy(Kh(u),a,h,f,b,T,1);break}}}function dj(u){var a=u.prev,h=u,f=u.next;if(Sr(a,h,f)>=0)return!1;for(var b=a.x,T=h.x,E=f.x,P=a.y,k=h.y,L=f.y,N=b<T?b<E?b:E:T<E?T:E,F=P<k?P<L?P:L:k<L?k:L,G=b>T?b>E?b:E:T>E?T:E,Z=P>k?P>L?P:L:k>L?k:L,J=f.next;J!==a;){if(J.x>=N&&J.x<=G&&J.y>=F&&J.y<=Z&&hf(b,P,T,k,E,L,J.x,J.y)&&Sr(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function pj(u,a,h,f){var b=u.prev,T=u,E=u.next;if(Sr(b,T,E)>=0)return!1;for(var P=b.x,k=T.x,L=E.x,N=b.y,F=T.y,G=E.y,Z=P<k?P<L?P:L:k<L?k:L,J=N<F?N<G?N:G:F<G?F:G,Q=P>k?P>L?P:L:k>L?k:L,oe=N>F?N>G?N:G:F>G?F:G,ue=I2(Z,J,a,h,f),Te=I2(Q,oe,a,h,f),de=u.prevZ,we=u.nextZ;de&&de.z>=ue&&we&&we.z<=Te;){if(de.x>=Z&&de.x<=Q&&de.y>=J&&de.y<=oe&&de!==b&&de!==E&&hf(P,N,k,F,L,G,de.x,de.y)&&Sr(de.prev,de,de.next)>=0||(de=de.prevZ,we.x>=Z&&we.x<=Q&&we.y>=J&&we.y<=oe&&we!==b&&we!==E&&hf(P,N,k,F,L,G,we.x,we.y)&&Sr(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;de&&de.z>=ue;){if(de.x>=Z&&de.x<=Q&&de.y>=J&&de.y<=oe&&de!==b&&de!==E&&hf(P,N,k,F,L,G,de.x,de.y)&&Sr(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;we&&we.z<=Te;){if(we.x>=Z&&we.x<=Q&&we.y>=J&&we.y<=oe&&we!==b&&we!==E&&hf(P,N,k,F,L,G,we.x,we.y)&&Sr(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function fj(u,a,h){var f=u;do{var b=f.prev,T=f.next.next;!I1(b,T)&&IP(b,f,f.next,T)&&qy(b,T)&&qy(T,b)&&(a.push(b.i/h|0),a.push(f.i/h|0),a.push(T.i/h|0),Hy(f),Hy(f.next),f=u=T),f=f.next}while(f!==u);return Kh(f)}function mj(u,a,h,f,b,T){var E=u;do{for(var P=E.next.next;P!==E.prev;){if(E.i!==P.i&&bj(E,P)){var k=MP(E,P);return E=Kh(E,E.next),k=Kh(k,k.next),Gy(E,a,h,f,b,T,0),void Gy(k,a,h,f,b,T,0)}P=P.next}E=E.next}while(E!==u)}function yj(u,a){return u.x-a.x}function gj(u,a){var h=function(b,T){var E,P=T,k=b.x,L=b.y,N=-1/0;do{if(L<=P.y&&L>=P.next.y&&P.next.y!==P.y){var F=P.x+(L-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(F<=k&&F>N&&(N=F,E=P.x<P.next.x?P:P.next,F===k))return E}P=P.next}while(P!==T);if(!E)return null;var G,Z=E,J=E.x,Q=E.y,oe=1/0;P=E;do k>=P.x&&P.x>=J&&k!==P.x&&hf(L<Q?k:N,L,J,Q,L<Q?N:k,L,P.x,P.y)&&(G=Math.abs(L-P.y)/(k-P.x),qy(P,b)&&(G<oe||G===oe&&(P.x>E.x||P.x===E.x&&_j(E,P)))&&(E=P,oe=G)),P=P.next;while(P!==Z);return E}(u,a);if(!h)return a;var f=MP(h,u);return Kh(f,f.next),Kh(h,h.next)}function _j(u,a){return Sr(u.prev,u,a.prev)<0&&Sr(a.next,u,u.next)<0}function I2(u,a,h,f,b){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*b|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*b|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function vj(u){var a=u,h=u;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==u);return h}function hf(u,a,h,f,b,T,E,P){return(b-E)*(a-P)>=(u-E)*(T-P)&&(u-E)*(f-P)>=(h-E)*(a-P)&&(h-E)*(T-P)>=(b-E)*(f-P)}function bj(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(h,f){var b=h;do{if(b.i!==h.i&&b.next.i!==h.i&&b.i!==f.i&&b.next.i!==f.i&&IP(b,b.next,h,f))return!0;b=b.next}while(b!==h);return!1}(u,a)&&(qy(u,a)&&qy(a,u)&&function(h,f){var b=h,T=!1,E=(h.x+f.x)/2,P=(h.y+f.y)/2;do b.y>P!=b.next.y>P&&b.next.y!==b.y&&E<(b.next.x-b.x)*(P-b.y)/(b.next.y-b.y)+b.x&&(T=!T),b=b.next;while(b!==h);return T}(u,a)&&(Sr(u.prev,u,a.prev)||Sr(u,a.prev,a))||I1(u,a)&&Sr(u.prev,u,u.next)>0&&Sr(a.prev,a,a.next)>0)}function Sr(u,a,h){return(a.y-u.y)*(h.x-a.x)-(a.x-u.x)*(h.y-a.y)}function I1(u,a){return u.x===a.x&&u.y===a.y}function IP(u,a,h,f){var b=A1(Sr(u,a,h)),T=A1(Sr(u,a,f)),E=A1(Sr(h,f,u)),P=A1(Sr(h,f,a));return b!==T&&E!==P||!(b!==0||!M1(u,h,a))||!(T!==0||!M1(u,f,a))||!(E!==0||!M1(h,u,f))||!(P!==0||!M1(h,a,f))}function M1(u,a,h){return a.x<=Math.max(u.x,h.x)&&a.x>=Math.min(u.x,h.x)&&a.y<=Math.max(u.y,h.y)&&a.y>=Math.min(u.y,h.y)}function A1(u){return u>0?1:u<0?-1:0}function qy(u,a){return Sr(u.prev,u,u.next)<0?Sr(u,a,u.next)>=0&&Sr(u,u.prev,a)>=0:Sr(u,a,u.prev)<0||Sr(u,u.next,a)<0}function MP(u,a){var h=new M2(u.i,u.x,u.y),f=new M2(a.i,a.x,a.y),b=u.next,T=a.prev;return u.next=a,a.prev=u,h.next=b,b.prev=h,f.next=h,h.prev=f,T.next=f,f.prev=T,f}function AP(u,a,h,f){var b=new M2(u,a,h);return f?(b.next=f.next,b.prev=f,f.next.prev=b,f.next=b):(b.prev=b,b.next=b),b}function Hy(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function M2(u,a,h){this.i=u,this.x=a,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A2(u,a,h,f){for(var b=0,T=a,E=h-f;T<h;T+=f)b+=(u[E]-u[T])*(u[T+1]+u[E+1]),E=T;return b}E2.exports=E1,E2.exports.default=E1,E1.deviation=function(u,a,h,f){var b=a&&a.length,T=Math.abs(A2(u,0,b?a[0]*h:u.length,h));if(b)for(var E=0,P=a.length;E<P;E++)T-=Math.abs(A2(u,a[E]*h,E<P-1?a[E+1]*h:u.length,h));var k=0;for(E=0;E<f.length;E+=3){var L=f[E]*h,N=f[E+1]*h,F=f[E+2]*h;k+=Math.abs((u[L]-u[F])*(u[N+1]-u[L+1])-(u[L]-u[N])*(u[F+1]-u[L+1]))}return T===0&&k===0?0:Math.abs((k-T)/T)},E1.flatten=function(u){for(var a=u[0][0].length,h={vertices:[],holes:[],dimensions:a},f=0,b=0;b<u.length;b++){for(var T=0;T<u[b].length;T++)for(var E=0;E<a;E++)h.vertices.push(u[b][T][E]);b>0&&h.holes.push(f+=u[b-1].length)}return h};var PP=p(E2.exports);function wj(u,a,h,f,b){CP(u,a,h||0,f||u.length-1,b||xj)}function CP(u,a,h,f,b){for(;f>h;){if(f-h>600){var T=f-h+1,E=a-h+1,P=Math.log(T),k=.5*Math.exp(2*P/3),L=.5*Math.sqrt(P*k*(T-k)/T)*(E-T/2<0?-1:1);CP(u,a,Math.max(h,Math.floor(a-E*k/T+L)),Math.min(f,Math.floor(a+(T-E)*k/T+L)),b)}var N=u[a],F=h,G=f;for(Wy(u,h,a),b(u[f],N)>0&&Wy(u,h,f);F<G;){for(Wy(u,F,G),F++,G--;b(u[F],N)<0;)F++;for(;b(u[G],N)>0;)G--}b(u[h],N)===0?Wy(u,h,G):Wy(u,++G,f),G<=a&&(h=G+1),a<=G&&(f=G-1)}}function Wy(u,a,h){var f=u[a];u[a]=u[h],u[h]=f}function xj(u,a){return u<a?-1:u>a?1:0}function P2(u,a){const h=u.length;if(h<=1)return[u];const f=[];let b,T;for(let E=0;E<h;E++){const P=vi(u[E]);P!==0&&(u[E].area=Math.abs(P),T===void 0&&(T=P<0),T===P<0?(b&&f.push(b),b=[u[E]]):b.push(u[E]))}if(b&&f.push(b),a>1)for(let E=0;E<f.length;E++)f[E].length<=a||(wj(f[E],a,1,f[E].length-1,Sj),f[E]=f[E].slice(0,a));return f}function Sj(u,a){return a.area-u.area}function C2(u,a,h){const f=h.patternDependencies;let b=!1;for(const T of a){const E=T.paint.get(`${u}-pattern`);E.isConstant()||(b=!0);const P=E.constantOr(null);P&&(b=!0,f[P.to]=!0,f[P.from]=!0)}return b}function $2(u,a,h,f,b){const T=b.patternDependencies;for(const E of a){const P=E.paint.get(`${u}-pattern`).value;if(P.kind!=="constant"){let k=P.evaluate({zoom:f-1},h,{},b.availableImages),L=P.evaluate({zoom:f},h,{},b.availableImages),N=P.evaluate({zoom:f+1},h,{},b.availableImages);k=k&&k.name?k.name:k,L=L&&L.name?L.name:L,N=N&&N.name?N.name:N,T[k]=!0,T[L]=!0,T[N]=!0,h.patterns[E.id]={min:k,mid:L,max:N}}}return h}class k2{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Y,this.indexArray=new Ce,this.indexArray2=new Re,this.programConfigurations=new er(a.layers,a.zoom),this.segments=new Ve,this.segments2=new Ve,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.hasPattern=C2("fill",this.layers,h);const b=this.layers[0].layout.get("fill-sort-key"),T=!b.isConstant(),E=[];for(const{feature:P,id:k,index:L,sourceLayerIndex:N}of a){const F=this.layers[0]._featureFilter.needGeometry,G=nc(P,F);if(!this.layers[0]._featureFilter.filter(new Zi(this.zoom),G,f))continue;const Z=T?b.evaluate(G,{},f,h.availableImages):void 0,J={id:k,properties:P.properties,type:P.type,sourceLayerIndex:N,index:L,geometry:F?G.geometry:sc(P),patterns:{},sortKey:Z};E.push(J)}T&&E.sort((P,k)=>P.sortKey-k.sortKey);for(const P of E){const{geometry:k,index:L,sourceLayerIndex:N}=P;if(this.hasPattern){const F=$2("fill",this.layers,P,this.zoom,h);this.patternFeatures.push(F)}else this.addFeature(P,k,L,f,{});h.featureIndex.insert(a[L].feature,k,L,N,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}addFeatures(a,h,f){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,hj),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,f,b,T){for(const E of P2(h,500)){let P=0;for(const Z of E)P+=Z.length;const k=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),L=k.vertexLength,N=[],F=[];for(const Z of E){if(Z.length===0)continue;Z!==E[0]&&F.push(N.length/2);const J=this.segments2.prepareSegment(Z.length,this.layoutVertexArray,this.indexArray2),Q=J.vertexLength;this.layoutVertexArray.emplaceBack(Z[0].x,Z[0].y),this.indexArray2.emplaceBack(Q+Z.length-1,Q),N.push(Z[0].x),N.push(Z[0].y);for(let oe=1;oe<Z.length;oe++)this.layoutVertexArray.emplaceBack(Z[oe].x,Z[oe].y),this.indexArray2.emplaceBack(Q+oe-1,Q+oe),N.push(Z[oe].x),N.push(Z[oe].y);J.vertexLength+=Z.length,J.primitiveLength+=Z.length}const G=PP(N,F);for(let Z=0;Z<G.length;Z+=3)this.indexArray.emplaceBack(L+G[Z],L+G[Z+1],L+G[Z+2]);k.vertexLength+=P,k.primitiveLength+=G.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,T,b)}}let $P,kP;pt("FillBucket",k2,{omit:["layers","patternFeatures"]});var Tj={get paint(){return kP=kP||new Xs({"fill-antialias":new wt(Oe.paint_fill["fill-antialias"]),"fill-opacity":new $t(Oe.paint_fill["fill-opacity"]),"fill-color":new $t(Oe.paint_fill["fill-color"]),"fill-outline-color":new $t(Oe.paint_fill["fill-outline-color"]),"fill-translate":new wt(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ec(Oe.paint_fill["fill-pattern"])})},get layout(){return $P=$P||new Xs({"fill-sort-key":new $t(Oe.layout_fill["fill-sort-key"])})}};class Ej extends so{constructor(a){super(a,Tj)}recalculate(a,h){super.recalculate(a,h);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new k2(a)}queryRadius(){return x1(this.paint.get("fill-translate"))}queryIntersectsFeature(a,h,f,b,T,E,P){return By(S1(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,P),b)}isTileClipped(){return!0}}const Ij=xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Mj=xr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Aj}=Ij;var uu={},Pj=g,RP=df;function df(u,a,h,f,b){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=f,this._values=b,u.readFields(Cj,this,a)}function Cj(u,a,h){u==1?a.id=h.readVarint():u==2?function(f,b){for(var T=f.readVarint()+f.pos;f.pos<T;){var E=b._keys[f.readVarint()],P=b._values[f.readVarint()];b.properties[E]=P}}(h,a):u==3?a.type=h.readVarint():u==4&&(a._geometry=h.pos)}function $j(u){for(var a,h,f=0,b=0,T=u.length,E=T-1;b<T;E=b++)f+=((h=u[E]).x-(a=u[b]).x)*(a.y+h.y);return f}df.types=["Unknown","Point","LineString","Polygon"],df.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var a,h=u.readVarint()+u.pos,f=1,b=0,T=0,E=0,P=[];u.pos<h;){if(b<=0){var k=u.readVarint();f=7&k,b=k>>3}if(b--,f===1||f===2)T+=u.readSVarint(),E+=u.readSVarint(),f===1&&(a&&P.push(a),a=[]),a.push(new Pj(T,E));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&P.push(a),P},df.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var a=u.readVarint()+u.pos,h=1,f=0,b=0,T=0,E=1/0,P=-1/0,k=1/0,L=-1/0;u.pos<a;){if(f<=0){var N=u.readVarint();h=7&N,f=N>>3}if(f--,h===1||h===2)(b+=u.readSVarint())<E&&(E=b),b>P&&(P=b),(T+=u.readSVarint())<k&&(k=T),T>L&&(L=T);else if(h!==7)throw new Error("unknown command "+h)}return[E,k,P,L]},df.prototype.toGeoJSON=function(u,a,h){var f,b,T=this.extent*Math.pow(2,h),E=this.extent*u,P=this.extent*a,k=this.loadGeometry(),L=df.types[this.type];function N(Z){for(var J=0;J<Z.length;J++){var Q=Z[J];Z[J]=[360*(Q.x+E)/T-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+P)/T)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(f=0;f<k.length;f++)F[f]=k[f][0];N(k=F);break;case 2:for(f=0;f<k.length;f++)N(k[f]);break;case 3:for(k=function(Z){var J=Z.length;if(J<=1)return[Z];for(var Q,oe,ue=[],Te=0;Te<J;Te++){var de=$j(Z[Te]);de!==0&&(oe===void 0&&(oe=de<0),oe===de<0?(Q&&ue.push(Q),Q=[Z[Te]]):Q.push(Z[Te]))}return Q&&ue.push(Q),ue}(k),f=0;f<k.length;f++)for(b=0;b<k[f].length;b++)N(k[f][b])}k.length===1?k=k[0]:L="Multi"+L;var G={type:"Feature",geometry:{type:L,coordinates:k},properties:this.properties};return"id"in this&&(G.id=this.id),G};var kj=RP,OP=LP;function LP(u,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(Rj,this,a),this.length=this._features.length}function Rj(u,a,h){u===15?a.version=h.readVarint():u===1?a.name=h.readString():u===5?a.extent=h.readVarint():u===2?a._features.push(h.pos):u===3?a._keys.push(h.readString()):u===4&&a._values.push(function(f){for(var b=null,T=f.readVarint()+f.pos;f.pos<T;){var E=f.readVarint()>>3;b=E===1?f.readString():E===2?f.readFloat():E===3?f.readDouble():E===4?f.readVarint64():E===5?f.readVarint():E===6?f.readSVarint():E===7?f.readBoolean():null}return b}(h))}LP.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var a=this._pbf.readVarint()+this._pbf.pos;return new kj(this._pbf,a,this.extent,this._keys,this._values)};var Oj=OP;function Lj(u,a,h){if(u===3){var f=new Oj(h,h.readVarint()+h.pos);f.length&&(a[f.name]=f)}}uu.VectorTile=function(u,a){this.layers=u.readFields(Lj,{},a)},uu.VectorTileFeature=RP,uu.VectorTileLayer=OP;const Dj=uu.VectorTileFeature.types,R2=Math.pow(2,13);function Zy(u,a,h,f,b,T,E,P){u.emplaceBack(a,h,2*Math.floor(f*R2)+E,b*R2*2,T*R2*2,Math.round(P))}class O2{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new ne,this.centroidVertexArray=new B,this.indexArray=new Ce,this.programConfigurations=new er(a.layers,a.zoom),this.segments=new Ve,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.features=[],this.hasPattern=C2("fill-extrusion",this.layers,h);for(const{feature:b,id:T,index:E,sourceLayerIndex:P}of a){const k=this.layers[0]._featureFilter.needGeometry,L=nc(b,k);if(!this.layers[0]._featureFilter.filter(new Zi(this.zoom),L,f))continue;const N={id:T,sourceLayerIndex:P,index:E,geometry:k?L.geometry:sc(b),properties:b.properties,type:b.type,patterns:{}};this.hasPattern?this.features.push($2("fill-extrusion",this.layers,N,this.zoom,h)):this.addFeature(N,N.geometry,E,f,{}),h.featureIndex.insert(b,N.geometry,E,P,this.index,!0)}}addFeatures(a,h,f){for(const b of this.features){const{geometry:T}=b;this.addFeature(b,T,b.index,h,f)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Aj),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Mj.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,f,b,T){const E={x:0,y:0,vertexCount:0};for(const P of P2(h,500)){let k=0;for(const J of P)k+=J.length;let L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const J of P){if(J.length===0||zj(J))continue;let Q=0;for(let oe=0;oe<J.length;oe++){const ue=J[oe];if(oe>=1){const Te=J[oe-1];if(!Nj(ue,Te)){L.vertexLength+4>Ve.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const de=ue.sub(Te)._perp()._unit(),we=Te.dist(ue);Q+we>32768&&(Q=0),Zy(this.layoutVertexArray,ue.x,ue.y,de.x,de.y,0,0,Q),Zy(this.layoutVertexArray,ue.x,ue.y,de.x,de.y,0,1,Q),E.x+=2*ue.x,E.y+=2*ue.y,E.vertexCount+=2,Q+=we,Zy(this.layoutVertexArray,Te.x,Te.y,de.x,de.y,0,0,Q),Zy(this.layoutVertexArray,Te.x,Te.y,de.x,de.y,0,1,Q),E.x+=2*Te.x,E.y+=2*Te.y,E.vertexCount+=2;const Ne=L.vertexLength;this.indexArray.emplaceBack(Ne,Ne+2,Ne+1),this.indexArray.emplaceBack(Ne+1,Ne+2,Ne+3),L.vertexLength+=4,L.primitiveLength+=2}}}}if(L.vertexLength+k>Ve.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),Dj[a.type]!=="Polygon")continue;const N=[],F=[],G=L.vertexLength;for(const J of P)if(J.length!==0){J!==P[0]&&F.push(N.length/2);for(let Q=0;Q<J.length;Q++){const oe=J[Q];Zy(this.layoutVertexArray,oe.x,oe.y,0,0,1,1,0),E.x+=oe.x,E.y+=oe.y,E.vertexCount+=1,N.push(oe.x),N.push(oe.y)}}const Z=PP(N,F);for(let J=0;J<Z.length;J+=3)this.indexArray.emplaceBack(G+Z[J],G+Z[J+2],G+Z[J+1]);L.primitiveLength+=Z.length/3,L.vertexLength+=k}for(let P=0;P<E.vertexCount;P++)this.centroidVertexArray.emplaceBack(Math.floor(E.x/E.vertexCount),Math.floor(E.y/E.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,T,b)}}function Nj(u,a){return u.x===a.x&&(u.x<0||u.x>li)||u.y===a.y&&(u.y<0||u.y>li)}function zj(u){return u.every(a=>a.x<0)||u.every(a=>a.x>li)||u.every(a=>a.y<0)||u.every(a=>a.y>li)}let DP;pt("FillExtrusionBucket",O2,{omit:["layers","features"]});var Fj={get paint(){return DP=DP||new Xs({"fill-extrusion-opacity":new wt(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $t(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ec(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $t(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $t(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Bj extends so{constructor(a){super(a,Fj)}createBucket(a){return new O2(a)}queryRadius(){return x1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,h,f,b,T,E,P,k){const L=S1(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,P),N=this.paint.get("fill-extrusion-height").evaluate(h,f),F=this.paint.get("fill-extrusion-base").evaluate(h,f),G=function(J,Q,oe,ue){const Te=[];for(const de of J){const we=[de.x,de.y,0,1];T1(we,we,Q),Te.push(new M(we[0]/we[3],we[1]/we[3]))}return Te}(L,k),Z=function(J,Q,oe,ue){const Te=[],de=[],we=ue[8]*Q,Ne=ue[9]*Q,ze=ue[10]*Q,lt=ue[11]*Q,vt=ue[8]*oe,ot=ue[9]*oe,st=ue[10]*oe,Qe=ue[11]*oe;for(const mt of J){const it=[],We=[];for(const Et of mt){const bt=Et.x,si=Et.y,Ji=ue[0]*bt+ue[4]*si+ue[12],tr=ue[1]*bt+ue[5]*si+ue[13],Gr=ue[2]*bt+ue[6]*si+ue[14],Vn=ue[3]*bt+ue[7]*si+ue[15],tn=Gr+ze,kr=Vn+lt,ls=Ji+vt,bs=tr+ot,rn=Gr+st,sn=Vn+Qe,qr=new M((Ji+we)/kr,(tr+Ne)/kr);qr.z=tn/kr,it.push(qr);const Hr=new M(ls/sn,bs/sn);Hr.z=rn/sn,We.push(Hr)}Te.push(it),de.push(We)}return[Te,de]}(b,F,N,k);return function(J,Q,oe){let ue=1/0;By(oe,Q)&&(ue=NP(oe,Q[0]));for(let Te=0;Te<Q.length;Te++){const de=Q[Te],we=J[Te];for(let Ne=0;Ne<de.length-1;Ne++){const ze=de[Ne],lt=[ze,de[Ne+1],we[Ne+1],we[Ne],ze];oc(oe,lt)&&(ue=Math.min(ue,NP(oe,lt)))}}return ue!==1/0&&ue}(Z[0],Z[1],G)}}function Yy(u,a){return u.x*a.x+u.y*a.y}function NP(u,a){if(u.length===1){let h=0;const f=a[h++];let b;for(;!b||f.equals(b);)if(b=a[h++],!b)return 1/0;for(;h<a.length;h++){const T=a[h],E=u[0],P=b.sub(f),k=T.sub(f),L=E.sub(f),N=Yy(P,P),F=Yy(P,k),G=Yy(k,k),Z=Yy(L,P),J=Yy(L,k),Q=N*G-F*F,oe=(G*Z-F*J)/Q,ue=(N*J-F*Z)/Q,Te=f.z*(1-oe-ue)+b.z*oe+T.z*ue;if(isFinite(Te))return Te}return 1/0}{let h=1/0;for(const f of a)h=Math.min(h,f.z);return h}}const Uj=xr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jj}=Uj,Vj=xr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Gj}=Vj,qj=uu.VectorTileFeature.types,Hj=Math.cos(Math.PI/180*37.5),zP=Math.pow(2,14)/.5;class L2{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new re,this.layoutVertexArray2=new le,this.indexArray=new Ce,this.programConfigurations=new er(a.layers,a.zoom),this.segments=new Ve,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,f){this.hasPattern=C2("line",this.layers,h);const b=this.layers[0].layout.get("line-sort-key"),T=!b.isConstant(),E=[];for(const{feature:P,id:k,index:L,sourceLayerIndex:N}of a){const F=this.layers[0]._featureFilter.needGeometry,G=nc(P,F);if(!this.layers[0]._featureFilter.filter(new Zi(this.zoom),G,f))continue;const Z=T?b.evaluate(G,{},f):void 0,J={id:k,properties:P.properties,type:P.type,sourceLayerIndex:N,index:L,geometry:F?G.geometry:sc(P),patterns:{},sortKey:Z};E.push(J)}T&&E.sort((P,k)=>P.sortKey-k.sortKey);for(const P of E){const{geometry:k,index:L,sourceLayerIndex:N}=P;if(this.hasPattern){const F=$2("line",this.layers,P,this.zoom,h);this.patternFeatures.push(F)}else this.addFeature(P,k,L,f,{});h.featureIndex.insert(a[L].feature,k,L,N,this.index)}}update(a,h,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,f)}addFeatures(a,h,f){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Gj)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,jj),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,f,b,T){const E=this.layers[0].layout,P=E.get("line-join").evaluate(a,{}),k=E.get("line-cap"),L=E.get("line-miter-limit"),N=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const F of h)this.addLine(F,a,P,k,L,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,T,b)}addLine(a,h,f,b,T,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<a.length-1;ue++)this.totalDistance+=a[ue].dist(a[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=qj[h.type]==="Polygon";let k=a.length;for(;k>=2&&a[k-1].equals(a[k-2]);)k--;let L=0;for(;L<k-1&&a[L].equals(a[L+1]);)L++;if(k<(P?3:2))return;f==="bevel"&&(T=1.05);const N=this.overscaling<=16?15*li/(512*this.overscaling):0,F=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let G,Z,J,Q,oe;this.e1=this.e2=-1,P&&(G=a[k-2],oe=a[L].sub(G)._unit()._perp());for(let ue=L;ue<k;ue++){if(J=ue===k-1?P?a[L+1]:void 0:a[ue+1],J&&a[ue].equals(J))continue;oe&&(Q=oe),G&&(Z=G),G=a[ue],oe=J?J.sub(G)._unit()._perp():Q,Q=Q||oe;let Te=Q.add(oe);Te.x===0&&Te.y===0||Te._unit();const de=Q.x*oe.x+Q.y*oe.y,we=Te.x*oe.x+Te.y*oe.y,Ne=we!==0?1/we:1/0,ze=2*Math.sqrt(2-2*we),lt=we<Hj&&Z&&J,vt=Q.x*oe.y-Q.y*oe.x>0;if(lt&&ue>L){const Qe=G.dist(Z);if(Qe>2*N){const mt=G.sub(G.sub(Z)._mult(N/Qe)._round());this.updateDistance(Z,mt),this.addCurrentVertex(mt,Q,0,0,F),Z=mt}}const ot=Z&&J;let st=ot?f:P?"butt":b;if(ot&&st==="round"&&(Ne<E?st="miter":Ne<=2&&(st="fakeround")),st==="miter"&&Ne>T&&(st="bevel"),st==="bevel"&&(Ne>2&&(st="flipbevel"),Ne<T&&(st="miter")),Z&&this.updateDistance(Z,G),st==="miter")Te._mult(Ne),this.addCurrentVertex(G,Te,0,0,F);else if(st==="flipbevel"){if(Ne>100)Te=oe.mult(-1);else{const Qe=Ne*Q.add(oe).mag()/Q.sub(oe).mag();Te._perp()._mult(Qe*(vt?-1:1))}this.addCurrentVertex(G,Te,0,0,F),this.addCurrentVertex(G,Te.mult(-1),0,0,F)}else if(st==="bevel"||st==="fakeround"){const Qe=-Math.sqrt(Ne*Ne-1),mt=vt?Qe:0,it=vt?0:Qe;if(Z&&this.addCurrentVertex(G,Q,mt,it,F),st==="fakeround"){const We=Math.round(180*ze/Math.PI/20);for(let Et=1;Et<We;Et++){let bt=Et/We;if(bt!==.5){const Ji=bt-.5;bt+=bt*Ji*(bt-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*Ji*Ji+(.848013+de*(.215638*de-1.06021)))}const si=oe.sub(Q)._mult(bt)._add(Q)._unit()._mult(vt?-1:1);this.addHalfVertex(G,si.x,si.y,!1,vt,0,F)}}J&&this.addCurrentVertex(G,oe,-mt,-it,F)}else if(st==="butt")this.addCurrentVertex(G,Te,0,0,F);else if(st==="square"){const Qe=Z?1:-1;this.addCurrentVertex(G,Te,Qe,Qe,F)}else st==="round"&&(Z&&(this.addCurrentVertex(G,Q,0,0,F),this.addCurrentVertex(G,Q,1,1,F,!0)),J&&(this.addCurrentVertex(G,oe,-1,-1,F,!0),this.addCurrentVertex(G,oe,0,0,F)));if(lt&&ue<k-1){const Qe=G.dist(J);if(Qe>2*N){const mt=G.add(J.sub(G)._mult(N/Qe)._round());this.updateDistance(G,mt),this.addCurrentVertex(mt,oe,0,0,F),G=mt}}}}addCurrentVertex(a,h,f,b,T,E=!1){const P=h.y*b-h.x,k=-h.y-h.x*b;this.addHalfVertex(a,h.x+h.y*f,h.y-h.x*f,E,!1,f,T),this.addHalfVertex(a,P,k,E,!0,-b,T),this.distance>zP/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,f,b,T,E))}addHalfVertex({x:a,y:h},f,b,T,E,P,k){const L=.5*(this.lineClips?this.scaledDistance*(zP-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(T?1:0),(h<<1)+(E?1:0),Math.round(63*f)+128,Math.round(63*b)+128,1+(P===0?0:P<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,N),k.primitiveLength++),E?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let FP,BP;pt("LineBucket",L2,{omit:["layers","patternFeatures"]});var UP={get paint(){return BP=BP||new Xs({"line-opacity":new $t(Oe.paint_line["line-opacity"]),"line-color":new $t(Oe.paint_line["line-color"]),"line-translate":new wt(Oe.paint_line["line-translate"]),"line-translate-anchor":new wt(Oe.paint_line["line-translate-anchor"]),"line-width":new $t(Oe.paint_line["line-width"]),"line-gap-width":new $t(Oe.paint_line["line-gap-width"]),"line-offset":new $t(Oe.paint_line["line-offset"]),"line-blur":new $t(Oe.paint_line["line-blur"]),"line-dasharray":new My(Oe.paint_line["line-dasharray"]),"line-pattern":new ec(Oe.paint_line["line-pattern"]),"line-gradient":new qh(Oe.paint_line["line-gradient"])})},get layout(){return FP=FP||new Xs({"line-cap":new wt(Oe.layout_line["line-cap"]),"line-join":new $t(Oe.layout_line["line-join"]),"line-miter-limit":new wt(Oe.layout_line["line-miter-limit"]),"line-round-limit":new wt(Oe.layout_line["line-round-limit"]),"line-sort-key":new $t(Oe.layout_line["line-sort-key"])})}};class Wj extends $t{possiblyEvaluate(a,h){return h=new Zi(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,f,b){return h=Fe({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,f,b)}}let P1;class Zj extends so{constructor(a){super(a,UP),this.gradientVersion=0,P1||(P1=new Wj(UP.paint.properties["line-width"].specification),P1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof qc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=P1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new L2(a)}queryRadius(a){const h=a,f=jP(Uy("line-width",this,h),Uy("line-gap-width",this,h)),b=Uy("line-offset",this,h);return f/2+Math.abs(b)+x1(this.paint.get("line-translate"))}queryIntersectsFeature(a,h,f,b,T,E,P){const k=S1(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,P),L=P/2*jP(this.paint.get("line-width").evaluate(h,f),this.paint.get("line-gap-width").evaluate(h,f)),N=this.paint.get("line-offset").evaluate(h,f);return N&&(b=function(F,G){const Z=[];for(let J=0;J<F.length;J++){const Q=F[J],oe=[];for(let ue=0;ue<Q.length;ue++){const Te=Q[ue-1],de=Q[ue],we=Q[ue+1],Ne=ue===0?new M(0,0):de.sub(Te)._unit()._perp(),ze=ue===Q.length-1?new M(0,0):we.sub(de)._unit()._perp(),lt=Ne._add(ze)._unit(),vt=lt.x*ze.x+lt.y*ze.y;vt!==0&&lt._mult(1/vt),oe.push(lt._mult(G)._add(de))}Z.push(oe)}return Z}(b,N*P)),function(F,G,Z){for(let J=0;J<G.length;J++){const Q=G[J];if(F.length>=3){for(let oe=0;oe<Q.length;oe++)if(cf(F,Q[oe]))return!0}if(b1(F,Q,Z))return!0}return!1}(k,b,L)}isTileClipped(){return!0}}function jP(u,a){return a>0?a+2*u:u}const Yj=xr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Jj=xr([{name:"a_projected_pos",components:3,type:"Float32"}],4);xr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kj=xr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);xr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const VP=xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Xj=xr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qj(u,a,h){return u.sections.forEach(f=>{f.text=function(b,T,E){const P=T.layout.get("text-transform").evaluate(E,{});return P==="uppercase"?b=b.toLocaleUpperCase():P==="lowercase"&&(b=b.toLocaleLowerCase()),Ql.applyArabicShaping&&(b=Ql.applyArabicShaping(b)),b}(f.text,a,h)}),u}xr([{name:"triangle",components:3,type:"Uint16"}]),xr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),xr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),xr([{type:"Float32",name:"offsetX"}]),xr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),xr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Jy={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Vr=24,GP=ki,qP=function(u,a,h,f,b){var T,E,P=8*b-f-1,k=(1<<P)-1,L=k>>1,N=-7,F=h?b-1:0,G=h?-1:1,Z=u[a+F];for(F+=G,T=Z&(1<<-N)-1,Z>>=-N,N+=P;N>0;T=256*T+u[a+F],F+=G,N-=8);for(E=T&(1<<-N)-1,T>>=-N,N+=f;N>0;E=256*E+u[a+F],F+=G,N-=8);if(T===0)T=1-L;else{if(T===k)return E?NaN:1/0*(Z?-1:1);E+=Math.pow(2,f),T-=L}return(Z?-1:1)*E*Math.pow(2,T-f)},HP=function(u,a,h,f,b,T){var E,P,k,L=8*T-b-1,N=(1<<L)-1,F=N>>1,G=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=f?0:T-1,J=f?1:-1,Q=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(P=isNaN(a)?1:0,E=N):(E=Math.floor(Math.log(a)/Math.LN2),a*(k=Math.pow(2,-E))<1&&(E--,k*=2),(a+=E+F>=1?G/k:G*Math.pow(2,1-F))*k>=2&&(E++,k/=2),E+F>=N?(P=0,E=N):E+F>=1?(P=(a*k-1)*Math.pow(2,b),E+=F):(P=a*Math.pow(2,F-1)*Math.pow(2,b),E=0));b>=8;u[h+Z]=255&P,Z+=J,P/=256,b-=8);for(E=E<<b|P,L+=b;L>0;u[h+Z]=255&E,Z+=J,E/=256,L-=8);u[h+Z-J]|=128*Q};function ki(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}ki.Varint=0,ki.Fixed64=1,ki.Bytes=2,ki.Fixed32=5;var D2=4294967296,WP=1/D2,ZP=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ac(u){return u.type===ki.Bytes?u.readVarint()+u.pos:u.pos+1}function pf(u,a,h){return h?4294967296*a+(u>>>0):4294967296*(a>>>0)+(u>>>0)}function YP(u,a,h){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));h.realloc(f);for(var b=h.pos-1;b>=u;b--)h.buf[b+f]=h.buf[b]}function eV(u,a){for(var h=0;h<u.length;h++)a.writeVarint(u[h])}function tV(u,a){for(var h=0;h<u.length;h++)a.writeSVarint(u[h])}function iV(u,a){for(var h=0;h<u.length;h++)a.writeFloat(u[h])}function rV(u,a){for(var h=0;h<u.length;h++)a.writeDouble(u[h])}function sV(u,a){for(var h=0;h<u.length;h++)a.writeBoolean(u[h])}function nV(u,a){for(var h=0;h<u.length;h++)a.writeFixed32(u[h])}function oV(u,a){for(var h=0;h<u.length;h++)a.writeSFixed32(u[h])}function aV(u,a){for(var h=0;h<u.length;h++)a.writeFixed64(u[h])}function lV(u,a){for(var h=0;h<u.length;h++)a.writeSFixed64(u[h])}function C1(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+16777216*u[a+3]}function ff(u,a,h){u[h]=a,u[h+1]=a>>>8,u[h+2]=a>>>16,u[h+3]=a>>>24}function JP(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+(u[a+3]<<24)}ki.prototype={destroy:function(){this.buf=null},readFields:function(u,a,h){for(h=h||this.length;this.pos<h;){var f=this.readVarint(),b=f>>3,T=this.pos;this.type=7&f,u(b,a,this),this.pos===T&&this.skip(f)}return a},readMessage:function(u,a){return this.readFields(u,a,this.readVarint()+this.pos)},readFixed32:function(){var u=C1(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=JP(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=C1(this.buf,this.pos)+C1(this.buf,this.pos+4)*D2;return this.pos+=8,u},readSFixed64:function(){var u=C1(this.buf,this.pos)+JP(this.buf,this.pos+4)*D2;return this.pos+=8,u},readFloat:function(){var u=qP(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=qP(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var a,h,f=this.buf;return a=127&(h=f[this.pos++]),h<128?a:(a|=(127&(h=f[this.pos++]))<<7,h<128?a:(a|=(127&(h=f[this.pos++]))<<14,h<128?a:(a|=(127&(h=f[this.pos++]))<<21,h<128?a:function(b,T,E){var P,k,L=E.buf;if(P=(112&(k=L[E.pos++]))>>4,k<128||(P|=(127&(k=L[E.pos++]))<<3,k<128)||(P|=(127&(k=L[E.pos++]))<<10,k<128)||(P|=(127&(k=L[E.pos++]))<<17,k<128)||(P|=(127&(k=L[E.pos++]))<<24,k<128)||(P|=(1&(k=L[E.pos++]))<<31,k<128))return pf(b,P,T);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(h=f[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,a=this.pos;return this.pos=u,u-a>=12&&ZP?function(h,f,b){return ZP.decode(h.subarray(f,b))}(this.buf,a,u):function(h,f,b){for(var T="",E=f;E<b;){var P,k,L,N=h[E],F=null,G=N>239?4:N>223?3:N>191?2:1;if(E+G>b)break;G===1?N<128&&(F=N):G===2?(192&(P=h[E+1]))==128&&(F=(31&N)<<6|63&P)<=127&&(F=null):G===3?(k=h[E+2],(192&(P=h[E+1]))==128&&(192&k)==128&&((F=(15&N)<<12|(63&P)<<6|63&k)<=2047||F>=55296&&F<=57343)&&(F=null)):G===4&&(k=h[E+2],L=h[E+3],(192&(P=h[E+1]))==128&&(192&k)==128&&(192&L)==128&&((F=(15&N)<<18|(63&P)<<12|(63&k)<<6|63&L)<=65535||F>=1114112)&&(F=null)),F===null?(F=65533,G=1):F>65535&&(F-=65536,T+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),T+=String.fromCharCode(F),E+=G}return T}(this.buf,a,u)},readBytes:function(){var u=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,u);return this.pos=u,a},readPackedVarint:function(u,a){if(this.type!==ki.Bytes)return u.push(this.readVarint(a));var h=ac(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(a));return u},readPackedSVarint:function(u){if(this.type!==ki.Bytes)return u.push(this.readSVarint());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==ki.Bytes)return u.push(this.readBoolean());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==ki.Bytes)return u.push(this.readFloat());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==ki.Bytes)return u.push(this.readDouble());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==ki.Bytes)return u.push(this.readFixed32());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==ki.Bytes)return u.push(this.readSFixed32());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==ki.Bytes)return u.push(this.readFixed64());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==ki.Bytes)return u.push(this.readSFixed64());var a=ac(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed64());return u},skip:function(u){var a=7&u;if(a===ki.Varint)for(;this.buf[this.pos++]>127;);else if(a===ki.Bytes)this.pos=this.readVarint()+this.pos;else if(a===ki.Fixed32)this.pos+=4;else{if(a!==ki.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(u,a){this.writeVarint(u<<3|a)},realloc:function(u){for(var a=this.length||16;a<this.pos+u;)a*=2;if(a!==this.length){var h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),ff(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),ff(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),ff(this.buf,-1&u,this.pos),ff(this.buf,Math.floor(u*WP),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),ff(this.buf,-1&u,this.pos),ff(this.buf,Math.floor(u*WP),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(a,h){var f,b;if(a>=0?(f=a%4294967296|0,b=a/4294967296|0):(b=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,b=b+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(T,E,P){P.buf[P.pos++]=127&T|128,T>>>=7,P.buf[P.pos++]=127&T|128,T>>>=7,P.buf[P.pos++]=127&T|128,T>>>=7,P.buf[P.pos++]=127&T|128,P.buf[P.pos]=127&(T>>>=7)}(f,0,h),function(T,E){var P=(7&T)<<4;E.buf[E.pos++]|=P|((T>>>=3)?128:0),T&&(E.buf[E.pos++]=127&T|((T>>>=7)?128:0),T&&(E.buf[E.pos++]=127&T|((T>>>=7)?128:0),T&&(E.buf[E.pos++]=127&T|((T>>>=7)?128:0),T&&(E.buf[E.pos++]=127&T|((T>>>=7)?128:0),T&&(E.buf[E.pos++]=127&T)))))}(b,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var a=this.pos;this.pos=function(f,b,T){for(var E,P,k=0;k<b.length;k++){if((E=b.charCodeAt(k))>55295&&E<57344){if(!P){E>56319||k+1===b.length?(f[T++]=239,f[T++]=191,f[T++]=189):P=E;continue}if(E<56320){f[T++]=239,f[T++]=191,f[T++]=189,P=E;continue}E=P-55296<<10|E-56320|65536,P=null}else P&&(f[T++]=239,f[T++]=191,f[T++]=189,P=null);E<128?f[T++]=E:(E<2048?f[T++]=E>>6|192:(E<65536?f[T++]=E>>12|224:(f[T++]=E>>18|240,f[T++]=E>>12&63|128),f[T++]=E>>6&63|128),f[T++]=63&E|128)}return T}(this.buf,u,this.pos);var h=this.pos-a;h>=128&&YP(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),HP(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),HP(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var a=u.length;this.writeVarint(a),this.realloc(a);for(var h=0;h<a;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,a){this.pos++;var h=this.pos;u(a,this);var f=this.pos-h;f>=128&&YP(h,f,this),this.pos=h-1,this.writeVarint(f),this.pos+=f},writeMessage:function(u,a,h){this.writeTag(u,ki.Bytes),this.writeRawMessage(a,h)},writePackedVarint:function(u,a){a.length&&this.writeMessage(u,eV,a)},writePackedSVarint:function(u,a){a.length&&this.writeMessage(u,tV,a)},writePackedBoolean:function(u,a){a.length&&this.writeMessage(u,sV,a)},writePackedFloat:function(u,a){a.length&&this.writeMessage(u,iV,a)},writePackedDouble:function(u,a){a.length&&this.writeMessage(u,rV,a)},writePackedFixed32:function(u,a){a.length&&this.writeMessage(u,nV,a)},writePackedSFixed32:function(u,a){a.length&&this.writeMessage(u,oV,a)},writePackedFixed64:function(u,a){a.length&&this.writeMessage(u,aV,a)},writePackedSFixed64:function(u,a){a.length&&this.writeMessage(u,lV,a)},writeBytesField:function(u,a){this.writeTag(u,ki.Bytes),this.writeBytes(a)},writeFixed32Field:function(u,a){this.writeTag(u,ki.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(u,a){this.writeTag(u,ki.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(u,a){this.writeTag(u,ki.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(u,a){this.writeTag(u,ki.Fixed64),this.writeSFixed64(a)},writeVarintField:function(u,a){this.writeTag(u,ki.Varint),this.writeVarint(a)},writeSVarintField:function(u,a){this.writeTag(u,ki.Varint),this.writeSVarint(a)},writeStringField:function(u,a){this.writeTag(u,ki.Bytes),this.writeString(a)},writeFloatField:function(u,a){this.writeTag(u,ki.Fixed32),this.writeFloat(a)},writeDoubleField:function(u,a){this.writeTag(u,ki.Fixed64),this.writeDouble(a)},writeBooleanField:function(u,a){this.writeVarintField(u,!!a)}};var N2=p(GP);const z2=3;function cV(u,a,h){u===1&&h.readMessage(uV,a)}function uV(u,a,h){if(u===3){const{id:f,bitmap:b,width:T,height:E,left:P,top:k,advance:L}=h.readMessage(hV,{});a.push({id:f,bitmap:new Vy({width:T+2*z2,height:E+2*z2},b),metrics:{width:T,height:E,left:P,top:k,advance:L}})}}function hV(u,a,h){u===1?a.id=h.readVarint():u===2?a.bitmap=h.readBytes():u===3?a.width=h.readVarint():u===4?a.height=h.readVarint():u===5?a.left=h.readSVarint():u===6?a.top=h.readSVarint():u===7&&(a.advance=h.readVarint())}const KP=z2;function XP(u){let a=0,h=0;for(const E of u)a+=E.w*E.h,h=Math.max(h,E.w);u.sort((E,P)=>P.h-E.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let b=0,T=0;for(const E of u)for(let P=f.length-1;P>=0;P--){const k=f[P];if(!(E.w>k.w||E.h>k.h)){if(E.x=k.x,E.y=k.y,T=Math.max(T,E.y+E.h),b=Math.max(b,E.x+E.w),E.w===k.w&&E.h===k.h){const L=f.pop();P<f.length&&(f[P]=L)}else E.h===k.h?(k.x+=E.w,k.w-=E.w):E.w===k.w?(k.y+=E.h,k.h-=E.h):(f.push({x:k.x+E.w,y:k.y,w:k.w-E.w,h:E.h}),k.y+=E.h,k.h-=E.h);break}}return{w:b,h:T,fill:a/(b*T)||0}}const bn=1;class F2{constructor(a,{pixelRatio:h,version:f,stretchX:b,stretchY:T,content:E}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=b,this.stretchY=T,this.content=E,this.version=f}get tl(){return[this.paddedRect.x+bn,this.paddedRect.y+bn]}get br(){return[this.paddedRect.x+this.paddedRect.w-bn,this.paddedRect.y+this.paddedRect.h-bn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*bn)/this.pixelRatio,(this.paddedRect.h-2*bn)/this.pixelRatio]}}class QP{constructor(a,h){const f={},b={};this.haveRenderCallbacks=[];const T=[];this.addImages(a,f,T),this.addImages(h,b,T);const{w:E,h:P}=XP(T),k=new ao({width:E||1,height:P||1});for(const L in a){const N=a[L],F=f[L].paddedRect;ao.copy(N.data,k,{x:0,y:0},{x:F.x+bn,y:F.y+bn},N.data)}for(const L in h){const N=h[L],F=b[L].paddedRect,G=F.x+bn,Z=F.y+bn,J=N.data.width,Q=N.data.height;ao.copy(N.data,k,{x:0,y:0},{x:G,y:Z},N.data),ao.copy(N.data,k,{x:0,y:Q-1},{x:G,y:Z-1},{width:J,height:1}),ao.copy(N.data,k,{x:0,y:0},{x:G,y:Z+Q},{width:J,height:1}),ao.copy(N.data,k,{x:J-1,y:0},{x:G-1,y:Z},{width:1,height:Q}),ao.copy(N.data,k,{x:0,y:0},{x:G+J,y:Z},{width:1,height:Q})}this.image=k,this.iconPositions=f,this.patternPositions=b}addImages(a,h,f){for(const b in a){const T=a[b],E={x:0,y:0,w:T.data.width+2*bn,h:T.data.height+2*bn};f.push(E),h[b]=new F2(E,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),h),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),h)}patchUpdatedImage(a,h,f){if(!a||!h||a.version===h.version)return;a.version=h.version;const[b,T]=a.tl;f.update(h.data,void 0,{x:b,y:T})}}var hu;pt("ImagePosition",F2),pt("ImageAtlas",QP),c.ah=void 0,(hu=c.ah||(c.ah={}))[hu.none=0]="none",hu[hu.horizontal=1]="horizontal",hu[hu.vertical=2]="vertical",hu[hu.horizontalOnly=3]="horizontalOnly";const Ky=-17;class Xy{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,h){const f=new Xy;return f.scale=a||1,f.fontStack=h,f}static forImage(a){const h=new Xy;return h.imageName=a,h}}class mf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const f=new mf;for(let b=0;b<a.sections.length;b++){const T=a.sections[b];T.image?f.addImageSection(T):f.addTextSection(T,h)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let f=0;f<a.length;f++){const b=a.charCodeAt(f+1)||null,T=a.charCodeAt(f-1)||null;h+=b&&xy(b)&&!Jy[a[f+1]]||T&&xy(T)&&!Jy[a[f-1]]||!Jy[a[f]]?a[f]:Jy[a[f]]}return h}(this.text)}trim(){let a=0;for(let f=0;f<this.text.length&&k1[this.text.charCodeAt(f)];f++)a++;let h=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&k1[this.text.charCodeAt(f)];f--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const f=new mf;return f.text=this.text.substring(a,h),f.sectionIndex=this.sectionIndex.slice(a,h),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}addTextSection(a,h){this.text+=a.text,this.sections.push(Xy.forText(a.scale,a.fontStack||h));const f=this.sections.length-1;for(let b=0;b<a.text.length;++b)this.sectionIndex.push(f)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void Pt("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Xy.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Pt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $1(u,a,h,f,b,T,E,P,k,L,N,F,G,Z,J,Q){const oe=mf.fromFeature(u,b);let ue;F===c.ah.vertical&&oe.verticalizePunctuation();const{processBidirectionalText:Te,processStyledBidirectionalText:de}=Ql;if(Te&&oe.sections.length===1){ue=[];const ze=Te(oe.toString(),B2(oe,L,T,a,f,Z,J));for(const lt of ze){const vt=new mf;vt.text=lt,vt.sections=oe.sections;for(let ot=0;ot<lt.length;ot++)vt.sectionIndex.push(0);ue.push(vt)}}else if(de){ue=[];const ze=de(oe.text,oe.sectionIndex,B2(oe,L,T,a,f,Z,J));for(const lt of ze){const vt=new mf;vt.text=lt[0],vt.sectionIndex=lt[1],vt.sections=oe.sections,ue.push(vt)}}else ue=function(ze,lt){const vt=[],ot=ze.text;let st=0;for(const Qe of lt)vt.push(ze.substring(st,Qe)),st=Qe;return st<ot.length&&vt.push(ze.substring(st,ot.length)),vt}(oe,B2(oe,L,T,a,f,Z,J));const we=[],Ne={positionedLines:we,text:oe.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(ze,lt,vt,ot,st,Qe,mt,it,We,Et,bt,si){let Ji=0,tr=Ky,Gr=0,Vn=0;const tn=it==="right"?1:it==="left"?0:.5;let kr=0;for(const qr of st){qr.trim();const Hr=qr.getMaxScale(),Ns=(Hr-1)*Vr,nn={positionedGlyphs:[],lineOffset:0};ze.positionedLines[kr]=nn;const zs=nn.positionedGlyphs;let wn=0;if(!qr.length()){tr+=Qe,++kr;continue}for(let Wr=0;Wr<qr.length();Wr++){const hi=qr.getSection(Wr),Fs=qr.getSectionIndex(Wr),ws=qr.getCharCode(Wr);let Zr=0,Do=null,ma=null,ya=null,lc=Vr;const No=!(We===c.ah.horizontal||!bt&&!Qp(ws)||bt&&(k1[ws]||(ls=ws,ut.Arabic(ls)||ut["Arabic Supplement"](ls)||ut["Arabic Extended-A"](ls)||ut["Arabic Presentation Forms-A"](ls)||ut["Arabic Presentation Forms-B"](ls))));if(hi.imageName){const co=ot[hi.imageName];if(!co)continue;ya=hi.imageName,ze.iconsInText=ze.iconsInText||!0,ma=co.paddedRect;const Sn=co.displaySize;hi.scale=hi.scale*Vr/si,Do={width:Sn[0],height:Sn[1],left:bn,top:-KP,advance:No?Sn[1]:Sn[0]},Zr=Ns+(Vr-Sn[1]*hi.scale),lc=Do.advance;const cc=No?Sn[0]*hi.scale-Vr*Hr:Sn[1]*hi.scale-Vr*Hr;cc>0&&cc>wn&&(wn=cc)}else{const co=vt[hi.fontStack],Sn=co&&co[ws];if(Sn&&Sn.rect)ma=Sn.rect,Do=Sn.metrics;else{const cc=lt[hi.fontStack],rg=cc&&cc[ws];if(!rg)continue;Do=rg.metrics}Zr=(Hr-hi.scale)*Vr}No?(ze.verticalizable=!0,zs.push({glyph:ws,imageName:ya,x:Ji,y:tr+Zr,vertical:No,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:Fs,metrics:Do,rect:ma}),Ji+=lc*hi.scale+Et):(zs.push({glyph:ws,imageName:ya,x:Ji,y:tr+Zr,vertical:No,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:Fs,metrics:Do,rect:ma}),Ji+=Do.advance*hi.scale+Et)}zs.length!==0&&(Gr=Math.max(Ji-Et,Gr),fV(zs,0,zs.length-1,tn,wn)),Ji=0;const xn=Qe*Hr+wn;nn.lineOffset=Math.max(wn,Ns),tr+=xn,Vn=Math.max(xn,Vn),++kr}var ls;const bs=tr-Ky,{horizontalAlign:rn,verticalAlign:sn}=U2(mt);(function(qr,Hr,Ns,nn,zs,wn,xn,Wr,hi){const Fs=(Hr-Ns)*zs;let ws=0;ws=wn!==xn?-Wr*nn-Ky:(-nn*hi+.5)*xn;for(const Zr of qr)for(const Do of Zr.positionedGlyphs)Do.x+=Fs,Do.y+=ws})(ze.positionedLines,tn,rn,sn,Gr,Vn,Qe,bs,st.length),ze.top+=-sn*bs,ze.bottom=ze.top+bs,ze.left+=-rn*Gr,ze.right=ze.left+Gr}(Ne,a,h,f,ue,E,P,k,F,L,G,Q),!function(ze){for(const lt of ze)if(lt.positionedGlyphs.length!==0)return!1;return!0}(we)&&Ne}const k1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dV={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function eC(u,a,h,f,b,T){if(a.imageName){const E=f[a.imageName];return E?E.displaySize[0]*a.scale*Vr/T+b:0}{const E=h[a.fontStack],P=E&&E[u];return P?P.metrics.advance*a.scale+b:0}}function tC(u,a,h,f){const b=Math.pow(u-a,2);return f?u<a?b/2:2*b:b+Math.abs(h)*h}function pV(u,a,h){let f=0;return u===10&&(f-=1e4),h&&(f+=150),u!==40&&u!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function iC(u,a,h,f,b,T){let E=null,P=tC(a,h,b,T);for(const k of f){const L=tC(a-k.x,h,b,T)+k.badness;L<=P&&(E=k,P=L)}return{index:u,x:a,priorBreak:E,badness:P}}function rC(u){return u?rC(u.priorBreak).concat(u.index):[]}function B2(u,a,h,f,b,T,E){if(T!=="point")return[];if(!u)return[];const P=[],k=function(G,Z,J,Q,oe,ue){let Te=0;for(let de=0;de<G.length();de++){const we=G.getSection(de);Te+=eC(G.getCharCode(de),we,Q,oe,Z,ue)}return Te/Math.max(1,Math.ceil(Te/J))}(u,a,h,f,b,E),L=u.text.indexOf("​")>=0;let N=0;for(let G=0;G<u.length();G++){const Z=u.getSection(G),J=u.getCharCode(G);if(k1[J]||(N+=eC(J,Z,f,b,a,E)),G<u.length()-1){const Q=!((F=J)<11904||!(ut["Bopomofo Extended"](F)||ut.Bopomofo(F)||ut["CJK Compatibility Forms"](F)||ut["CJK Compatibility Ideographs"](F)||ut["CJK Compatibility"](F)||ut["CJK Radicals Supplement"](F)||ut["CJK Strokes"](F)||ut["CJK Symbols and Punctuation"](F)||ut["CJK Unified Ideographs Extension A"](F)||ut["CJK Unified Ideographs"](F)||ut["Enclosed CJK Letters and Months"](F)||ut["Halfwidth and Fullwidth Forms"](F)||ut.Hiragana(F)||ut["Ideographic Description Characters"](F)||ut["Kangxi Radicals"](F)||ut["Katakana Phonetic Extensions"](F)||ut.Katakana(F)||ut["Vertical Forms"](F)||ut["Yi Radicals"](F)||ut["Yi Syllables"](F)));(dV[J]||Q||Z.imageName)&&P.push(iC(G+1,N,k,P,pV(J,u.getCharCode(G+1),Q&&L),!1))}}var F;return rC(iC(u.length(),N,k,P,0,!0))}function U2(u){let a=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function fV(u,a,h,f,b){if(!f&&!b)return;const T=u[h],E=(u[h].x+T.metrics.advance*T.scale)*f;for(let P=a;P<=h;P++)u[P].x-=E,u[P].y+=b}function mV(u,a,h){const{horizontalAlign:f,verticalAlign:b}=U2(h),T=a[0]-u.displaySize[0]*f,E=a[1]-u.displaySize[1]*b;return{image:u,top:E,bottom:E+u.displaySize[1],left:T,right:T+u.displaySize[0]}}function sC(u,a,h,f,b,T){const E=u.image;let P;if(E.content){const oe=E.content,ue=E.pixelRatio||1;P=[oe[0]/ue,oe[1]/ue,E.displaySize[0]-oe[2]/ue,E.displaySize[1]-oe[3]/ue]}const k=a.left*T,L=a.right*T;let N,F,G,Z;h==="width"||h==="both"?(Z=b[0]+k-f[3],F=b[0]+L+f[1]):(Z=b[0]+(k+L-E.displaySize[0])/2,F=Z+E.displaySize[0]);const J=a.top*T,Q=a.bottom*T;return h==="height"||h==="both"?(N=b[1]+J-f[0],G=b[1]+Q+f[2]):(N=b[1]+(J+Q-E.displaySize[1])/2,G=N+E.displaySize[1]),{image:E,top:N,right:F,bottom:G,left:Z,collisionPadding:P}}const Qy=255,nl=128,du=Qy*nl;function nC(u,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Zi(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:b}=h;let T=0;for(;T<f.length&&f[T]<=u;)T++;T=Math.max(0,T-1);let E=T;for(;E<f.length&&f[E]<u+1;)E++;E=Math.min(f.length-1,E);const P=f[T],k=f[E];return h.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:k,interpolationType:b}:{kind:"camera",minZoom:P,maxZoom:k,minSize:h.evaluate(new Zi(P)),maxSize:h.evaluate(new Zi(k)),interpolationType:b}}}function j2(u,a,h){let f="never";const b=u.get(a);return b?f=b:u.get(h)&&(f="always"),f}const yV=uu.VectorTileFeature.types,gV=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function R1(u,a,h,f,b,T,E,P,k,L,N,F,G){const Z=P?Math.min(du,Math.round(P[0])):0,J=P?Math.min(du,Math.round(P[1])):0;u.emplaceBack(a,h,Math.round(32*f),Math.round(32*b),T,E,(Z<<1)+(k?1:0),J,16*L,16*N,256*F,256*G)}function V2(u,a,h){u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h)}function _V(u){for(const a of u.sections)if(d1(a.text))return!0;return!1}class G2{constructor(a){this.layoutVertexArray=new fe,this.indexArray=new Ce,this.programConfigurations=a,this.segments=new Ve,this.dynamicLayoutVertexArray=new Ae,this.opacityVertexArray=new ce,this.hasVisibleVertices=!1,this.placedSymbolArray=new l}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,f,b){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Yj.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Jj.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,gV,!0),this.opacityVertexBuffer.itemSize=1),(f||b)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}pt("SymbolBuffers",G2);class q2{constructor(a,h,f){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new f,this.segments=new Ve,this.collisionVertexArray=new Pe}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Kj.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}pt("CollisionBuffers",q2);class yf{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(E=>E.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=x2([]),this.placementViewportMatrix=x2([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nC(this.zoom,h["text-size"]),this.iconSizeData=nC(this.zoom,h["icon-size"]);const f=this.layers[0].layout,b=f.get("symbol-sort-key"),T=f.get("symbol-z-order");this.canOverlap=j2(f,"text-overlap","text-allow-overlap")!=="never"||j2(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!b.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(E=>c.ah[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=a.sourceID}createArrays(){this.text=new G2(new er(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new G2(new er(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new _,this.lineVertexArray=new x,this.symbolInstances=new m,this.textAnchorOffsets=new $}calculateGlyphDependencies(a,h,f,b,T){for(let E=0;E<a.length;E++)if(h[a.charCodeAt(E)]=!0,(f||b)&&T){const P=Jy[a.charAt(E)];P&&(h[P.charCodeAt(0)]=!0)}}populate(a,h,f){const b=this.layers[0],T=b.layout,E=T.get("text-font"),P=T.get("text-field"),k=T.get("icon-image"),L=(P.value.kind!=="constant"||P.value.value instanceof Ls&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),N=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,F=T.get("symbol-sort-key");if(this.features=[],!L&&!N)return;const G=h.iconDependencies,Z=h.glyphDependencies,J=h.availableImages,Q=new Zi(this.zoom);for(const{feature:oe,id:ue,index:Te,sourceLayerIndex:de}of a){const we=b._featureFilter.needGeometry,Ne=nc(oe,we);if(!b._featureFilter.filter(Q,Ne,f))continue;let ze,lt;if(we||(Ne.geometry=sc(oe)),L){const ot=b.getValueAndResolveTokens("text-field",Ne,f,J),st=Ls.factory(ot),Qe=this.hasRTLText=this.hasRTLText||_V(st);(!Qe||Ql.getRTLTextPluginStatus()==="unavailable"||Qe&&Ql.isParsed())&&(ze=Qj(st,b,Ne))}if(N){const ot=b.getValueAndResolveTokens("icon-image",Ne,f,J);lt=ot instanceof Js?ot:Js.fromString(ot)}if(!ze&&!lt)continue;const vt=this.sortFeaturesByKey?F.evaluate(Ne,{},f):void 0;if(this.features.push({id:ue,text:ze,icon:lt,index:Te,sourceLayerIndex:de,geometry:Ne.geometry,properties:oe.properties,type:yV[oe.type],sortKey:vt}),lt&&(G[lt.name]=!0),ze){const ot=E.evaluate(Ne,{},f).join(","),st=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.ah.vertical)>=0;for(const Qe of ze.sections)if(Qe.image)G[Qe.image.name]=!0;else{const mt=Vh(ze.toString()),it=Qe.fontStack||ot,We=Z[it]=Z[it]||{};this.calculateGlyphDependencies(Qe.text,We,st,this.allowVerticalPlacement,mt)}}}T.get("symbol-placement")==="line"&&(this.features=function(oe){const ue={},Te={},de=[];let we=0;function Ne(ot){de.push(oe[ot]),we++}function ze(ot,st,Qe){const mt=Te[ot];return delete Te[ot],Te[st]=mt,de[mt].geometry[0].pop(),de[mt].geometry[0]=de[mt].geometry[0].concat(Qe[0]),mt}function lt(ot,st,Qe){const mt=ue[st];return delete ue[st],ue[ot]=mt,de[mt].geometry[0].shift(),de[mt].geometry[0]=Qe[0].concat(de[mt].geometry[0]),mt}function vt(ot,st,Qe){const mt=Qe?st[0][st[0].length-1]:st[0][0];return`${ot}:${mt.x}:${mt.y}`}for(let ot=0;ot<oe.length;ot++){const st=oe[ot],Qe=st.geometry,mt=st.text?st.text.toString():null;if(!mt){Ne(ot);continue}const it=vt(mt,Qe),We=vt(mt,Qe,!0);if(it in Te&&We in ue&&Te[it]!==ue[We]){const Et=lt(it,We,Qe),bt=ze(it,We,de[Et].geometry);delete ue[it],delete Te[We],Te[vt(mt,de[bt].geometry,!0)]=bt,de[Et].geometry=null}else it in Te?ze(it,We,Qe):We in ue?lt(it,We,Qe):(Ne(ot),ue[it]=we-1,Te[We]=we-1)}return de.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((oe,ue)=>oe.sortKey-ue.sortKey)}update(a,h,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,f),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const f=this.lineVertexArray.length;if(a.segment!==void 0){let b=a.dist(h[a.segment+1]),T=a.dist(h[a.segment]);const E={};for(let P=a.segment+1;P<h.length;P++)E[P]={x:h[P].x,y:h[P].y,tileUnitDistanceFromAnchor:b},P<h.length-1&&(b+=h[P+1].dist(h[P]));for(let P=a.segment||0;P>=0;P--)E[P]={x:h[P].x,y:h[P].y,tileUnitDistanceFromAnchor:T},P>0&&(T+=h[P-1].dist(h[P]));for(let P=0;P<h.length;P++){const k=E[P];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,h,f,b,T,E,P,k,L,N,F,G){const Z=a.indexArray,J=a.layoutVertexArray,Q=a.segments.prepareSegment(4*h.length,J,Z,this.canOverlap?E.sortKey:void 0),oe=this.glyphOffsetArray.length,ue=Q.vertexLength,Te=this.allowVerticalPlacement&&P===c.ah.vertical?Math.PI/2:0,de=E.text&&E.text.sections;for(let we=0;we<h.length;we++){const{tl:Ne,tr:ze,bl:lt,br:vt,tex:ot,pixelOffsetTL:st,pixelOffsetBR:Qe,minFontScaleX:mt,minFontScaleY:it,glyphOffset:We,isSDF:Et,sectionIndex:bt}=h[we],si=Q.vertexLength,Ji=We[1];R1(J,k.x,k.y,Ne.x,Ji+Ne.y,ot.x,ot.y,f,Et,st.x,st.y,mt,it),R1(J,k.x,k.y,ze.x,Ji+ze.y,ot.x+ot.w,ot.y,f,Et,Qe.x,st.y,mt,it),R1(J,k.x,k.y,lt.x,Ji+lt.y,ot.x,ot.y+ot.h,f,Et,st.x,Qe.y,mt,it),R1(J,k.x,k.y,vt.x,Ji+vt.y,ot.x+ot.w,ot.y+ot.h,f,Et,Qe.x,Qe.y,mt,it),V2(a.dynamicLayoutVertexArray,k,Te),Z.emplaceBack(si,si+1,si+2),Z.emplaceBack(si+1,si+2,si+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(We[0]),we!==h.length-1&&bt===h[we+1].sectionIndex||a.programConfigurations.populatePaintArrays(J.length,E,E.index,{},G,de&&de[bt])}a.placedSymbolArray.emplaceBack(k.x,k.y,oe,this.glyphOffsetArray.length-oe,ue,L,N,k.segment,f?f[0]:0,f?f[1]:0,b[0],b[1],P,0,!1,0,F)}_addCollisionDebugVertex(a,h,f,b,T,E){return h.emplaceBack(0,0),a.emplaceBack(f.x,f.y,b,T,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(a,h,f,b,T,E,P){const k=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),L=k.vertexLength,N=T.layoutVertexArray,F=T.collisionVertexArray,G=P.anchorX,Z=P.anchorY;this._addCollisionDebugVertex(N,F,E,G,Z,new M(a,h)),this._addCollisionDebugVertex(N,F,E,G,Z,new M(f,h)),this._addCollisionDebugVertex(N,F,E,G,Z,new M(f,b)),this._addCollisionDebugVertex(N,F,E,G,Z,new M(a,b)),k.vertexLength+=4;const J=T.indexArray;J.emplaceBack(L,L+1),J.emplaceBack(L+1,L+2),J.emplaceBack(L+2,L+3),J.emplaceBack(L+3,L),k.primitiveLength+=4}addDebugCollisionBoxes(a,h,f,b){for(let T=a;T<h;T++){const E=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,b?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new q2(xe,VP.members,Re),this.iconCollisionBox=new q2(xe,VP.members,Re);for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,f,b,T,E,P,k,L){const N={};for(let F=h;F<f;F++){const G=a.get(F);N.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.textFeatureIndex=G.featureIndex;break}for(let F=b;F<T;F++){const G=a.get(F);N.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalTextFeatureIndex=G.featureIndex;break}for(let F=E;F<P;F++){const G=a.get(F);N.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.iconFeatureIndex=G.featureIndex;break}for(let F=k;F<L;F++){const G=a.get(F);N.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalIconFeatureIndex=G.featureIndex;break}return N}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const f=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const f=a.placedSymbolArray.get(h),b=f.vertexStartIndex+4*f.numGlyphs;for(let T=f.vertexStartIndex;T<b;T+=4)a.indexArray.emplaceBack(T,T+1,T+2),a.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),f=Math.cos(a),b=[],T=[],E=[];for(let P=0;P<this.symbolInstances.length;++P){E.push(P);const k=this.symbolInstances.get(P);b.push(0|Math.round(h*k.anchorX+f*k.anchorY)),T.push(k.featureIndex)}return E.sort((P,k)=>b[P]-b[k]||T[k]-T[P]),E}addToSortKeyRanges(a,h){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===h?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const f=this.symbolInstances.get(h);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((b,T,E)=>{b>=0&&E.indexOf(b)===T&&this.addIndicesForPlacedSymbol(this.text,b)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let oC,aC;pt("SymbolBucket",yf,{omit:["layers","collisionBoxArray","features","compareText"]}),yf.MAX_GLYPHS=65535,yf.addDynamicAttributes=V2;var H2={get paint(){return aC=aC||new Xs({"icon-opacity":new $t(Oe.paint_symbol["icon-opacity"]),"icon-color":new $t(Oe.paint_symbol["icon-color"]),"icon-halo-color":new $t(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new $t(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $t(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new $t(Oe.paint_symbol["text-opacity"]),"text-color":new $t(Oe.paint_symbol["text-color"],{runtimeType:Ur,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new $t(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new $t(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new $t(Oe.paint_symbol["text-halo-blur"]),"text-translate":new wt(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new wt(Oe.paint_symbol["text-translate-anchor"])})},get layout(){return oC=oC||new Xs({"symbol-placement":new wt(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $t(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wt(Oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wt(Oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wt(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new $t(Oe.layout_symbol["icon-size"]),"icon-text-fit":new wt(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wt(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new $t(Oe.layout_symbol["icon-image"]),"icon-rotate":new $t(Oe.layout_symbol["icon-rotate"]),"icon-padding":new $t(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new $t(Oe.layout_symbol["icon-offset"]),"icon-anchor":new $t(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new $t(Oe.layout_symbol["text-field"]),"text-font":new $t(Oe.layout_symbol["text-font"]),"text-size":new $t(Oe.layout_symbol["text-size"]),"text-max-width":new $t(Oe.layout_symbol["text-max-width"]),"text-line-height":new wt(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new $t(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new $t(Oe.layout_symbol["text-justify"]),"text-radial-offset":new $t(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(Oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new $t(Oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new $t(Oe.layout_symbol["text-anchor"]),"text-max-angle":new wt(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new $t(Oe.layout_symbol["text-rotate"]),"text-padding":new wt(Oe.layout_symbol["text-padding"]),"text-keep-upright":new wt(Oe.layout_symbol["text-keep-upright"]),"text-transform":new $t(Oe.layout_symbol["text-transform"]),"text-offset":new $t(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new wt(Oe.layout_symbol["text-allow-overlap"]),"text-overlap":new wt(Oe.layout_symbol["text-overlap"]),"text-ignore-placement":new wt(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new wt(Oe.layout_symbol["text-optional"])})}};class lC{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:ha,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}pt("FormatSectionOverride",lC,{omit:["defaultValue"]});class O1 extends so{constructor(a){super(a,H2)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const b=[];for(const T of f)b.indexOf(T)<0&&b.push(T);this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,f,b){const T=this.layout.get(a).evaluate(h,{},f,b),E=this._unevaluatedLayout._values[a];return E.isDataDriven()||Ui(E.value)||!T?T:function(P,k){return k.replace(/{([^{}]+)}/g,(L,N)=>P&&N in P?String(P[N]):"")}(h.properties,T)}createBucket(a){return new yf(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of H2.paint.overridableProperties){if(!O1.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),f=new lC(h),b=new Fh(f,h.property.specification);let T=null;T=h.value.kind==="constant"||h.value.kind==="source"?new Xc("source",b):new Hp("composite",b,h.value.zoomStops),this.paint._values[a]=new ro(h.property,T,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,f){return!(!this.layout||h.isDataDriven()||f.isDataDriven())&&O1.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const f=a.get("text-field"),b=H2.paint.properties[h];let T=!1;const E=P=>{for(const k of P)if(b.overrides&&b.overrides.hasOverride(k))return void(T=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Ls)E(f.value.value.sections);else if(f.value.kind==="source"){const P=L=>{T||(L instanceof da&&Si(L.value)===io?E(L.value.sections):L instanceof qp?E(L.sections):L.eachChild(P))},k=f.value;k._styleExpression&&P(k._styleExpression.expression)}return T}}let cC;var vV={get paint(){return cC=cC||new Xs({"background-color":new wt(Oe.paint_background["background-color"]),"background-pattern":new My(Oe.paint_background["background-pattern"]),"background-opacity":new wt(Oe.paint_background["background-opacity"])})}};class bV extends so{constructor(a){super(a,vV)}}let uC;var wV={get paint(){return uC=uC||new Xs({"raster-opacity":new wt(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new wt(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(Oe.paint_raster["raster-saturation"]),"raster-contrast":new wt(Oe.paint_raster["raster-contrast"]),"raster-resampling":new wt(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(Oe.paint_raster["raster-fade-duration"])})}};class xV extends so{constructor(a){super(a,wV)}}class SV extends so{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class TV{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const W2=63710088e-1;class pu{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pu($e(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,f=this.lat*h,b=a.lat*h,T=Math.sin(f)*Math.sin(b)+Math.cos(f)*Math.cos(b)*Math.cos((a.lng-this.lng)*h);return W2*Math.acos(Math.min(T,1))}static convert(a){if(a instanceof pu)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new pu(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new pu(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const hC=2*Math.PI*W2;function dC(u){return hC*Math.cos(u*Math.PI/180)}function pC(u){return(180+u)/360}function fC(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function mC(u,a){return u/dC(a)}function Z2(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class L1{constructor(a,h,f=0){this.x=+a,this.y=+h,this.z=+f}static fromLngLat(a,h=0){const f=pu.convert(a);return new L1(pC(f.lng),fC(f.lat),mC(h,f.lat))}toLngLat(){return new pu(360*this.x-180,Z2(this.y))}toAltitude(){return this.z*dC(Z2(this.y))}meterInMercatorCoordinateUnits(){return 1/hC*(a=Z2(this.y),1/Math.cos(a*Math.PI/180));var a}}function yC(u,a,h){var f=2*Math.PI*6378137/256/Math.pow(2,h);return[u*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class Y2{constructor(a,h,f){if(a<0||a>25||f<0||f>=Math.pow(2,a)||h<0||h>=Math.pow(2,a))throw new Error(`x=${h}, y=${f}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=f,this.key=eg(0,a,a,h,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,f){const b=(E=this.y,P=this.z,k=yC(256*(T=this.x),256*(E=Math.pow(2,P)-E-1),P),L=yC(256*(T+1),256*(E+1),P),k[0]+","+k[1]+","+L[0]+","+L[1]);var T,E,P,k,L;const N=function(F,G,Z){let J,Q="";for(let oe=F;oe>0;oe--)J=1<<oe-1,Q+=(G&J?1:0)+(Z&J?2:0);return Q}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,b)}isChildOf(a){const h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){const h=Math.pow(2,this.z);return new M((a.x*h-this.x)*li,(a.y*h-this.y)*li)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gC{constructor(a,h){this.wrap=a,this.canonical=h,this.key=eg(a,h.z,h.z,h.x,h.y)}}class lo{constructor(a,h,f,b,T){if(a<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${f}`);this.overscaledZ=a,this.wrap=h,this.canonical=new Y2(f,+b,+T),this.key=eg(h,a,f,b,T)}clone(){return new lo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-a;return a>this.canonical.z?new lo(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new lo(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-a;return a>this.canonical.z?eg(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):eg(this.wrap*+h,a,a,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new lo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,f=2*this.canonical.x,b=2*this.canonical.y;return[new lo(h,this.wrap,h,f,b),new lo(h,this.wrap,h,f+1,b),new lo(h,this.wrap,h,f,b+1),new lo(h,this.wrap,h,f+1,b+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new lo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new lo(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new L1(a.x-this.wrap,a.y))}}function eg(u,a,h,f,b){(u*=2)<0&&(u=-1*u-1);const T=1<<h;return(T*T*u+T*b+f).toString(36)+h.toString(36)+a.toString(36)}pt("CanonicalTileID",Y2),pt("OverscaledTileID",lo,{omit:["posMatrix"]});class _C{constructor(a,h,f,b=1,T=1,E=1,P=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Pt(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const k=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=b,this.greenFactor=T,this.blueFactor=E,this.baseShift=P;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let L=0;L<k;L++)this.data[this._idx(-1,L)]=this.data[this._idx(0,L)],this.data[this._idx(k,L)]=this.data[this._idx(k-1,L)],this.data[this._idx(L,-1)]=this.data[this._idx(L,0)],this.data[this._idx(L,k)]=this.data[this._idx(L,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let L=0;L<k;L++)for(let N=0;N<k;N++){const F=this.get(L,N);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(a,h){const f=new Uint8Array(this.data.buffer),b=4*this._idx(a,h);return this.unpack(f[b],f[b+1],f[b+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,f){return a*this.redFactor+h*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new ao({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let b=h*this.dim,T=h*this.dim+this.dim,E=f*this.dim,P=f*this.dim+this.dim;switch(h){case-1:b=T-1;break;case 1:T=b+1}switch(f){case-1:E=P-1;break;case 1:P=E+1}const k=-h*this.dim,L=-f*this.dim;for(let N=E;N<P;N++)for(let F=b;F<T;F++)this.data[this._idx(F,N)]=a.data[this._idx(F+k,N+L)]}}pt("DEMData",_C);class vC{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const f=a[h];this._stringToNumber[f]=h,this._numberToString[h]=f}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class bC{constructor(a,h,f,b,T){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=f,a._y=b,this.properties=a.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class wC{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new pa(li,16,0),this.grid3D=new pa(li,16,0),this.featureIndexArray=new D,this.promoteId=h}insert(a,h,f,b,T,E){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,b,T);const k=E?this.grid3D:this.grid;for(let L=0;L<h.length;L++){const N=h[L],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<N.length;G++){const Z=N[G];F[0]=Math.min(F[0],Z.x),F[1]=Math.min(F[1],Z.y),F[2]=Math.max(F[2],Z.x),F[3]=Math.max(F[3],Z.y)}F[0]<li&&F[1]<li&&F[2]>=0&&F[3]>=0&&k.insert(P,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new uu.VectorTile(new N2(this.rawTileData)).layers,this.sourceLayerCoder=new vC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,f,b){this.loadVTLayers();const T=a.params||{},E=li/a.tileSize/a.scale,P=Yp(T.filter),k=a.queryGeometry,L=a.queryPadding*E,N=SC(k),F=this.grid.query(N.minX-L,N.minY-L,N.maxX+L,N.maxY+L),G=SC(a.cameraQueryGeometry),Z=this.grid3D.query(G.minX-L,G.minY-L,G.maxX+L,G.maxY+L,(oe,ue,Te,de)=>function(we,Ne,ze,lt,vt){for(const st of we)if(Ne<=st.x&&ze<=st.y&&lt>=st.x&&vt>=st.y)return!0;const ot=[new M(Ne,ze),new M(Ne,vt),new M(lt,vt),new M(lt,ze)];if(we.length>2){for(const st of ot)if(cf(we,st))return!0}for(let st=0;st<we.length-1;st++)if(ij(we[st],we[st+1],ot))return!0;return!1}(a.cameraQueryGeometry,oe-L,ue-L,Te+L,de+L));for(const oe of Z)F.push(oe);F.sort(EV);const J={};let Q;for(let oe=0;oe<F.length;oe++){const ue=F[oe];if(ue===Q)continue;Q=ue;const Te=this.featureIndexArray.get(ue);let de=null;this.loadMatchingFeature(J,Te.bucketIndex,Te.sourceLayerIndex,Te.featureIndex,P,T.layers,T.availableImages,h,f,b,(we,Ne,ze)=>(de||(de=sc(we)),Ne.queryIntersectsFeature(k,we,ze,de,this.z,a.transform,E,a.pixelPosMatrix)))}return J}loadMatchingFeature(a,h,f,b,T,E,P,k,L,N,F){const G=this.bucketLayerIDs[h];if(E&&!function(oe,ue){for(let Te=0;Te<oe.length;Te++)if(ue.indexOf(oe[Te])>=0)return!0;return!1}(E,G))return;const Z=this.sourceLayerCoder.decode(f),J=this.vtLayers[Z].feature(b);if(T.needGeometry){const oe=nc(J,!0);if(!T.filter(new Zi(this.tileID.overscaledZ),oe,this.tileID.canonical))return}else if(!T.filter(new Zi(this.tileID.overscaledZ),J))return;const Q=this.getId(J,Z);for(let oe=0;oe<G.length;oe++){const ue=G[oe];if(E&&E.indexOf(ue)<0)continue;const Te=k[ue];if(!Te)continue;let de={};Q&&N&&(de=N.getState(Te.sourceLayer||"_geojsonTileLayer",Q));const we=Fe({},L[ue]);we.paint=xC(we.paint,Te.paint,J,de,P),we.layout=xC(we.layout,Te.layout,J,de,P);const Ne=!F||F(J,Te,de);if(!Ne)continue;const ze=new bC(J,this.z,this.x,this.y,Q);ze.layer=we;let lt=a[ue];lt===void 0&&(lt=a[ue]=[]),lt.push({featureIndex:b,feature:ze,intersectionZ:Ne})}}lookupSymbolFeatures(a,h,f,b,T,E,P,k){const L={};this.loadVTLayers();const N=Yp(T);for(const F of a)this.loadMatchingFeature(L,f,b,F,N,E,P,k,h);return L}hasLayer(a){for(const h of this.bucketLayerIDs)for(const f of h)if(a===f)return!0;return!1}getId(a,h){let f=a.id;return this.promoteId&&(f=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof f=="boolean"&&(f=Number(f))),f}}function xC(u,a,h,f,b){return et(u,(T,E)=>{const P=a instanceof Gh?a.get(E):null;return P&&P.evaluate?P.evaluate(h,f,b):P})}function SC(u){let a=1/0,h=1/0,f=-1/0,b=-1/0;for(const T of u)a=Math.min(a,T.x),h=Math.min(h,T.y),f=Math.max(f,T.x),b=Math.max(b,T.y);return{minX:a,minY:h,maxX:f,maxY:b}}function EV(u,a){return a-u}function TC(u,a,h,f,b){const T=[];for(let E=0;E<u.length;E++){const P=u[E];let k;for(let L=0;L<P.length-1;L++){let N=P[L],F=P[L+1];N.x<a&&F.x<a||(N.x<a?N=new M(a,N.y+(a-N.x)/(F.x-N.x)*(F.y-N.y))._round():F.x<a&&(F=new M(a,N.y+(a-N.x)/(F.x-N.x)*(F.y-N.y))._round()),N.y<h&&F.y<h||(N.y<h?N=new M(N.x+(h-N.y)/(F.y-N.y)*(F.x-N.x),h)._round():F.y<h&&(F=new M(N.x+(h-N.y)/(F.y-N.y)*(F.x-N.x),h)._round()),N.x>=f&&F.x>=f||(N.x>=f?N=new M(f,N.y+(f-N.x)/(F.x-N.x)*(F.y-N.y))._round():F.x>=f&&(F=new M(f,N.y+(f-N.x)/(F.x-N.x)*(F.y-N.y))._round()),N.y>=b&&F.y>=b||(N.y>=b?N=new M(N.x+(b-N.y)/(F.y-N.y)*(F.x-N.x),b)._round():F.y>=b&&(F=new M(N.x+(b-N.y)/(F.y-N.y)*(F.x-N.x),b)._round()),k&&N.equals(k[k.length-1])||(k=[N],T.push(k)),k.push(F)))))}}return T}pt("FeatureIndex",wC,{omit:["rawTileData","sourceLayerCoder"]});class fu extends M{constructor(a,h,f,b){super(a,h),this.angle=f,b!==void 0&&(this.segment=b)}clone(){return new fu(this.x,this.y,this.angle,this.segment)}}function EC(u,a,h,f,b){if(a.segment===void 0||h===0)return!0;let T=a,E=a.segment+1,P=0;for(;P>-h/2;){if(E--,E<0)return!1;P-=u[E].dist(T),T=u[E]}P+=u[E].dist(u[E+1]),E++;const k=[];let L=0;for(;P<h/2;){const N=u[E],F=u[E+1];if(!F)return!1;let G=u[E-1].angleTo(N)-N.angleTo(F);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:P,angleDelta:G}),L+=G;P-k[0].distance>f;)L-=k.shift().angleDelta;if(L>b)return!1;E++,P+=N.dist(F)}return!0}function IC(u){let a=0;for(let h=0;h<u.length-1;h++)a+=u[h].dist(u[h+1]);return a}function MC(u,a,h){return u?.6*a*h:0}function AC(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function IV(u,a,h,f,b,T){const E=MC(h,b,T),P=AC(h,f)*T;let k=0;const L=IC(u)/2;for(let N=0;N<u.length-1;N++){const F=u[N],G=u[N+1],Z=F.dist(G);if(k+Z>L){const J=(L-k)/Z,Q=gn.number(F.x,G.x,J),oe=gn.number(F.y,G.y,J),ue=new fu(Q,oe,G.angleTo(F),N);return ue._round(),!E||EC(u,ue,P,E,a)?ue:void 0}k+=Z}}function MV(u,a,h,f,b,T,E,P,k){const L=MC(f,T,E),N=AC(f,b),F=N*E,G=u[0].x===0||u[0].x===k||u[0].y===0||u[0].y===k;return a-F<a/4&&(a=F+a/4),PC(u,G?a/2*P%a:(N/2+2*T)*E*P%a,a,L,h,F,G,!1,k)}function PC(u,a,h,f,b,T,E,P,k){const L=T/2,N=IC(u);let F=0,G=a-h,Z=[];for(let J=0;J<u.length-1;J++){const Q=u[J],oe=u[J+1],ue=Q.dist(oe),Te=oe.angleTo(Q);for(;G+h<F+ue;){G+=h;const de=(G-F)/ue,we=gn.number(Q.x,oe.x,de),Ne=gn.number(Q.y,oe.y,de);if(we>=0&&we<k&&Ne>=0&&Ne<k&&G-L>=0&&G+L<=N){const ze=new fu(we,Ne,Te,J);ze._round(),f&&!EC(u,ze,T,f,b)||Z.push(ze)}}F+=ue}return P||Z.length||E||(Z=PC(u,F/2,h,f,b,T,E,!0,k)),Z}pt("Anchor",fu);const gf=bn;function CC(u,a,h,f){const b=[],T=u.image,E=T.pixelRatio,P=T.paddedRect.w-2*gf,k=T.paddedRect.h-2*gf,L=u.right-u.left,N=u.bottom-u.top,F=T.stretchX||[[0,P]],G=T.stretchY||[[0,k]],Z=(Qe,mt)=>Qe+mt[1]-mt[0],J=F.reduce(Z,0),Q=G.reduce(Z,0),oe=P-J,ue=k-Q;let Te=0,de=J,we=0,Ne=Q,ze=0,lt=oe,vt=0,ot=ue;if(T.content&&f){const Qe=T.content;Te=D1(F,0,Qe[0]),we=D1(G,0,Qe[1]),de=D1(F,Qe[0],Qe[2]),Ne=D1(G,Qe[1],Qe[3]),ze=Qe[0]-Te,vt=Qe[1]-we,lt=Qe[2]-Qe[0]-de,ot=Qe[3]-Qe[1]-Ne}const st=(Qe,mt,it,We)=>{const Et=N1(Qe.stretch-Te,de,L,u.left),bt=z1(Qe.fixed-ze,lt,Qe.stretch,J),si=N1(mt.stretch-we,Ne,N,u.top),Ji=z1(mt.fixed-vt,ot,mt.stretch,Q),tr=N1(it.stretch-Te,de,L,u.left),Gr=z1(it.fixed-ze,lt,it.stretch,J),Vn=N1(We.stretch-we,Ne,N,u.top),tn=z1(We.fixed-vt,ot,We.stretch,Q),kr=new M(Et,si),ls=new M(tr,si),bs=new M(tr,Vn),rn=new M(Et,Vn),sn=new M(bt/E,Ji/E),qr=new M(Gr/E,tn/E),Hr=a*Math.PI/180;if(Hr){const zs=Math.sin(Hr),wn=Math.cos(Hr),xn=[wn,-zs,zs,wn];kr._matMult(xn),ls._matMult(xn),rn._matMult(xn),bs._matMult(xn)}const Ns=Qe.stretch+Qe.fixed,nn=mt.stretch+mt.fixed;return{tl:kr,tr:ls,bl:rn,br:bs,tex:{x:T.paddedRect.x+gf+Ns,y:T.paddedRect.y+gf+nn,w:it.stretch+it.fixed-Ns,h:We.stretch+We.fixed-nn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:sn,pixelOffsetBR:qr,minFontScaleX:lt/E/L,minFontScaleY:ot/E/N,isSDF:h}};if(f&&(T.stretchX||T.stretchY)){const Qe=$C(F,oe,J),mt=$C(G,ue,Q);for(let it=0;it<Qe.length-1;it++){const We=Qe[it],Et=Qe[it+1];for(let bt=0;bt<mt.length-1;bt++)b.push(st(We,mt[bt],Et,mt[bt+1]))}}else b.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:k+1}));return b}function D1(u,a,h){let f=0;for(const b of u)f+=Math.max(a,Math.min(h,b[1]))-Math.max(a,Math.min(h,b[0]));return f}function $C(u,a,h){const f=[{fixed:-gf,stretch:0}];for(const[b,T]of u){const E=f[f.length-1];f.push({fixed:b-E.stretch,stretch:E.stretch}),f.push({fixed:b-E.stretch,stretch:E.stretch+(T-b)})}return f.push({fixed:a+gf,stretch:h}),f}function N1(u,a,h,f){return u/a*h+f}function z1(u,a,h,f){return u-a*h/f}class F1{constructor(a,h,f,b,T,E,P,k,L,N){if(this.boxStartIndex=a.length,L){let F=E.top,G=E.bottom;const Z=E.collisionPadding;Z&&(F-=Z[1],G+=Z[3]);let J=G-F;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{let F=E.top*P-k[0],G=E.bottom*P+k[2],Z=E.left*P-k[3],J=E.right*P+k[1];const Q=E.collisionPadding;if(Q&&(Z-=Q[0]*P,F-=Q[1]*P,J+=Q[2]*P,G+=Q[3]*P),N){const oe=new M(Z,F),ue=new M(J,F),Te=new M(Z,G),de=new M(J,G),we=N*Math.PI/180;oe._rotate(we),ue._rotate(we),Te._rotate(we),de._rotate(we),Z=Math.min(oe.x,ue.x,Te.x,de.x),J=Math.max(oe.x,ue.x,Te.x,de.x),F=Math.min(oe.y,ue.y,Te.y,de.y),G=Math.max(oe.y,ue.y,Te.y,de.y)}a.emplaceBack(h.x,h.y,Z,F,J,G,f,b,T)}this.boxEndIndex=a.length}}class AV{constructor(a=[],h=PV){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:f}=this,b=h[a];for(;a>0;){const T=a-1>>1,E=h[T];if(f(b,E)>=0)break;h[a]=E,a=T}h[a]=b}_down(a){const{data:h,compare:f}=this,b=this.length>>1,T=h[a];for(;a<b;){let E=1+(a<<1),P=h[E];const k=E+1;if(k<this.length&&f(h[k],P)<0&&(E=k,P=h[k]),f(P,T)>=0)break;h[a]=P,a=E}h[a]=T}}function PV(u,a){return u<a?-1:u>a?1:0}function CV(u,a=1,h=!1){let f=1/0,b=1/0,T=-1/0,E=-1/0;const P=u[0];for(let Z=0;Z<P.length;Z++){const J=P[Z];(!Z||J.x<f)&&(f=J.x),(!Z||J.y<b)&&(b=J.y),(!Z||J.x>T)&&(T=J.x),(!Z||J.y>E)&&(E=J.y)}const k=Math.min(T-f,E-b);let L=k/2;const N=new AV([],$V);if(k===0)return new M(f,b);for(let Z=f;Z<T;Z+=k)for(let J=b;J<E;J+=k)N.push(new _f(Z+L,J+L,L,u));let F=function(Z){let J=0,Q=0,oe=0;const ue=Z[0];for(let Te=0,de=ue.length,we=de-1;Te<de;we=Te++){const Ne=ue[Te],ze=ue[we],lt=Ne.x*ze.y-ze.x*Ne.y;Q+=(Ne.x+ze.x)*lt,oe+=(Ne.y+ze.y)*lt,J+=3*lt}return new _f(Q/J,oe/J,0,Z)}(u),G=N.length;for(;N.length;){const Z=N.pop();(Z.d>F.d||!F.d)&&(F=Z,h&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,G)),Z.max-F.d<=a||(L=Z.h/2,N.push(new _f(Z.p.x-L,Z.p.y-L,L,u)),N.push(new _f(Z.p.x+L,Z.p.y-L,L,u)),N.push(new _f(Z.p.x-L,Z.p.y+L,L,u)),N.push(new _f(Z.p.x+L,Z.p.y+L,L,u)),G+=4)}return h&&(console.log(`num probes: ${G}`),console.log(`best distance: ${F.d}`)),F.p}function $V(u,a){return a.max-u.max}function _f(u,a,h,f){this.p=new M(u,a),this.h=h,this.d=function(b,T){let E=!1,P=1/0;for(let k=0;k<T.length;k++){const L=T[k];for(let N=0,F=L.length,G=F-1;N<F;G=N++){const Z=L[N],J=L[G];Z.y>b.y!=J.y>b.y&&b.x<(J.x-Z.x)*(b.y-Z.y)/(J.y-Z.y)+Z.x&&(E=!E),P=Math.min(P,fP(b,Z,J))}}return(E?1:-1)*Math.sqrt(P)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var vs;c.ap=void 0,(vs=c.ap||(c.ap={}))[vs.center=1]="center",vs[vs.left=2]="left",vs[vs.right=3]="right",vs[vs.top=4]="top",vs[vs.bottom=5]="bottom",vs[vs["top-left"]=6]="top-left",vs[vs["top-right"]=7]="top-right",vs[vs["bottom-left"]=8]="bottom-left",vs[vs["bottom-right"]=9]="bottom-right";const mu=7,J2=Number.POSITIVE_INFINITY;function kC(u,a){return a[1]!==J2?function(h,f,b){let T=0,E=0;switch(f=Math.abs(f),b=Math.abs(b),h){case"top-right":case"top-left":case"top":E=b-mu;break;case"bottom-right":case"bottom-left":case"bottom":E=-b+mu}switch(h){case"top-right":case"bottom-right":case"right":T=-f;break;case"top-left":case"bottom-left":case"left":T=f}return[T,E]}(u,a[0],a[1]):function(h,f){let b=0,T=0;f<0&&(f=0);const E=f/Math.SQRT2;switch(h){case"top-right":case"top-left":T=E-mu;break;case"bottom-right":case"bottom-left":T=-E+mu;break;case"bottom":T=-f+mu;break;case"top":T=f-mu}switch(h){case"top-right":case"bottom-right":b=-E;break;case"top-left":case"bottom-left":b=E;break;case"left":b=f;break;case"right":b=-f}return[b,T]}(u,a[0])}function RC(u,a,h){var f;const b=u.layout,T=(f=b.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(a,{},h);if(T){const P=T.values,k=[];for(let L=0;L<P.length;L+=2){const N=k[L]=P[L],F=P[L+1].map(G=>G*Vr);N.startsWith("top")?F[1]-=mu:N.startsWith("bottom")&&(F[1]+=mu),k[L+1]=F}return new es(k)}const E=b.get("text-variable-anchor");if(E){let P;P=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[b.get("text-radial-offset").evaluate(a,{},h)*Vr,J2]:b.get("text-offset").evaluate(a,{},h).map(L=>L*Vr);const k=[];for(const L of E)k.push(L,kC(L,P));return new es(k)}return null}function K2(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function kV(u,a,h,f,b,T,E,P,k,L,N){let F=T.textMaxSize.evaluate(a,{});F===void 0&&(F=E);const G=u.layers[0].layout,Z=G.get("icon-offset").evaluate(a,{},N),J=LC(h.horizontal),Q=E/24,oe=u.tilePixelRatio*Q,ue=u.tilePixelRatio*F/24,Te=u.tilePixelRatio*P,de=u.tilePixelRatio*G.get("symbol-spacing"),we=G.get("text-padding")*u.tilePixelRatio,Ne=function(We,Et,bt,si=1){const Ji=We.get("icon-padding").evaluate(Et,{},bt),tr=Ji&&Ji.values;return[tr[0]*si,tr[1]*si,tr[2]*si,tr[3]*si]}(G,a,N,u.tilePixelRatio),ze=G.get("text-max-angle")/180*Math.PI,lt=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",vt=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",ot=G.get("symbol-placement"),st=de/2,Qe=G.get("icon-text-fit");let mt;f&&Qe!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(mt=sC(f,h.vertical,Qe,G.get("icon-text-fit-padding"),Z,Q)),J&&(f=sC(f,J,Qe,G.get("icon-text-fit-padding"),Z,Q)));const it=(We,Et)=>{Et.x<0||Et.x>=li||Et.y<0||Et.y>=li||function(bt,si,Ji,tr,Gr,Vn,tn,kr,ls,bs,rn,sn,qr,Hr,Ns,nn,zs,wn,xn,Wr,hi,Fs,ws,Zr,Do){const ma=bt.addToLineVertexArray(si,Ji);let ya,lc,No,co,Sn=0,cc=0,rg=0,FC=0,nS=-1,oS=-1;const uc={};let BC=ei("");if(bt.allowVerticalPlacement&&tr.vertical){const Bs=kr.layout.get("text-rotate").evaluate(hi,{},Zr)+90;No=new F1(ls,si,bs,rn,sn,tr.vertical,qr,Hr,Ns,Bs),tn&&(co=new F1(ls,si,bs,rn,sn,tn,zs,wn,Ns,Bs))}if(Gr){const Bs=kr.layout.get("icon-rotate").evaluate(hi,{}),uo=kr.layout.get("icon-text-fit")!=="none",Xh=CC(Gr,Bs,ws,uo),_a=tn?CC(tn,Bs,ws,uo):void 0;lc=new F1(ls,si,bs,rn,sn,Gr,zs,wn,!1,Bs),Sn=4*Xh.length;const Qh=bt.iconSizeData;let ol=null;Qh.kind==="source"?(ol=[nl*kr.layout.get("icon-size").evaluate(hi,{})],ol[0]>du&&Pt(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Qy}. Reduce your "icon-size".`)):Qh.kind==="composite"&&(ol=[nl*Fs.compositeIconSizes[0].evaluate(hi,{},Zr),nl*Fs.compositeIconSizes[1].evaluate(hi,{},Zr)],(ol[0]>du||ol[1]>du)&&Pt(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Qy}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,Xh,ol,Wr,xn,hi,c.ah.none,si,ma.lineStartIndex,ma.lineLength,-1,Zr),nS=bt.icon.placedSymbolArray.length-1,_a&&(cc=4*_a.length,bt.addSymbols(bt.icon,_a,ol,Wr,xn,hi,c.ah.vertical,si,ma.lineStartIndex,ma.lineLength,-1,Zr),oS=bt.icon.placedSymbolArray.length-1)}const UC=Object.keys(tr.horizontal);for(const Bs of UC){const uo=tr.horizontal[Bs];if(!ya){BC=ei(uo.text);const _a=kr.layout.get("text-rotate").evaluate(hi,{},Zr);ya=new F1(ls,si,bs,rn,sn,uo,qr,Hr,Ns,_a)}const Xh=uo.positionedLines.length===1;if(rg+=OC(bt,si,uo,Vn,kr,Ns,hi,nn,ma,tr.vertical?c.ah.horizontal:c.ah.horizontalOnly,Xh?UC:[Bs],uc,nS,Fs,Zr),Xh)break}tr.vertical&&(FC+=OC(bt,si,tr.vertical,Vn,kr,Ns,hi,nn,ma,c.ah.vertical,["vertical"],uc,oS,Fs,Zr));const LV=ya?ya.boxStartIndex:bt.collisionBoxArray.length,DV=ya?ya.boxEndIndex:bt.collisionBoxArray.length,NV=No?No.boxStartIndex:bt.collisionBoxArray.length,zV=No?No.boxEndIndex:bt.collisionBoxArray.length,FV=lc?lc.boxStartIndex:bt.collisionBoxArray.length,BV=lc?lc.boxEndIndex:bt.collisionBoxArray.length,UV=co?co.boxStartIndex:bt.collisionBoxArray.length,jV=co?co.boxEndIndex:bt.collisionBoxArray.length;let ga=-1;const U1=(Bs,uo)=>Bs&&Bs.circleDiameter?Math.max(Bs.circleDiameter,uo):uo;ga=U1(ya,ga),ga=U1(No,ga),ga=U1(lc,ga),ga=U1(co,ga);const jC=ga>-1?1:0;jC&&(ga*=Do/Vr),bt.glyphOffsetArray.length>=yf.MAX_GLYPHS&&Pt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),hi.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,hi.sortKey);const VV=RC(kr,hi,Zr),[GV,qV]=function(Bs,uo){const Xh=Bs.length,_a=uo==null?void 0:uo.values;if((_a==null?void 0:_a.length)>0)for(let Qh=0;Qh<_a.length;Qh+=2){const ol=_a[Qh+1];Bs.emplaceBack(c.ap[_a[Qh]],ol[0],ol[1])}return[Xh,Bs.length]}(bt.textAnchorOffsets,VV);bt.symbolInstances.emplaceBack(si.x,si.y,uc.right>=0?uc.right:-1,uc.center>=0?uc.center:-1,uc.left>=0?uc.left:-1,uc.vertical||-1,nS,oS,BC,LV,DV,NV,zV,FV,BV,UV,jV,bs,rg,FC,Sn,cc,jC,0,qr,ga,GV,qV)}(u,Et,We,h,f,b,mt,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,oe,[we,we,we,we],lt,k,Te,Ne,vt,Z,a,T,L,N,E)};if(ot==="line")for(const We of TC(a.geometry,0,0,li,li)){const Et=MV(We,de,ze,h.vertical||J,f,24,ue,u.overscaling,li);for(const bt of Et)J&&RV(u,J.text,st,bt)||it(We,bt)}else if(ot==="line-center"){for(const We of a.geometry)if(We.length>1){const Et=IV(We,ze,h.vertical||J,f,24,ue);Et&&it(We,Et)}}else if(a.type==="Polygon")for(const We of P2(a.geometry,0)){const Et=CV(We,16);it(We[0],new fu(Et.x,Et.y,0))}else if(a.type==="LineString")for(const We of a.geometry)it(We,new fu(We[0].x,We[0].y,0));else if(a.type==="Point")for(const We of a.geometry)for(const Et of We)it([Et],new fu(Et.x,Et.y,0))}function OC(u,a,h,f,b,T,E,P,k,L,N,F,G,Z,J){const Q=function(Te,de,we,Ne,ze,lt,vt,ot){const st=Ne.layout.get("text-rotate").evaluate(lt,{})*Math.PI/180,Qe=[];for(const mt of de.positionedLines)for(const it of mt.positionedGlyphs){if(!it.rect)continue;const We=it.rect||{};let Et=KP+1,bt=!0,si=1,Ji=0;const tr=(ze||ot)&&it.vertical,Gr=it.metrics.advance*it.scale/2;if(ot&&de.verticalizable&&(Ji=mt.lineOffset/2-(it.imageName?-(Vr-it.metrics.width*it.scale)/2:(it.scale-1)*Vr)),it.imageName){const Wr=vt[it.imageName];bt=Wr.sdf,si=Wr.pixelRatio,Et=bn/si}const Vn=ze?[it.x+Gr,it.y]:[0,0];let tn=ze?[0,0]:[it.x+Gr+we[0],it.y+we[1]-Ji],kr=[0,0];tr&&(kr=tn,tn=[0,0]);const ls=it.metrics.isDoubleResolution?2:1,bs=(it.metrics.left-Et)*it.scale-Gr+tn[0],rn=(-it.metrics.top-Et)*it.scale+tn[1],sn=bs+We.w/ls*it.scale/si,qr=rn+We.h/ls*it.scale/si,Hr=new M(bs,rn),Ns=new M(sn,rn),nn=new M(bs,qr),zs=new M(sn,qr);if(tr){const Wr=new M(-Gr,Gr-Ky),hi=-Math.PI/2,Fs=Vr/2-Gr,ws=new M(5-Ky-Fs,-(it.imageName?Fs:0)),Zr=new M(...kr);Hr._rotateAround(hi,Wr)._add(ws)._add(Zr),Ns._rotateAround(hi,Wr)._add(ws)._add(Zr),nn._rotateAround(hi,Wr)._add(ws)._add(Zr),zs._rotateAround(hi,Wr)._add(ws)._add(Zr)}if(st){const Wr=Math.sin(st),hi=Math.cos(st),Fs=[hi,-Wr,Wr,hi];Hr._matMult(Fs),Ns._matMult(Fs),nn._matMult(Fs),zs._matMult(Fs)}const wn=new M(0,0),xn=new M(0,0);Qe.push({tl:Hr,tr:Ns,bl:nn,br:zs,tex:We,writingMode:de.writingMode,glyphOffset:Vn,sectionIndex:it.sectionIndex,isSDF:bt,pixelOffsetTL:wn,pixelOffsetBR:xn,minFontScaleX:0,minFontScaleY:0})}return Qe}(0,h,P,b,T,E,f,u.allowVerticalPlacement),oe=u.textSizeData;let ue=null;oe.kind==="source"?(ue=[nl*b.layout.get("text-size").evaluate(E,{})],ue[0]>du&&Pt(`${u.layerIds[0]}: Value for "text-size" is >= ${Qy}. Reduce your "text-size".`)):oe.kind==="composite"&&(ue=[nl*Z.compositeTextSizes[0].evaluate(E,{},J),nl*Z.compositeTextSizes[1].evaluate(E,{},J)],(ue[0]>du||ue[1]>du)&&Pt(`${u.layerIds[0]}: Value for "text-size" is >= ${Qy}. Reduce your "text-size".`)),u.addSymbols(u.text,Q,ue,P,T,E,L,a,k.lineStartIndex,k.lineLength,G,J);for(const Te of N)F[Te]=u.text.placedSymbolArray.length-1;return 4*Q.length}function LC(u){for(const a in u)return u[a];return null}function RV(u,a,h,f){const b=u.compareText;if(a in b){const T=b[a];for(let E=T.length-1;E>=0;E--)if(f.dist(T[E])<h)return!0}else b[a]=[];return b[a].push(f),!1}const DC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class X2{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,f]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const b=f>>4;if(b!==1)throw new Error(`Got v${b} data when expected v1.`);const T=DC[15&f];if(!T)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(a,2,1),[P]=new Uint32Array(a,4,1);return new X2(P,E,T,a)}constructor(a,h=64,f=Float64Array,b){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const T=DC.indexOf(this.ArrayType),E=2*a*this.ArrayType.BYTES_PER_ELEMENT,P=a*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-P%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${f}.`);b&&b instanceof ArrayBuffer?(this.data=b,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+P+k,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+E+P+k),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+P+k,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=h,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return Q2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,f,b){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:E,nodeSize:P}=this,k=[0,T.length-1,0],L=[];for(;k.length;){const N=k.pop()||0,F=k.pop()||0,G=k.pop()||0;if(F-G<=P){for(let oe=G;oe<=F;oe++){const ue=E[2*oe],Te=E[2*oe+1];ue>=a&&ue<=f&&Te>=h&&Te<=b&&L.push(T[oe])}continue}const Z=G+F>>1,J=E[2*Z],Q=E[2*Z+1];J>=a&&J<=f&&Q>=h&&Q<=b&&L.push(T[Z]),(N===0?a<=J:h<=Q)&&(k.push(G),k.push(Z-1),k.push(1-N)),(N===0?f>=J:b>=Q)&&(k.push(Z+1),k.push(F),k.push(1-N))}return L}within(a,h,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:E}=this,P=[0,b.length-1,0],k=[],L=f*f;for(;P.length;){const N=P.pop()||0,F=P.pop()||0,G=P.pop()||0;if(F-G<=E){for(let oe=G;oe<=F;oe++)zC(T[2*oe],T[2*oe+1],a,h)<=L&&k.push(b[oe]);continue}const Z=G+F>>1,J=T[2*Z],Q=T[2*Z+1];zC(J,Q,a,h)<=L&&k.push(b[Z]),(N===0?a-f<=J:h-f<=Q)&&(P.push(G),P.push(Z-1),P.push(1-N)),(N===0?a+f>=J:h+f>=Q)&&(P.push(Z+1),P.push(F),P.push(1-N))}return k}}function Q2(u,a,h,f,b,T){if(b-f<=h)return;const E=f+b>>1;NC(u,a,E,f,b,T),Q2(u,a,h,f,E-1,1-T),Q2(u,a,h,E+1,b,1-T)}function NC(u,a,h,f,b,T){for(;b>f;){if(b-f>600){const L=b-f+1,N=h-f+1,F=Math.log(L),G=.5*Math.exp(2*F/3),Z=.5*Math.sqrt(F*G*(L-G)/L)*(N-L/2<0?-1:1);NC(u,a,h,Math.max(f,Math.floor(h-N*G/L+Z)),Math.min(b,Math.floor(h+(L-N)*G/L+Z)),T)}const E=a[2*h+T];let P=f,k=b;for(tg(u,a,f,h),a[2*b+T]>E&&tg(u,a,f,b);P<k;){for(tg(u,a,P,k),P++,k--;a[2*P+T]<E;)P++;for(;a[2*k+T]>E;)k--}a[2*f+T]===E?tg(u,a,f,k):(k++,tg(u,a,k,b)),k<=h&&(f=k+1),h<=k&&(b=k-1)}}function tg(u,a,h,f){eS(u,h,f),eS(a,2*h,2*f),eS(a,2*h+1,2*f+1)}function eS(u,a,h){const f=u[a];u[a]=u[h],u[h]=f}function zC(u,a,h,f){const b=u-h,T=a-f;return b*b+T*T}var tS;c.bd=void 0,(tS=c.bd||(c.bd={})).create="create",tS.load="load",tS.fullLoad="fullLoad";let B1=null,ig=[];const iS=1e3/60,rS="loadTime",sS="fullLoadTime",OV={mark(u){performance.mark(u)},frame(u){const a=u;B1!=null&&ig.push(a-B1),B1=a},clearMetrics(){B1=null,ig=[],performance.clearMeasures(rS),performance.clearMeasures(sS);for(const u in c.bd)performance.clearMarks(c.bd[u])},getPerformanceMetrics(){performance.measure(rS,c.bd.create,c.bd.load),performance.measure(sS,c.bd.create,c.bd.fullLoad);const u=performance.getEntriesByName(rS)[0].duration,a=performance.getEntriesByName(sS)[0].duration,h=ig.length,f=1/(ig.reduce((T,E)=>T+E,0)/h/1e3),b=ig.filter(T=>T>iS).reduce((T,E)=>T+(E-iS)/iS,0);return{loadTime:u,fullLoadTime:a,fps:f,percentDroppedFrames:b/(h+b)*100,totalFrames:h}}};c.$=Ve,c.A=uf,c.B=function(u){if(Tt==null){const a=u.navigator?u.navigator.userAgent:null;Tt=!!u.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Tt},c.C=class{constructor(u,a){this.target=u,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new TV(()=>this.process()),this.subscription=function(h,f,b,T){return h.addEventListener(f,b,!1),{unsubscribe:()=>{h.removeEventListener(f,b,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=Li(self)?u:window}registerMessageHandler(u,a){this.messageHandlers[u]=a}sendAsync(u,a){return new Promise((h,f)=>{const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[b]={resolve:h,reject:f},a&&a.signal.addEventListener("abort",()=>{delete this.resolveRejects[b];const P={id:b,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(P)},{once:!0});const T=[],E=Object.assign(Object.assign({},u),{id:b,sourceMapId:this.mapId,origin:location.origin,data:Xl(u.data,T)});this.target.postMessage(E,{transfer:T})})}receive(u){const a=u.data,h=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[h];const f=this.abortControllers[h];return delete this.abortControllers[h],void(f&&f.abort())}if(Li(self)||a.mustQueue)return this.tasks[h]=a,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,a)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),a=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(u,a)}processTask(u,a){return o(this,void 0,void 0,function*(){if(a.type==="<response>"){const b=this.resolveRejects[u];return delete this.resolveRejects[u],b?void(a.error?b.reject(nu(a.error)):b.resolve(nu(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=nu(a.data),f=new AbortController;this.abortControllers[u]=f;try{const b=yield this.messageHandlers[a.type](a.sourceMapId,h,f);this.completeTask(u,null,b)}catch(b){this.completeTask(u,b)}})}completeTask(u,a,h){const f=[];delete this.abortControllers[u];const b={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?Xl(a):null,data:Xl(h,f)};this.target.postMessage(b,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.D=wt,c.E=la,c.F=function(){var u=new uf(16);return uf!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},c.G=Kr,c.H=function(u,a,h){var f,b,T,E,P,k,L,N,F,G,Z,J,Q=h[0],oe=h[1],ue=h[2];return a===u?(u[12]=a[0]*Q+a[4]*oe+a[8]*ue+a[12],u[13]=a[1]*Q+a[5]*oe+a[9]*ue+a[13],u[14]=a[2]*Q+a[6]*oe+a[10]*ue+a[14],u[15]=a[3]*Q+a[7]*oe+a[11]*ue+a[15]):(b=a[1],T=a[2],E=a[3],P=a[4],k=a[5],L=a[6],N=a[7],F=a[8],G=a[9],Z=a[10],J=a[11],u[0]=f=a[0],u[1]=b,u[2]=T,u[3]=E,u[4]=P,u[5]=k,u[6]=L,u[7]=N,u[8]=F,u[9]=G,u[10]=Z,u[11]=J,u[12]=f*Q+P*oe+F*ue+a[12],u[13]=b*Q+k*oe+G*ue+a[13],u[14]=T*Q+L*oe+Z*ue+a[14],u[15]=E*Q+N*oe+J*ue+a[15]),u},c.I=F2,c.J=function(u,a,h){var f=h[0],b=h[1],T=h[2];return u[0]=a[0]*f,u[1]=a[1]*f,u[2]=a[2]*f,u[3]=a[3]*f,u[4]=a[4]*b,u[5]=a[5]*b,u[6]=a[6]*b,u[7]=a[7]*b,u[8]=a[8]*T,u[9]=a[9]*T,u[10]=a[10]*T,u[11]=a[11]*T,u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},c.K=_P,c.L=function(u,a){const h={};for(let f=0;f<a.length;f++){const b=a[f];b in u&&(h[b]=u[b])}return h},c.M=pu,c.N=pC,c.O=fC,c.P=M,c.Q=lo,c.R=ao,c.S=ie,c.T=Ey,c.U=ve,c.V=Fr,c.W=li,c.X=xr,c.Y=L1,c.Z=class extends rl{},c._=o,c.a=Zs,c.a$=function(u,a,h){return u[0]=a[0]*h[0],u[1]=a[1]*h[1],u[2]=a[2]*h[2],u[3]=a[3]*h[3],u},c.a0=Y2,c.a1=Xe,c.a2=u=>{const a=window.document.createElement("video");return a.muted=!0,new Promise(h=>{a.onloadstart=()=>{h(a)};for(const f of u){const b=window.document.createElement("source");Di(f)||(a.crossOrigin="Anonymous"),b.src=f,a.appendChild(b)}})},c.a3=function(){return Ge++},c.a4=g1,c.a5=yf,c.a6=Yp,c.a7=nc,c.a8=Zi,c.a9=bC,c.aA=ct,c.aB=function(u,a){if(!u)return[{command:"setStyle",args:[a]}];let h=[];try{if(!ai(u.version,a.version))return[{command:"setStyle",args:[a]}];ai(u.center,a.center)||h.push({command:"setCenter",args:[a.center]}),ai(u.zoom,a.zoom)||h.push({command:"setZoom",args:[a.zoom]}),ai(u.bearing,a.bearing)||h.push({command:"setBearing",args:[a.bearing]}),ai(u.pitch,a.pitch)||h.push({command:"setPitch",args:[a.pitch]}),ai(u.sprite,a.sprite)||h.push({command:"setSprite",args:[a.sprite]}),ai(u.glyphs,a.glyphs)||h.push({command:"setGlyphs",args:[a.glyphs]}),ai(u.transition,a.transition)||h.push({command:"setTransition",args:[a.transition]}),ai(u.light,a.light)||h.push({command:"setLight",args:[a.light]}),ai(u.terrain,a.terrain)||h.push({command:"setTerrain",args:[a.terrain]}),ai(u.sky,a.sky)||h.push({command:"setSky",args:[a.sky]});const f={},b=[];(function(E,P,k,L){let N;for(N in P=P||{},E=E||{})Object.prototype.hasOwnProperty.call(E,N)&&(Object.prototype.hasOwnProperty.call(P,N)||Qa(N,k,L));for(N in P)Object.prototype.hasOwnProperty.call(P,N)&&(Object.prototype.hasOwnProperty.call(E,N)?ai(E[N],P[N])||(E[N].type==="geojson"&&P[N].type==="geojson"&&ua(E,P,N)?Br(k,{command:"setGeoJSONSourceData",args:[N,P[N].data]}):el(N,P,k,L)):Bn(N,P,k))})(u.sources,a.sources,b,f);const T=[];u.layers&&u.layers.forEach(E=>{"source"in E&&f[E.source]?h.push({command:"removeLayer",args:[E.id]}):T.push(E)}),h=h.concat(b),function(E,P,k){P=P||[];const L=(E=E||[]).map(ks),N=P.map(ks),F=E.reduce(Gl,{}),G=P.reduce(Gl,{}),Z=L.slice(),J=Object.create(null);let Q,oe,ue,Te,de;for(let we=0,Ne=0;we<L.length;we++)Q=L[we],Object.prototype.hasOwnProperty.call(G,Q)?Ne++:(Br(k,{command:"removeLayer",args:[Q]}),Z.splice(Z.indexOf(Q,Ne),1));for(let we=0,Ne=0;we<N.length;we++)Q=N[N.length-1-we],Z[Z.length-1-we]!==Q&&(Object.prototype.hasOwnProperty.call(F,Q)?(Br(k,{command:"removeLayer",args:[Q]}),Z.splice(Z.lastIndexOf(Q,Z.length-Ne),1)):Ne++,Te=Z[Z.length-we],Br(k,{command:"addLayer",args:[G[Q],Te]}),Z.splice(Z.length-we,0,Q),J[Q]=!0);for(let we=0;we<N.length;we++)if(Q=N[we],oe=F[Q],ue=G[Q],!J[Q]&&!ai(oe,ue))if(ai(oe.source,ue.source)&&ai(oe["source-layer"],ue["source-layer"])&&ai(oe.type,ue.type)){for(de in Ao(oe.layout,ue.layout,k,Q,null,"setLayoutProperty"),Ao(oe.paint,ue.paint,k,Q,null,"setPaintProperty"),ai(oe.filter,ue.filter)||Br(k,{command:"setFilter",args:[Q,ue.filter]}),ai(oe.minzoom,ue.minzoom)&&ai(oe.maxzoom,ue.maxzoom)||Br(k,{command:"setLayerZoomRange",args:[Q,ue.minzoom,ue.maxzoom]}),oe)Object.prototype.hasOwnProperty.call(oe,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Ao(oe[de],ue[de],k,Q,de.slice(6),"setPaintProperty"):ai(oe[de],ue[de])||Br(k,{command:"setLayerProperty",args:[Q,de,ue[de]]}));for(de in ue)Object.prototype.hasOwnProperty.call(ue,de)&&!Object.prototype.hasOwnProperty.call(oe,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Ao(oe[de],ue[de],k,Q,de.slice(6),"setPaintProperty"):ai(oe[de],ue[de])||Br(k,{command:"setLayerProperty",args:[Q,de,ue[de]]}))}else Br(k,{command:"removeLayer",args:[Q]}),Te=Z[Z.lastIndexOf(Q)+1],Br(k,{command:"addLayer",args:[ue,Te]})}(T,a.layers,h)}catch(f){console.warn("Unable to compute style diff:",f),h=[{command:"setStyle",args:[a]}]}return h},c.aC=function(u){const a=[],h=u.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},c.aD=function u(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let f=0;f<a.length;f++)if(!u(a[f],h[f]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(const f in a)if(!u(a[f],h[f]))return!1;return!0}return a===h},c.aE=et,c.aF=at,c.aG=class extends ji{constructor(u,a){super(u,a),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},c.aH=_s,c.aI=class extends ji{constructor(u,a){super(u,a),this.current=ic}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let a=1;a<16;a++)if(u[a]!==this.current[a]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},c.aJ=no,c.aK=class extends ji{constructor(u,a){super(u,a),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},c.aL=class extends ji{constructor(u,a){super(u,a),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},c.aM=Oo,c.aN=function(u,a,h,f,b,T,E){var P=1/(a-h),k=1/(f-b),L=1/(T-E);return u[0]=-2*P,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*k,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*L,u[11]=0,u[12]=(a+h)*P,u[13]=(b+f)*k,u[14]=(E+T)*L,u[15]=1,u},c.aO=Ei,c.aP=sj,c.aQ=class extends Zh{},c.aR=Xj,c.aS=class extends au{},c.aT=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},c.aU=SP,c.aV=B,c.aW=class extends Ly{},c.aX=Ce,c.aY=function(u,a){return u[0]===a[0]&&u[1]===a[1]&&u[2]===a[2]&&u[3]===a[3]&&u[4]===a[4]&&u[5]===a[5]&&u[6]===a[6]&&u[7]===a[7]&&u[8]===a[8]&&u[9]===a[9]&&u[10]===a[10]&&u[11]===a[11]&&u[12]===a[12]&&u[13]===a[13]&&u[14]===a[14]&&u[15]===a[15]},c.aZ=function(u,a){var h=u[0],f=u[1],b=u[2],T=u[3],E=u[4],P=u[5],k=u[6],L=u[7],N=u[8],F=u[9],G=u[10],Z=u[11],J=u[12],Q=u[13],oe=u[14],ue=u[15],Te=a[0],de=a[1],we=a[2],Ne=a[3],ze=a[4],lt=a[5],vt=a[6],ot=a[7],st=a[8],Qe=a[9],mt=a[10],it=a[11],We=a[12],Et=a[13],bt=a[14],si=a[15];return Math.abs(h-Te)<=en*Math.max(1,Math.abs(h),Math.abs(Te))&&Math.abs(f-de)<=en*Math.max(1,Math.abs(f),Math.abs(de))&&Math.abs(b-we)<=en*Math.max(1,Math.abs(b),Math.abs(we))&&Math.abs(T-Ne)<=en*Math.max(1,Math.abs(T),Math.abs(Ne))&&Math.abs(E-ze)<=en*Math.max(1,Math.abs(E),Math.abs(ze))&&Math.abs(P-lt)<=en*Math.max(1,Math.abs(P),Math.abs(lt))&&Math.abs(k-vt)<=en*Math.max(1,Math.abs(k),Math.abs(vt))&&Math.abs(L-ot)<=en*Math.max(1,Math.abs(L),Math.abs(ot))&&Math.abs(N-st)<=en*Math.max(1,Math.abs(N),Math.abs(st))&&Math.abs(F-Qe)<=en*Math.max(1,Math.abs(F),Math.abs(Qe))&&Math.abs(G-mt)<=en*Math.max(1,Math.abs(G),Math.abs(mt))&&Math.abs(Z-it)<=en*Math.max(1,Math.abs(Z),Math.abs(it))&&Math.abs(J-We)<=en*Math.max(1,Math.abs(J),Math.abs(We))&&Math.abs(Q-Et)<=en*Math.max(1,Math.abs(Q),Math.abs(Et))&&Math.abs(oe-bt)<=en*Math.max(1,Math.abs(oe),Math.abs(bt))&&Math.abs(ue-si)<=en*Math.max(1,Math.abs(ue),Math.abs(si))},c.a_=function(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},c.aa=function(u){const a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,f,b,T)=>{const E=b||T;return a[f]=!E||E.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},c.ab=function(u,a){const h=[];for(const f in u)f in a||h.push(f);return h},c.ac=Me,c.ad=function(u,a,h){var f=Math.sin(h),b=Math.cos(h),T=a[0],E=a[1],P=a[2],k=a[3],L=a[4],N=a[5],F=a[6],G=a[7];return a!==u&&(u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=T*b+L*f,u[1]=E*b+N*f,u[2]=P*b+F*f,u[3]=k*b+G*f,u[4]=L*b-T*f,u[5]=N*b-E*f,u[6]=F*b-P*f,u[7]=G*b-k*f,u},c.ae=function(u){var a=new uf(16);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5],a[6]=u[6],a[7]=u[7],a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},c.af=T1,c.ag=function(u,a){let h=0,f=0;if(u.kind==="constant")f=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:b,minZoom:T,maxZoom:E}=u,P=b?Me(Ds.interpolationFactor(b,a,T,E),0,1):0;u.kind==="camera"?f=gn.number(u.minSize,u.maxSize,P):h=P}return{uSizeT:h,uSize:f}},c.ai=function(u,{uSize:a,uSizeT:h},{lowerSize:f,upperSize:b}){return u.kind==="source"?f/nl:u.kind==="composite"?gn.number(f/nl,b/nl,h):a},c.aj=V2,c.ak=function(u,a,h,f){const b=a.y-u.y,T=a.x-u.x,E=f.y-h.y,P=f.x-h.x,k=E*T-P*b;if(k===0)return null;const L=(P*(u.y-h.y)-E*(u.x-h.x))/k;return new M(u.x+L*T,u.y+L*b)},c.al=TC,c.am=oc,c.an=x2,c.ao=Vr,c.aq=j2,c.ar=function(u,a){var h=a[0],f=a[1],b=a[2],T=a[3],E=a[4],P=a[5],k=a[6],L=a[7],N=a[8],F=a[9],G=a[10],Z=a[11],J=a[12],Q=a[13],oe=a[14],ue=a[15],Te=h*P-f*E,de=h*k-b*E,we=h*L-T*E,Ne=f*k-b*P,ze=f*L-T*P,lt=b*L-T*k,vt=N*Q-F*J,ot=N*oe-G*J,st=N*ue-Z*J,Qe=F*oe-G*Q,mt=F*ue-Z*Q,it=G*ue-Z*oe,We=Te*it-de*mt+we*Qe+Ne*st-ze*ot+lt*vt;return We?(u[0]=(P*it-k*mt+L*Qe)*(We=1/We),u[1]=(b*mt-f*it-T*Qe)*We,u[2]=(Q*lt-oe*ze+ue*Ne)*We,u[3]=(G*ze-F*lt-Z*Ne)*We,u[4]=(k*st-E*it-L*ot)*We,u[5]=(h*it-b*st+T*ot)*We,u[6]=(oe*we-J*lt-ue*de)*We,u[7]=(N*lt-G*we+Z*de)*We,u[8]=(E*mt-P*st+L*vt)*We,u[9]=(f*st-h*mt-T*vt)*We,u[10]=(J*ze-Q*we+ue*Te)*We,u[11]=(F*we-N*ze-Z*Te)*We,u[12]=(P*ot-E*Qe-k*vt)*We,u[13]=(h*Qe-f*ot+b*vt)*We,u[14]=(Q*de-J*Ne-oe*Te)*We,u[15]=(N*Ne-F*de+G*Te)*We,u):null},c.as=K2,c.at=U2,c.au=X2,c.av=function(){const u={},a=Oe.$version;for(const h in Oe.$root){const f=Oe.$root[h];if(f.required){let b=null;b=h==="version"?a:f.type==="array"?[]:{},b!=null&&(u[h]=b)}}return u},c.aw=wy,c.ax=Ke,c.ay=function(u){u=u.slice();const a=Object.create(null);for(let h=0;h<u.length;h++)a[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=Vl(u[h],a[u[h].ref]));return u},c.az=function(u){if(u.type==="custom")return new SV(u);switch(u.type){case"background":return new bV(u);case"circle":return new nj(u);case"fill":return new Ej(u);case"fill-extrusion":return new Bj(u);case"heatmap":return new aj(u);case"hillshade":return new cj(u);case"line":return new Zj(u);case"raster":return new xV(u);case"symbol":return new O1(u)}},c.b=Ft,c.b0=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]+u[3]*a[3]},c.b1=$e,c.b2=gC,c.b3=mC,c.b4=function(u,a,h,f,b){var T,E=1/Math.tan(a/2);return u[0]=E/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=E,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,b!=null&&b!==1/0?(u[10]=(b+f)*(T=1/(f-b)),u[14]=2*b*f*T):(u[10]=-1,u[14]=-2*f),u},c.b5=function(u,a,h){var f=Math.sin(h),b=Math.cos(h),T=a[4],E=a[5],P=a[6],k=a[7],L=a[8],N=a[9],F=a[10],G=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=T*b+L*f,u[5]=E*b+N*f,u[6]=P*b+F*f,u[7]=k*b+G*f,u[8]=L*b-T*f,u[9]=N*b-E*f,u[10]=F*b-P*f,u[11]=G*b-k*f,u},c.b6=pe,c.b7=_e,c.b8=function(u){return u*Math.PI/180},c.b9=function(u,a){return u[0]=a[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=a[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=a[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},c.bA=Ql,c.ba=class extends rf{},c.bb=W2,c.bc=OV,c.be=ms,c.bf=function(u,a){Zs.REGISTERED_PROTOCOLS[u]=a},c.bg=function(u){delete Zs.REGISTERED_PROTOCOLS[u]},c.bh=function(u,a){const h={};for(let b=0;b<u.length;b++){const T=a&&a[u[b].id]||v2(u[b]);a&&(a[u[b].id]=T);let E=h[T];E||(E=h[T]=[]),E.push(u[b])}const f=[];for(const b in h)f.push(h[b]);return f},c.bi=pt,c.bj=vC,c.bk=wC,c.bl=QP,c.bm=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=li/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const a=u.bucket.layers[0],h=a.layout,f=a._unevaluatedLayout._values,b={layoutIconSize:f["icon-size"].possiblyEvaluate(new Zi(u.bucket.zoom+1),u.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new Zi(u.bucket.zoom+1),u.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new Zi(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=u.bucket.textSizeData;b.compositeTextSizes=[f["text-size"].possiblyEvaluate(new Zi(L),u.canonical),f["text-size"].possiblyEvaluate(new Zi(N),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=u.bucket.iconSizeData;b.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new Zi(L),u.canonical),f["icon-size"].possiblyEvaluate(new Zi(N),u.canonical)]}const T=h.get("text-line-height")*Vr,E=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",P=h.get("text-keep-upright"),k=h.get("text-size");for(const L of u.bucket.features){const N=h.get("text-font").evaluate(L,{},u.canonical).join(","),F=k.evaluate(L,{},u.canonical),G=b.layoutTextSize.evaluate(L,{},u.canonical),Z=b.layoutIconSize.evaluate(L,{},u.canonical),J={horizontal:{},vertical:void 0},Q=L.text;let oe,ue=[0,0];if(Q){const we=Q.toString(),Ne=h.get("text-letter-spacing").evaluate(L,{},u.canonical)*Vr,ze=Xp(we)?Ne:0,lt=h.get("text-anchor").evaluate(L,{},u.canonical),vt=RC(a,L,u.canonical);if(!vt){const it=h.get("text-radial-offset").evaluate(L,{},u.canonical);ue=it?kC(lt,[it*Vr,J2]):h.get("text-offset").evaluate(L,{},u.canonical).map(We=>We*Vr)}let ot=E?"center":h.get("text-justify").evaluate(L,{},u.canonical);const st=h.get("symbol-placement"),Qe=st==="point"?h.get("text-max-width").evaluate(L,{},u.canonical)*Vr:0,mt=()=>{u.bucket.allowVerticalPlacement&&Vh(we)&&(J.vertical=$1(Q,u.glyphMap,u.glyphPositions,u.imagePositions,N,Qe,T,lt,"left",ze,ue,c.ah.vertical,!0,st,G,F))};if(!E&&vt){const it=new Set;if(ot==="auto")for(let Et=0;Et<vt.values.length;Et+=2)it.add(K2(vt.values[Et]));else it.add(ot);let We=!1;for(const Et of it)if(!J.horizontal[Et])if(We)J.horizontal[Et]=J.horizontal[0];else{const bt=$1(Q,u.glyphMap,u.glyphPositions,u.imagePositions,N,Qe,T,"center",Et,ze,ue,c.ah.horizontal,!1,st,G,F);bt&&(J.horizontal[Et]=bt,We=bt.positionedLines.length===1)}mt()}else{ot==="auto"&&(ot=K2(lt));const it=$1(Q,u.glyphMap,u.glyphPositions,u.imagePositions,N,Qe,T,lt,ot,ze,ue,c.ah.horizontal,!1,st,G,F);it&&(J.horizontal[ot]=it),mt(),Vh(we)&&E&&P&&(J.vertical=$1(Q,u.glyphMap,u.glyphPositions,u.imagePositions,N,Qe,T,lt,ot,ze,ue,c.ah.vertical,!1,st,G,F))}}let Te=!1;if(L.icon&&L.icon.name){const we=u.imageMap[L.icon.name];we&&(oe=mV(u.imagePositions[L.icon.name],h.get("icon-offset").evaluate(L,{},u.canonical),h.get("icon-anchor").evaluate(L,{},u.canonical)),Te=!!we.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Te:u.bucket.sdfIcons!==Te&&Pt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(we.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const de=LC(J.horizontal)||J.vertical;u.bucket.iconsInText=!!de&&de.iconsInText,(de||oe)&&kV(u.bucket,L,J,oe,u.imageMap,b,G,Z,ue,Te,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},c.bn=L2,c.bo=k2,c.bp=O2,c.bq=uu,c.br=N2,c.bs=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},c.bt=function(u,a,h,f,b){return o(this,void 0,void 0,function*(){if(ve())try{return yield Fr(u,a,h,f,b)}catch{}return function(T,E,P,k,L){const N=T.width,F=T.height;Cr&&_r||(Cr=new OffscreenCanvas(N,F),_r=Cr.getContext("2d",{willReadFrequently:!0})),Cr.width=N,Cr.height=F,_r.drawImage(T,0,0,N,F);const G=_r.getImageData(E,P,k,L);return _r.clearRect(0,0,N,F),G.data}(u,a,h,f,b)})},c.bu=_C,c.bv=p,c.bw=g,c.bx=GP,c.by=Ni,c.bz=function(u){return u.message===Cs},c.c=fs,c.d=u=>o(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const a=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(a)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.e=Fe,c.f=u=>new Promise((a,h)=>{const f=new Image;f.onload=()=>{a(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Hi})},f.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const b=new Blob([new Uint8Array(u)],{type:"image/png"});f.src=u.byteLength?URL.createObjectURL(b):Hi}),c.g=yn,c.h=(u,a)=>oi(Fe(u,{type:"json"}),a),c.i=Li,c.j=vr,c.k=Mo,c.l=(u,a)=>oi(Fe(u,{type:"arrayBuffer"}),a),c.m=oi,c.n=function(u){return new N2(u).readFields(cV,[])},c.o=Vy,c.p=XP,c.q=Xs,c.r=_y,c.s=Di,c.t=u1,c.u=ut,c.v=Oe,c.w=Pt,c.x=su,c.y=function([u,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:u*Math.cos(a)*Math.sin(h),y:u*Math.sin(a)*Math.sin(h),z:u*Math.cos(h)}},c.z=gn}),s("worker",["./shared"],function(c){class o{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,H){for(const te of j){this._layerConfigs[te.id]=te;const ye=this._layers[te.id]=c.az(te);ye._featureFilter=c.a6(ye.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of H)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const K=c.bh(Object.values(this._layerConfigs),this.keyCache);for(const te of K){const ye=te.map(ee=>this._layers[ee.id]),ge=ye[0];if(ge.visibility==="none")continue;const Se=ge.source||"";let he=this.familiesBySource[Se];he||(he=this.familiesBySource[Se]={});const Ie=ge.sourceLayer||"_geojsonTileLayer";let Be=he[Ie];Be||(Be=he[Ie]=[]),Be.push(ye)}}}class p{constructor(j){const H={},K=[];for(const Se in j){const he=j[Se],Ie=H[Se]={};for(const Be in he){const ee=he[+Be];if(!ee||ee.bitmap.width===0||ee.bitmap.height===0)continue;const ke={x:0,y:0,w:ee.bitmap.width+2,h:ee.bitmap.height+2};K.push(ke),Ie[Be]={rect:ke,metrics:ee.metrics}}}const{w:te,h:ye}=c.p(K),ge=new c.o({width:te||1,height:ye||1});for(const Se in j){const he=j[Se];for(const Ie in he){const Be=he[+Ie];if(!Be||Be.bitmap.width===0||Be.bitmap.height===0)continue;const ee=H[Se][Ie].rect;c.o.copy(Be.bitmap,ge,{x:0,y:0},{x:ee.x+1,y:ee.y+1},Be.bitmap)}}this.image=ge,this.positions=H}}c.bi("GlyphAtlas",p);class g{constructor(j){this.tileID=new c.Q(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId,this.inFlightDependencies=[]}parse(j,H,K,te){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=j,this.collisionBoxArray=new c.a4;const ye=new c.bj(Object.keys(j.layers).sort()),ge=new c.bk(this.tileID,this.promoteId);ge.bucketLayerIDs=[];const Se={},he={featureIndex:ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Ie=H.familiesBySource[this.source];for(const kt in Ie){const Wi=j.layers[kt];if(!Wi)continue;Wi.version===1&&c.w(`Vector tile source "${this.source}" layer "${kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const br=ye.encode(kt),Mt=[];for(let Xr=0;Xr<Wi.length;Xr++){const Qr=Wi.feature(Xr),Os=ge.getId(Qr,kt);Mt.push({feature:Qr,id:Os,index:Xr,sourceLayerIndex:br})}for(const Xr of Ie[kt]){const Qr=Xr[0];Qr.source!==this.source&&c.w(`layer.source = ${Qr.source} does not equal this.source = ${this.source}`),Qr.minzoom&&this.zoom<Math.floor(Qr.minzoom)||Qr.maxzoom&&this.zoom>=Qr.maxzoom||Qr.visibility!=="none"&&(S(Xr,this.zoom,K),(Se[Qr.id]=Qr.createBucket({index:ge.bucketLayerIDs.length,layers:Xr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:br,sourceID:this.source})).populate(Mt,he,this.tileID.canonical),ge.bucketLayerIDs.push(Xr.map(Os=>Os.id)))}}const Be=c.aE(he.glyphDependencies,kt=>Object.keys(kt).map(Number));this.inFlightDependencies.forEach(kt=>kt==null?void 0:kt.abort()),this.inFlightDependencies=[];let ee=Promise.resolve({});if(Object.keys(Be).length){const kt=new AbortController;this.inFlightDependencies.push(kt),ee=te.sendAsync({type:"getGlyphs",data:{stacks:Be,source:this.source,tileID:this.tileID,type:"glyphs"}},kt)}const ke=Object.keys(he.iconDependencies);let gt=Promise.resolve({});if(ke.length){const kt=new AbortController;this.inFlightDependencies.push(kt),gt=te.sendAsync({type:"getImages",data:{icons:ke,source:this.source,tileID:this.tileID,type:"icons"}},kt)}const xt=Object.keys(he.patternDependencies);let It=Promise.resolve({});if(xt.length){const kt=new AbortController;this.inFlightDependencies.push(kt),It=te.sendAsync({type:"getImages",data:{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"}},kt)}const[Ze,Dt,Xt]=yield Promise.all([ee,gt,It]),wi=new p(Ze),or=new c.bl(Dt,Xt);for(const kt in Se){const Wi=Se[kt];Wi instanceof c.a5?(S(Wi.layers,this.zoom,K),c.bm({bucket:Wi,glyphMap:Ze,glyphPositions:wi.positions,imageMap:Dt,imagePositions:or.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wi.hasPattern&&(Wi instanceof c.bn||Wi instanceof c.bo||Wi instanceof c.bp)&&(S(Wi.layers,this.zoom,K),Wi.addFeatures(he,this.tileID.canonical,or.patternPositions))}return this.status="done",{buckets:Object.values(Se).filter(kt=>!kt.isEmpty()),featureIndex:ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wi.image,imageAtlas:or,glyphMap:this.returnDependencies?Ze:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?wi.positions:null}})}}function S(se,j,H){const K=new c.a8(j);for(const te of se)te.recalculate(K,H)}class M{constructor(j,H,K){this.actor=j,this.layerIndex=H,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(j,H){return c._(this,void 0,void 0,function*(){const K=yield c.l(j.request,H);try{return{vectorTile:new c.bq.VectorTile(new c.br(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(te){const ye=new Uint8Array(K.data);let ge=`Unable to parse the tile at ${j.request.url}, `;throw ge+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.messge}`,new Error(ge)}})}loadTile(j){return c._(this,void 0,void 0,function*(){const H=j.uid,K=!!(j&&j.request&&j.request.collectResourceTiming)&&new c.bs(j.request),te=new g(j);this.loading[H]=te;const ye=new AbortController;te.abort=ye;try{const ge=yield this.loadVectorTile(j,ye);if(delete this.loading[H],!ge)return null;const Se=ge.rawData,he={};ge.expires&&(he.expires=ge.expires),ge.cacheControl&&(he.cacheControl=ge.cacheControl);const Ie={};if(K){const ee=K.finish();ee&&(Ie.resourceTiming=JSON.parse(JSON.stringify(ee)))}te.vectorTile=ge.vectorTile;const Be=te.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[H]=te,this.fetching[H]={rawTileData:Se,cacheControl:he,resourceTiming:Ie};try{const ee=yield Be;return c.e({rawTileData:Se.slice(0)},ee,he,Ie)}finally{delete this.fetching[H]}}catch(ge){throw delete this.loading[H],te.status="done",this.loaded[H]=te,ge}})}reloadTile(j){return c._(this,void 0,void 0,function*(){const H=j.uid;if(!this.loaded||!this.loaded[H])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[H];if(K.showCollisionBoxes=j.showCollisionBoxes,K.status==="parsing"){const te=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor);let ye;if(this.fetching[H]){const{rawTileData:ge,cacheControl:Se,resourceTiming:he}=this.fetching[H];delete this.fetching[H],ye=c.e({rawTileData:ge.slice(0)},te,Se,he)}else ye=te;return ye}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(j){return c._(this,void 0,void 0,function*(){const H=this.loading,K=j.uid;H&&H[K]&&H[K].abort&&(H[K].abort.abort(),delete H[K])})}removeTile(j){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[j.uid]&&delete this.loaded[j.uid]})}}class A{constructor(){this.loaded={}}loadTile(j){return c._(this,void 0,void 0,function*(){const{uid:H,encoding:K,rawImageData:te,redFactor:ye,greenFactor:ge,blueFactor:Se,baseShift:he}=j,Ie=te.width+2,Be=te.height+2,ee=c.b(te)?new c.R({width:Ie,height:Be},yield c.bt(te,-1,-1,Ie,Be)):te,ke=new c.bu(H,ee,K,ye,ge,Se,he);return this.loaded=this.loaded||{},this.loaded[H]=ke,ke})}removeTile(j){const H=this.loaded,K=j.uid;H&&H[K]&&delete H[K]}}function O(se,j){if(se.length!==0){z(se[0],j);for(var H=1;H<se.length;H++)z(se[H],!j)}}function z(se,j){for(var H=0,K=0,te=0,ye=se.length,ge=ye-1;te<ye;ge=te++){var Se=(se[te][0]-se[ge][0])*(se[ge][1]+se[te][1]),he=H+Se;K+=Math.abs(H)>=Math.abs(Se)?H-he+Se:Se-he+H,H=he}H+K>=0!=!!j&&se.reverse()}var V=c.bv(function se(j,H){var K,te=j&&j.type;if(te==="FeatureCollection")for(K=0;K<j.features.length;K++)se(j.features[K],H);else if(te==="GeometryCollection")for(K=0;K<j.geometries.length;K++)se(j.geometries[K],H);else if(te==="Feature")se(j.geometry,H);else if(te==="Polygon")O(j.coordinates,H);else if(te==="MultiPolygon")for(K=0;K<j.coordinates.length;K++)O(j.coordinates[K],H);return j});const W=c.bq.VectorTileFeature.prototype.toGeoJSON;var ie={exports:{}},ve=c.bw,pe=c.bq.VectorTileFeature,_e=Me;function Me(se,j){this.options=j||{},this.features=se,this.length=se.length}function $e(se,j){this.id=typeof se.id=="number"?se.id:void 0,this.type=se.type,this.rawGeometry=se.type===1?[se.geometry]:se.geometry,this.properties=se.tags,this.extent=j||4096}Me.prototype.feature=function(se){return new $e(this.features[se],this.options.extent)},$e.prototype.loadGeometry=function(){var se=this.rawGeometry;this.geometry=[];for(var j=0;j<se.length;j++){for(var H=se[j],K=[],te=0;te<H.length;te++)K.push(new ve(H[te][0],H[te][1]));this.geometry.push(K)}return this.geometry},$e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var se=this.geometry,j=1/0,H=-1/0,K=1/0,te=-1/0,ye=0;ye<se.length;ye++)for(var ge=se[ye],Se=0;Se<ge.length;Se++){var he=ge[Se];j=Math.min(j,he.x),H=Math.max(H,he.x),K=Math.min(K,he.y),te=Math.max(te,he.y)}return[j,K,H,te]},$e.prototype.toGeoJSON=pe.prototype.toGeoJSON;var Fe=c.bx,Ge=_e;function et(se){var j=new Fe;return function(H,K){for(var te in H.layers)K.writeMessage(3,at,H.layers[te])}(se,j),j.finish()}function at(se,j){var H;j.writeVarintField(15,se.version||1),j.writeStringField(1,se.name||""),j.writeVarintField(5,se.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<se.length;H++)K.feature=se.feature(H),j.writeMessage(2,ct,K);var te=K.keys;for(H=0;H<te.length;H++)j.writeStringField(3,te[H]);var ye=K.values;for(H=0;H<ye.length;H++)j.writeMessage(4,Li,ye[H])}function ct(se,j){var H=se.feature;H.id!==void 0&&j.writeVarintField(1,H.id),j.writeMessage(2,nt,se),j.writeVarintField(3,H.type),j.writeMessage(4,vi,H)}function nt(se,j){var H=se.feature,K=se.keys,te=se.values,ye=se.keycache,ge=se.valuecache;for(var Se in H.properties){var he=H.properties[Se],Ie=ye[Se];if(he!==null){Ie===void 0&&(K.push(Se),ye[Se]=Ie=K.length-1),j.writeVarint(Ie);var Be=typeof he;Be!=="string"&&Be!=="boolean"&&Be!=="number"&&(he=JSON.stringify(he));var ee=Be+":"+he,ke=ge[ee];ke===void 0&&(te.push(he),ge[ee]=ke=te.length-1),j.writeVarint(ke)}}}function Pt(se,j){return(j<<3)+(7&se)}function ft(se){return se<<1^se>>31}function vi(se,j){for(var H=se.loadGeometry(),K=se.type,te=0,ye=0,ge=H.length,Se=0;Se<ge;Se++){var he=H[Se],Ie=1;K===1&&(Ie=he.length),j.writeVarint(Pt(1,Ie));for(var Be=K===3?he.length-1:he.length,ee=0;ee<Be;ee++){ee===1&&K!==1&&j.writeVarint(Pt(2,Be-1));var ke=he[ee].x-te,gt=he[ee].y-ye;j.writeVarint(ft(ke)),j.writeVarint(ft(gt)),te+=ke,ye+=gt}K===3&&j.writeVarint(Pt(7,1))}}function Li(se,j){var H=typeof se;H==="string"?j.writeStringField(1,se):H==="boolean"?j.writeBooleanField(7,se):H==="number"&&(se%1!=0?j.writeDoubleField(3,se):se<0?j.writeSVarintField(6,se):j.writeVarintField(5,se))}ie.exports=et,ie.exports.fromVectorTileJs=et,ie.exports.fromGeojsonVt=function(se,j){j=j||{};var H={};for(var K in se)H[K]=new Ge(se[K].features,j),H[K].name=K,H[K].version=j.version,H[K].extent=j.extent;return et({layers:H})},ie.exports.GeoJSONWrapper=Ge;var Tt=c.bv(ie.exports);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:se=>se},Hi=Math.fround||(Fr=new Float32Array(1),se=>(Fr[0]=+se,Fr[0]));var Fr;const Cr=3,_r=5,Cs=6;class fs{constructor(j){this.options=Object.assign(Object.create(Ft),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:H,minZoom:K,maxZoom:te}=this.options;H&&console.time("total time");const ye=`prepare ${j.length} points`;H&&console.time(ye),this.points=j;const ge=[];for(let he=0;he<j.length;he++){const Ie=j[he];if(!Ie.geometry)continue;const[Be,ee]=Ie.geometry.coordinates,ke=Hi(Kr(Be)),gt=Hi(ms(ee));ge.push(ke,gt,1/0,he,-1,1),this.options.reduce&&ge.push(0)}let Se=this.trees[te+1]=this._createTree(ge);H&&console.timeEnd(ye);for(let he=te;he>=K;he--){const Ie=+Date.now();Se=this.trees[he]=this._createTree(this._cluster(Se,he)),H&&console.log("z%d: %d clusters in %dms",he,Se.numItems,+Date.now()-Ie)}return H&&console.timeEnd("total time"),this}getClusters(j,H){let K=((j[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,j[1]));let ye=j[2]===180?180:((j[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)K=-180,ye=180;else if(K>ye){const ee=this.getClusters([K,te,180,ge],H),ke=this.getClusters([-180,te,ye,ge],H);return ee.concat(ke)}const Se=this.trees[this._limitZoom(H)],he=Se.range(Kr(K),ms(ge),Kr(ye),ms(te)),Ie=Se.data,Be=[];for(const ee of he){const ke=this.stride*ee;Be.push(Ie[ke+_r]>1?Zs(Ie,ke,this.clusterProps):this.points[Ie[ke+Cr]])}return Be}getChildren(j){const H=this._getOriginId(j),K=this._getOriginZoom(j),te="No cluster with the specified id.",ye=this.trees[K];if(!ye)throw new Error(te);const ge=ye.data;if(H*this.stride>=ge.length)throw new Error(te);const Se=this.options.radius/(this.options.extent*Math.pow(2,K-1)),he=ye.within(ge[H*this.stride],ge[H*this.stride+1],Se),Ie=[];for(const Be of he){const ee=Be*this.stride;ge[ee+4]===j&&Ie.push(ge[ee+_r]>1?Zs(ge,ee,this.clusterProps):this.points[ge[ee+Cr]])}if(Ie.length===0)throw new Error(te);return Ie}getLeaves(j,H,K){const te=[];return this._appendLeaves(te,j,H=H||10,K=K||0,0),te}getTile(j,H,K){const te=this.trees[this._limitZoom(j)],ye=Math.pow(2,j),{extent:ge,radius:Se}=this.options,he=Se/ge,Ie=(K-he)/ye,Be=(K+1+he)/ye,ee={features:[]};return this._addTileFeatures(te.range((H-he)/ye,Ie,(H+1+he)/ye,Be),te.data,H,K,ye,ee),H===0&&this._addTileFeatures(te.range(1-he/ye,Ie,1,Be),te.data,ye,K,ye,ee),H===ye-1&&this._addTileFeatures(te.range(0,Ie,he/ye,Be),te.data,-1,K,ye,ee),ee.features.length?ee:null}getClusterExpansionZoom(j){let H=this._getOriginZoom(j)-1;for(;H<=this.options.maxZoom;){const K=this.getChildren(j);if(H++,K.length!==1)break;j=K[0].properties.cluster_id}return H}_appendLeaves(j,H,K,te,ye){const ge=this.getChildren(H);for(const Se of ge){const he=Se.properties;if(he&&he.cluster?ye+he.point_count<=te?ye+=he.point_count:ye=this._appendLeaves(j,he.cluster_id,K,te,ye):ye<te?ye++:j.push(Se),j.length===K)break}return ye}_createTree(j){const H=new c.au(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<j.length;K+=this.stride)H.add(j[K],j[K+1]);return H.finish(),H.data=j,H}_addTileFeatures(j,H,K,te,ye,ge){for(const Se of j){const he=Se*this.stride,Ie=H[he+_r]>1;let Be,ee,ke;if(Ie)Be=yn(H,he,this.clusterProps),ee=H[he],ke=H[he+1];else{const It=this.points[H[he+Cr]];Be=It.properties;const[Ze,Dt]=It.geometry.coordinates;ee=Kr(Ze),ke=ms(Dt)}const gt={type:1,geometry:[[Math.round(this.options.extent*(ee*ye-K)),Math.round(this.options.extent*(ke*ye-te))]],tags:Be};let xt;xt=Ie||this.options.generateId?H[he+Cr]:this.points[H[he+Cr]].id,xt!==void 0&&(gt.id=xt),ge.features.push(gt)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,H){const{radius:K,extent:te,reduce:ye,minPoints:ge}=this.options,Se=K/(te*Math.pow(2,H)),he=j.data,Ie=[],Be=this.stride;for(let ee=0;ee<he.length;ee+=Be){if(he[ee+2]<=H)continue;he[ee+2]=H;const ke=he[ee],gt=he[ee+1],xt=j.within(he[ee],he[ee+1],Se),It=he[ee+_r];let Ze=It;for(const Dt of xt){const Xt=Dt*Be;he[Xt+2]>H&&(Ze+=he[Xt+_r])}if(Ze>It&&Ze>=ge){let Dt,Xt=ke*It,wi=gt*It,or=-1;const kt=((ee/Be|0)<<5)+(H+1)+this.points.length;for(const Wi of xt){const br=Wi*Be;if(he[br+2]<=H)continue;he[br+2]=H;const Mt=he[br+_r];Xt+=he[br]*Mt,wi+=he[br+1]*Mt,he[br+4]=kt,ye&&(Dt||(Dt=this._map(he,ee,!0),or=this.clusterProps.length,this.clusterProps.push(Dt)),ye(Dt,this._map(he,br)))}he[ee+4]=kt,Ie.push(Xt/Ze,wi/Ze,1/0,kt,-1,Ze),ye&&Ie.push(or)}else{for(let Dt=0;Dt<Be;Dt++)Ie.push(he[ee+Dt]);if(Ze>1)for(const Dt of xt){const Xt=Dt*Be;if(!(he[Xt+2]<=H)){he[Xt+2]=H;for(let wi=0;wi<Be;wi++)Ie.push(he[Xt+wi])}}}}return Ie}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,H,K){if(j[H+_r]>1){const ge=this.clusterProps[j[H+Cs]];return K?Object.assign({},ge):ge}const te=this.points[j[H+Cr]].properties,ye=this.options.map(te);return K&&ye===te?Object.assign({},ye):ye}}function Zs(se,j,H){return{type:"Feature",id:se[j+Cr],properties:yn(se,j,H),geometry:{type:"Point",coordinates:[(K=se[j],360*(K-.5)),Ke(se[j+1])]}};var K}function yn(se,j,H){const K=se[j+_r],te=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,ye=se[j+Cs],ge=ye===-1?{}:Object.assign({},H[ye]);return Object.assign(ge,{cluster:!0,cluster_id:se[j+Cr],point_count:K,point_count_abbreviated:te})}function Kr(se){return se/360+.5}function ms(se){const j=Math.sin(se*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function Ke(se){const j=(180-360*se)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function oi(se,j,H,K){for(var te,ye=K,ge=H-j>>1,Se=H-j,he=se[j],Ie=se[j+1],Be=se[H],ee=se[H+1],ke=j+3;ke<H;ke+=3){var gt=Di(se[ke],se[ke+1],he,Ie,Be,ee);if(gt>ye)te=ke,ye=gt;else if(gt===ye){var xt=Math.abs(ke-ge);xt<Se&&(te=ke,Se=xt)}}ye>K&&(te-j>3&&oi(se,j,te,K),se[te+2]=ye,H-te>3&&oi(se,te,H,K))}function Di(se,j,H,K,te,ye){var ge=te-H,Se=ye-K;if(ge!==0||Se!==0){var he=((se-H)*ge+(j-K)*Se)/(ge*ge+Se*Se);he>1?(H=te,K=ye):he>0&&(H+=ge*he,K+=Se*he)}return(ge=se-H)*ge+(Se=j-K)*Se}function $s(se,j,H,K){var te={id:se===void 0?null:se,type:j,geometry:H,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ye){var ge=ye.geometry,Se=ye.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")Io(ye,ge);else if(Se==="Polygon"||Se==="MultiLineString")for(var he=0;he<ge.length;he++)Io(ye,ge[he]);else if(Se==="MultiPolygon")for(he=0;he<ge.length;he++)for(var Ie=0;Ie<ge[he].length;Ie++)Io(ye,ge[he][Ie])}(te),te}function Io(se,j){for(var H=0;H<j.length;H+=3)se.minX=Math.min(se.minX,j[H]),se.minY=Math.min(se.minY,j[H+1]),se.maxX=Math.max(se.maxX,j[H]),se.maxY=Math.max(se.maxY,j[H+1])}function Mo(se,j,H,K){if(j.geometry){var te=j.geometry.coordinates,ye=j.geometry.type,ge=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),Se=[],he=j.id;if(H.promoteId?he=j.properties[H.promoteId]:H.generateId&&(he=K||0),ye==="Point")vr(te,Se);else if(ye==="MultiPoint")for(var Ie=0;Ie<te.length;Ie++)vr(te[Ie],Se);else if(ye==="LineString")la(te,Se,ge,!1);else if(ye==="MultiLineString"){if(H.lineMetrics){for(Ie=0;Ie<te.length;Ie++)la(te[Ie],Se=[],ge,!1),se.push($s(he,"LineString",Se,j.properties));return}Oe(te,Se,ge,!1)}else if(ye==="Polygon")Oe(te,Se,ge,!0);else{if(ye!=="MultiPolygon"){if(ye==="GeometryCollection"){for(Ie=0;Ie<j.geometry.geometries.length;Ie++)Mo(se,{id:he,geometry:j.geometry.geometries[Ie],properties:j.properties},H,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<te.length;Ie++){var Be=[];Oe(te[Ie],Be,ge,!0),Se.push(Be)}}se.push($s(he,ye,Se,j.properties))}}function vr(se,j){j.push(ca(se[0])),j.push(Vl(se[1])),j.push(0)}function la(se,j,H,K){for(var te,ye,ge=0,Se=0;Se<se.length;Se++){var he=ca(se[Se][0]),Ie=Vl(se[Se][1]);j.push(he),j.push(Ie),j.push(0),Se>0&&(ge+=K?(te*Ie-he*ye)/2:Math.sqrt(Math.pow(he-te,2)+Math.pow(Ie-ye,2))),te=he,ye=Ie}var Be=j.length-3;j[2]=1,oi(j,0,Be,H),j[Be+2]=1,j.size=Math.abs(ge),j.start=0,j.end=j.size}function Oe(se,j,H,K){for(var te=0;te<se.length;te++){var ye=[];la(se[te],ye,H,K),j.push(ye)}}function ca(se){return se/360+.5}function Vl(se){var j=Math.sin(se*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function ai(se,j,H,K,te,ye,ge,Se){if(K/=j,ye>=(H/=j)&&ge<K)return se;if(ge<H||ye>=K)return null;for(var he=[],Ie=0;Ie<se.length;Ie++){var Be=se[Ie],ee=Be.geometry,ke=Be.type,gt=te===0?Be.minX:Be.minY,xt=te===0?Be.maxX:Be.maxY;if(gt>=H&&xt<K)he.push(Be);else if(!(xt<H||gt>=K)){var It=[];if(ke==="Point"||ke==="MultiPoint")Br(ee,It,H,K,te);else if(ke==="LineString")Bn(ee,It,H,K,te,!1,Se.lineMetrics);else if(ke==="MultiLineString")el(ee,It,H,K,te,!1);else if(ke==="Polygon")el(ee,It,H,K,te,!0);else if(ke==="MultiPolygon")for(var Ze=0;Ze<ee.length;Ze++){var Dt=[];el(ee[Ze],Dt,H,K,te,!0),Dt.length&&It.push(Dt)}if(It.length){if(Se.lineMetrics&&ke==="LineString"){for(Ze=0;Ze<It.length;Ze++)he.push($s(Be.id,ke,It[Ze],Be.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(It.length===1?(ke="LineString",It=It[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=It.length===3?"Point":"MultiPoint"),he.push($s(Be.id,ke,It,Be.tags))}}}return he.length?he:null}function Br(se,j,H,K,te){for(var ye=0;ye<se.length;ye+=3){var ge=se[ye+te];ge>=H&&ge<=K&&(j.push(se[ye]),j.push(se[ye+1]),j.push(se[ye+2]))}}function Bn(se,j,H,K,te,ye,ge){for(var Se,he,Ie=Qa(se),Be=te===0?Ao:ks,ee=se.start,ke=0;ke<se.length-3;ke+=3){var gt=se[ke],xt=se[ke+1],It=se[ke+2],Ze=se[ke+3],Dt=se[ke+4],Xt=te===0?gt:xt,wi=te===0?Ze:Dt,or=!1;ge&&(Se=Math.sqrt(Math.pow(gt-Ze,2)+Math.pow(xt-Dt,2))),Xt<H?wi>H&&(he=Be(Ie,gt,xt,Ze,Dt,H),ge&&(Ie.start=ee+Se*he)):Xt>K?wi<K&&(he=Be(Ie,gt,xt,Ze,Dt,K),ge&&(Ie.start=ee+Se*he)):ua(Ie,gt,xt,It),wi<H&&Xt>=H&&(he=Be(Ie,gt,xt,Ze,Dt,H),or=!0),wi>K&&Xt<=K&&(he=Be(Ie,gt,xt,Ze,Dt,K),or=!0),!ye&&or&&(ge&&(Ie.end=ee+Se*he),j.push(Ie),Ie=Qa(se)),ge&&(ee+=Se)}var kt=se.length-3;gt=se[kt],xt=se[kt+1],It=se[kt+2],(Xt=te===0?gt:xt)>=H&&Xt<=K&&ua(Ie,gt,xt,It),kt=Ie.length-3,ye&&kt>=3&&(Ie[kt]!==Ie[0]||Ie[kt+1]!==Ie[1])&&ua(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&j.push(Ie)}function Qa(se){var j=[];return j.size=se.size,j.start=se.start,j.end=se.end,j}function el(se,j,H,K,te,ye){for(var ge=0;ge<se.length;ge++)Bn(se[ge],j,H,K,te,ye,!1)}function ua(se,j,H,K){se.push(j),se.push(H),se.push(K)}function Ao(se,j,H,K,te,ye){var ge=(ye-j)/(K-j);return se.push(ye),se.push(H+(te-H)*ge),se.push(1),ge}function ks(se,j,H,K,te,ye){var ge=(ye-H)/(te-H);return se.push(j+(K-j)*ge),se.push(ye),se.push(1),ge}function Gl(se,j){for(var H=[],K=0;K<se.length;K++){var te,ye=se[K],ge=ye.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")te=Xe(ye.geometry,j);else if(ge==="MultiLineString"||ge==="Polygon"){te=[];for(var Se=0;Se<ye.geometry.length;Se++)te.push(Xe(ye.geometry[Se],j))}else if(ge==="MultiPolygon")for(te=[],Se=0;Se<ye.geometry.length;Se++){for(var he=[],Ie=0;Ie<ye.geometry[Se].length;Ie++)he.push(Xe(ye.geometry[Se][Ie],j));te.push(he)}H.push($s(ye.id,ge,te,ye.tags))}return H}function Xe(se,j){var H=[];H.size=se.size,se.start!==void 0&&(H.start=se.start,H.end=se.end);for(var K=0;K<se.length;K+=3)H.push(se[K]+j,se[K+1],se[K+2]);return H}function Rs(se,j){if(se.transformed)return se;var H,K,te,ye=1<<se.z,ge=se.x,Se=se.y;for(H=0;H<se.features.length;H++){var he=se.features[H],Ie=he.geometry,Be=he.type;if(he.geometry=[],Be===1)for(K=0;K<Ie.length;K+=2)he.geometry.push(ys(Ie[K],Ie[K+1],j,ye,ge,Se));else for(K=0;K<Ie.length;K++){var ee=[];for(te=0;te<Ie[K].length;te+=2)ee.push(ys(Ie[K][te],Ie[K][te+1],j,ye,ge,Se));he.geometry.push(ee)}}return se.transformed=!0,se}function ys(se,j,H,K,te,ye){return[Math.round(H*(se*K-te)),Math.round(H*(j*K-ye))]}function ql(se,j,H,K,te){for(var ye=j===te.maxZoom?0:te.tolerance/((1<<j)*te.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:K,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Se=0;Se<se.length;Se++){ge.numFeatures++,ha(ge,se[Se],ye,te);var he=se[Se].minX,Ie=se[Se].minY,Be=se[Se].maxX,ee=se[Se].maxY;he<ge.minX&&(ge.minX=he),Ie<ge.minY&&(ge.minY=Ie),Be>ge.maxX&&(ge.maxX=Be),ee>ge.maxY&&(ge.maxY=ee)}return ge}function ha(se,j,H,K){var te=j.geometry,ye=j.type,ge=[];if(ye==="Point"||ye==="MultiPoint")for(var Se=0;Se<te.length;Se+=3)ge.push(te[Se]),ge.push(te[Se+1]),se.numPoints++,se.numSimplified++;else if(ye==="LineString")Ye(ge,te,se,H,!1,!1);else if(ye==="MultiLineString"||ye==="Polygon")for(Se=0;Se<te.length;Se++)Ye(ge,te[Se],se,H,ye==="Polygon",Se===0);else if(ye==="MultiPolygon")for(var he=0;he<te.length;he++){var Ie=te[he];for(Se=0;Se<Ie.length;Se++)Ye(ge,Ie[Se],se,H,!0,Se===0)}if(ge.length){var Be=j.tags||null;if(ye==="LineString"&&K.lineMetrics){for(var ee in Be={},j.tags)Be[ee]=j.tags[ee];Be.mapbox_clip_start=te.start/te.size,Be.mapbox_clip_end=te.end/te.size}var ke={geometry:ge,type:ye==="Polygon"||ye==="MultiPolygon"?3:ye==="LineString"||ye==="MultiLineString"?2:1,tags:Be};j.id!==null&&(ke.id=j.id),se.features.push(ke)}}function Ye(se,j,H,K,te,ye){var ge=K*K;if(K>0&&j.size<(te?ge:K))H.numPoints+=j.length/3;else{for(var Se=[],he=0;he<j.length;he+=3)(K===0||j[he+2]>ge)&&(H.numSimplified++,Se.push(j[he]),Se.push(j[he+1])),H.numPoints++;te&&function(Ie,Be){for(var ee=0,ke=0,gt=Ie.length,xt=gt-2;ke<gt;xt=ke,ke+=2)ee+=(Ie[ke]-Ie[xt])*(Ie[ke+1]+Ie[xt+1]);if(ee>0===Be)for(ke=0,gt=Ie.length;ke<gt/2;ke+=2){var It=Ie[ke],Ze=Ie[ke+1];Ie[ke]=Ie[gt-2-ke],Ie[ke+1]=Ie[gt-1-ke],Ie[gt-2-ke]=It,Ie[gt-1-ke]=Ze}}(Se,ye),se.push(Se)}}function Ht(se,j){var H=(j=this.options=function(te,ye){for(var ge in ye)te[ge]=ye[ge];return te}(Object.create(this.options),j)).debug;if(H&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(te,ye){var ge=[];if(te.type==="FeatureCollection")for(var Se=0;Se<te.features.length;Se++)Mo(ge,te.features[Se],ye,Se);else Mo(ge,te.type==="Feature"?te:{geometry:te},ye);return ge}(se,j);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),K=function(te,ye){var ge=ye.buffer/ye.extent,Se=te,he=ai(te,1,-1-ge,ge,0,-1,2,ye),Ie=ai(te,1,1-ge,2+ge,0,-1,2,ye);return(he||Ie)&&(Se=ai(te,1,-ge,1+ge,0,-1,2,ye)||[],he&&(Se=Gl(he,1).concat(Se)),Ie&&(Se=Se.concat(Gl(Ie,-1)))),Se}(K,j),K.length&&this.splitTile(K,0,0,0),H&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function jt(se,j,H){return 32*((1<<se)*H+j)+se}function Ur(se,j){return j?se.properties[j]:se.id}function Ys(se,j){if(se==null)return!0;if(se.type==="Feature")return Ur(se,j)!=null;if(se.type==="FeatureCollection"){const H=new Set;for(const K of se.features){const te=Ur(K,j);if(te==null||H.has(te))return!1;H.add(te)}return!0}return!1}function Gt(se,j){const H=new Map;if(se!=null)if(se.type==="Feature")H.set(Ur(se,j),se);else for(const K of se.features)H.set(Ur(K,j),K);return H}Ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ht.prototype.splitTile=function(se,j,H,K,te,ye,ge){for(var Se=[se,j,H,K],he=this.options,Ie=he.debug;Se.length;){K=Se.pop(),H=Se.pop(),j=Se.pop(),se=Se.pop();var Be=1<<j,ee=jt(j,H,K),ke=this.tiles[ee];if(!ke&&(Ie>1&&console.time("creation"),ke=this.tiles[ee]=ql(se,j,H,K,he),this.tileCoords.push({z:j,x:H,y:K}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,H,K,ke.numFeatures,ke.numPoints,ke.numSimplified),console.timeEnd("creation"));var gt="z"+j;this.stats[gt]=(this.stats[gt]||0)+1,this.total++}if(ke.source=se,te){if(j===he.maxZoom||j===te)continue;var xt=1<<te-j;if(H!==Math.floor(ye/xt)||K!==Math.floor(ge/xt))continue}else if(j===he.indexMaxZoom||ke.numPoints<=he.indexMaxPoints)continue;if(ke.source=null,se.length!==0){Ie>1&&console.time("clipping");var It,Ze,Dt,Xt,wi,or,kt=.5*he.buffer/he.extent,Wi=.5-kt,br=.5+kt,Mt=1+kt;It=Ze=Dt=Xt=null,wi=ai(se,Be,H-kt,H+br,0,ke.minX,ke.maxX,he),or=ai(se,Be,H+Wi,H+Mt,0,ke.minX,ke.maxX,he),se=null,wi&&(It=ai(wi,Be,K-kt,K+br,1,ke.minY,ke.maxY,he),Ze=ai(wi,Be,K+Wi,K+Mt,1,ke.minY,ke.maxY,he),wi=null),or&&(Dt=ai(or,Be,K-kt,K+br,1,ke.minY,ke.maxY,he),Xt=ai(or,Be,K+Wi,K+Mt,1,ke.minY,ke.maxY,he),or=null),Ie>1&&console.timeEnd("clipping"),Se.push(It||[],j+1,2*H,2*K),Se.push(Ze||[],j+1,2*H,2*K+1),Se.push(Dt||[],j+1,2*H+1,2*K),Se.push(Xt||[],j+1,2*H+1,2*K+1)}}},Ht.prototype.getTile=function(se,j,H){var K=this.options,te=K.extent,ye=K.debug;if(se<0||se>24)return null;var ge=1<<se,Se=jt(se,j=(j%ge+ge)%ge,H);if(this.tiles[Se])return Rs(this.tiles[Se],te);ye>1&&console.log("drilling down to z%d-%d-%d",se,j,H);for(var he,Ie=se,Be=j,ee=H;!he&&Ie>0;)Ie--,Be=Math.floor(Be/2),ee=Math.floor(ee/2),he=this.tiles[jt(Ie,Be,ee)];return he&&he.source?(ye>1&&console.log("found parent tile z%d-%d-%d",Ie,Be,ee),ye>1&&console.time("drilling down"),this.splitTile(he.source,Ie,Be,ee,se,j,H),ye>1&&console.timeEnd("drilling down"),this.tiles[Se]?Rs(this.tiles[Se],te):null):null};class Po extends M{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(j,H){return c._(this,void 0,void 0,function*(){const K=j.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const te=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!te)return null;const ye=new class{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.W,this.length=Se.length,this._features=Se}feature(Se){return new class{constructor(he){this._feature=he,this.extent=c.W,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const Ie of this._feature.geometry)he.push([new c.P(Ie[0],Ie[1])]);return he}{const he=[];for(const Ie of this._feature.geometry){const Be=[];for(const ee of Ie)Be.push(new c.P(ee[0],ee[1]));he.push(Be)}return he}}toGeoJSON(he,Ie,Be){return W.call(this,he,Ie,Be)}}(this._features[Se])}}(te.features);let ge=Tt(ye);return ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),{vectorTile:ye,rawData:ge.buffer}})}loadData(j){return c._(this,void 0,void 0,function*(){var H;(H=this._pendingRequest)===null||H===void 0||H.abort();const K=!!(j&&j.request&&j.request.collectResourceTiming)&&new c.bs(j.request);this._pendingRequest=new AbortController;try{let te=yield this.loadGeoJSON(j,this._pendingRequest);if(delete this._pendingRequest,typeof te!="object")throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(V(te,!0),j.filter){const ge=c.by(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map(he=>`${he.key}: ${he.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(he=>ge.value.evaluate({zoom:0},he))}}this._geoJSONIndex=j.cluster?new fs(function({superclusterOptions:ge,clusterProperties:Se}){if(!Se||!ge)return ge;const he={},Ie={},Be={accumulated:null,zoom:0},ee={properties:null},ke=Object.keys(Se);for(const gt of ke){const[xt,It]=Se[gt],Ze=c.by(It),Dt=c.by(typeof xt=="string"?[xt,["accumulated"],["get",gt]]:xt);he[gt]=Ze.value,Ie[gt]=Dt.value}return ge.map=gt=>{ee.properties=gt;const xt={};for(const It of ke)xt[It]=he[It].evaluate(Be,ee);return xt},ge.reduce=(gt,xt)=>{ee.properties=xt;for(const It of ke)Be.accumulated=gt[It],gt[It]=Ie[It].evaluate(Be,ee)},ge}(j)).load(te.features):function(ge,Se){return new Ht(ge,Se)}(te,j.geojsonVtOptions),this.loaded={};const ye={};if(K){const ge=K.finish();ge&&(ye.resourceTiming={},ye.resourceTiming[j.source]=JSON.parse(JSON.stringify(ge)))}return ye}catch(te){if(delete this._pendingRequest,c.bz(te))return{abandoned:!0};throw te}})}reloadTile(j){const H=this.loaded;return H&&H[j.uid]?super.reloadTile(j):this.loadTile(j)}loadGeoJSON(j,H){return c._(this,void 0,void 0,function*(){const{promoteId:K}=j;if(j.request){const te=yield c.h(j.request,H);return this._dataUpdateable=Ys(te.data,K)?Gt(te.data,K):void 0,te.data}if(typeof j.data=="string")try{const te=JSON.parse(j.data);return this._dataUpdateable=Ys(te,K)?Gt(te,K):void 0,te}catch{throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`)}if(!j.dataDiff)throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${j.source}`);return function(te,ye,ge){var Se,he,Ie,Be;if(ye.removeAll&&te.clear(),ye.remove)for(const ee of ye.remove)te.delete(ee);if(ye.add)for(const ee of ye.add){const ke=Ur(ee,ge);ke!=null&&te.set(ke,ee)}if(ye.update)for(const ee of ye.update){let ke=te.get(ee.id);if(ke==null)continue;const gt=!ee.removeAllProperties&&(((Se=ee.removeProperties)===null||Se===void 0?void 0:Se.length)>0||((he=ee.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0);if((ee.newGeometry||ee.removeAllProperties||gt)&&(ke=Object.assign({},ke),te.set(ee.id,ke),gt&&(ke.properties=Object.assign({},ke.properties))),ee.newGeometry&&(ke.geometry=ee.newGeometry),ee.removeAllProperties)ke.properties={};else if(((Ie=ee.removeProperties)===null||Ie===void 0?void 0:Ie.length)>0)for(const xt of ee.removeProperties)Object.prototype.hasOwnProperty.call(ke.properties,xt)&&delete ke.properties[xt];if(((Be=ee.addOrUpdateProperties)===null||Be===void 0?void 0:Be.length)>0)for(const{key:xt,value:It}of ee.addOrUpdateProperties)ke.properties[xt]=It}}(this._dataUpdateable,j.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(j){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(j){return this._geoJSONIndex.getClusterExpansionZoom(j.clusterId)}getClusterChildren(j){return this._geoJSONIndex.getChildren(j.clusterId)}getClusterLeaves(j){return this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset)}}class io{constructor(j){this.self=j,this.actor=new c.C(j),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(H,K)=>{if(this.externalWorkerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.externalWorkerSourceTypes[H]=K},this.self.addProtocol=c.bf,this.self.removeProtocol=c.bg,this.self.registerRTLTextPlugin=H=>{if(c.bA.isParsed())throw new Error("RTL text plugin already registered.");c.bA.setMethods(H)},this.actor.registerMessageHandler("loadDEMTile",(H,K)=>this._getDEMWorkerSource(H,K.source).loadTile(K)),this.actor.registerMessageHandler("removeDEMTile",(H,K)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(H,K.source).removeTile(K)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(H,K)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(H,K.type,K.source).getClusterExpansionZoom(K)})),this.actor.registerMessageHandler("getClusterChildren",(H,K)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(H,K.type,K.source).getClusterChildren(K)})),this.actor.registerMessageHandler("getClusterLeaves",(H,K)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(H,K.type,K.source).getClusterLeaves(K)})),this.actor.registerMessageHandler("loadData",(H,K)=>this._getWorkerSource(H,K.type,K.source).loadData(K)),this.actor.registerMessageHandler("loadTile",(H,K)=>this._getWorkerSource(H,K.type,K.source).loadTile(K)),this.actor.registerMessageHandler("reloadTile",(H,K)=>this._getWorkerSource(H,K.type,K.source).reloadTile(K)),this.actor.registerMessageHandler("abortTile",(H,K)=>this._getWorkerSource(H,K.type,K.source).abortTile(K)),this.actor.registerMessageHandler("removeTile",(H,K)=>this._getWorkerSource(H,K.type,K.source).removeTile(K)),this.actor.registerMessageHandler("removeSource",(H,K)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[H]||!this.workerSources[H][K.type]||!this.workerSources[H][K.type][K.source])return;const te=this.workerSources[H][K.type][K.source];delete this.workerSources[H][K.type][K.source],te.removeSource!==void 0&&te.removeSource(K)})),this.actor.registerMessageHandler("removeMap",H=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[H],delete this.availableImages[H],delete this.workerSources[H],delete this.demWorkerSources[H]})),this.actor.registerMessageHandler("setReferrer",(H,K)=>c._(this,void 0,void 0,function*(){this.referrer=K})),this.actor.registerMessageHandler("syncRTLPluginState",(H,K)=>this._syncRTLPluginState(H,K)),this.actor.registerMessageHandler("importScript",(H,K)=>c._(this,void 0,void 0,function*(){this.self.importScripts(K)})),this.actor.registerMessageHandler("setImages",(H,K)=>this._setImages(H,K)),this.actor.registerMessageHandler("updateLayers",(H,K)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(H).update(K.layers,K.removedIds)})),this.actor.registerMessageHandler("setLayers",(H,K)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(H).replace(K)}))}_setImages(j,H){return c._(this,void 0,void 0,function*(){this.availableImages[j]=H;for(const K in this.workerSources[j]){const te=this.workerSources[j][K];for(const ye in te)te[ye].availableImages=H}})}_syncRTLPluginState(j,H){return c._(this,void 0,void 0,function*(){if(c.bA.isParsed())return c.bA.getState();if(H.pluginStatus!=="loading")return c.bA.setState(H),H;const K=H.pluginURL;if(this.self.importScripts(K),c.bA.isParsed()){const te={pluginStatus:"loaded",pluginURL:K};return c.bA.setState(te),te}throw c.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${K}`)})}_getAvailableImages(j){let H=this.availableImages[j];return H||(H=[]),H}_getLayerIndex(j){let H=this.layerIndexes[j];return H||(H=this.layerIndexes[j]=new o),H}_getWorkerSource(j,H,K){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][H]||(this.workerSources[j][H]={}),!this.workerSources[j][H][K]){const te={sendAsync:(ye,ge)=>(ye.targetMapId=j,this.actor.sendAsync(ye,ge))};switch(H){case"vector":this.workerSources[j][H][K]=new M(te,this._getLayerIndex(j),this._getAvailableImages(j));break;case"geojson":this.workerSources[j][H][K]=new Po(te,this._getLayerIndex(j),this._getAvailableImages(j));break;default:this.workerSources[j][H][K]=new this.externalWorkerSourceTypes[H](te,this._getLayerIndex(j),this._getAvailableImages(j))}}return this.workerSources[j][H][K]}_getDEMWorkerSource(j,H){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][H]||(this.demWorkerSources[j][H]=new A),this.demWorkerSources[j][H]}}return c.i(self)&&(self.worker=new io(self)),io}),s("index",["exports","./shared"],function(c,o){var p="4.1.2";let g,S;const M={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:w=>new Promise((l,d)=>{const m=requestAnimationFrame(l);w.signal.addEventListener("abort",()=>{cancelAnimationFrame(m),d(o.c())})}),getImageData(w,l=0){return this.getImageCanvasContext(w).getImageData(-l,-l,w.width+2*l,w.height+2*l)},getImageCanvasContext(w){const l=window.document.createElement("canvas"),d=l.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return l.width=w.width,l.height=w.height,d.drawImage(w,0,0,w.width,w.height),d},resolveURL:w=>(g||(g=document.createElement("a")),g.href=w,g.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(S==null&&(S=matchMedia("(prefers-reduced-motion: reduce)")),S.matches)}};class A{static testProp(l){if(!A.docStyle)return l[0];for(let d=0;d<l.length;d++)if(l[d]in A.docStyle)return l[d];return l[0]}static create(l,d,m){const _=window.document.createElement(l);return d!==void 0&&(_.className=d),m&&m.appendChild(_),_}static createNS(l,d){return window.document.createElementNS(l,d)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(l,d){l.style[A.transformProp]=d}static addEventListener(l,d,m,_={}){l.addEventListener(d,m,"passive"in _?_:_.capture)}static removeEventListener(l,d,m,_={}){l.removeEventListener(d,m,"passive"in _?_:_.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(l){const d=l.getBoundingClientRect();return{x:d.width/l.offsetWidth||1,y:d.height/l.offsetHeight||1,boundingClientRect:d}}static getPoint(l,d,m){const _=d.boundingClientRect;return new o.P((m.clientX-_.left)/d.x-l.clientLeft,(m.clientY-_.top)/d.y-l.clientTop)}static mousePos(l,d){const m=A.getScale(l);return A.getPoint(l,m,d)}static touchPos(l,d){const m=[],_=A.getScale(l);for(let x=0;x<d.length;x++)m.push(A.getPoint(l,_,d[x]));return m}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const O={supported:!1,testSupport:function(w){!W&&V&&(ie?ve(w):z=w)}};let z,V,W=!1,ie=!1;function ve(w){const l=w.createTexture();w.bindTexture(w.TEXTURE_2D,l);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,V),w.isContextLost())return;O.supported=!0}catch{}w.deleteTexture(l),W=!0}var pe,_e;typeof document<"u"&&(V=document.createElement("img"),V.onload=function(){z&&ve(z),z=null,ie=!0},V.onerror=function(){W=!0,z=null},V.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(w){let l,d,m,_;w.resetRequestQueue=()=>{l=[],d=0,m=0,_={}},w.addThrottleControl=R=>{const D=m++;return _[D]=R,D},w.removeThrottleControl=R=>{delete _[R],C()},w.getImage=(R,D,B=!0)=>new Promise((U,Y)=>{O.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),o.e(R,{type:"image"}),l.push({abortController:D,requestParameters:R,supportImageRefresh:B,state:"queued",onError:ne=>{Y(ne)},onSuccess:ne=>{U(ne)}}),C()});const x=R=>o._(this,void 0,void 0,function*(){R.state="running";const{requestParameters:D,supportImageRefresh:B,onError:U,onSuccess:Y,abortController:ne}=R,re=B===!1&&!o.i(self)&&!o.g(D.url)&&(!D.headers||Object.keys(D.headers).reduce((fe,Ae)=>fe&&Ae==="accept",!0));d++;const le=re?$(D,ne):o.m(D,ne);try{const fe=yield le;delete R.abortController,R.state="completed",fe.data instanceof HTMLImageElement||o.b(fe.data)?Y(fe):fe.data&&Y({data:yield(X=fe.data,typeof createImageBitmap=="function"?o.d(X):o.f(X)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete R.abortController,U(fe)}finally{d--,C()}var X}),C=()=>{const R=(()=>{for(const D of Object.keys(_))if(_[D]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let D=d;D<R&&l.length>0;D++){const B=l.shift();B.abortController.signal.aborted?D--:x(B)}},$=(R,D)=>new Promise((B,U)=>{const Y=new Image,ne=R.url,re=R.credentials;re&&re==="include"?Y.crossOrigin="use-credentials":(re&&re==="same-origin"||!o.s(ne))&&(Y.crossOrigin="anonymous"),D.signal.addEventListener("abort",()=>{Y.src="",U(o.c())}),Y.fetchPriority="high",Y.onload=()=>{Y.onerror=Y.onload=null,B({data:Y})},Y.onerror=()=>{Y.onerror=Y.onload=null,D.signal.aborted||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Y.src=ne})}(pe||(pe={})),pe.resetRequestQueue(),function(w){w.Glyphs="Glyphs",w.Image="Image",w.Source="Source",w.SpriteImage="SpriteImage",w.SpriteJSON="SpriteJSON",w.Style="Style",w.Tile="Tile",w.Unknown="Unknown"}(_e||(_e={}));class Me{constructor(l){this._transformRequestFn=l}transformRequest(l,d){return this._transformRequestFn&&this._transformRequestFn(l,d)||{url:l}}normalizeSpriteURL(l,d,m){const _=function(x){const C=x.match($e);if(!C)throw new Error(`Unable to parse URL "${x}"`);return{protocol:C[1],authority:C[2],path:C[3]||"/",params:C[4]?C[4].split("&"):[]}}(l);return _.path+=`${d}${m}`,function(x){const C=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${C}`}(_)}setTransformRequest(l){this._transformRequestFn=l}}const $e=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Fe(w){var l=new o.A(3);return l[0]=w[0],l[1]=w[1],l[2]=w[2],l}var Ge,et=function(w,l,d){return w[0]=l[0]-d[0],w[1]=l[1]-d[1],w[2]=l[2]-d[2],w};Ge=new o.A(3),o.A!=Float32Array&&(Ge[0]=0,Ge[1]=0,Ge[2]=0);var at=function(w){var l=w[0],d=w[1];return l*l+d*d};function ct(w){const l=[];if(typeof w=="string")l.push({id:"default",url:w});else if(w&&w.length>0){const d=[];for(const{id:m,url:_}of w){const x=`${m}${_}`;d.indexOf(x)===-1&&(d.push(x),l.push({id:m,url:_}))}}return l}(function(){var w=new o.A(2);o.A!=Float32Array&&(w[0]=0,w[1]=0)})();class nt{constructor(l,d,m,_){this.context=l,this.format=m,this.texture=l.gl.createTexture(),this.update(d,_)}update(l,d,m){const{width:_,height:x}=l,C=!(this.size&&this.size[0]===_&&this.size[1]===x||m),{context:$}=this,{gl:R}=$;if(this.useMipmap=!!(d&&d.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),$.pixelStoreUnpackFlipY.set(!1),$.pixelStoreUnpack.set(1),$.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!d||d.premultiply!==!1)),C)this.size=[_,x],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,l):R.texImage2D(R.TEXTURE_2D,0,this.format,_,x,0,this.format,R.UNSIGNED_BYTE,l.data);else{const{x:D,y:B}=m||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?R.texSubImage2D(R.TEXTURE_2D,0,D,B,R.RGBA,R.UNSIGNED_BYTE,l):R.texSubImage2D(R.TEXTURE_2D,0,D,B,_,x,R.RGBA,R.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(l,d,m){const{context:_}=this,{gl:x}=_;x.bindTexture(x.TEXTURE_2D,this.texture),m!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=x.LINEAR),l!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,m||l),this.filter=l),d!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,d),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function Pt(w){const{userImage:l}=w;return!!(l&&l.render&&l.render())&&(w.data.replace(new Uint8Array(l.data.buffer)),!0)}class ft extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:d,promiseResolve:m}of this.requestors)m(this._getImagesForIds(d));this.requestors=[]}}getImage(l){const d=this.images[l];if(d&&!d.data&&d.spriteData){const m=d.spriteData;d.data=new o.R({width:m.width,height:m.height},m.context.getImageData(m.x,m.y,m.width,m.height).data),d.spriteData=null}return d}addImage(l,d){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,d)&&(this.images[l]=d)}_validate(l,d){let m=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchX" value`))),m=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchY" value`))),m=!1),this._validateContent(d.content,d)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "content" value`))),m=!1),m}_validateStretch(l,d){if(!l)return!0;let m=0;for(const _ of l){if(_[0]<m||_[1]<_[0]||d<_[1])return!1;m=_[1]}return!0}_validateContent(l,d){if(!l)return!0;if(l.length!==4)return!1;const m=d.spriteData,_=m&&m.width||d.data.width,x=m&&m.height||d.data.height;return!(l[0]<0||_<l[0]||l[1]<0||x<l[1]||l[2]<0||_<l[2]||l[3]<0||x<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,d,m=!0){const _=this.getImage(l);if(m&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[l]=d,this.updatedImages[l]=!0}removeImage(l){const d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((d,m)=>{let _=!0;if(!this.isLoaded())for(const x of l)this.images[x]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:d})})}_getImagesForIds(l){const d={};for(const m of l){let _=this.getImage(m);_||(this.fire(new o.k("styleimagemissing",{id:m})),_=this.getImage(m)),_?d[m]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:o.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:l,height:d}=this.atlasImage;return{width:l,height:d}}getPattern(l){const d=this.patterns[l],m=this.getImage(l);if(!m)return null;if(d&&d.position.version===m.version)return d.position;if(d)d.position.version=m.version;else{const _={w:m.data.width+2,h:m.data.height+2,x:0,y:0},x=new o.I(_,m);this.patterns[l]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new nt(l,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const x in this.patterns)l.push(this.patterns[x].bin);const{w:d,h:m}=o.p(l),_=this.atlasImage;_.resize({width:d||1,height:m||1});for(const x in this.patterns){const{bin:C}=this.patterns[x],$=C.x+1,R=C.y+1,D=this.getImage(x).data,B=D.width,U=D.height;o.R.copy(D,_,{x:0,y:0},{x:$,y:R},{width:B,height:U}),o.R.copy(D,_,{x:0,y:U-1},{x:$,y:R-1},{width:B,height:1}),o.R.copy(D,_,{x:0,y:0},{x:$,y:R+U},{width:B,height:1}),o.R.copy(D,_,{x:B-1,y:0},{x:$-1,y:R},{width:1,height:U}),o.R.copy(D,_,{x:0,y:0},{x:$+B,y:R},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const d of l){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const m=this.getImage(d);m||o.w(`Image with ID: "${d}" was not found`),Pt(m)&&this.updateImage(d,m)}}}const vi=1e20;function Li(w,l,d,m,_,x,C,$,R){for(let D=l;D<l+m;D++)Tt(w,d*x+D,x,_,C,$,R);for(let D=d;D<d+_;D++)Tt(w,D*x+l,1,m,C,$,R)}function Tt(w,l,d,m,_,x,C){x[0]=0,C[0]=-vi,C[1]=vi,_[0]=w[l];for(let $=1,R=0,D=0;$<m;$++){_[$]=w[l+$*d];const B=$*$;do{const U=x[R];D=(_[$]-_[U]+B-U*U)/($-U)/2}while(D<=C[R]&&--R>-1);R++,x[R]=$,C[R]=D,C[R+1]=vi}for(let $=0,R=0;$<m;$++){for(;C[R+1]<$;)R++;const D=x[R],B=$-D;w[l+$*d]=_[D]+B*B}}class Ft{constructor(l,d){this.requestManager=l,this.localIdeographFontFamily=d,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,function*(){const d=[];for(const x in l)for(const C of l[x])d.push(this._getAndCacheGlyphsPromise(x,C));const m=yield Promise.all(d),_={};for(const{stack:x,id:C,glyph:$}of m)_[x]||(_[x]={}),_[x][C]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};return _})}_getAndCacheGlyphsPromise(l,d){return o._(this,void 0,void 0,function*(){let m=this.entries[l];m||(m=this.entries[l]={glyphs:{},requests:{},ranges:{}});let _=m.glyphs[d];if(_!==void 0)return{stack:l,id:d,glyph:_};if(_=this._tinySDF(m,l,d),_)return m.glyphs[d]=_,{stack:l,id:d,glyph:_};const x=Math.floor(d/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(m.ranges[x])return{stack:l,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!m.requests[x]){const $=Ft.loadGlyphRange(l,x,this.url,this.requestManager);m.requests[x]=$}const C=yield m.requests[x];for(const $ in C)this._doesCharSupportLocalGlyph(+$)||(m.glyphs[+$]=C[+$]);return m.ranges[x]=!0,{stack:l,id:d,glyph:C[d]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l))}_tinySDF(l,d,m){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(m))return;let x=l.tinySDF;if(!x){let $="400";/bold/i.test(d)?$="900":/medium/i.test(d)?$="500":/light/i.test(d)&&($="200"),x=l.tinySDF=new Ft.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:$})}const C=x.draw(String.fromCharCode(m));return{id:m,bitmap:new o.o({width:C.width||60,height:C.height||60},C.data),metrics:{width:C.glyphWidth/2||24,height:C.glyphHeight/2||24,left:C.glyphLeft/2+.5||0,top:C.glyphTop/2-27.5||-8,advance:C.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ft.loadGlyphRange=function(w,l,d,m){return o._(this,void 0,void 0,function*(){const _=256*l,x=_+255,C=m.transformRequest(d.replace("{fontstack}",w).replace("{range}",`${_}-${x}`),_e.Glyphs),$=yield o.l(C,new AbortController);if(!$||!$.data)throw new Error(`Could not load glyph range. range: ${l}, ${_}-${x}`);const R={};for(const D of o.n($.data))R[D.id]=D;return R})},Ft.TinySDF=class{constructor({fontSize:w=24,buffer:l=3,radius:d=8,cutoff:m=.25,fontFamily:_="sans-serif",fontWeight:x="normal",fontStyle:C="normal"}={}){this.buffer=l,this.cutoff=m,this.radius=d;const $=this.size=w+4*l,R=this._createCanvas($),D=this.ctx=R.getContext("2d",{willReadFrequently:!0});D.font=`${C} ${x} ${w}px ${_}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array($*$),this.gridInner=new Float64Array($*$),this.f=new Float64Array($),this.z=new Float64Array($+1),this.v=new Uint16Array($)}_createCanvas(w){const l=document.createElement("canvas");return l.width=l.height=w,l}draw(w){const{width:l,actualBoundingBoxAscent:d,actualBoundingBoxDescent:m,actualBoundingBoxLeft:_,actualBoundingBoxRight:x}=this.ctx.measureText(w),C=Math.ceil(d),$=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-_))),R=Math.min(this.size-this.buffer,C+Math.ceil(m)),D=$+2*this.buffer,B=R+2*this.buffer,U=Math.max(D*B,0),Y=new Uint8ClampedArray(U),ne={data:Y,width:D,height:B,glyphWidth:$,glyphHeight:R,glyphTop:C,glyphLeft:0,glyphAdvance:l};if($===0||R===0)return ne;const{ctx:re,buffer:le,gridInner:X,gridOuter:fe}=this;re.clearRect(le,le,$,R),re.fillText(w,le,le+C);const Ae=re.getImageData(le,le,$,R);fe.fill(vi,0,U),X.fill(0,0,U);for(let ce=0;ce<R;ce++)for(let xe=0;xe<$;xe++){const Pe=Ae.data[4*(ce*$+xe)+3]/255;if(Pe===0)continue;const Ce=(ce+le)*D+xe+le;if(Pe===1)fe[Ce]=0,X[Ce]=vi;else{const Re=.5-Pe;fe[Ce]=Re>0?Re*Re:0,X[Ce]=Re<0?Re*Re:0}}Li(fe,0,0,D,B,D,this.f,this.v,this.z),Li(X,le,le,$,R,D,this.f,this.v,this.z);for(let ce=0;ce<U;ce++){const xe=Math.sqrt(fe[ce])-Math.sqrt(X[ce]);Y[ce]=Math.round(255-255*(xe/this.radius+this.cutoff))}return ne}};class Hi{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,d){return o.y(l.expression.evaluate(d))}interpolate(l,d,m){return{x:o.z.number(l.x,d.x,m),y:o.z.number(l.y,d.y,m),z:o.z.number(l.z,d.z,m)}}}let Fr;class Cr extends o.E{constructor(l){super(),Fr=Fr||new o.q({anchor:new o.D(o.v.light.anchor),position:new Hi,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(Fr),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,d={}){if(!this._validate(o.r,l,d))for(const m in l){const _=l[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),_):this._transitionable.setValue(m,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,m){return(!m||m.validate!==!1)&&o.t(this,l.call(o.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}class _r{constructor(l,d){this.width=l,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,d){const m=l.join(",")+String(d);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(l,d)),this.dashEntry[m]}getDashRanges(l,d,m){const _=[];let x=l.length%2==1?-l[l.length-1]*m:0,C=l[0]*m,$=!0;_.push({left:x,right:C,isDash:$,zeroLength:l[0]===0});let R=l[0];for(let D=1;D<l.length;D++){$=!$;const B=l[D];x=R*m,R+=B,C=R*m,_.push({left:x,right:C,isDash:$,zeroLength:B===0})}return _}addRoundDash(l,d,m){const _=d/2;for(let x=-m;x<=m;x++){const C=this.width*(this.nextRow+m+x);let $=0,R=l[$];for(let D=0;D<this.width;D++){D/R.right>1&&(R=l[++$]);const B=Math.abs(D-R.left),U=Math.abs(D-R.right),Y=Math.min(B,U);let ne;const re=x/m*(_+1);if(R.isDash){const le=_-Math.abs(re);ne=Math.sqrt(Y*Y+le*le)}else ne=_-Math.sqrt(Y*Y+re*re);this.data[C+D]=Math.max(0,Math.min(255,ne+128))}}}addRegularDash(l){for(let $=l.length-1;$>=0;--$){const R=l[$],D=l[$+1];R.zeroLength?l.splice($,1):D&&D.isDash===R.isDash&&(D.left=R.left,l.splice($,1))}const d=l[0],m=l[l.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const _=this.width*this.nextRow;let x=0,C=l[x];for(let $=0;$<this.width;$++){$/C.right>1&&(C=l[++x]);const R=Math.abs($-C.left),D=Math.abs($-C.right),B=Math.min(R,D);this.data[_+$]=Math.max(0,Math.min(255,(C.isDash?B:-B)+128))}}addDash(l,d){const m=d?7:0,_=2*m+1;if(this.nextRow+_>this.height)return o.w("LineAtlas out of space"),null;let x=0;for(let $=0;$<l.length;$++)x+=l[$];if(x!==0){const $=this.width/x,R=this.getDashRanges(l,this.width,$);d?this.addRoundDash(R,$,m):this.addRegularDash(R)}const C={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:x};return this.nextRow+=_,this.dirty=!0,C}bind(l){const d=l.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const Cs="maplibre_preloaded_worker_pool";class fs{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<fs.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Cs]}numActive(){return Object.keys(this.active).length}}const Zs=Math.floor(M.hardwareConcurrency/2);let yn,Kr;function ms(){return yn||(yn=new fs),yn}fs.workerCount=o.B(globalThis)?Math.max(Math.min(Zs,3),1):1;class Ke{constructor(l,d){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=d;const m=this.workerPool.acquire(d);for(let _=0;_<m.length;_++){const x=new o.C(m[_],d);x.name=`Worker ${_}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,d){const m=[];for(const _ of this.actors)m.push(_.sendAsync({type:l,data:d}));return Promise.all(m)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,d){for(const m of this.actors)m.registerMessageHandler(l,d)}}function oi(){return Kr||(Kr=new Ke(ms(),o.G),Kr.registerMessageHandler("getResource",(w,l,d)=>o.m(l,d))),Kr}function Di(w,l){const d=o.F();return o.H(d,d,[1,1,0]),o.J(d,d,[.5*w.width,.5*w.height,1]),o.K(d,d,w.calculatePosMatrix(l.toUnwrapped()))}function $s(w,l,d,m,_,x){const C=function(U,Y,ne){if(U)for(const re of U){const le=Y[re];if(le&&le.source===ne&&le.type==="fill-extrusion")return!0}else for(const re in Y){const le=Y[re];if(le.source===ne&&le.type==="fill-extrusion")return!0}return!1}(_&&_.layers,l,w.id),$=x.maxPitchScaleFactor(),R=w.tilesIn(m,$,C);R.sort(Io);const D=[];for(const U of R)D.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(l,d,w._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,_,x,$,Di(w.transform,U.tileID))});const B=function(U){const Y={},ne={};for(const re of U){const le=re.queryResults,X=re.wrappedTileID,fe=ne[X]=ne[X]||{};for(const Ae in le){const ce=le[Ae],xe=fe[Ae]=fe[Ae]||{},Pe=Y[Ae]=Y[Ae]||[];for(const Ce of ce)xe[Ce.featureIndex]||(xe[Ce.featureIndex]=!0,Pe.push(Ce))}}return Y}(D);for(const U in B)B[U].forEach(Y=>{const ne=Y.feature,re=w.getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=re});return B}function Io(w,l){const d=w.tileID,m=l.tileID;return d.overscaledZ-m.overscaledZ||d.canonical.y-m.canonical.y||d.wrap-m.wrap||d.canonical.x-m.canonical.x}function Mo(w,l,d){return o._(this,void 0,void 0,function*(){let m=w;if(w.url?m=(yield o.h(l.transformRequest(w.url,_e.Source),d)).data:yield M.frameAsync(d),!m)return null;const _=o.L(o.e(m,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in m&&m.vector_layers&&(_.vectorLayerIds=m.vector_layers.map(x=>x.id)),_})}class vr{constructor(l,d){l&&(d?this.setSouthWest(l).setNorthEast(d):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.M?new o.M(l.lng,l.lat):o.M.convert(l),this}extend(l){const d=this._sw,m=this._ne;let _,x;if(l instanceof o.M)_=l,x=l;else{if(!(l instanceof vr))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(vr.convert(l)):this.extend(o.M.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.M.convert(l)):this;if(_=l._sw,x=l._ne,!_||!x)return this}return d||m?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),m.lng=Math.max(x.lng,m.lng),m.lat=Math.max(x.lat,m.lat)):(this._sw=new o.M(_.lng,_.lat),this._ne=new o.M(x.lng,x.lat)),this}getCenter(){return new o.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.M(this.getWest(),this.getNorth())}getSouthEast(){return new o.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:d,lat:m}=o.M.convert(l);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&_}static convert(l){return l instanceof vr?l:l&&new vr(l)}static fromLngLat(l,d=0){const m=360*d/40075017,_=m/Math.cos(Math.PI/180*l.lat);return new vr(new o.M(l.lng-_,l.lat-m),new o.M(l.lng+_,l.lat+m))}}class la{constructor(l,d,m){this.bounds=vr.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=m||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),m=Math.floor(o.N(this.bounds.getWest())*d),_=Math.floor(o.O(this.bounds.getNorth())*d),x=Math.ceil(o.N(this.bounds.getEast())*d),C=Math.ceil(o.O(this.bounds.getSouth())*d);return l.x>=m&&l.x<x&&l.y>=_&&l.y<C}}class Oe extends o.E{constructor(l,d,m,_){if(super(),this.id=l,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.L(d,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Mo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new la(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(d,_e.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};m.request.collectResourceTiming=this._collectResourceTiming;let _="reloadTile";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((x,C)=>{l.reloadPromise={resolve:x,reject:C}})}else l.actor=this.dispatcher.getActor(),_="loadTile";l.abortController=new AbortController;try{const x=yield l.actor.sendAsync({type:_,data:m},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,x)}catch(x){if(delete l.abortController,l.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,d){if(d&&d.resourceTiming&&(l.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&l.setExpiryData(d),l.loadVectorData(d,this.map.painter),l.reloadPromise){const m=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(m.resolve).catch(m.reject)}}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"abortTile",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"removeTile",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ca extends o.E{constructor(l,d,m,_){super(),this.id=l,this.dispatcher=m,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},d),o.e(this,o.L(d,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Mo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(o.e(this,l),l.bounds&&(this.tileBounds=new la(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const m=yield pe.getImage(this.map._requestManager.transformRequest(d,_e.Tile),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&l.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const _=this.map.painter.context,x=_.gl,C=m.data;l.texture=this.map.painter.getTileTexture(C.width),l.texture?l.texture.update(C,{useMipmap:!0}):(l.texture=new nt(_,C,x.RGBA,{useMipmap:!0}),l.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),_.extTextureFilterAnisotropic&&x.texParameterf(x.TEXTURE_2D,_.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_.extTextureFilterAnisotropicMax)),l.state="loaded"}}catch(m){if(delete l.abortController,l.aborted)l.state="unloaded";else if(m)throw l.state="errored",m}})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class Vl extends ca{constructor(l,d,m,_){super(l,d,m,_),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(d,_e.Tile);l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const _=yield pe.getImage(m,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(_&&_.data){const x=_.data;this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&l.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const C=o.b(x)&&o.S()?x:yield this.readImageNow(x),$={type:this.type,uid:l.uid,source:this.id,rawImageData:C,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const R=yield l.actor.sendAsync({type:"loadDEMTile",data:$});l.dem=R,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(_){if(delete l.abortController,l.aborted)l.state="unloaded";else if(_)throw l.state="errored",_}})}readImageNow(l){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.U()){const d=l.width+2,m=l.height+2;try{return new o.R({width:d,height:m},yield o.V(l,-1,-1,d,m))}catch{}}return M.getImageData(l,1)})}_getNeighboringTiles(l){const d=l.canonical,m=Math.pow(2,d.z),_=(d.x-1+m)%m,x=d.x===0?l.wrap-1:l.wrap,C=(d.x+1+m)%m,$=d.x+1===m?l.wrap+1:l.wrap,R={};return R[new o.Q(l.overscaledZ,x,d.z,_,d.y).key]={backfilled:!1},R[new o.Q(l.overscaledZ,$,d.z,C,d.y).key]={backfilled:!1},d.y>0&&(R[new o.Q(l.overscaledZ,x,d.z,_,d.y-1).key]={backfilled:!1},R[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},R[new o.Q(l.overscaledZ,$,d.z,C,d.y-1).key]={backfilled:!1}),d.y+1<m&&(R[new o.Q(l.overscaledZ,x,d.z,_,d.y+1).key]={backfilled:!1},R[new o.Q(l.overscaledZ,l.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},R[new o.Q(l.overscaledZ,$,d.z,C,d.y+1).key]={backfilled:!1}),R}unloadTile(l){return o._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class ai extends o.E{constructor(l,d,m,_){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(_),this._data=d.data,this._options=o.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const x=o.W/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*x,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*x,extent:o.W,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.W,radius:(d.clusterRadius||50)*x,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,d,m){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:l,limit:d,offset:m}})}_updateWorkerData(l){return o._(this,void 0,void 0,function*(){const d=o.e({type:this.type},this.workerOptions);l?d.dataDiff=l:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(M.resolveURL(this._data),_e.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const m=yield this.actor.sendAsync({type:"loadData",data:d});if(this._pendingLoads--,this._removed||m.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let _=null;m.resourceTiming&&m.resourceTiming[this.id]&&(_=m.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&o.e(x,{resourceTiming:_}),this.fire(new o.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(m){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(m))}})}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,function*(){const d=l.actor?"reloadTile":"loadTile";l.actor=this.actor;const m={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:m},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(_,this.map.painter,d==="reloadTile")})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Br=o.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bn extends o.E{constructor(l,d,m,_){super(),this.id=l,this.dispatcher=m,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(l){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield pe.getImage(this.map._requestManager.transformRequest(this.url,_e.Image),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,l&&(this.coordinates=l),this._finishLoading())}catch(d){this._request=null,this.fire(new o.j(d))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const d=l.map(o.Y.fromLngLat);this.tileID=function(_){let x=1/0,C=1/0,$=-1/0,R=-1/0;for(const Y of _)x=Math.min(x,Y.x),C=Math.min(C,Y.y),$=Math.max($,Y.x),R=Math.max(R,Y.y);const D=Math.max($-x,R-C),B=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),U=Math.pow(2,B);return new o.a0(B,Math.floor((x+$)/2*U),Math.floor((C+R)/2*U))}(d),this.minzoom=this.maxzoom=this.tileID.z;const m=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new o.Z,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,o.W,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,o.W),this._boundsArray.emplaceBack(m[2].x,m[2].y,o.W,o.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Br.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new nt(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let m=!1;for(const _ in this.tiles){const x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,m=!0)}m&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Qa extends Bn{constructor(l,d,m,_){super(l,d,m,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const d of l.urls)this.urls.push(this.map._requestManager.transformRequest(d,_e.Source).url);try{const d=yield o.a2(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new o.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const d=this.video.seekable;l<d.start(0)||l>d.end(0)?this.fire(new o.j(new o.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Br.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new nt(l,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let m=!1;for(const _ in this.tiles){const x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,m=!0)}m&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class el extends Bn{constructor(l,d,m,_){super(l,d,m,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(C=>typeof C!="number"))||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.j(new o.a1(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a1(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a1(`sources.${l}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,m=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Br.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new nt(d,this.canvas,m.RGBA,{premultiply:!0});let _=!1;for(const x in this.tiles){const C=this.tiles[x];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,_=!0)}_&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const ua={},Ao=w=>{switch(w){case"geojson":return ai;case"image":return Bn;case"raster":return ca;case"raster-dem":return Vl;case"vector":return Oe;case"video":return Qa;case"canvas":return el}return ua[w]},ks="RTLPluginLoaded";class Gl extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=oi()}_syncState(l){return this.status=l,this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:l,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,function*(d,m=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=M.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!m)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(ks))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Xe=null;function Rs(){return Xe||(Xe=new Gl),Xe}class ys{constructor(l,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a3(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const d=l+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,d,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(_,x){const C={};if(!x)return C;for(const $ of _){const R=$.layerIds.map(D=>x.getLayer(D)).filter(Boolean);if(R.length!==0){$.layers=R,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(D=>R.filter(B=>B.id===D)[0]));for(const D of R)C[D.id]=$}}return C}(l.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof o.a5){if(this.hasSymbolBuckets=!0,!m)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof o.a5&&x.hasRTLText){this.hasRTLText=!0,Rs().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const x=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(x))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a4}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const m in this.buckets){const _=this.buckets[m];_.uploadPending()&&_.upload(l)}const d=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new nt(l,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new nt(l,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,d,m,_,x,C,$,R,D,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:x,scale:C,tileSize:this.tileSize,pixelPosMatrix:B,transform:R,params:$,queryPadding:this.queryPadding*D},l,d,m):{}}querySourceFeatures(l,d){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const _=m.loadVTLayers(),x=d&&d.sourceLayer?d.sourceLayer:"",C=_._geojsonTileLayer||_[x];if(!C)return;const $=o.a6(d&&d.filter),{z:R,x:D,y:B}=this.tileID.canonical,U={z:R,x:D,y:B};for(let Y=0;Y<C.length;Y++){const ne=C.feature(Y);if($.needGeometry){const X=o.a7(ne,!0);if(!$.filter(new o.a8(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!$.filter(new o.a8(this.tileID.overscaledZ),ne))continue;const re=m.getId(ne,x),le=new o.a9(ne,R,D,B,re);le.tile=U,l.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const d=this.expirationTime;if(l.cacheControl){const m=o.aa(l.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const m=Date.now();let _=!1;if(this.expirationTime>m)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const x=this.expirationTime-d;x?this.expirationTime=m+Math.max(x,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const x=this.buckets[_],C=x.layers[0].sourceLayer||"_geojsonTileLayer",$=m[C],R=l[C];if(!$||!R||Object.keys(R).length===0)continue;x.update(R,$,this.imageAtlas&&this.imageAtlas.patternPositions||{});const D=d&&d.style&&d.style.getLayer(_);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=M.now()+l}setDependencies(l,d){const m={};for(const _ of d)m[_]=!0;this.dependencies[l]=m}hasDependency(l,d){for(const m of l){const _=this.dependencies[m];if(_){for(const x of d)if(_[x])return!0}}return!1}}class ql{constructor(l,d){this.max=l,this.onRemove=d,this.reset()}reset(){for(const l in this.data)for(const d of this.data[l])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(l,d,m){const _=l.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const x={value:d,timeout:void 0};if(m!==void 0&&(x.timeout=setTimeout(()=>{this.remove(l,x)},m)),this.data[_].push(x),this.order.push(_),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value}getByKey(l){const d=this.data[l];return d?d[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,d){if(!this.has(l))return this;const m=l.wrapped().key,_=d===void 0?0:this.data[m].indexOf(d),x=this.data[m][_];return this.data[m].splice(_,1),x.timeout&&clearTimeout(x.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(x.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(l){const d=[];for(const m in this.data)for(const _ of this.data[m])l(_.value)||d.push(_);for(const m of d)this.remove(m.value.tileID,m)}}class ha{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,d,m){const _=String(d);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][_]=this.stateChanges[l][_]||{},o.e(this.stateChanges[l][_],m),this.deletedStates[l]===null){this.deletedStates[l]={};for(const x in this.state[l])x!==_&&(this.deletedStates[l][x]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][_]===null){this.deletedStates[l][_]={};for(const x in this.state[l][_])m[x]||(this.deletedStates[l][_][x]=null)}else for(const x in m)this.deletedStates[l]&&this.deletedStates[l][_]&&this.deletedStates[l][_][x]===null&&delete this.deletedStates[l][_][x]}removeFeatureState(l,d,m){if(this.deletedStates[l]===null)return;const _=String(d);if(this.deletedStates[l]=this.deletedStates[l]||{},m&&d!==void 0)this.deletedStates[l][_]!==null&&(this.deletedStates[l][_]=this.deletedStates[l][_]||{},this.deletedStates[l][_][m]=null);else if(d!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][_])for(m in this.deletedStates[l][_]={},this.stateChanges[l][_])this.deletedStates[l][_][m]=null;else this.deletedStates[l][_]=null;else this.deletedStates[l]=null}getState(l,d){const m=String(d),_=o.e({},(this.state[l]||{})[m],(this.stateChanges[l]||{})[m]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const x=this.deletedStates[l][d];if(x===null)return{};for(const C in x)delete _[C]}return _}initializeTileState(l,d){l.setFeatureState(this.state,d)}coalesceChanges(l,d){const m={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const x={};for(const C in this.stateChanges[_])this.state[_][C]||(this.state[_][C]={}),o.e(this.state[_][C],this.stateChanges[_][C]),x[C]=this.state[_][C];m[_]=x}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const x={};if(this.deletedStates[_]===null)for(const C in this.state[_])x[C]={},this.state[_][C]={};else for(const C in this.deletedStates[_]){if(this.deletedStates[_][C]===null)this.state[_][C]={};else for(const $ of Object.keys(this.deletedStates[_][C]))delete this.state[_][C][$];x[C]=this.state[_][C]}m[_]=m[_]||{},o.e(m[_],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const _ in l)l[_].setFeatureState(m,d)}}class Ye extends o.E{constructor(l,d,m){super(),this.id=l,this.dispatcher=m,this.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,x,C,$)=>{const R=new(Ao(x.type))(_,x,C,$);if(R.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${R.id}`);return R})(l,d,m,this),this._tiles={},this._cache=new ql(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ha,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const d=this._tiles[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,d,m){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,d,m)}catch(_){l.state="errored",_.status!==404?this._source.fire(new o.j(_,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const m=this._tiles[d];m.upload(l),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Ht).map(l=>l.key)}getRenderableIds(l){const d=[];for(const m in this._tiles)this._isIdRenderable(m,l)&&d.push(this._tiles[m]);return l?d.sort((m,_)=>{const x=m.tileID,C=_.tileID,$=new o.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),R=new o.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-C.overscaledZ||R.y-$.y||R.x-$.x}).map(m=>m.tileID.key):d.map(m=>m.tileID).sort(Ht).map(m=>m.key)}hasRenderableParent(l){const d=this.findLoadedParent(l,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(l,d){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(d||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,d){return o._(this,void 0,void 0,function*(){const m=this._tiles[l];m&&(m.state!=="loading"&&(m.state=d),yield this._loadTile(m,l,d))})}_tileLoaded(l,d,m){l.timeAdded=M.now(),m==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(d,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const x=d[_];if(l.neighboringTiles&&l.neighboringTiles[x]){const C=this.getTileByID(x);m(l,C),m(C,l)}}function m(_,x){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let C=x.tileID.canonical.x-_.tileID.canonical.x;const $=x.tileID.canonical.y-_.tileID.canonical.y,R=Math.pow(2,_.tileID.canonical.z),D=x.tileID.key;C===0&&$===0||Math.abs($)>1||(Math.abs(C)>1&&(Math.abs(C+R)===1?C+=R:Math.abs(C-R)===1&&(C-=R)),x.dem&&_.dem&&(_.dem.backfillBorder(x.dem,C,$),_.neighboringTiles&&_.neighboringTiles[D]&&(_.neighboringTiles[D].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,d,m,_){for(const x in this._tiles){let C=this._tiles[x];if(_[x]||!C.hasData()||C.tileID.overscaledZ<=d||C.tileID.overscaledZ>m)continue;let $=C.tileID;for(;C&&C.tileID.overscaledZ>d+1;){const D=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[D.key],C&&C.hasData()&&($=D)}let R=$;for(;R.overscaledZ>d;)if(R=R.scaledTo(R.overscaledZ-1),l[R.key]){_[$.key]=$;break}}}findLoadedParent(l,d){if(l.key in this._loadedParentTiles){const m=this._loadedParentTiles[l.key];return m&&m.tileID.overscaledZ>=d?m:null}for(let m=l.overscaledZ-1;m>=d;m--){const _=l.scaledTo(m),x=this._getLoadedTile(_);if(x)return x}}_getLoadedTile(l){const d=this._tiles[l.key];return d&&d.hasData()?d:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const d=Math.ceil(l.width/this._source.tileSize)+1,m=Math.ceil(l.height/this._source.tileSize)+1,_=Math.floor(d*m*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)}handleWrapJump(l){const d=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,d){const m={};for(const _ in this._tiles){const x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+d),m[x.tileID.key]=x}this._tiles=m;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(l,d){if(this.transform=l,this.terrain=d,!this._sourceLoaded||this._paused)return;let m;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new o.Q(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(m=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(m=m.filter(B=>this._source.hasTile(B)))):m=[];const _=l.coveringZoomLevel(this._source),x=Math.max(_-Ye.maxOverzooming,this._source.minzoom),C=Math.max(_+Ye.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const B={};for(const U of m)if(U.canonical.z>this._source.minzoom){const Y=U.scaledTo(U.canonical.z-1);B[Y.key]=Y;const ne=U.scaledTo(Math.max(this._source.minzoom,Math.min(U.canonical.z,5)));B[ne.key]=ne}m=m.concat(Object.values(B))}const $=m.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,$&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(m,_);if(jt(this._source.type)){const B={},U={},Y=Object.keys(R),ne=M.now();for(const re of Y){const le=R[re],X=this._tiles[re];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=ne)continue;const fe=this.findLoadedParent(le,x);fe&&(this._addTile(fe.tileID),B[fe.tileID.key]=fe.tileID),U[re]=le}this._retainLoadedChildren(U,_,C,R);for(const re in B)R[re]||(this._coveredTiles[re]=!0,R[re]=B[re]);if(d){const re={},le={};for(const X of m)this._tiles[X.key].hasData()?re[X.key]=X:le[X.key]=X;for(const X in le){const fe=le[X].children(this._source.maxzoom);this._tiles[fe[0].key]&&this._tiles[fe[1].key]&&this._tiles[fe[2].key]&&this._tiles[fe[3].key]&&(re[fe[0].key]=R[fe[0].key]=fe[0],re[fe[1].key]=R[fe[1].key]=fe[1],re[fe[2].key]=R[fe[2].key]=fe[2],re[fe[3].key]=R[fe[3].key]=fe[3],delete le[X])}for(const X in le){const fe=this.findLoadedParent(le[X],this._source.minzoom);if(fe){re[fe.tileID.key]=R[fe.tileID.key]=fe.tileID;for(const Ae in re)re[Ae].isChildOf(fe.tileID)&&delete re[Ae]}}for(const X in this._tiles)re[X]||(this._coveredTiles[X]=!0)}}for(const B in R)this._tiles[B].clearFadeHold();const D=o.ab(this._tiles,R);for(const B of D){const U=this._tiles[B];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(B)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,d){const m={},_={},x=Math.max(d-Ye.maxOverzooming,this._source.minzoom),C=Math.max(d+Ye.maxUnderzooming,this._source.minzoom),$={};for(const R of l){const D=this._addTile(R);m[R.key]=R,D.hasData()||d<this._source.maxzoom&&($[R.key]=R)}this._retainLoadedChildren($,d,C,m);for(const R of l){let D=this._tiles[R.key];if(D.hasData())continue;if(d+1>this._source.maxzoom){const U=R.children(this._source.maxzoom)[0],Y=this.getTile(U);if(Y&&Y.hasData()){m[U.key]=U;continue}}else{const U=R.children(this._source.maxzoom);if(m[U[0].key]&&m[U[1].key]&&m[U[2].key]&&m[U[3].key])continue}let B=D.wasRequested();for(let U=R.overscaledZ-1;U>=x;--U){const Y=R.scaledTo(U);if(_[Y.key])break;if(_[Y.key]=!0,D=this.getTile(Y),!D&&B&&(D=this._addTile(Y)),D){const ne=D.hasData();if((B||ne)&&(m[Y.key]=Y),B=D.wasRequested(),ne)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const d=[];let m,_=this._tiles[l].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){m=this._loadedParentTiles[_.key];break}d.push(_.key);const x=_.scaledTo(_.overscaledZ-1);if(m=this._getLoadedTile(x),m)break;_=x}for(const x of d)this._loadedParentTiles[x]=m}}_addTile(l){let d=this._tiles[l.key];if(d)return d;d=this._cache.getAndRemove(l),d&&(this._setTileReloadTimer(l.key,d),d.tileID=l,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,d)));const m=d;return d||(d=new ys(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(d,l.key,d.state)),d.uses++,this._tiles[l.key]=d,m||this._source.fire(new o.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(l,d){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const m=d.getExpiryTimeout();m&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},m))}_removeTile(l){const d=this._tiles[l];d&&(d.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,d,m){const _=[],x=this.transform;if(!x)return _;const C=m?x.getCameraQueryGeometry(l):l,$=l.map(re=>x.pointCoordinate(re,this.terrain)),R=C.map(re=>x.pointCoordinate(re,this.terrain)),D=this.getIds();let B=1/0,U=1/0,Y=-1/0,ne=-1/0;for(const re of R)B=Math.min(B,re.x),U=Math.min(U,re.y),Y=Math.max(Y,re.x),ne=Math.max(ne,re.y);for(let re=0;re<D.length;re++){const le=this._tiles[D[re]];if(le.holdingForFade())continue;const X=le.tileID,fe=Math.pow(2,x.zoom-le.tileID.overscaledZ),Ae=d*le.queryPadding*o.W/le.tileSize/fe,ce=[X.getTilePoint(new o.Y(B,U)),X.getTilePoint(new o.Y(Y,ne))];if(ce[0].x-Ae<o.W&&ce[0].y-Ae<o.W&&ce[1].x+Ae>=0&&ce[1].y+Ae>=0){const xe=$.map(Ce=>X.getTilePoint(Ce)),Pe=R.map(Ce=>X.getTilePoint(Ce));_.push({tile:le,tileID:X,queryGeometry:xe,cameraQueryGeometry:Pe,scale:fe})}}return _}getVisibleCoordinates(l){const d=this.getRenderableIds(l).map(m=>this._tiles[m].tileID);for(const m of d)m.posMatrix=this.transform.calculatePosMatrix(m.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(jt(this._source.type)){const l=M.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=l)return!0}return!1}setFeatureState(l,d,m){this._state.updateState(l=l||"_geojsonTileLayer",d,m)}removeFeatureState(l,d,m){this._state.removeFeatureState(l=l||"_geojsonTileLayer",d,m)}getFeatureState(l,d){return this._state.getState(l=l||"_geojsonTileLayer",d)}setDependencies(l,d,m){const _=this._tiles[l];_&&_.setDependencies(d,m)}reloadTilesForDependencies(l,d){for(const m in this._tiles)this._tiles[m].hasDependency(l,d)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(l,d))}}function Ht(w,l){const d=Math.abs(2*w.wrap)-+(w.wrap<0),m=Math.abs(2*l.wrap)-+(l.wrap<0);return w.overscaledZ-l.overscaledZ||m-d||l.canonical.y-w.canonical.y||l.canonical.x-w.canonical.x}function jt(w){return w==="raster"||w==="image"||w==="video"}Ye.maxOverzooming=10,Ye.maxUnderzooming=3;class Ur{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ac(l,0,1);let d=1,m=this._distances[d];const _=l*this.paddedLength+this.padding;for(;m<_&&d<this._distances.length;)m=this._distances[++d];const x=d-1,C=this._distances[x],$=m-C,R=$>0?(_-C)/$:0;return this.points[x].mult(1-R).add(this.points[d].mult(R))}}function Ys(w,l){let d=!0;return w==="always"||w!=="never"&&l!=="never"||(d=!1),d}class Gt{constructor(l,d,m){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(l/m),this.yCellCount=Math.ceil(d/m);for(let C=0;C<this.xCellCount*this.yCellCount;C++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,m,_,x){this._forEachCell(d,m,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(l,d,m,_){this._forEachCell(d-_,m-_,d+_,m+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(m),this.circles.push(_)}_insertBoxCell(l,d,m,_,x,C){this.boxCells[x].push(C)}_insertCircleCell(l,d,m,_,x,C){this.circleCells[x].push(C)}_query(l,d,m,_,x,C,$){if(m<0||l>this.width||_<0||d>this.height)return[];const R=[];if(l<=0&&d<=0&&this.width<=m&&this.height<=_){if(x)return[{key:null,x1:l,y1:d,x2:m,y2:_}];for(let D=0;D<this.boxKeys.length;D++)R.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const B=this.circles[3*D],U=this.circles[3*D+1],Y=this.circles[3*D+2];R.push({key:this.circleKeys[D],x1:B-Y,y1:U-Y,x2:B+Y,y2:U+Y})}}else this._forEachCell(l,d,m,_,this._queryCell,R,{hitTest:x,overlapMode:C,seenUids:{box:{},circle:{}}},$);return R}query(l,d,m,_){return this._query(l,d,m,_,!1,null)}hitTest(l,d,m,_,x,C){return this._query(l,d,m,_,!0,x,C).length>0}hitTestCircle(l,d,m,_,x){const C=l-m,$=l+m,R=d-m,D=d+m;if($<0||C>this.width||D<0||R>this.height)return!1;const B=[];return this._forEachCell(C,R,$,D,this._queryCellCircle,B,{hitTest:!0,overlapMode:_,circle:{x:l,y:d,radius:m},seenUids:{box:{},circle:{}}},x),B.length>0}_queryCell(l,d,m,_,x,C,$,R){const{seenUids:D,hitTest:B,overlapMode:U}=$,Y=this.boxCells[x];if(Y!==null){const re=this.bboxes;for(const le of Y)if(!D.box[le]){D.box[le]=!0;const X=4*le,fe=this.boxKeys[le];if(l<=re[X+2]&&d<=re[X+3]&&m>=re[X+0]&&_>=re[X+1]&&(!R||R(fe))&&(!B||!Ys(U,fe.overlapMode))&&(C.push({key:fe,x1:re[X],y1:re[X+1],x2:re[X+2],y2:re[X+3]}),B))return!0}}const ne=this.circleCells[x];if(ne!==null){const re=this.circles;for(const le of ne)if(!D.circle[le]){D.circle[le]=!0;const X=3*le,fe=this.circleKeys[le];if(this._circleAndRectCollide(re[X],re[X+1],re[X+2],l,d,m,_)&&(!R||R(fe))&&(!B||!Ys(U,fe.overlapMode))){const Ae=re[X],ce=re[X+1],xe=re[X+2];if(C.push({key:fe,x1:Ae-xe,y1:ce-xe,x2:Ae+xe,y2:ce+xe}),B)return!0}}}return!1}_queryCellCircle(l,d,m,_,x,C,$,R){const{circle:D,seenUids:B,overlapMode:U}=$,Y=this.boxCells[x];if(Y!==null){const re=this.bboxes;for(const le of Y)if(!B.box[le]){B.box[le]=!0;const X=4*le,fe=this.boxKeys[le];if(this._circleAndRectCollide(D.x,D.y,D.radius,re[X+0],re[X+1],re[X+2],re[X+3])&&(!R||R(fe))&&!Ys(U,fe.overlapMode))return C.push(!0),!0}}const ne=this.circleCells[x];if(ne!==null){const re=this.circles;for(const le of ne)if(!B.circle[le]){B.circle[le]=!0;const X=3*le,fe=this.circleKeys[le];if(this._circlesCollide(re[X],re[X+1],re[X+2],D.x,D.y,D.radius)&&(!R||R(fe))&&!Ys(U,fe.overlapMode))return C.push(!0),!0}}}_forEachCell(l,d,m,_,x,C,$,R){const D=this._convertToXCellCoord(l),B=this._convertToYCellCoord(d),U=this._convertToXCellCoord(m),Y=this._convertToYCellCoord(_);for(let ne=D;ne<=U;ne++)for(let re=B;re<=Y;re++)if(x.call(this,l,d,m,_,this.xCellCount*re+ne,C,$,R))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,m,_,x,C){const $=_-l,R=x-d,D=m+C;return D*D>$*$+R*R}_circleAndRectCollide(l,d,m,_,x,C,$){const R=(C-_)/2,D=Math.abs(l-(_+R));if(D>R+m)return!1;const B=($-x)/2,U=Math.abs(d-(x+B));if(U>B+m)return!1;if(D<=R||U<=B)return!0;const Y=D-R,ne=U-B;return Y*Y+ne*ne<=m*m}}function Po(w,l,d,m,_){const x=o.F();return l?(o.J(x,x,[1/_,1/_,1]),d||o.ad(x,x,m.angle)):o.K(x,m.labelPlaneMatrix,w),x}function io(w,l,d,m,_){if(l){const x=o.ae(w);return o.J(x,x,[_,_,1]),d||o.ad(x,x,-m.angle),x}return m.glCoordMatrix}function se(w,l,d){let m;d?(m=[w.x,w.y,d(w.x,w.y),1],o.af(m,m,l)):(m=[w.x,w.y,0,1],xt(m,m,l));const _=m[3];return{point:new o.P(m[0]/_,m[1]/_),signedDistanceFromCamera:_}}function j(w,l){return .5+w/l*.5}function H(w,l){const d=w[0]/w[3],m=w[1]/w[3];return d>=-l[0]&&d<=l[0]&&m>=-l[1]&&m<=l[1]}function K(w,l,d,m,_,x,C,$,R,D){const B=m?w.textSizeData:w.iconSizeData,U=o.ag(B,d.transform.zoom),Y=[256/d.width*2+1,256/d.height*2+1],ne=m?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;ne.clear();const re=w.lineVertexArray,le=m?w.text.placedSymbolArray:w.icon.placedSymbolArray,X=d.transform.width/d.transform.height;let fe=!1;for(let Ae=0;Ae<le.length;Ae++){const ce=le.get(Ae);if(ce.hidden||ce.writingMode===o.ah.vertical&&!fe){gt(ce.numGlyphs,ne);continue}let xe;if(fe=!1,D?(xe=[ce.anchorX,ce.anchorY,D(ce.anchorX,ce.anchorY),1],o.af(xe,xe,l)):(xe=[ce.anchorX,ce.anchorY,0,1],xt(xe,xe,l)),!H(xe,Y)){gt(ce.numGlyphs,ne);continue}const Pe=j(d.transform.cameraToCenterDistance,xe[3]),Ce=o.ai(B,U,ce),Re=C?Ce/Pe:Ce*Pe,qe=new o.P(ce.anchorX,ce.anchorY),Ue=se(qe,_,D).point,Ve={projections:{},offsets:{}},dt=ge(ce,Re,!1,$,l,_,x,w.glyphOffsetArray,re,ne,Ue,qe,Ve,X,R,D);fe=dt.useVertical,(dt.notEnoughRoom||fe||dt.needsFlipping&&ge(ce,Re,!0,$,l,_,x,w.glyphOffsetArray,re,ne,Ue,qe,Ve,X,R,D).notEnoughRoom)&&gt(ce.numGlyphs,ne)}m?w.text.dynamicLayoutVertexBuffer.updateData(ne):w.icon.dynamicLayoutVertexBuffer.updateData(ne)}function te(w,l,d,m,_,x,C,$,R,D,B,U,Y){const ne=$.glyphStartIndex+$.numGlyphs,re=$.lineStartIndex,le=$.lineStartIndex+$.lineLength,X=l.getoffsetX($.glyphStartIndex),fe=l.getoffsetX(ne-1),Ae=ee(w*X,d,m,_,x,C,$.segment,re,le,R,D,B,U,Y);if(!Ae)return null;const ce=ee(w*fe,d,m,_,x,C,$.segment,re,le,R,D,B,U,Y);return ce?{first:Ae,last:ce}:null}function ye(w,l,d,m){return w===o.ah.horizontal&&Math.abs(d.y-l.y)>Math.abs(d.x-l.x)*m?{useVertical:!0}:(w===o.ah.vertical?l.y<d.y:l.x>d.x)?{needsFlipping:!0}:null}function ge(w,l,d,m,_,x,C,$,R,D,B,U,Y,ne,re,le){const X=l/24,fe=w.lineOffsetX*X,Ae=w.lineOffsetY*X;let ce;if(w.numGlyphs>1){const xe=w.glyphStartIndex+w.numGlyphs,Pe=w.lineStartIndex,Ce=w.lineStartIndex+w.lineLength,Re=te(X,$,fe,Ae,d,B,U,w,R,x,Y,re,le);if(!Re)return{notEnoughRoom:!0};const qe=se(Re.first.point,C,le).point,Ue=se(Re.last.point,C,le).point;if(m&&!d){const Ve=ye(w.writingMode,qe,Ue,ne);if(Ve)return Ve}ce=[Re.first];for(let Ve=w.glyphStartIndex+1;Ve<xe-1;Ve++)ce.push(ee(X*$.getoffsetX(Ve),fe,Ae,d,B,U,w.segment,Pe,Ce,R,x,Y,re,le));ce.push(Re.last)}else{if(m&&!d){const Pe=se(U,_,le).point,Ce=w.lineStartIndex+w.segment+1,Re=new o.P(R.getx(Ce),R.gety(Ce)),qe=se(Re,_,le),Ue=qe.signedDistanceFromCamera>0?qe.point:Se(U,Re,Pe,1,_,le),Ve=ye(w.writingMode,Pe,Ue,ne);if(Ve)return Ve}const xe=ee(X*$.getoffsetX(w.glyphStartIndex),fe,Ae,d,B,U,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,R,x,Y,re,le);if(!xe)return{notEnoughRoom:!0};ce=[xe]}for(const xe of ce)o.aj(D,xe.point,xe.angle);return{}}function Se(w,l,d,m,_,x){const C=se(w.add(w.sub(l)._unit()),_,x).point,$=d.sub(C);return d.add($._mult(m/$.mag()))}function he(w,l){const{projectionCache:d,lineVertexArray:m,labelPlaneMatrix:_,tileAnchorPoint:x,distanceFromAnchor:C,getElevation:$,previousVertex:R,direction:D,absOffsetX:B}=l;if(d.projections[w])return d.projections[w];const U=new o.P(m.getx(w),m.gety(w)),Y=se(U,_,$);if(Y.signedDistanceFromCamera>0)return d.projections[w]=Y.point,Y.point;const ne=w-D;return Se(C===0?x:new o.P(m.getx(ne),m.gety(ne)),U,R,B-C+1,_,$)}function Ie(w,l,d){return w._unit()._perp()._mult(l*d)}function Be(w,l,d,m,_,x,C,$){const{projectionCache:R,direction:D}=$;if(R.offsets[w])return R.offsets[w];const B=d.add(l);if(w+D<m||w+D>=_)return R.offsets[w]=B,B;const U=he(w+D,$),Y=Ie(U.sub(d),C,D),ne=d.add(Y),re=U.add(Y);return R.offsets[w]=o.ak(x,B,ne,re)||B,R.offsets[w]}function ee(w,l,d,m,_,x,C,$,R,D,B,U,Y,ne){const re=m?w-l:w+l;let le=re>0?1:-1,X=0;m&&(le*=-1,X=Math.PI),le<0&&(X+=Math.PI);let fe,Ae,ce=le>0?$+C:$+C+1,xe=_,Pe=_,Ce=0,Re=0;const qe=Math.abs(re),Ue=[];let Ve;for(;Ce+Re<=qe;){if(ce+=le,ce<$||ce>=R)return null;Ce+=Re,Pe=xe,Ae=fe;const tt={projectionCache:U,lineVertexArray:D,labelPlaneMatrix:B,tileAnchorPoint:x,distanceFromAnchor:Ce,getElevation:ne,previousVertex:Pe,direction:le,absOffsetX:qe};if(xe=he(ce,tt),d===0)Ue.push(Pe),Ve=xe.sub(Pe);else{let Rt;const Yt=xe.sub(Pe);Rt=Yt.mag()===0?Ie(he(ce+le,tt).sub(xe),d,le):Ie(Yt,d,le),Ae||(Ae=Pe.add(Rt)),fe=Be(ce,Rt,xe,$,R,Ae,d,tt),Ue.push(Ae),Ve=fe.sub(Ae)}Re=Ve.mag()}const dt=Ve._mult((qe-Ce)/Re)._add(Ae||Pe),Vt=X+Math.atan2(xe.y-Pe.y,xe.x-Pe.x);return Ue.push(dt),{point:dt,angle:Y?Vt:0,path:Ue}}const ke=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function gt(w,l){for(let d=0;d<w;d++){const m=l.length;l.resize(m+4),l.float32.set(ke,3*m)}}function xt(w,l,d){const m=l[0],_=l[1];return w[0]=d[0]*m+d[4]*_+d[12],w[1]=d[1]*m+d[5]*_+d[13],w[3]=d[3]*m+d[7]*_+d[15],w}const It=100;class Ze{constructor(l,d=new Gt(l.width+200,l.height+200,25),m=new Gt(l.width+200,l.height+200,25)){this.transform=l,this.grid=d,this.ignoredGrid=m,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+It,this.screenBottomBoundary=l.height+It,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,d,m,_,x,C){const $=this.projectAndGetPerspectiveRatio(_,l.anchorPointX,l.anchorPointY,C),R=m*$.perspectiveRatio,D=l.x1*R+$.point.x,B=l.y1*R+$.point.y,U=l.x2*R+$.point.x,Y=l.y2*R+$.point.y;return!this.isInsideGrid(D,B,U,Y)||d!=="always"&&this.grid.hitTest(D,B,U,Y,d,x)||$.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[D,B,U,Y],offscreen:this.isOffscreen(D,B,U,Y)}}placeCollisionCircles(l,d,m,_,x,C,$,R,D,B,U,Y,ne,re){const le=[],X=new o.P(d.anchorX,d.anchorY),fe=se(X,C,re),Ae=j(this.transform.cameraToCenterDistance,fe.signedDistanceFromCamera),ce=(B?x/Ae:x*Ae)/o.ao,xe=se(X,$,re).point,Pe=te(ce,_,d.lineOffsetX*ce,d.lineOffsetY*ce,!1,xe,X,d,m,$,{projections:{},offsets:{}},!1,re);let Ce=!1,Re=!1,qe=!0;if(Pe){const Ue=.5*Y*Ae+ne,Ve=new o.P(-100,-100),dt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Vt=new Ur,tt=Pe.first,Rt=Pe.last;let Yt=[];for(let Qt=tt.path.length-1;Qt>=1;Qt--)Yt.push(tt.path[Qt]);for(let Qt=1;Qt<Rt.path.length;Qt++)Yt.push(Rt.path[Qt]);const ui=2.5*Ue;if(R){const Qt=Yt.map(ei=>se(ei,R,re));Yt=Qt.some(ei=>ei.signedDistanceFromCamera<=0)?[]:Qt.map(ei=>ei.point)}let Nt=[];if(Yt.length>0){const Qt=Yt[0].clone(),ei=Yt[0].clone();for(let ir=1;ir<Yt.length;ir++)Qt.x=Math.min(Qt.x,Yt[ir].x),Qt.y=Math.min(Qt.y,Yt[ir].y),ei.x=Math.max(ei.x,Yt[ir].x),ei.y=Math.max(ei.y,Yt[ir].y);Nt=Qt.x>=Ve.x&&ei.x<=dt.x&&Qt.y>=Ve.y&&ei.y<=dt.y?[Yt]:ei.x<Ve.x||Qt.x>dt.x||ei.y<Ve.y||Qt.y>dt.y?[]:o.al([Yt],Ve.x,Ve.y,dt.x,dt.y)}for(const Qt of Nt){Vt.reset(Qt,.25*Ue);let ei=0;ei=Vt.length<=.5*Ue?1:Math.ceil(Vt.paddedLength/ui)+1;for(let ir=0;ir<ei;ir++){const zi=ir/Math.max(ei-1,1),Qs=Vt.lerp(zi),$r=Qs.x+It,ji=Qs.y+It;le.push($r,ji,Ue,0);const _s=$r-Ue,no=ji-Ue,Oo=$r+Ue,ic=ji+Ue;if(qe=qe&&this.isOffscreen(_s,no,Oo,ic),Re=Re||this.isInsideGrid(_s,no,Oo,ic),l!=="always"&&this.grid.hitTestCircle($r,ji,Ue,l,U)&&(Ce=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ce}}}}return{circles:!D&&Ce||!Re||Ae<this.perspectiveRatioCutoff?[]:le,offscreen:qe,collisionDetected:Ce}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let m=1/0,_=1/0,x=-1/0,C=-1/0;for(const B of l){const U=new o.P(B.x+It,B.y+It);m=Math.min(m,U.x),_=Math.min(_,U.y),x=Math.max(x,U.x),C=Math.max(C,U.y),d.push(U)}const $=this.grid.query(m,_,x,C).concat(this.ignoredGrid.query(m,_,x,C)),R={},D={};for(const B of $){const U=B.key;if(R[U.bucketInstanceId]===void 0&&(R[U.bucketInstanceId]={}),R[U.bucketInstanceId][U.featureIndex])continue;const Y=[new o.P(B.x1,B.y1),new o.P(B.x2,B.y1),new o.P(B.x2,B.y2),new o.P(B.x1,B.y2)];o.am(d,Y)&&(R[U.bucketInstanceId][U.featureIndex]=!0,D[U.bucketInstanceId]===void 0&&(D[U.bucketInstanceId]=[]),D[U.bucketInstanceId].push(U.featureIndex))}return D}insertCollisionBox(l,d,m,_,x,C){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:C,overlapMode:d},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,m,_,x,C){const $=m?this.ignoredGrid:this.grid,R={bucketInstanceId:_,featureIndex:x,collisionGroupID:C,overlapMode:d};for(let D=0;D<l.length;D+=4)$.insertCircle(R,l[D],l[D+1],l[D+2])}projectAndGetPerspectiveRatio(l,d,m,_){let x;return _?(x=[d,m,_(d,m),1],o.af(x,x,l)):(x=[d,m,0,1],xt(x,x,l)),{point:new o.P((x[0]/x[3]+1)/2*this.transform.width+It,(-x[1]/x[3]+1)/2*this.transform.height+It),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(l,d,m,_){return m<It||l>=this.screenRightBoundary||_<It||d>this.screenBottomBoundary}isInsideGrid(l,d,m,_){return m>=0&&l<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=o.an([]);return o.H(l,l,[-100,-100,0]),l}}function Dt(w,l,d){return l*(o.W/(w.tileSize*Math.pow(2,d-w.tileID.overscaledZ)))}class Xt{constructor(l,d,m,_){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):_&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class wi{constructor(l,d,m,_,x){this.text=new Xt(l?l.text:null,d,m,x),this.icon=new Xt(l?l.icon:null,d,_,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class or{constructor(l,d,m){this.text=l,this.icon=d,this.skipFade=m}}class kt{constructor(){this.invProjMatrix=o.F(),this.viewportMatrix=o.F(),this.circles=[]}}class Wi{constructor(l,d,m,_,x){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=m,this.bucketIndex=_,this.tileID=x}}class br{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:m=>m.collisionGroupID===d}}return this.collisionGroups[l]}}function Mt(w,l,d,m,_){const{horizontalAlign:x,verticalAlign:C}=o.at(w);return new o.P(-(x-.5)*l+m[0]*_,-(C-.5)*d+m[1]*_)}function Xr(w,l,d,m,_,x){const{x1:C,x2:$,y1:R,y2:D,anchorPointX:B,anchorPointY:U}=w,Y=new o.P(l,d);return m&&Y._rotate(_?x:-x),{x1:C+Y.x,y1:R+Y.y,x2:$+Y.x,y2:D+Y.y,anchorPointX:B,anchorPointY:U}}class Qr{constructor(l,d,m,_,x){this.transform=l.clone(),this.terrain=d,this.collisionIndex=new Ze(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new br(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,m,_){const x=m.getBucket(d),C=m.latestFeatureIndex;if(!x||!C||d.id!==x.layerIds[0])return;const $=m.collisionBoxArray,R=x.layers[0].layout,D=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),B=m.tileSize/o.W,U=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),Y=R.get("text-pitch-alignment")==="map",ne=R.get("text-rotation-alignment")==="map",re=Dt(m,1,this.transform.zoom),le=Po(U,Y,ne,this.transform,re);let X=null;if(Y){const Ae=io(U,Y,ne,this.transform,re);X=o.K([],this.transform.labelPlaneMatrix,Ae)}this.retainedQueryData[x.bucketInstanceId]=new Wi(x.bucketInstanceId,C,x.sourceLayerIndex,x.index,m.tileID);const fe={bucket:x,layout:R,posMatrix:U,textLabelPlaneMatrix:le,labelToScreenMatrix:X,scale:D,textPixelRatio:B,holdingForFade:m.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:o.ag(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const Ae of x.sortKeyRanges){const{sortKey:ce,symbolInstanceStart:xe,symbolInstanceEnd:Pe}=Ae;l.push({sortKey:ce,symbolInstanceStart:xe,symbolInstanceEnd:Pe,parameters:fe})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(l,d,m,_,x,C,$,R,D,B,U,Y,ne,re,le,X){const fe=o.ap[l.textAnchor],Ae=[l.textOffset0,l.textOffset1],ce=Mt(fe,m,_,Ae,x),xe=this.collisionIndex.placeCollisionBox(Xr(d,ce.x,ce.y,C,$,this.transform.angle),U,R,D,B.predicate,X);if((!le||this.collisionIndex.placeCollisionBox(Xr(le,ce.x,ce.y,C,$,this.transform.angle),U,R,D,B.predicate,X).box.length!==0)&&xe.box.length>0){let Pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(Pe=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Ae,width:m,height:_,anchor:fe,textBoxScale:x,prevAnchor:Pe},this.markUsedJustification(ne,fe,Y,re),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,re,Y),this.placedOrientations[Y.crossTileID]=re),{shift:ce,placedGlyphBoxes:xe}}}placeLayerBucketPart(l,d,m){const{bucket:_,layout:x,posMatrix:C,textLabelPlaneMatrix:$,labelToScreenMatrix:R,textPixelRatio:D,holdingForFade:B,collisionBoxArray:U,partiallyEvaluatedTextSize:Y,collisionGroup:ne}=l.parameters,re=x.get("text-optional"),le=x.get("icon-optional"),X=o.aq(x,"text-overlap","text-allow-overlap"),fe=X==="always",Ae=o.aq(x,"icon-overlap","icon-allow-overlap"),ce=Ae==="always",xe=x.get("text-rotation-alignment")==="map",Pe=x.get("text-pitch-alignment")==="map",Ce=x.get("icon-text-fit")!=="none",Re=x.get("symbol-z-order")==="viewport-y",qe=fe&&(ce||!_.hasIconData()||le),Ue=ce&&(fe||!_.hasTextData()||re);!_.collisionArrays&&U&&_.deserializeCollisionBoxes(U);const Ve=this.retainedQueryData[_.bucketInstanceId].tileID,dt=this.terrain?(tt,Rt)=>this.terrain.getElevation(Ve,tt,Rt):null,Vt=(tt,Rt)=>{var Yt,ui;if(d[tt.crossTileID])return;if(B)return void(this.placements[tt.crossTileID]=new or(!1,!1,!1));let Nt=!1,Qt=!1,ei=!0,ir=null,zi={box:null,offscreen:null},Qs={box:null,offscreen:null},$r=null,ji=null,_s=null,no=0,Oo=0,ic=0;Rt.textFeatureIndex?no=Rt.textFeatureIndex:tt.useRuntimeCollisionCircles&&(no=tt.featureIndex),Rt.verticalTextFeatureIndex&&(Oo=Rt.verticalTextFeatureIndex);const rc=Rt.textBox;if(rc){const lr=er=>{let is=o.ah.horizontal;if(_.allowVerticalPlacement&&!er&&this.prevPlacement){const vn=this.prevPlacement.placedOrientations[tt.crossTileID];vn&&(this.placedOrientations[tt.crossTileID]=vn,is=vn,this.markUsedOrientation(_,is,tt))}return is},Yi=(er,is)=>{if(_.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&Rt.verticalTextBox){for(const vn of _.writingModes)if(vn===o.ah.vertical?(zi=is(),Qs=zi):zi=er(),zi&&zi.box&&zi.box.length)break}else zi=er()},mr=tt.textAnchorOffsetStartIndex,cu=tt.textAnchorOffsetEndIndex;if(cu===mr){const er=(is,vn)=>{const li=this.collisionIndex.placeCollisionBox(is,X,D,C,ne.predicate,dt);return li&&li.box&&li.box.length&&(this.markUsedOrientation(_,vn,tt),this.placedOrientations[tt.crossTileID]=vn),li};Yi(()=>er(rc,o.ah.horizontal),()=>{const is=Rt.verticalTextBox;return _.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&is?er(is,o.ah.vertical):{box:null,offscreen:null}}),lr(zi&&zi.box&&zi.box.length)}else{let er=o.ap[(ui=(Yt=this.prevPlacement)===null||Yt===void 0?void 0:Yt.variableOffsets[tt.crossTileID])===null||ui===void 0?void 0:ui.anchor];const is=(li,zy,_1)=>{const sc=li.x2-li.x1,nc=li.y2-li.y1,lf=tt.textBoxScale,Fy=Ce&&Ae==="never"?zy:null;let oc={box:[],offscreen:!1},v1=X==="never"?1:2,By="never";er&&v1++;for(let b1=0;b1<v1;b1++){for(let Yh=mr;Yh<cu;Yh++){const w1=_.textAnchorOffsets.get(Yh);if(er&&w1.textAnchor!==er)continue;const Jh=this.attemptAnchorPlacement(w1,li,sc,nc,lf,xe,Pe,D,C,ne,By,tt,_,_1,Fy,dt);if(Jh&&(oc=Jh.placedGlyphBoxes,oc&&oc.box&&oc.box.length))return Nt=!0,ir=Jh.shift,oc}er?er=null:By=X}return oc};Yi(()=>is(rc,Rt.iconBox,o.ah.horizontal),()=>{const li=Rt.verticalTextBox;return _.allowVerticalPlacement&&!(zi&&zi.box&&zi.box.length)&&tt.numVerticalGlyphVertices>0&&li?is(li,Rt.verticalIconBox,o.ah.vertical):{box:null,offscreen:null}}),zi&&(Nt=zi.box,ei=zi.offscreen);const vn=lr(zi&&zi.box);if(!Nt&&this.prevPlacement){const li=this.prevPlacement.variableOffsets[tt.crossTileID];li&&(this.variableOffsets[tt.crossTileID]=li,this.markUsedJustification(_,li.anchor,tt,vn))}}}if($r=zi,Nt=$r&&$r.box&&$r.box.length>0,ei=$r&&$r.offscreen,tt.useRuntimeCollisionCircles){const lr=_.text.placedSymbolArray.get(tt.centerJustifiedTextSymbolIndex),Yi=o.ai(_.textSizeData,Y,lr),mr=x.get("text-padding");ji=this.collisionIndex.placeCollisionCircles(X,lr,_.lineVertexArray,_.glyphOffsetArray,Yi,C,$,R,m,Pe,ne.predicate,tt.collisionCircleDiameter,mr,dt),ji.circles.length&&ji.collisionDetected&&!m&&o.w("Collisions detected, but collision boxes are not shown"),Nt=fe||ji.circles.length>0&&!ji.collisionDetected,ei=ei&&ji.offscreen}if(Rt.iconFeatureIndex&&(ic=Rt.iconFeatureIndex),Rt.iconBox){const lr=Yi=>{const mr=Ce&&ir?Xr(Yi,ir.x,ir.y,xe,Pe,this.transform.angle):Yi;return this.collisionIndex.placeCollisionBox(mr,Ae,D,C,ne.predicate,dt)};Qs&&Qs.box&&Qs.box.length&&Rt.verticalIconBox?(_s=lr(Rt.verticalIconBox),Qt=_s.box.length>0):(_s=lr(Rt.iconBox),Qt=_s.box.length>0),ei=ei&&_s.offscreen}const Lo=re||tt.numHorizontalGlyphVertices===0&&tt.numVerticalGlyphVertices===0,oo=le||tt.numIconVertices===0;if(Lo||oo?oo?Lo||(Qt=Qt&&Nt):Nt=Qt&&Nt:Qt=Nt=Qt&&Nt,Nt&&$r&&$r.box&&this.collisionIndex.insertCollisionBox($r.box,X,x.get("text-ignore-placement"),_.bucketInstanceId,Qs&&Qs.box&&Oo?Oo:no,ne.ID),Qt&&_s&&this.collisionIndex.insertCollisionBox(_s.box,Ae,x.get("icon-ignore-placement"),_.bucketInstanceId,ic,ne.ID),ji&&(Nt&&this.collisionIndex.insertCollisionCircles(ji.circles,X,x.get("text-ignore-placement"),_.bucketInstanceId,no,ne.ID),m)){const lr=_.bucketInstanceId;let Yi=this.collisionCircleArrays[lr];Yi===void 0&&(Yi=this.collisionCircleArrays[lr]=new kt);for(let mr=0;mr<ji.circles.length;mr+=4)Yi.circles.push(ji.circles[mr+0]),Yi.circles.push(ji.circles[mr+1]),Yi.circles.push(ji.circles[mr+2]),Yi.circles.push(ji.collisionDetected?1:0)}if(tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tt.crossTileID]=new or(Nt||qe,Qt||Ue,ei||_.justReloaded),d[tt.crossTileID]=!0};if(Re){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tt=_.getSortedSymbolIndexes(this.transform.angle);for(let Rt=tt.length-1;Rt>=0;--Rt){const Yt=tt[Rt];Vt(_.symbolInstances.get(Yt),_.collisionArrays[Yt])}}else for(let tt=l.symbolInstanceStart;tt<l.symbolInstanceEnd;tt++)Vt(_.symbolInstances.get(tt),_.collisionArrays[tt]);if(m&&_.bucketInstanceId in this.collisionCircleArrays){const tt=this.collisionCircleArrays[_.bucketInstanceId];o.ar(tt.invProjMatrix,C),tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(l,d,m,_){let x;x=_===o.ah.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[o.as(d)];const C=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const $ of C)$>=0&&(l.text.placedSymbolArray.get($).crossTileID=x>=0&&$!==x?0:m.crossTileID)}markUsedOrientation(l,d,m){const _=d===o.ah.horizontal||d===o.ah.horizontalOnly?d:0,x=d===o.ah.vertical?d:0,C=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const $ of C)l.text.placedSymbolArray.get($).placedOrientation=_;m.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let m=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(l):1,x=d?d.opacities:{},C=d?d.variableOffsets:{},$=d?d.placedOrientations:{};for(const R in this.placements){const D=this.placements[R],B=x[R];B?(this.opacities[R]=new wi(B,_,D.text,D.icon),m=m||D.text!==B.text.placed||D.icon!==B.icon.placed):(this.opacities[R]=new wi(null,_,D.text,D.icon,D.skipFade),m=m||D.text||D.icon)}for(const R in x){const D=x[R];if(!this.opacities[R]){const B=new wi(D,_,!1,!1);B.isHidden()||(this.opacities[R]=B,m=m||D.text.placed||D.icon.placed)}}for(const R in C)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=C[R]);for(const R in $)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=$[R]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d){const m={};for(const _ of d){const x=_.getBucket(l);x&&_.latestFeatureIndex&&l.id===x.layerIds[0]&&this.updateBucketOpacities(x,m,_.collisionBoxArray)}}updateBucketOpacities(l,d,m){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const _=l.layers[0],x=_.layout,C=new wi(null,0,!1,!1,!0),$=x.get("text-allow-overlap"),R=x.get("icon-allow-overlap"),D=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=x.get("text-rotation-alignment")==="map",U=x.get("text-pitch-alignment")==="map",Y=x.get("icon-text-fit")!=="none",ne=new wi(null,0,$&&(R||!l.hasIconData()||x.get("icon-optional")),R&&($||!l.hasTextData()||x.get("text-optional")),!0);!l.collisionArrays&&m&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(m);const re=(le,X,fe)=>{for(let Ae=0;Ae<X/4;Ae++)le.opacityVertexArray.emplaceBack(fe);le.hasVisibleVertices=le.hasVisibleVertices||fe!==es};for(let le=0;le<l.symbolInstances.length;le++){const X=l.symbolInstances.get(le),{numHorizontalGlyphVertices:fe,numVerticalGlyphVertices:Ae,crossTileID:ce}=X;let xe=this.opacities[ce];d[ce]?xe=C:xe||(xe=ne,this.opacities[ce]=xe),d[ce]=!0;const Pe=X.numIconVertices>0,Ce=this.placedOrientations[X.crossTileID],Re=Ce===o.ah.vertical,qe=Ce===o.ah.horizontal||Ce===o.ah.horizontalOnly;if(fe>0||Ae>0){const Ue=Rp(xe.text);re(l.text,fe,Re?es:Ue),re(l.text,Ae,qe?es:Ue);const Ve=xe.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(tt=>{tt>=0&&(l.text.placedSymbolArray.get(tt).hidden=Ve||Re?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=Ve||qe?1:0);const dt=this.variableOffsets[X.crossTileID];dt&&this.markUsedJustification(l,dt.anchor,X,Ce);const Vt=this.placedOrientations[X.crossTileID];Vt&&(this.markUsedJustification(l,"left",X,Vt),this.markUsedOrientation(l,Vt,X))}if(Pe){const Ue=Rp(xe.icon),Ve=!(Y&&X.verticalPlacedIconSymbolIndex&&Re);X.placedIconSymbolIndex>=0&&(re(l.icon,X.numIconVertices,Ve?Ue:es),l.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=xe.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(re(l.icon,X.numVerticalIconVertices,Ve?es:Ue),l.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=xe.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const Ue=l.collisionArrays[le];if(Ue){let Ve=new o.P(0,0);if(Ue.textBox||Ue.verticalTextBox){let Vt=!0;if(D){const tt=this.variableOffsets[ce];tt?(Ve=Mt(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textBoxScale),B&&Ve._rotate(U?this.transform.angle:-this.transform.angle)):Vt=!1}Ue.textBox&&Os(l.textCollisionBox.collisionVertexArray,xe.text.placed,!Vt||Re,Ve.x,Ve.y),Ue.verticalTextBox&&Os(l.textCollisionBox.collisionVertexArray,xe.text.placed,!Vt||qe,Ve.x,Ve.y)}const dt=!!(!qe&&Ue.verticalIconBox);Ue.iconBox&&Os(l.iconCollisionBox.collisionVertexArray,xe.icon.placed,dt,Y?Ve.x:0,Y?Ve.y:0),Ue.verticalIconBox&&Os(l.iconCollisionBox.collisionVertexArray,xe.icon.placed,!dt,Y?Ve.x:0,Y?Ve.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const le=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=le.invProjMatrix,l.placementViewportMatrix=le.viewportMatrix,l.collisionCircleArray=le.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const m=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*m>l}setStale(){this.stale=!0}}function Os(w,l,d,m,_){w.emplaceBack(l?1:0,d?1:0,m||0,_||0),w.emplaceBack(l?1:0,d?1:0,m||0,_||0),w.emplaceBack(l?1:0,d?1:0,m||0,_||0),w.emplaceBack(l?1:0,d?1:0,m||0,_||0)}const kp=Math.pow(2,25),kh=Math.pow(2,24),Ei=Math.pow(2,17),Hl=Math.pow(2,16),pr=Math.pow(2,9),Ls=Math.pow(2,8),gs=Math.pow(2,1);function Rp(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const l=w.placed?1:0,d=Math.floor(127*w.opacity);return d*kp+l*kh+d*Ei+l*Hl+d*pr+l*Ls+d*gs+l}const es=0;class Js{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,d,m,_,x){const C=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(C,_,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort(($,R)=>$.sortKey-R.sortKey));this._currentPartIndex<C.length;)if(d.placeLayerBucketPart(C[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,x())return!0;return!1}}class Op{constructor(l,d,m,_,x,C,$,R){this.placement=new Qr(l,d,C,$,R),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(l,d,m){const _=M.now(),x=()=>!this._forceFullPlacement&&M.now()-_>2;for(;this._currentPlacementIndex>=0;){const C=d[l[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=$)&&(!C.maxzoom||C.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new Js(C)),this._inProgressLayer.continuePlacement(m[C.source],this.placement,this._showCollisionBoxes,C,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Co=512/o.W/2;class Si{constructor(l,d,m){this.tileID=l,this.bucketInstanceId=m,this._symbolsByKey={};const _=new Map;for(let x=0;x<d.length;x++){const C=d.get(x),$=C.key,R=_.get($);R?R.push(C):_.set($,[C])}for(const[x,C]of _){const $={positions:C.map(R=>({x:Math.floor(R.anchorX*Co),y:Math.floor(R.anchorY*Co)})),crossTileIDs:C.map(R=>R.crossTileID)};if($.positions.length>128){const R=new o.au($.positions.length,16,Uint16Array);for(const{x:D,y:B}of $.positions)R.add(D,B);R.finish(),delete $.positions,$.index=R}this._symbolsByKey[x]=$}}getScaledCoordinates(l,d){const{x:m,y:_,z:x}=this.tileID.canonical,{x:C,y:$,z:R}=d.canonical,D=Co/Math.pow(2,R-x),B=($*o.W+l.anchorY)*D,U=_*o.W*Co;return{x:Math.floor((C*o.W+l.anchorX)*D-m*o.W*Co),y:Math.floor(B-U)}}findMatches(l,d,m){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let x=0;x<l.length;x++){const C=l.get(x);if(C.crossTileID)continue;const $=this._symbolsByKey[C.key];if(!$)continue;const R=this.getScaledCoordinates(C,d);if($.index){const D=$.index.range(R.x-_,R.y-_,R.x+_,R.y+_).sort();for(const B of D){const U=$.crossTileIDs[B];if(!m[U]){m[U]=!0,C.crossTileID=U;break}}}else if($.positions)for(let D=0;D<$.positions.length;D++){const B=$.positions[D],U=$.crossTileIDs[D];if(Math.abs(B.x-R.x)<=_&&Math.abs(B.y-R.y)<=_&&!m[U]){m[U]=!0,C.crossTileID=U;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:l})=>l)}}class Wl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class da{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(d!==0)for(const m in this.indexes){const _=this.indexes[m],x={};for(const C in _){const $=_[C];$.tileID=$.tileID.unwrapTo($.tileID.wrap+d),x[$.tileID.key]=$}this.indexes[m]=x}this.lng=l}addBucket(l,d,m){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let x=0;x<d.symbolInstances.length;x++)d.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const _=this.usedCrossTileIDs[l.overscaledZ];for(const x in this.indexes){const C=this.indexes[x];if(Number(x)>l.overscaledZ)for(const $ in C){const R=C[$];R.tileID.isChildOf(l)&&R.findMatches(d.symbolInstances,l,_)}else{const $=C[l.scaledTo(Number(x)).key];$&&$.findMatches(d.symbolInstances,l,_)}}for(let x=0;x<d.symbolInstances.length;x++){const C=d.symbolInstances.get(x);C.crossTileID||(C.crossTileID=m.generate(),_[C.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Si(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const m of d.getCrossTileIDsLists())for(const _ of m)delete this.usedCrossTileIDs[l][_]}removeStaleBuckets(l){let d=!1;for(const m in this.indexes){const _=this.indexes[m];for(const x in _)l[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,_[x]),delete _[x],d=!0)}return d}}class ae{constructor(){this.layerIndexes={},this.crossTileIDs=new Wl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,m){let _=this.layerIndexes[l.id];_===void 0&&(_=this.layerIndexes[l.id]=new da);let x=!1;const C={};_.handleWrapJump(m);for(const $ of d){const R=$.getBucket(l);R&&l.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket($.tileID,R,this.crossTileIDs)&&(x=!0),C[R.bucketInstanceId]=!0)}return _.removeStaleBuckets(C)&&(x=!0),x}pruneUnusedLayers(l){const d={};l.forEach(m=>{d[m]=!0});for(const m in this.layerIndexes)d[m]||delete this.layerIndexes[m]}}const De=(w,l)=>o.t(w,l&&l.filter(d=>d.identifier!=="source.canvas")),je=o.av();class Zt extends o.E{constructor(l,d={}){super(),this._rtlPluginLoaded=()=>{for(const m in this.sourceCaches){const _=this.sourceCaches[m].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[m].reload()}},this.map=l,this.dispatcher=new Ke(ms(),l._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(m,_)=>this.getGlyphs(m,_)),this.dispatcher.registerMessageHandler("getImages",(m,_)=>this.getImages(m,_)),this.imageManager=new ft,this.imageManager.setEventedParent(this),this.glyphManager=new Ft(l._requestManager,d.localIdeographFontFamily),this.lineAtlas=new _r(256,512),this.crossTileSymbolIndex=new ae,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.ax()),Rs().on(ks,this._rtlPluginLoaded),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const _=this.sourceCaches[m.sourceId];if(!_)return;const x=_.getSource();if(x&&x.vectorLayerIds)for(const C in this._layers){const $=this._layers[C];$.source===x.id&&this._validateLayer($)}})}loadURL(l,d={},m){this.fire(new o.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(l,_e.Style);this._loadStyleRequest=new AbortController,o.h(_,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,d,m)}).catch(x=>{this._loadStyleRequest=null,x&&this.fire(new o.j(x))})}loadJSON(l,d={},m){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(l,d,m)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(je,{validate:!1})}_load(l,d,m){var _;const x=d.transformStyle?d.transformStyle(m,l):l;if(!d.validate||!De(this,o.x(x))){this._loaded=!0,this.stylesheet=x;for(const C in x.sources)this.addSource(C,x.sources[C],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new Cr(this.stylesheet.light),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const l=o.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",l),this._order=l.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of l){const m=o.az(d);m.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=m}}_loadSprite(l,d=!1,m=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,C,$,R){return o._(this,void 0,void 0,function*(){const D=ct(x),B=$>1?"@2x":"",U={},Y={};for(const{id:ne,url:re}of D){const le=C.transformRequest(C.normalizeSpriteURL(re,B,".json"),_e.SpriteJSON);U[ne]=o.h(le,R);const X=C.transformRequest(C.normalizeSpriteURL(re,B,".png"),_e.SpriteImage);Y[ne]=pe.getImage(X,R)}return yield Promise.all([...Object.values(U),...Object.values(Y)]),function(ne,re){return o._(this,void 0,void 0,function*(){const le={};for(const X in ne){le[X]={};const fe=M.getImageCanvasContext((yield re[X]).data),Ae=(yield ne[X]).data;for(const ce in Ae){const{width:xe,height:Pe,x:Ce,y:Re,sdf:qe,pixelRatio:Ue,stretchX:Ve,stretchY:dt,content:Vt}=Ae[ce];le[X][ce]={data:null,pixelRatio:Ue,sdf:qe,stretchX:Ve,stretchY:dt,content:Vt,spriteData:{width:xe,height:Pe,x:Ce,y:Re,context:fe}}}}return le})}(U,Y)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const C in x){this._spritesImagesIds[C]=[];const $=this._spritesImagesIds[C]?this._spritesImagesIds[C].filter(R=>!(R in x)):[];for(const R of $)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in x[C]){const D=C==="default"?R:`${C}:${R}`;this._spritesImagesIds[C].push(D),D in this.imageManager.images?this.imageManager.updateImage(D,x[C][R],!1):this.imageManager.addImage(D,x[C][R]),d&&(this._changedImages[D]=!0)}}}).catch(x=>{this._spriteRequest=null,_=x,this.fire(new o.j(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),m&&m(_)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(l){const d=this.sourceCaches[l.source];if(!d)return;const m=l.sourceLayer;if(!m)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.j(new Error(`Source layer "${m}" does not exist on source "${_.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l){const d=this._serializedAllLayers();if(!l||l.length===0)return Object.values(d);const m=[];for(const _ of l)d[_]&&m.push(d[_]);return m}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const d=Object.keys(this._layers);for(const m of d){const _=this._layers[m];_.type!=="custom"&&(l[m]=_.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const d=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const C in this._updatedSources){const $=this._updatedSources[C];if($==="reload")this._reloadSource(C);else{if($!=="clear")throw new Error(`Invalid action ${$}`);this._clearSource(C)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const m={};for(const _ in this.sourceCaches){const x=this.sourceCaches[_];m[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];x.recalculate(l,this._availableImages),!x.isHidden(l.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const _ in m){const x=this.sourceCaches[_];m[_]!==x.used&&x.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(l),this.z=l.zoom,d&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(l),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,d={}){var m;this._checkLoaded();const _=this.serialize();if(l=d.transformStyle?d.transformStyle(_,l):l,((m=d.validate)===null||m===void 0||m)&&De(this,o.x(l)))return!1;(l=o.aA(l)).layers=o.ay(l.layers);const x=o.aB(_,l),C=this._getOperationsToPerform(x);if(C.unimplemented.length>0)throw new Error(`Unimplemented: ${C.unimplemented.join(", ")}.`);if(C.operations.length===0)return!1;for(const $ of C.operations)$();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const d=[],m=[];for(const _ of l)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:m.push(_.command)}return{operations:d,unimplemented:m}}addImage(l,d){if(this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,d),this._afterImageUpdated(l)}updateImage(l,d){this.imageManager.updateImage(l,d)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,d,m={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.x.source,`sources.${l}`,d,null,m))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[l]=new Ye(l,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:l})),_.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===l)return this.fire(new o.j(new Error(`Source "${l}" cannot be removed while layer "${m}" is using it.`)));const d=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],d.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,d){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const m=this.sourceCaches[l].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(d),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,d,m={}){this._checkLoaded();const _=l.id;if(this.getLayer(_))return void this.fire(new o.j(new Error(`Layer "${_}" already exists on this map.`)));let x;if(l.type==="custom"){if(De(this,o.aC(l)))return;x=o.az(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(_,l.source),l=o.aA(l),l=o.e(l,{source:_})),this._validate(o.x.layer,`layers.${_}`,l,{arrayIndex:-1},m))return;x=o.az(l),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}})}const C=d?this._order.indexOf(d):this._order.length;if(d&&C===-1)this.fire(new o.j(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(C,0,_),this._layerOrderChanged=!0,this._layers[_]=x,this._removedLayers[_]&&x.source&&x.type!=="custom"){const $=this._removedLayers[_];delete this._removedLayers[_],$.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(l,d){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===d)return;const m=this._order.indexOf(l);this._order.splice(m,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new o.j(new Error(`Cannot move layer "${l}" before non-existing layer "${d}".`))):(this._order.splice(_,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const d=this._layers[l];if(!d)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${l}".`)));d.setEventedParent(null);const m=this._order.indexOf(l);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,d,m){this._checkLoaded();const _=this.getLayer(l);_?_.minzoom===d&&_.maxzoom===m||(d!=null&&(_.minzoom=d),m!=null&&(_.maxzoom=m),this._updateLayer(_)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,d,m={}){this._checkLoaded();const _=this.getLayer(l);if(_){if(!o.aD(_.filter,d))return d==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.x.filter,`layers.${_.id}.filter`,d,null,m)||(_.filter=o.aA(d),this._updateLayer(_)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.aA(this.getLayer(l).filter)}setLayoutProperty(l,d,m,_={}){this._checkLoaded();const x=this.getLayer(l);x?o.aD(x.getLayoutProperty(d),m)||(x.setLayoutProperty(d,m,_),this._updateLayer(x)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,d){const m=this.getLayer(l);if(m)return m.getLayoutProperty(d);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,d,m,_={}){this._checkLoaded();const x=this.getLayer(l);x?o.aD(x.getPaintProperty(d),m)||(x.setPaintProperty(d,m,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,d){return this.getLayer(l).getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const m=l.source,_=l.sourceLayer,x=this.sourceCaches[m];if(x===void 0)return void this.fire(new o.j(new Error(`The source '${m}' does not exist in the map's style.`)));const C=x.getSource().type;C==="geojson"&&_?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):C!=="vector"||_?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(_,l.id,d)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,d){this._checkLoaded();const m=l.source,_=this.sourceCaches[m];if(_===void 0)return void this.fire(new o.j(new Error(`The source '${m}' does not exist in the map's style.`)));const x=_.getSource().type,C=x==="vector"?l.sourceLayer:void 0;x!=="vector"||C?d&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(C,l.id,d):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const d=l.source,m=l.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||m?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),_.getFeatureState(m,l.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.aE(this.sourceCaches,x=>x.serialize()),d=this._serializeByIds(this._order),m=this.map.getTerrain()||void 0,_=this.stylesheet;return o.aF({version:_.version,name:_.name,metadata:_.metadata,light:_.light,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,sources:l,layers:d,terrain:m},x=>x!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const d=C=>this._layers[C].type==="fill-extrusion",m={},_=[];for(let C=this._order.length-1;C>=0;C--){const $=this._order[C];if(d($)){m[$]=C;for(const R of l){const D=R[$];if(D)for(const B of D)_.push(B)}}}_.sort((C,$)=>$.intersectionZ-C.intersectionZ);const x=[];for(let C=this._order.length-1;C>=0;C--){const $=this._order[C];if(d($))for(let R=_.length-1;R>=0;R--){const D=_[R].feature;if(m[D.layer.id]<C)break;x.push(D),_.pop()}else for(const R of l){const D=R[$];if(D)for(const B of D)x.push(B.feature)}}return x}queryRenderedFeatures(l,d,m){d&&d.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const $ of d.layers){const R=this._layers[$];if(!R)return this.fire(new o.j(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];_[R.source]=!0}}const x=[];d.availableImages=this._availableImages;const C=this._serializedAllLayers();for(const $ in this.sourceCaches)d.layers&&!_[$]||x.push($s(this.sourceCaches[$],this._layers,C,l,d,m));return this.placement&&x.push(function($,R,D,B,U,Y,ne){const re={},le=Y.queryRenderedSymbols(B),X=[];for(const fe of Object.keys(le).map(Number))X.push(ne[fe]);X.sort(Io);for(const fe of X){const Ae=fe.featureIndex.lookupSymbolFeatures(le[fe.bucketInstanceId],R,fe.bucketIndex,fe.sourceLayerIndex,U.filter,U.layers,U.availableImages,$);for(const ce in Ae){const xe=re[ce]=re[ce]||[],Pe=Ae[ce];Pe.sort((Ce,Re)=>{const qe=fe.featureSortOrder;if(qe){const Ue=qe.indexOf(Ce.featureIndex);return qe.indexOf(Re.featureIndex)-Ue}return Re.featureIndex-Ce.featureIndex});for(const Ce of Pe)xe.push(Ce)}}for(const fe in re)re[fe].forEach(Ae=>{const ce=Ae.feature,xe=D[$[fe].source].getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=xe});return re}(this._layers,C,this.sourceCaches,l,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(l,d){d&&d.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",d.filter,null,d);const m=this.sourceCaches[l];return m?function(_,x){const C=_.getRenderableIds().map(D=>_.getTileByID(D)),$=[],R={};for(let D=0;D<C.length;D++){const B=C[D],U=B.tileID.canonical.key;R[U]||(R[U]=!0,B.querySourceFeatures($,x))}return $}(m,d):[]}getLight(){return this.light.getLight()}setLight(l,d={}){this._checkLoaded();const m=this.light.getLight();let _=!1;for(const C in l)if(!o.aD(l[C],m[C])){_=!0;break}if(!_)return;const x={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,d),this.light.updateTransitions(x)}_validate(l,d,m,_,x={}){return(!x||x.validate!==!1)&&De(this,l.call(o.x,o.e({key:d,style:this.serialize(),value:m,styleSpec:o.v},_)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Rs().off(ks,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const m=this.sourceCaches[d];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const d in this.sourceCaches)this.sourceCaches[d].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,d,m,_,x=!1){let C=!1,$=!1;const R={};for(const D of this._order){const B=this._layers[D];if(B.type!=="symbol")continue;if(!R[B.source]){const Y=this.sourceCaches[B.source];R[B.source]=Y.getRenderableIds(!0).map(ne=>Y.getTileByID(ne)).sort((ne,re)=>re.tileID.overscaledZ-ne.tileID.overscaledZ||(ne.tileID.isLessThan(re.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(B,R[B.source],l.center.lng);C=C||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M.now(),l.zoom))&&(this.pauseablePlacement=new Op(l,this.map.terrain,this._order,x,d,m,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M.now()),$=!0),C&&this.pauseablePlacement.placement.setStale()),$||C)for(const D of this._order){const B=this._layers[D];B.type==="symbol"&&this.placement.updateLayerOpacities(B,R[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,d){return o._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),m})}getGlyphs(l,d){return o._(this,void 0,void 0,function*(){const m=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,d={}){this._checkLoaded(),l&&this._validate(o.x.glyphs,"glyphs",l,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,d,m={},_){this._checkLoaded();const x=[{id:l,url:d}],C=[...ct(this.stylesheet.sprite),...x];this._validate(o.x.sprite,"sprite",C,null,m)||(this.stylesheet.sprite=C,this._loadSprite(x,!0,_))}removeSprite(l){this._checkLoaded();const d=ct(this.stylesheet.sprite);if(d.find(m=>m.id===l)){if(this._spritesImagesIds[l])for(const m of this._spritesImagesIds[l])this.imageManager.removeImage(m),this._changedImages[m]=!0;d.splice(d.findIndex(m=>m.id===l),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(l,d={},m){this._checkLoaded(),l&&this._validate(o.x.sprite,"sprite",l,null,d)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,m):(this._unloadSprite(),m&&m(null)))}}var Mi=o.X([{name:"a_pos",type:"Int16",components:2}]),Ti="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const jr={prelude:yi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:yi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:yi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:yi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:yi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:yi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:yi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:yi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yi("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ti),terrainDepth:yi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ti),terrainCoords:yi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ti)};function yi(w,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=l.match(/attribute ([\w]+) ([\w]+)/g),_=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=x?x.concat(_):_,$={};return{fragmentSource:w=w.replace(d,(R,D,B,U,Y)=>($[Y]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${B} ${U} ${Y};
#else
uniform ${B} ${U} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${B} ${U} ${Y} = u_${Y};
#endif
`)),vertexSource:l=l.replace(d,(R,D,B,U,Y)=>{const ne=U==="float"?"vec2":"vec4",re=Y.match(/color/)?"color":ne;return $[Y]?D==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${B} ${ne} a_${Y};
varying ${B} ${U} ${Y};
#else
uniform ${B} ${U} u_${Y};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${B} ${U} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${re}(a_${Y}, u_${Y}_t);
#else
    ${B} ${U} ${Y} = u_${Y};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${B} ${ne} a_${Y};
#else
uniform ${B} ${U} u_${Y};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${B} ${U} ${Y} = a_${Y};
#else
    ${B} ${U} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${B} ${U} ${Y} = unpack_mix_${re}(a_${Y}, u_${Y}_t);
#else
    ${B} ${U} ${Y} = u_${Y};
#endif
`}),staticAttributes:m,staticUniforms:C}}class Lp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,d,m,_,x,C,$,R,D){this.context=l;let B=this.boundPaintVertexBuffers.length!==_.length;for(let U=0;!B&&U<_.length;U++)this.boundPaintVertexBuffers[U]!==_[U]&&(B=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==m||B||this.boundIndexBuffer!==x||this.boundVertexOffset!==C||this.boundDynamicVertexBuffer!==$||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==D?this.freshBind(d,m,_,x,C,$,R,D):(l.bindVertexArray.set(this.vao),$&&$.bind(),x&&x.dynamicDraw&&x.bind(),R&&R.bind(),D&&D.bind())}freshBind(l,d,m,_,x,C,$,R){const D=l.numAttributes,B=this.context,U=B.gl;this.vao&&this.destroy(),this.vao=B.createVertexArray(),B.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=C,this.boundDynamicVertexBuffer2=$,this.boundDynamicVertexBuffer3=R,d.enableAttributes(U,l);for(const Y of m)Y.enableAttributes(U,l);C&&C.enableAttributes(U,l),$&&$.enableAttributes(U,l),R&&R.enableAttributes(U,l),d.bind(),d.setVertexAttribPointers(U,l,x);for(const Y of m)Y.bind(),Y.setVertexAttribPointers(U,l,x);C&&(C.bind(),C.setVertexAttribPointers(U,l,x)),_&&_.bind(),$&&($.bind(),$.setVertexAttribPointers(U,l,x)),R&&(R.bind(),R.setVertexAttribPointers(U,l,x)),B.currentNumAttributes=D}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function $o(w){const l=[];for(let d=0;d<w.length;d++){if(w[d]===null)continue;const m=w[d].split(" ");l.push(m.pop())}return l}class Xm{constructor(l,d,m,_,x,C){const $=l.gl;this.program=$.createProgram();const R=$o(d.staticAttributes),D=m?m.getBinderAttributes():[],B=R.concat(D),U=jr.prelude.staticUniforms?$o(jr.prelude.staticUniforms):[],Y=d.staticUniforms?$o(d.staticUniforms):[],ne=m?m.getBinderUniforms():[],re=U.concat(Y).concat(ne),le=[];for(const Ce of re)le.indexOf(Ce)<0&&le.push(Ce);const X=m?m.defines():[];x&&X.push("#define OVERDRAW_INSPECTOR;"),C&&X.push("#define TERRAIN3D;");const fe=X.concat(jr.prelude.fragmentSource,d.fragmentSource).join(`
`),Ae=X.concat(jr.prelude.vertexSource,d.vertexSource).join(`
`),ce=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(ce,fe),$.compileShader(ce),!$.getShaderParameter(ce,$.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${$.getShaderInfoLog(ce)}`);$.attachShader(this.program,ce);const xe=$.createShader($.VERTEX_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(xe,Ae),$.compileShader(xe),!$.getShaderParameter(xe,$.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${$.getShaderInfoLog(xe)}`);$.attachShader(this.program,xe),this.attributes={};const Pe={};this.numAttributes=B.length;for(let Ce=0;Ce<this.numAttributes;Ce++)B[Ce]&&($.bindAttribLocation(this.program,Ce,B[Ce]),this.attributes[B[Ce]]=Ce);if($.linkProgram(this.program),!$.getProgramParameter(this.program,$.LINK_STATUS))throw new Error(`Program failed to link: ${$.getProgramInfoLog(this.program)}`);$.deleteShader(xe),$.deleteShader(ce);for(let Ce=0;Ce<le.length;Ce++){const Re=le[Ce];if(Re&&!Pe[Re]){const qe=$.getUniformLocation(this.program,Re);qe&&(Pe[Re]=qe)}}this.fixedUniforms=_(l,Pe),this.terrainUniforms=((Ce,Re)=>({u_depth:new o.aG(Ce,Re.u_depth),u_terrain:new o.aG(Ce,Re.u_terrain),u_terrain_dim:new o.aH(Ce,Re.u_terrain_dim),u_terrain_matrix:new o.aI(Ce,Re.u_terrain_matrix),u_terrain_unpack:new o.aJ(Ce,Re.u_terrain_unpack),u_terrain_exaggeration:new o.aH(Ce,Re.u_terrain_exaggeration)}))(l,Pe),this.binderUniforms=m?m.getUniforms(l,Pe):[]}draw(l,d,m,_,x,C,$,R,D,B,U,Y,ne,re,le,X,fe,Ae){const ce=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(m),l.setStencilMode(_),l.setColorMode(x),l.setCullFace(C),R){l.activeTexture.set(ce.TEXTURE2),ce.bindTexture(ce.TEXTURE_2D,R.depthTexture),l.activeTexture.set(ce.TEXTURE3),ce.bindTexture(ce.TEXTURE_2D,R.texture);for(const Pe in this.terrainUniforms)this.terrainUniforms[Pe].set(R[Pe])}for(const Pe in this.fixedUniforms)this.fixedUniforms[Pe].set($[Pe]);le&&le.setUniforms(l,this.binderUniforms,ne,{zoom:re});let xe=0;switch(d){case ce.LINES:xe=2;break;case ce.TRIANGLES:xe=3;break;case ce.LINE_STRIP:xe=1}for(const Pe of Y.get()){const Ce=Pe.vaos||(Pe.vaos={});(Ce[D]||(Ce[D]=new Lp)).bind(l,this,B,le?le.getPaintVertexBuffers():[],U,Pe.vertexOffset,X,fe,Ae),ce.drawElements(d,Pe.primitiveLength*xe,ce.UNSIGNED_SHORT,Pe.primitiveOffset*xe*2)}}}function Rh(w,l,d){const m=1/Dt(d,1,l.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,l.transform.tileZoom)/_,C=x*(d.tileID.canonical.x+d.tileID.wrap*_),$=x*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[m,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[C>>16,$>>16],u_pixel_coord_lower:[65535&C,65535&$]}}const N_=(w,l,d,m)=>{const _=l.style.light,x=_.properties.get("position"),C=[x.x,x.y,x.z],$=function(){var D=new o.A(9);return o.A!=Float32Array&&(D[1]=0,D[2]=0,D[3]=0,D[5]=0,D[6]=0,D[7]=0),D[0]=1,D[4]=1,D[8]=1,D}();_.properties.get("anchor")==="viewport"&&function(D,B){var U=Math.sin(B),Y=Math.cos(B);D[0]=Y,D[1]=U,D[2]=0,D[3]=-U,D[4]=Y,D[5]=0,D[6]=0,D[7]=0,D[8]=1}($,-l.transform.angle),function(D,B,U){var Y=B[0],ne=B[1],re=B[2];D[0]=Y*U[0]+ne*U[3]+re*U[6],D[1]=Y*U[1]+ne*U[4]+re*U[7],D[2]=Y*U[2]+ne*U[5]+re*U[8]}(C,C,$);const R=_.properties.get("color");return{u_matrix:w,u_lightpos:C,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+d,u_opacity:m}},n2=(w,l,d,m,_,x,C)=>o.e(N_(w,l,d,m),Rh(x,l,C),{u_height_factor:-Math.pow(2,_.overscaledZ)/C.tileSize/8}),Dp=w=>({u_matrix:w}),z_=(w,l,d,m)=>o.e(Dp(w),Rh(d,l,m)),F_=(w,l)=>({u_matrix:w,u_world:l}),o2=(w,l,d,m,_)=>o.e(z_(w,l,d,m),{u_world:_}),B_=(w,l,d,m)=>{const _=w.transform;let x,C;if(m.paint.get("circle-pitch-alignment")==="map"){const $=Dt(d,1,_.zoom);x=!0,C=[$,$]}else x=!1,C=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:w.translatePosMatrix(l.posMatrix,d,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:C}},a2=(w,l,d)=>{const m=Dt(d,1,l.zoom),_=Math.pow(2,l.zoom-d.tileID.overscaledZ),x=d.tileID.overscaleFactor();return{u_matrix:w,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[l.pixelsToGLUnits[0]/(m*_),l.pixelsToGLUnits[1]/(m*_)],u_overscale_factor:x}},Np=(w,l,d=1)=>({u_matrix:w,u_color:l,u_overlay:0,u_overlay_scale:d}),Qm=w=>({u_matrix:w}),U_=(w,l,d,m)=>({u_matrix:w,u_extrude_scale:Dt(l,1,d),u_intensity:m});function j_(w,l){const d=Math.pow(2,l.canonical.z),m=l.canonical.y;return[new o.Y(0,m/d).toLngLat().lat,new o.Y(0,(m+1)/d).toLngLat().lat]}const zp=(w,l,d,m)=>{const _=w.transform;return{u_matrix:Lh(w,l,d,m),u_ratio:1/Dt(l,1,_.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Zl=(w,l,d,m,_)=>o.e(zp(w,l,d,_),{u_image:0,u_image_height:m}),Fp=(w,l,d,m,_)=>{const x=w.transform,C=Oh(l,x);return{u_matrix:Lh(w,l,d,_),u_texsize:l.imageAtlasTexture.size,u_ratio:1/Dt(l,1,x.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[C,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Un=(w,l,d,m,_,x)=>{const C=w.lineAtlas,$=Oh(l,w.transform),R=d.layout.get("line-cap")==="round",D=C.getDash(m.from,R),B=C.getDash(m.to,R),U=D.width*_.fromScale,Y=B.width*_.toScale;return o.e(zp(w,l,d,x),{u_patternscale_a:[$/U,-D.height/2],u_patternscale_b:[$/Y,-B.height/2],u_sdfgamma:C.width/(256*Math.min(U,Y)*w.pixelRatio)/2,u_image:0,u_tex_y_a:D.y,u_tex_y_b:B.y,u_mix:_.t})};function Oh(w,l){return 1/Dt(w,1,l.tileZoom)}function Lh(w,l,d,m){return w.translatePosMatrix(m?m.posMatrix:l.tileID.posMatrix,l,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Dh=(w,l,d,m,_)=>{return{u_matrix:w,u_tl_parent:l,u_scale_parent:d,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(C=_.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(x=_.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Bp(_.paint.get("raster-hue-rotate"))};var x,C};function Bp(w){w*=Math.PI/180;const l=Math.sin(w),d=Math.cos(w);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const Nh=(w,l,d,m,_,x,C,$,R,D)=>{const B=_.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:B.width/B.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:C,u_coord_matrix:$,u_is_text:+R,u_pitch_with_map:+m,u_texsize:D,u_texture:0}},qc=(w,l,d,m,_,x,C,$,R,D,B)=>{const U=_.transform;return o.e(Nh(w,l,d,m,_,x,C,$,R,D),{u_gamma_scale:m?Math.cos(U._pitch)*U.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+B})},l2=(w,l,d,m,_,x,C,$,R,D)=>o.e(qc(w,l,d,m,_,x,C,$,!0,R,!0),{u_texsize_icon:D,u_texture_icon:1}),c2=(w,l,d)=>({u_matrix:w,u_opacity:l,u_color:d}),V_=(w,l,d,m,_,x)=>o.e(function(C,$,R,D){const B=R.imageManager.getPattern(C.from.toString()),U=R.imageManager.getPattern(C.to.toString()),{width:Y,height:ne}=R.imageManager.getPixelSize(),re=Math.pow(2,D.tileID.overscaledZ),le=D.tileSize*Math.pow(2,R.transform.tileZoom)/re,X=le*(D.tileID.canonical.x+D.tileID.wrap*re),fe=le*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[Y,ne],u_mix:$.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:$.fromScale,u_scale_b:$.toScale,u_tile_units_to_pixels:1/Dt(D,1,R.transform.tileZoom),u_pixel_coord_upper:[X>>16,fe>>16],u_pixel_coord_lower:[65535&X,65535&fe]}}(m,x,d,_),{u_matrix:w,u_opacity:l}),u2={fillExtrusion:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_lightpos:new o.aK(w,l.u_lightpos),u_lightintensity:new o.aH(w,l.u_lightintensity),u_lightcolor:new o.aK(w,l.u_lightcolor),u_vertical_gradient:new o.aH(w,l.u_vertical_gradient),u_opacity:new o.aH(w,l.u_opacity)}),fillExtrusionPattern:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_lightpos:new o.aK(w,l.u_lightpos),u_lightintensity:new o.aH(w,l.u_lightintensity),u_lightcolor:new o.aK(w,l.u_lightcolor),u_vertical_gradient:new o.aH(w,l.u_vertical_gradient),u_height_factor:new o.aH(w,l.u_height_factor),u_image:new o.aG(w,l.u_image),u_texsize:new o.aL(w,l.u_texsize),u_pixel_coord_upper:new o.aL(w,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(w,l.u_pixel_coord_lower),u_scale:new o.aK(w,l.u_scale),u_fade:new o.aH(w,l.u_fade),u_opacity:new o.aH(w,l.u_opacity)}),fill:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix)}),fillPattern:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_image:new o.aG(w,l.u_image),u_texsize:new o.aL(w,l.u_texsize),u_pixel_coord_upper:new o.aL(w,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(w,l.u_pixel_coord_lower),u_scale:new o.aK(w,l.u_scale),u_fade:new o.aH(w,l.u_fade)}),fillOutline:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_world:new o.aL(w,l.u_world)}),fillOutlinePattern:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_world:new o.aL(w,l.u_world),u_image:new o.aG(w,l.u_image),u_texsize:new o.aL(w,l.u_texsize),u_pixel_coord_upper:new o.aL(w,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(w,l.u_pixel_coord_lower),u_scale:new o.aK(w,l.u_scale),u_fade:new o.aH(w,l.u_fade)}),circle:(w,l)=>({u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_scale_with_map:new o.aG(w,l.u_scale_with_map),u_pitch_with_map:new o.aG(w,l.u_pitch_with_map),u_extrude_scale:new o.aL(w,l.u_extrude_scale),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_matrix:new o.aI(w,l.u_matrix)}),collisionBox:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_pixels_to_tile_units:new o.aH(w,l.u_pixels_to_tile_units),u_extrude_scale:new o.aL(w,l.u_extrude_scale),u_overscale_factor:new o.aH(w,l.u_overscale_factor)}),collisionCircle:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_inv_matrix:new o.aI(w,l.u_inv_matrix),u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_viewport_size:new o.aL(w,l.u_viewport_size)}),debug:(w,l)=>({u_color:new o.aM(w,l.u_color),u_matrix:new o.aI(w,l.u_matrix),u_overlay:new o.aG(w,l.u_overlay),u_overlay_scale:new o.aH(w,l.u_overlay_scale)}),clippingMask:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix)}),heatmap:(w,l)=>({u_extrude_scale:new o.aH(w,l.u_extrude_scale),u_intensity:new o.aH(w,l.u_intensity),u_matrix:new o.aI(w,l.u_matrix)}),heatmapTexture:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_world:new o.aL(w,l.u_world),u_image:new o.aG(w,l.u_image),u_color_ramp:new o.aG(w,l.u_color_ramp),u_opacity:new o.aH(w,l.u_opacity)}),hillshade:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_image:new o.aG(w,l.u_image),u_latrange:new o.aL(w,l.u_latrange),u_light:new o.aL(w,l.u_light),u_shadow:new o.aM(w,l.u_shadow),u_highlight:new o.aM(w,l.u_highlight),u_accent:new o.aM(w,l.u_accent)}),hillshadePrepare:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_image:new o.aG(w,l.u_image),u_dimension:new o.aL(w,l.u_dimension),u_zoom:new o.aH(w,l.u_zoom),u_unpack:new o.aJ(w,l.u_unpack)}),line:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_ratio:new o.aH(w,l.u_ratio),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(w,l.u_units_to_pixels)}),lineGradient:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_ratio:new o.aH(w,l.u_ratio),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(w,l.u_units_to_pixels),u_image:new o.aG(w,l.u_image),u_image_height:new o.aH(w,l.u_image_height)}),linePattern:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_texsize:new o.aL(w,l.u_texsize),u_ratio:new o.aH(w,l.u_ratio),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_image:new o.aG(w,l.u_image),u_units_to_pixels:new o.aL(w,l.u_units_to_pixels),u_scale:new o.aK(w,l.u_scale),u_fade:new o.aH(w,l.u_fade)}),lineSDF:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_ratio:new o.aH(w,l.u_ratio),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_units_to_pixels:new o.aL(w,l.u_units_to_pixels),u_patternscale_a:new o.aL(w,l.u_patternscale_a),u_patternscale_b:new o.aL(w,l.u_patternscale_b),u_sdfgamma:new o.aH(w,l.u_sdfgamma),u_image:new o.aG(w,l.u_image),u_tex_y_a:new o.aH(w,l.u_tex_y_a),u_tex_y_b:new o.aH(w,l.u_tex_y_b),u_mix:new o.aH(w,l.u_mix)}),raster:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_tl_parent:new o.aL(w,l.u_tl_parent),u_scale_parent:new o.aH(w,l.u_scale_parent),u_buffer_scale:new o.aH(w,l.u_buffer_scale),u_fade_t:new o.aH(w,l.u_fade_t),u_opacity:new o.aH(w,l.u_opacity),u_image0:new o.aG(w,l.u_image0),u_image1:new o.aG(w,l.u_image1),u_brightness_low:new o.aH(w,l.u_brightness_low),u_brightness_high:new o.aH(w,l.u_brightness_high),u_saturation_factor:new o.aH(w,l.u_saturation_factor),u_contrast_factor:new o.aH(w,l.u_contrast_factor),u_spin_weights:new o.aK(w,l.u_spin_weights)}),symbolIcon:(w,l)=>({u_is_size_zoom_constant:new o.aG(w,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(w,l.u_is_size_feature_constant),u_size_t:new o.aH(w,l.u_size_t),u_size:new o.aH(w,l.u_size),u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_pitch:new o.aH(w,l.u_pitch),u_rotate_symbol:new o.aG(w,l.u_rotate_symbol),u_aspect_ratio:new o.aH(w,l.u_aspect_ratio),u_fade_change:new o.aH(w,l.u_fade_change),u_matrix:new o.aI(w,l.u_matrix),u_label_plane_matrix:new o.aI(w,l.u_label_plane_matrix),u_coord_matrix:new o.aI(w,l.u_coord_matrix),u_is_text:new o.aG(w,l.u_is_text),u_pitch_with_map:new o.aG(w,l.u_pitch_with_map),u_texsize:new o.aL(w,l.u_texsize),u_texture:new o.aG(w,l.u_texture)}),symbolSDF:(w,l)=>({u_is_size_zoom_constant:new o.aG(w,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(w,l.u_is_size_feature_constant),u_size_t:new o.aH(w,l.u_size_t),u_size:new o.aH(w,l.u_size),u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_pitch:new o.aH(w,l.u_pitch),u_rotate_symbol:new o.aG(w,l.u_rotate_symbol),u_aspect_ratio:new o.aH(w,l.u_aspect_ratio),u_fade_change:new o.aH(w,l.u_fade_change),u_matrix:new o.aI(w,l.u_matrix),u_label_plane_matrix:new o.aI(w,l.u_label_plane_matrix),u_coord_matrix:new o.aI(w,l.u_coord_matrix),u_is_text:new o.aG(w,l.u_is_text),u_pitch_with_map:new o.aG(w,l.u_pitch_with_map),u_texsize:new o.aL(w,l.u_texsize),u_texture:new o.aG(w,l.u_texture),u_gamma_scale:new o.aH(w,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_is_halo:new o.aG(w,l.u_is_halo)}),symbolTextAndIcon:(w,l)=>({u_is_size_zoom_constant:new o.aG(w,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(w,l.u_is_size_feature_constant),u_size_t:new o.aH(w,l.u_size_t),u_size:new o.aH(w,l.u_size),u_camera_to_center_distance:new o.aH(w,l.u_camera_to_center_distance),u_pitch:new o.aH(w,l.u_pitch),u_rotate_symbol:new o.aG(w,l.u_rotate_symbol),u_aspect_ratio:new o.aH(w,l.u_aspect_ratio),u_fade_change:new o.aH(w,l.u_fade_change),u_matrix:new o.aI(w,l.u_matrix),u_label_plane_matrix:new o.aI(w,l.u_label_plane_matrix),u_coord_matrix:new o.aI(w,l.u_coord_matrix),u_is_text:new o.aG(w,l.u_is_text),u_pitch_with_map:new o.aG(w,l.u_pitch_with_map),u_texsize:new o.aL(w,l.u_texsize),u_texsize_icon:new o.aL(w,l.u_texsize_icon),u_texture:new o.aG(w,l.u_texture),u_texture_icon:new o.aG(w,l.u_texture_icon),u_gamma_scale:new o.aH(w,l.u_gamma_scale),u_device_pixel_ratio:new o.aH(w,l.u_device_pixel_ratio),u_is_halo:new o.aG(w,l.u_is_halo)}),background:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_opacity:new o.aH(w,l.u_opacity),u_color:new o.aM(w,l.u_color)}),backgroundPattern:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_opacity:new o.aH(w,l.u_opacity),u_image:new o.aG(w,l.u_image),u_pattern_tl_a:new o.aL(w,l.u_pattern_tl_a),u_pattern_br_a:new o.aL(w,l.u_pattern_br_a),u_pattern_tl_b:new o.aL(w,l.u_pattern_tl_b),u_pattern_br_b:new o.aL(w,l.u_pattern_br_b),u_texsize:new o.aL(w,l.u_texsize),u_mix:new o.aH(w,l.u_mix),u_pattern_size_a:new o.aL(w,l.u_pattern_size_a),u_pattern_size_b:new o.aL(w,l.u_pattern_size_b),u_scale_a:new o.aH(w,l.u_scale_a),u_scale_b:new o.aH(w,l.u_scale_b),u_pixel_coord_upper:new o.aL(w,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(w,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aH(w,l.u_tile_units_to_pixels)}),terrain:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_texture:new o.aG(w,l.u_texture),u_ele_delta:new o.aH(w,l.u_ele_delta)}),terrainDepth:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_ele_delta:new o.aH(w,l.u_ele_delta)}),terrainCoords:(w,l)=>({u_matrix:new o.aI(w,l.u_matrix),u_texture:new o.aG(w,l.u_texture),u_terrain_coords_id:new o.aH(w,l.u_terrain_coords_id),u_ele_delta:new o.aH(w,l.u_ele_delta)})};class Yl{constructor(l,d,m){this.context=l;const _=l.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Up={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gn{constructor(l,d,m,_){this.length=d.length,this.attributes=m,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=l;const x=l.gl;this.buffer=x.createBuffer(),l.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let m=0;m<this.attributes.length;m++){const _=d.attributes[this.attributes[m].name];_!==void 0&&l.enableVertexAttribArray(_)}}setVertexAttribPointers(l,d,m){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],C=d.attributes[x.name];C!==void 0&&l.vertexAttribPointer(C,x.components,l[Up[x.type]],!1,this.itemSize,x.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ds=new WeakMap;function Hc(w){var l;if(Ds.has(w))return Ds.get(w);{const d=(l=w.getParameter(w.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Ds.set(w,d),d}}class bi{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jp extends bi{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ey extends bi{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ty extends bi{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Vp extends bi{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class iy extends bi{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class ry extends bi{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Gp extends bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class G_ extends bi{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class q_ extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class Wc extends bi{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class h2 extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class d2 extends bi{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class p2 extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class f2 extends bi{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class m2 extends bi{getDefault(){return o.aO.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class y2 extends bi{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class sy extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class qp extends bi{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class ny extends bi{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class oy extends bi{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Zc extends bi{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class H_ extends bi{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class W_ extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class ay extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Jl extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Z_ extends bi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Yc extends bi{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Jc extends bi{getDefault(){return null}set(l){var d;if(l===this.current&&!this.dirty)return;const m=this.gl;Hc(m)?m.bindVertexArray(l):(d=m.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Y_ extends bi{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class ly extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class xi extends bi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Kc extends bi{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class g2 extends Kc{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class J_ extends Kc{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class zh extends Kc{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class _2{constructor(l,d,m,_,x){this.context=l,this.width=d,this.height=m;const C=l.gl,$=this.framebuffer=C.createFramebuffer();if(this.colorAttachment=new g2(l,$),_)this.depthAttachment=x?new zh(l,$):new J_(l,$);else if(x)throw new Error("Stencil cannot be set without depth");if(C.checkFramebufferStatus(C.FRAMEBUFFER)!==C.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){const m=this.depthAttachment.get();m&&l.deleteRenderbuffer(m)}l.deleteFramebuffer(this.framebuffer)}}class wr{constructor(l,d,m){this.blendFunction=l,this.blendColor=d,this.mask=m}}wr.Replace=[1,0],wr.disabled=new wr(wr.Replace,o.aO.transparent,[!1,!1,!1,!1]),wr.unblended=new wr(wr.Replace,o.aO.transparent,[!0,!0,!0,!0]),wr.alphaBlended=new wr([1,771],o.aO.transparent,[!0,!0,!0,!0]);class K_{constructor(l){var d,m;if(this.gl=l,this.clearColor=new jp(this),this.clearDepth=new ey(this),this.clearStencil=new ty(this),this.colorMask=new Vp(this),this.depthMask=new iy(this),this.stencilMask=new ry(this),this.stencilFunc=new Gp(this),this.stencilOp=new G_(this),this.stencilTest=new q_(this),this.depthRange=new Wc(this),this.depthTest=new h2(this),this.depthFunc=new d2(this),this.blend=new p2(this),this.blendFunc=new f2(this),this.blendColor=new m2(this),this.blendEquation=new y2(this),this.cullFace=new sy(this),this.cullFaceSide=new qp(this),this.frontFace=new ny(this),this.program=new oy(this),this.activeTexture=new Zc(this),this.viewport=new H_(this),this.bindFramebuffer=new W_(this),this.bindRenderbuffer=new ay(this),this.bindTexture=new Jl(this),this.bindVertexBuffer=new Z_(this),this.bindElementBuffer=new Yc(this),this.bindVertexArray=new Jc(this),this.pixelStoreUnpack=new Y_(this),this.pixelStoreUnpackPremultiplyAlpha=new ly(this),this.pixelStoreUnpackFlipY=new xi(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Hc(l)){this.HALF_FLOAT=l.HALF_FLOAT;const _=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=l.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(m=l.RGB16F)!==null&&m!==void 0?m:_==null?void 0:_.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const _=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d){return new Yl(this,l,d)}createVertexBuffer(l,d,m){return new gn(this,l,d,m)}createRenderbuffer(l,d,m){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,l,d,m),this.bindRenderbuffer.set(null),x}createFramebuffer(l,d,m,_){return new _2(this,l,d,m,_)}clear({color:l,depth:d,stencil:m}){const _=this.gl;let x=0;l&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),m!==void 0&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),_.clear(x)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.aD(l.blendFunction,wr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Hc(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var d;return Hc(this.gl)?this.gl.deleteVertexArray(l):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class gi{constructor(l,d,m){this.func=l,this.mask=d,this.range=m}}gi.ReadOnly=!1,gi.ReadWrite=!0,gi.disabled=new gi(519,gi.ReadOnly,[0,1]);const Fh=7680;class Ui{constructor(l,d,m,_,x,C){this.test=l,this.ref=d,this.mask=m,this.fail=_,this.depthFail=x,this.pass=C}}Ui.disabled=new Ui({func:519,mask:0},0,0,Fh,Fh,Fh);class Ni{constructor(l,d,m){this.enable=l,this.mode=d,this.frontFace=m}}let Xc;function Hp(w,l,d,m,_,x,C){const $=w.context,R=$.gl,D=w.useProgram("collisionBox"),B=[];let U=0,Y=0;for(let ce=0;ce<m.length;ce++){const xe=m[ce],Pe=l.getTile(xe),Ce=Pe.getBucket(d);if(!Ce)continue;let Re=xe.posMatrix;_[0]===0&&_[1]===0||(Re=w.translatePosMatrix(xe.posMatrix,Pe,_,x));const qe=C?Ce.textCollisionBox:Ce.iconCollisionBox,Ue=Ce.collisionCircleArray;if(Ue.length>0){const Ve=o.F(),dt=Re;o.aP(Ve,Ce.placementInvProjMatrix,w.transform.glCoordMatrix),o.aP(Ve,Ve,Ce.placementViewportMatrix),B.push({circleArray:Ue,circleOffset:Y,transform:dt,invTransform:Ve,coord:xe}),U+=Ue.length/4,Y=U}qe&&D.draw($,R.LINES,gi.disabled,Ui.disabled,w.colorModeForRenderPass(),Ni.disabled,a2(Re,w.transform,Pe),w.style.map.terrain&&w.style.map.terrain.getTerrainData(xe),d.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,w.transform.zoom,null,null,qe.collisionVertexBuffer)}if(!C||!B.length)return;const ne=w.useProgram("collisionCircle"),re=new o.aQ;re.resize(4*U),re._trim();let le=0;for(const ce of B)for(let xe=0;xe<ce.circleArray.length/4;xe++){const Pe=4*xe,Ce=ce.circleArray[Pe+0],Re=ce.circleArray[Pe+1],qe=ce.circleArray[Pe+2],Ue=ce.circleArray[Pe+3];re.emplace(le++,Ce,Re,qe,Ue,0),re.emplace(le++,Ce,Re,qe,Ue,1),re.emplace(le++,Ce,Re,qe,Ue,2),re.emplace(le++,Ce,Re,qe,Ue,3)}(!Xc||Xc.length<2*U)&&(Xc=function(ce){const xe=2*ce,Pe=new o.aS;Pe.resize(xe),Pe._trim();for(let Ce=0;Ce<xe;Ce++){const Re=6*Ce;Pe.uint16[Re+0]=4*Ce+0,Pe.uint16[Re+1]=4*Ce+1,Pe.uint16[Re+2]=4*Ce+2,Pe.uint16[Re+3]=4*Ce+2,Pe.uint16[Re+4]=4*Ce+3,Pe.uint16[Re+5]=4*Ce+0}return Pe}(U));const X=$.createIndexBuffer(Xc,!0),fe=$.createVertexBuffer(re,o.aR.members,!0);for(const ce of B){const xe={u_matrix:ce.transform,u_inv_matrix:ce.invTransform,u_camera_to_center_distance:(Ae=w.transform).cameraToCenterDistance,u_viewport_size:[Ae.width,Ae.height]};ne.draw($,R.TRIANGLES,gi.disabled,Ui.disabled,w.colorModeForRenderPass(),Ni.disabled,xe,w.style.map.terrain&&w.style.map.terrain.getTerrainData(ce.coord),d.id,fe,X,o.$.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,w.transform.zoom,null,null,null)}var Ae;fe.destroy(),X.destroy()}Ni.disabled=new Ni(!1,1029,2305),Ni.backCCW=new Ni(!0,1029,2305);const X_=o.an(new Float32Array(16));function Wp(w,l,d,m,_,x){const{horizontalAlign:C,verticalAlign:$}=o.at(w);return new o.P((-(C-.5)*l/_+m[0])*x,(-($-.5)*d/_+m[1])*x)}function Zp(w,l,d,m,_,x,C,$,R,D,B){const U=w.text.placedSymbolArray,Y=w.text.dynamicLayoutVertexArray,ne=w.icon.dynamicLayoutVertexArray,re={};Y.clear();for(let le=0;le<U.length;le++){const X=U.get(le),fe=X.hidden||!X.crossTileID||w.allowVerticalPlacement&&!X.placedOrientation?null:m[X.crossTileID];if(fe){const Ae=new o.P(X.anchorX,X.anchorY),ce=se(Ae,d?C:x,B),xe=j(_.cameraToCenterDistance,ce.signedDistanceFromCamera);let Pe=o.ai(w.textSizeData,R,X)*xe/o.ao;d&&(Pe*=w.tilePixelRatio/$);const{width:Ce,height:Re,anchor:qe,textOffset:Ue,textBoxScale:Ve}=fe,dt=Wp(qe,Ce,Re,Ue,Ve,Pe),Vt=d?se(Ae.add(dt),x,B).point:ce.point.add(l?dt.rotate(-_.angle):dt),tt=w.allowVerticalPlacement&&X.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let Rt=0;Rt<X.numGlyphs;Rt++)o.aj(Y,Vt,tt);D&&X.associatedIconIndex>=0&&(re[X.associatedIconIndex]={shiftedAnchor:Vt,angle:tt})}else gt(X.numGlyphs,Y)}if(D){ne.clear();const le=w.icon.placedSymbolArray;for(let X=0;X<le.length;X++){const fe=le.get(X);if(fe.hidden)gt(fe.numGlyphs,ne);else{const Ae=re[X];if(Ae)for(let ce=0;ce<fe.numGlyphs;ce++)o.aj(ne,Ae.shiftedAnchor,Ae.angle);else gt(fe.numGlyphs,ne)}}w.icon.dynamicLayoutVertexBuffer.updateData(ne)}w.text.dynamicLayoutVertexBuffer.updateData(Y)}function cy(w,l,d){return d.iconsInText&&l?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function Q_(w,l,d,m,_,x,C,$,R,D,B,U){const Y=w.context,ne=Y.gl,re=w.transform,le=$==="map",X=R==="map",fe=$!=="viewport"&&d.layout.get("symbol-placement")!=="point",Ae=le&&!X&&!fe,ce=!d.layout.get("symbol-sort-key").isConstant();let xe=!1;const Pe=w.depthModeForSublayer(0,gi.ReadOnly),Ce=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Re=[];for(const qe of m){const Ue=l.getTile(qe),Ve=Ue.getBucket(d);if(!Ve)continue;const dt=_?Ve.text:Ve.icon;if(!dt||!dt.segments.get().length||!dt.hasVisibleVertices)continue;const Vt=dt.programConfigurations.get(d.id),tt=_||Ve.sdfIcons,Rt=_?Ve.textSizeData:Ve.iconSizeData,Yt=X||re.pitch!==0,ui=w.useProgram(cy(tt,_,Ve),Vt),Nt=o.ag(Rt,re.zoom),Qt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(qe);let ei,ir,zi,Qs,$r=[0,0],ji=null;if(_)ir=Ue.glyphAtlasTexture,zi=ne.LINEAR,ei=Ue.glyphAtlasTexture.size,Ve.iconsInText&&($r=Ue.imageAtlasTexture.size,ji=Ue.imageAtlasTexture,Qs=Yt||w.options.rotating||w.options.zooming||Rt.kind==="composite"||Rt.kind==="camera"?ne.LINEAR:ne.NEAREST);else{const er=d.layout.get("icon-size").constantOr(0)!==1||Ve.iconsNeedLinear;ir=Ue.imageAtlasTexture,zi=tt||w.options.rotating||w.options.zooming||er||Yt?ne.LINEAR:ne.NEAREST,ei=Ue.imageAtlasTexture.size}const _s=Dt(Ue,1,w.transform.zoom),no=Po(qe.posMatrix,X,le,w.transform,_s),Oo=io(qe.posMatrix,X,le,w.transform,_s),ic=Ce&&Ve.hasTextData(),rc=d.layout.get("icon-text-fit")!=="none"&&ic&&Ve.hasIconData();if(fe){const er=w.style.map.terrain?(vn,li)=>w.style.map.terrain.getElevation(qe,vn,li):null,is=d.layout.get("text-rotation-alignment")==="map";K(Ve,qe.posMatrix,w,_,no,Oo,X,D,is,er)}const Lo=w.translatePosMatrix(qe.posMatrix,Ue,x,C),oo=fe||_&&Ce||rc?X_:no,lr=w.translatePosMatrix(Oo,Ue,x,C,!0),Yi=tt&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mr;mr=tt?Ve.iconsInText?l2(Rt.kind,Nt,Ae,X,w,Lo,oo,lr,ei,$r):qc(Rt.kind,Nt,Ae,X,w,Lo,oo,lr,_,ei,!0):Nh(Rt.kind,Nt,Ae,X,w,Lo,oo,lr,_,ei);const cu={program:ui,buffers:dt,uniformValues:mr,atlasTexture:ir,atlasTextureIcon:ji,atlasInterpolation:zi,atlasInterpolationIcon:Qs,isSDF:tt,hasHalo:Yi};if(ce&&Ve.canOverlap){xe=!0;const er=dt.segments.get();for(const is of er)Re.push({segments:new o.$([is]),sortKey:is.sortKey,state:cu,terrainData:Qt})}else Re.push({segments:dt.segments,sortKey:0,state:cu,terrainData:Qt})}xe&&Re.sort((qe,Ue)=>qe.sortKey-Ue.sortKey);for(const qe of Re){const Ue=qe.state;if(Y.activeTexture.set(ne.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,ne.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&(Y.activeTexture.set(ne.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,ne.CLAMP_TO_EDGE)),Ue.isSDF){const Ve=Ue.uniformValues;Ue.hasHalo&&(Ve.u_is_halo=1,Yp(Ue.buffers,qe.segments,d,w,Ue.program,Pe,B,U,Ve,qe.terrainData)),Ve.u_is_halo=0}Yp(Ue.buffers,qe.segments,d,w,Ue.program,Pe,B,U,Ue.uniformValues,qe.terrainData)}}function Yp(w,l,d,m,_,x,C,$,R,D){const B=m.context;_.draw(B,B.gl.TRIANGLES,x,C,$,Ni.disabled,R,D,d.id,w.layoutVertexBuffer,w.indexBuffer,l,d.paint,m.transform.zoom,w.programConfigurations.get(d.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function e1(w,l,d,m,_){if(!d||!m||!m.imageAtlas)return;const x=m.imageAtlas.patternPositions;let C=x[d.to.toString()],$=x[d.from.toString()];if(!C&&$&&(C=$),!$&&C&&($=C),!C||!$){const R=_.getPaintProperty(l);C=x[R],$=x[R]}C&&$&&w.setConstantPatternPositions(C,$)}function uy(w,l,d,m,_,x,C){const $=w.context.gl,R="fill-pattern",D=d.paint.get(R),B=D&&D.constantOr(1),U=d.getCrossfadeParameters();let Y,ne,re,le,X;C?(ne=B&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=$.LINES):(ne=B?"fillPattern":"fill",Y=$.TRIANGLES);const fe=D.constantOr(null);for(const Ae of m){const ce=l.getTile(Ae);if(B&&!ce.patternsLoaded())continue;const xe=ce.getBucket(d);if(!xe)continue;const Pe=xe.programConfigurations.get(d.id),Ce=w.useProgram(ne,Pe),Re=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Ae);B&&(w.context.activeTexture.set($.TEXTURE0),ce.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Pe.updatePaintBuffers(U)),e1(Pe,R,fe,ce,d);const qe=Re?Ae:null,Ue=w.translatePosMatrix(qe?qe.posMatrix:Ae.posMatrix,ce,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(C){le=xe.indexBuffer2,X=xe.segments2;const Ve=[$.drawingBufferWidth,$.drawingBufferHeight];re=ne==="fillOutlinePattern"&&B?o2(Ue,w,U,ce,Ve):F_(Ue,Ve)}else le=xe.indexBuffer,X=xe.segments,re=B?z_(Ue,w,U,ce):Dp(Ue);Ce.draw(w.context,Y,_,w.stencilModeForClipping(Ae),x,Ni.disabled,re,Re,d.id,xe.layoutVertexBuffer,le,X,d.paint,w.transform.zoom,Pe)}}function Qc(w,l,d,m,_,x,C){const $=w.context,R=$.gl,D="fill-extrusion-pattern",B=d.paint.get(D),U=B.constantOr(1),Y=d.getCrossfadeParameters(),ne=d.paint.get("fill-extrusion-opacity"),re=B.constantOr(null);for(const le of m){const X=l.getTile(le),fe=X.getBucket(d);if(!fe)continue;const Ae=w.style.map.terrain&&w.style.map.terrain.getTerrainData(le),ce=fe.programConfigurations.get(d.id),xe=w.useProgram(U?"fillExtrusionPattern":"fillExtrusion",ce);U&&(w.context.activeTexture.set(R.TEXTURE0),X.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ce.updatePaintBuffers(Y)),e1(ce,D,re,X,d);const Pe=w.translatePosMatrix(le.posMatrix,X,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ce=d.paint.get("fill-extrusion-vertical-gradient"),Re=U?n2(Pe,w,Ce,ne,le,Y,X):N_(Pe,w,Ce,ne);xe.draw($,$.gl.TRIANGLES,_,x,C,Ni.backCCW,Re,Ae,d.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,d.paint,w.transform.zoom,ce,w.style.map.terrain&&fe.centroidVertexBuffer)}}function hy(w,l,d,m,_,x,C){const $=w.context,R=$.gl,D=d.fbo;if(!D)return;const B=w.useProgram("hillshade"),U=w.style.map.terrain&&w.style.map.terrain.getTerrainData(l);$.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,D.colorAttachment.get()),B.draw($,R.TRIANGLES,_,x,C,Ni.disabled,((Y,ne,re,le)=>{const X=re.paint.get("hillshade-shadow-color"),fe=re.paint.get("hillshade-highlight-color"),Ae=re.paint.get("hillshade-accent-color");let ce=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(ce-=Y.transform.angle);const xe=!Y.options.moving;return{u_matrix:le?le.posMatrix:Y.transform.calculatePosMatrix(ne.tileID.toUnwrapped(),xe),u_image:0,u_latrange:j_(0,ne.tileID),u_light:[re.paint.get("hillshade-exaggeration"),ce],u_shadow:X,u_highlight:fe,u_accent:Ae}})(w,d,m,U?l:null),U,m.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments)}function t1(w,l,d,m,_,x){const C=w.context,$=C.gl,R=l.dem;if(R&&R.data){const D=R.dim,B=R.stride,U=R.getPixels();if(C.activeTexture.set($.TEXTURE1),C.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||w.getTileTexture(B),l.demTexture){const ne=l.demTexture;ne.update(U,{premultiply:!1}),ne.bind($.NEAREST,$.CLAMP_TO_EDGE)}else l.demTexture=new nt(C,U,$.RGBA,{premultiply:!1}),l.demTexture.bind($.NEAREST,$.CLAMP_TO_EDGE);C.activeTexture.set($.TEXTURE0);let Y=l.fbo;if(!Y){const ne=new nt(C,{width:D,height:D,data:null},$.RGBA);ne.bind($.LINEAR,$.CLAMP_TO_EDGE),Y=l.fbo=C.createFramebuffer(D,D,!0,!1),Y.colorAttachment.set(ne.texture)}C.bindFramebuffer.set(Y.framebuffer),C.viewport.set([0,0,D,D]),w.useProgram("hillshadePrepare").draw(C,$.TRIANGLES,m,_,x,Ni.disabled,((ne,re)=>{const le=re.stride,X=o.F();return o.aN(X,0,o.W,-o.W,0,0,1),o.H(X,X,[0,-o.W,0]),{u_matrix:X,u_image:1,u_dimension:[le,le],u_zoom:ne.overscaledZ,u_unpack:re.getUnpackVector()}})(l.tileID,R),null,d.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function i1(w,l,d,m,_,x){const C=m.paint.get("raster-fade-duration");if(!x&&C>0){const $=M.now(),R=($-w.timeAdded)/C,D=l?($-l.timeAdded)/C:-1,B=d.getSource(),U=_.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),Y=!l||Math.abs(l.tileID.overscaledZ-U)>Math.abs(w.tileID.overscaledZ-U),ne=Y&&w.refreshedUponExpiration?1:o.ac(Y?R:1-D,0,1);return w.refreshedUponExpiration&&R>=1&&(w.refreshedUponExpiration=!1),l?{opacity:1,mix:1-ne}:{opacity:ne,mix:0}}return{opacity:1,mix:0}}const Jp=new o.aO(1,0,0,1),dy=new o.aO(0,1,0,1),v2=new o.aO(0,0,1,1),r1=new o.aO(1,0,1,1),fr=new o.aO(0,1,1,1);function tl(w,l,d,m){eu(w,0,l+d/2,w.transform.width,d,m)}function _n(w,l,d,m){eu(w,l-d/2,0,d,w.transform.height,m)}function eu(w,l,d,m,_,x){const C=w.context,$=C.gl;$.enable($.SCISSOR_TEST),$.scissor(l*w.pixelRatio,d*w.pixelRatio,m*w.pixelRatio,_*w.pixelRatio),C.clear({color:x}),$.disable($.SCISSOR_TEST)}function py(w,l,d){const m=w.context,_=m.gl,x=d.posMatrix,C=w.useProgram("debug"),$=gi.disabled,R=Ui.disabled,D=w.colorModeForRenderPass(),B="$debug",U=w.style.map.terrain&&w.style.map.terrain.getTerrainData(d);m.activeTexture.set(_.TEXTURE0);const Y=l.getTileByID(d.key).latestRawTileData,ne=Math.floor((Y&&Y.byteLength||0)/1024),re=l.getTile(d).tileSize,le=512/Math.min(re,512)*(d.overscaledZ/w.transform.zoom)*.5;let X=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(X+=` => ${d.overscaledZ}`),function(fe,Ae){fe.initDebugOverlayCanvas();const ce=fe.debugOverlayCanvas,xe=fe.context.gl,Pe=fe.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,ce.width,ce.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(Ae,5,5),Pe.strokeText(Ae,5,5),fe.debugOverlayTexture.update(ce),fe.debugOverlayTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE)}(w,`${X} ${ne}kB`),C.draw(m,_.TRIANGLES,$,R,wr.alphaBlended,Ni.disabled,Np(x,o.aO.transparent,le),null,B,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),C.draw(m,_.LINE_STRIP,$,R,D,Ni.disabled,Np(x,o.aO.red),U,B,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function fy(w,l,d){const m=w.context,_=m.gl,x=w.colorModeForRenderPass(),C=new gi(_.LEQUAL,gi.ReadWrite,w.depthRangeFor3D),$=w.useProgram("terrain"),R=l.getTerrainMesh();m.bindFramebuffer.set(null),m.viewport.set([0,0,w.width,w.height]);for(const D of d){const B=w.renderToTexture.getTexture(D),U=l.getTerrainData(D.tileID);m.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,B.texture);const Y={u_matrix:w.transform.calculatePosMatrix(D.tileID.toUnwrapped()),u_texture:0,u_ele_delta:l.getMeshFrameDelta(w.transform.zoom)};$.draw(m,_.TRIANGLES,C,Ui.disabled,x,Ni.backCCW,Y,U,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}}class tu{constructor(l,d){this.context=new K_(l),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ye.maxUnderzooming+Ye.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ae}resize(l,d,m){if(this.width=Math.floor(l*m),this.height=Math.floor(d*m),this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const l=this.context,d=new o.aV;d.emplaceBack(0,0),d.emplaceBack(o.W,0),d.emplaceBack(0,o.W),d.emplaceBack(o.W,o.W),this.tileExtentBuffer=l.createVertexBuffer(d,Mi.members),this.tileExtentSegments=o.$.simpleSegment(0,0,4,2);const m=new o.aV;m.emplaceBack(0,0),m.emplaceBack(o.W,0),m.emplaceBack(0,o.W),m.emplaceBack(o.W,o.W),this.debugBuffer=l.createVertexBuffer(m,Mi.members),this.debugSegments=o.$.simpleSegment(0,0,4,5);const _=new o.Z;_.emplaceBack(0,0,0,0),_.emplaceBack(o.W,0,o.W,0),_.emplaceBack(0,o.W,0,o.W),_.emplaceBack(o.W,o.W,o.W,o.W),this.rasterBoundsBuffer=l.createVertexBuffer(_,Br.members),this.rasterBoundsSegments=o.$.simpleSegment(0,0,4,2);const x=new o.aV;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(x,Mi.members),this.viewportSegments=o.$.simpleSegment(0,0,4,2);const C=new o.aW;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(C);const $=new o.aX;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer($);const R=this.context.gl;this.stencilClearMode=new Ui({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO)}clearStencil(){const l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=o.F();o.aN(m,0,this.width,this.height,0,0,1),o.J(m,m,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,d.TRIANGLES,gi.disabled,this.stencilClearMode,wr.disabled,Ni.disabled,Qm(m),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,d){if(this.currentStencilSource===l.source||!l.isTileClipped()||!d||!d.length)return;this.currentStencilSource=l.source;const m=this.context,_=m.gl;this.nextStencilID+d.length>256&&this.clearStencil(),m.setColorMode(wr.disabled),m.setDepthMode(gi.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of d){const $=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,R=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C);x.draw(m,_.TRIANGLES,gi.disabled,new Ui({func:_.ALWAYS,mask:0},$,255,_.KEEP,_.KEEP,_.REPLACE),wr.disabled,Ni.disabled,Qm(C.posMatrix),R,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new Ui({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){const d=this.context.gl;return new Ui({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,m=l.sort((C,$)=>$.overscaledZ-C.overscaledZ),_=m[m.length-1].overscaledZ,x=m[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const C={};for(let $=0;$<x;$++)C[$+_]=new Ui({func:d.GEQUAL,mask:255},$+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=x,[C,m]}return[{[_]:Ui.disabled},m]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new wr([l.CONSTANT_COLOR,l.ONE],new o.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?wr.unblended:wr.alphaBlended}depthModeForSublayer(l,d,m){if(!this.opaquePassEnabledForLayer())return gi.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new gi(m||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,d){this.style=l,this.options=d,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(M.now()),this.imageManager.beginFrame();const m=this.style._order,_=this.style.sourceCaches,x={},C={},$={};for(const R in _){const D=_[R];D.used&&D.prepare(this.context),x[R]=D.getVisibleCoordinates(),C[R]=x[R].slice().reverse(),$[R]=D.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let R=0;R<m.length;R++)if(this.style._layers[m[R]].is3D()){this.opaquePassCutoff=R;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const R of m){const D=this.style._layers[R];if(!D.hasOffscreenPass()||D.isHidden(this.transform.zoom))continue;const B=C[D.source];(D.type==="custom"||B.length)&&this.renderLayer(this,_[D.source],D,B)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?o.aO.black:o.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const R=this.style._layers[m[this.currentLayer]],D=_[R.source],B=x[R.source];this._renderTileClippingMasks(R,B),this.renderLayer(this,D,R,B)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const R=this.style._layers[m[this.currentLayer]],D=_[R.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(R))continue;const B=(R.type==="symbol"?$:C)[R.source];this._renderTileClippingMasks(R,x[R.source]),this.renderLayer(this,D,R,B)}if(this.options.showTileBoundaries){const R=function(D,B){let U=null;const Y=Object.values(D._layers).flatMap(X=>X.source&&!X.isHidden(B)?[D.sourceCaches[X.source]]:[]),ne=Y.filter(X=>X.getSource().type==="vector"),re=Y.filter(X=>X.getSource().type!=="vector"),le=X=>{(!U||U.getSource().maxzoom<X.getSource().maxzoom)&&(U=X)};return ne.forEach(X=>le(X)),U||re.forEach(X=>le(X)),U}(this.style,this.transform.zoom);R&&function(D,B,U){for(let Y=0;Y<U.length;Y++)py(D,B,U[Y])}(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(R){const D=R.transform.padding;tl(R,R.transform.height-(D.top||0),3,Jp),tl(R,D.bottom||0,3,dy),_n(R,D.left||0,3,v2),_n(R,R.transform.width-(D.right||0),3,r1);const B=R.transform.centerPoint;(function(U,Y,ne,re){eu(U,Y-1,ne-10,2,20,re),eu(U,Y-10,ne-1,20,2,re)})(R,B.x,R.transform.height-B.y,fr)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,m=this.transform.projMatrix;let _=this.terrainFacilitator.dirty;_||(_=l?!o.aY(d,m):!o.aZ(d,m)),_||(_=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),_&&(o.a_(d,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,C){const $=x.context,R=$.gl,D=wr.unblended,B=new gi(R.LEQUAL,gi.ReadWrite,[0,1]),U=C.getTerrainMesh(),Y=C.sourceCache.getRenderableTiles(),ne=x.useProgram("terrainDepth");$.bindFramebuffer.set(C.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),$.clear({color:o.aO.transparent,depth:1});for(const re of Y){const le=C.getTerrainData(re.tileID),X={u_matrix:x.transform.calculatePosMatrix(re.tileID.toUnwrapped()),u_ele_delta:C.getMeshFrameDelta(x.transform.zoom)};ne.draw($,R.TRIANGLES,B,Ui.disabled,D,Ni.backCCW,X,le,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,C){const $=x.context,R=$.gl,D=wr.unblended,B=new gi(R.LEQUAL,gi.ReadWrite,[0,1]),U=C.getTerrainMesh(),Y=C.getCoordsTexture(),ne=C.sourceCache.getRenderableTiles(),re=x.useProgram("terrainCoords");$.bindFramebuffer.set(C.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),$.clear({color:o.aO.transparent,depth:1}),C.coordsIndex=[];for(const le of ne){const X=C.getTerrainData(le.tileID);$.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,Y.texture);const fe={u_matrix:x.transform.calculatePosMatrix(le.tileID.toUnwrapped()),u_terrain_coords_id:(255-C.coordsIndex.length)/255,u_texture:0,u_ele_delta:C.getMeshFrameDelta(x.transform.zoom)};re.draw($,R.TRIANGLES,B,Ui.disabled,D,Ni.backCCW,fe,X,"terrain",U.vertexBuffer,U.indexBuffer,U.segments),C.coordsIndex.push(le.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(l,d,m,_){if(!m.isHidden(this.transform.zoom)&&(m.type==="background"||m.type==="custom"||(_||[]).length))switch(this.id=m.id,m.type){case"symbol":(function(x,C,$,R,D){if(x.renderPass!=="translucent")return;const B=Ui.disabled,U=x.colorModeForRenderPass();($._unevaluatedLayout.hasValue("text-variable-anchor")||$._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Y,ne,re,le,X,fe,Ae){const ce=ne.transform,xe=X==="map",Pe=fe==="map";for(const Ce of Y){const Re=le.getTile(Ce),qe=Re.getBucket(re);if(!qe||!qe.text||!qe.text.segments.get().length)continue;const Ue=o.ag(qe.textSizeData,ce.zoom),Ve=Dt(Re,1,ne.transform.zoom),dt=Po(Ce.posMatrix,Pe,xe,ne.transform,Ve),Vt=re.layout.get("icon-text-fit")!=="none"&&qe.hasIconData();if(Ue){const tt=Math.pow(2,ce.zoom-Re.tileID.overscaledZ);Zp(qe,xe,Pe,Ae,ce,dt,Ce.posMatrix,tt,Ue,Vt,ne.style.map.terrain?(Rt,Yt)=>ne.style.map.terrain.getElevation(Ce,Rt,Yt):null)}}}(R,x,$,C,$.layout.get("text-rotation-alignment"),$.layout.get("text-pitch-alignment"),D),$.paint.get("icon-opacity").constantOr(1)!==0&&Q_(x,C,$,R,!1,$.paint.get("icon-translate"),$.paint.get("icon-translate-anchor"),$.layout.get("icon-rotation-alignment"),$.layout.get("icon-pitch-alignment"),$.layout.get("icon-keep-upright"),B,U),$.paint.get("text-opacity").constantOr(1)!==0&&Q_(x,C,$,R,!0,$.paint.get("text-translate"),$.paint.get("text-translate-anchor"),$.layout.get("text-rotation-alignment"),$.layout.get("text-pitch-alignment"),$.layout.get("text-keep-upright"),B,U),C.map.showCollisionBoxes&&(Hp(x,C,$,R,$.paint.get("text-translate"),$.paint.get("text-translate-anchor"),!0),Hp(x,C,$,R,$.paint.get("icon-translate"),$.paint.get("icon-translate-anchor"),!1))})(l,d,m,_,this.style.placement.variableOffsets);break;case"circle":(function(x,C,$,R){if(x.renderPass!=="translucent")return;const D=$.paint.get("circle-opacity"),B=$.paint.get("circle-stroke-width"),U=$.paint.get("circle-stroke-opacity"),Y=!$.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&(B.constantOr(1)===0||U.constantOr(1)===0))return;const ne=x.context,re=ne.gl,le=x.depthModeForSublayer(0,gi.ReadOnly),X=Ui.disabled,fe=x.colorModeForRenderPass(),Ae=[];for(let ce=0;ce<R.length;ce++){const xe=R[ce],Pe=C.getTile(xe),Ce=Pe.getBucket($);if(!Ce)continue;const Re=Ce.programConfigurations.get($.id),qe=x.useProgram("circle",Re),Ue=Ce.layoutVertexBuffer,Ve=Ce.indexBuffer,dt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(xe),Vt={programConfiguration:Re,program:qe,layoutVertexBuffer:Ue,indexBuffer:Ve,uniformValues:B_(x,xe,Pe,$),terrainData:dt};if(Y){const tt=Ce.segments.get();for(const Rt of tt)Ae.push({segments:new o.$([Rt]),sortKey:Rt.sortKey,state:Vt})}else Ae.push({segments:Ce.segments,sortKey:0,state:Vt})}Y&&Ae.sort((ce,xe)=>ce.sortKey-xe.sortKey);for(const ce of Ae){const{programConfiguration:xe,program:Pe,layoutVertexBuffer:Ce,indexBuffer:Re,uniformValues:qe,terrainData:Ue}=ce.state;Pe.draw(ne,re.TRIANGLES,le,X,fe,Ni.disabled,qe,Ue,$.id,Ce,Re,ce.segments,$.paint,x.transform.zoom,xe)}})(l,d,m,_);break;case"heatmap":(function(x,C,$,R){if($.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const D=x.context,B=D.gl,U=Ui.disabled,Y=new wr([B.ONE,B.ONE],o.aO.transparent,[!0,!0,!0,!0]);(function(ne,re,le){const X=ne.gl;ne.activeTexture.set(X.TEXTURE1),ne.viewport.set([0,0,re.width/4,re.height/4]);let fe=le.heatmapFbo;if(fe)X.bindTexture(X.TEXTURE_2D,fe.colorAttachment.get()),ne.bindFramebuffer.set(fe.framebuffer);else{const Ae=X.createTexture();X.bindTexture(X.TEXTURE_2D,Ae),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),fe=le.heatmapFbo=ne.createFramebuffer(re.width/4,re.height/4,!1,!1),function(ce,xe,Pe,Ce){var Re,qe;const Ue=ce.gl,Ve=(Re=ce.HALF_FLOAT)!==null&&Re!==void 0?Re:Ue.UNSIGNED_BYTE,dt=(qe=ce.RGBA16F)!==null&&qe!==void 0?qe:Ue.RGBA;Ue.texImage2D(Ue.TEXTURE_2D,0,dt,xe.width/4,xe.height/4,0,Ue.RGBA,Ve,null),Ce.colorAttachment.set(Pe)}(ne,re,Ae,fe)}})(D,x,$),D.clear({color:o.aO.transparent});for(let ne=0;ne<R.length;ne++){const re=R[ne];if(C.hasRenderableParent(re))continue;const le=C.getTile(re),X=le.getBucket($);if(!X)continue;const fe=X.programConfigurations.get($.id),Ae=x.useProgram("heatmap",fe),{zoom:ce}=x.transform;Ae.draw(D,B.TRIANGLES,gi.disabled,U,Y,Ni.disabled,U_(re.posMatrix,le,ce,$.paint.get("heatmap-intensity")),null,$.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,$.paint,x.transform.zoom,fe)}D.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(D,B){const U=D.context,Y=U.gl,ne=B.heatmapFbo;if(!ne)return;U.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ne.colorAttachment.get()),U.activeTexture.set(Y.TEXTURE1);let re=B.colorRampTexture;re||(re=B.colorRampTexture=new nt(U,B.colorRamp,Y.RGBA)),re.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),D.useProgram("heatmapTexture").draw(U,Y.TRIANGLES,gi.disabled,Ui.disabled,D.colorModeForRenderPass(),Ni.disabled,((le,X,fe,Ae)=>{const ce=o.F();o.aN(ce,0,le.width,le.height,0,0,1);const xe=le.context.gl;return{u_matrix:ce,u_world:[xe.drawingBufferWidth,xe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}})(D,B),null,B.id,D.viewportBuffer,D.quadTriangleIndexBuffer,D.viewportSegments,B.paint,D.transform.zoom)}(x,$))})(l,d,m,_);break;case"line":(function(x,C,$,R){if(x.renderPass!=="translucent")return;const D=$.paint.get("line-opacity"),B=$.paint.get("line-width");if(D.constantOr(1)===0||B.constantOr(1)===0)return;const U=x.depthModeForSublayer(0,gi.ReadOnly),Y=x.colorModeForRenderPass(),ne=$.paint.get("line-dasharray"),re=$.paint.get("line-pattern"),le=re.constantOr(1),X=$.paint.get("line-gradient"),fe=$.getCrossfadeParameters(),Ae=le?"linePattern":ne?"lineSDF":X?"lineGradient":"line",ce=x.context,xe=ce.gl;let Pe=!0;for(const Ce of R){const Re=C.getTile(Ce);if(le&&!Re.patternsLoaded())continue;const qe=Re.getBucket($);if(!qe)continue;const Ue=qe.programConfigurations.get($.id),Ve=x.context.program.get(),dt=x.useProgram(Ae,Ue),Vt=Pe||dt.program!==Ve,tt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ce),Rt=re.constantOr(null);if(Rt&&Re.imageAtlas){const Nt=Re.imageAtlas,Qt=Nt.patternPositions[Rt.to.toString()],ei=Nt.patternPositions[Rt.from.toString()];Qt&&ei&&Ue.setConstantPatternPositions(Qt,ei)}const Yt=tt?Ce:null,ui=le?Fp(x,Re,$,fe,Yt):ne?Un(x,Re,$,ne,fe,Yt):X?Zl(x,Re,$,qe.lineClipsArray.length,Yt):zp(x,Re,$,Yt);if(le)ce.activeTexture.set(xe.TEXTURE0),Re.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Ue.updatePaintBuffers(fe);else if(ne&&(Vt||x.lineAtlas.dirty))ce.activeTexture.set(xe.TEXTURE0),x.lineAtlas.bind(ce);else if(X){const Nt=qe.gradients[$.id];let Qt=Nt.texture;if($.gradientVersion!==Nt.version){let ei=256;if($.stepInterpolant){const ir=C.getSource().maxzoom,zi=Ce.canonical.z===ir?Math.ceil(1<<x.transform.maxZoom-Ce.canonical.z):1;ei=o.ac(o.aT(qe.maxLineLength/o.W*1024*zi),256,ce.maxTextureSize)}Nt.gradient=o.aU({expression:$.gradientExpression(),evaluationKey:"lineProgress",resolution:ei,image:Nt.gradient||void 0,clips:qe.lineClipsArray}),Nt.texture?Nt.texture.update(Nt.gradient):Nt.texture=new nt(ce,Nt.gradient,xe.RGBA),Nt.version=$.gradientVersion,Qt=Nt.texture}ce.activeTexture.set(xe.TEXTURE0),Qt.bind($.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}dt.draw(ce,xe.TRIANGLES,U,x.stencilModeForClipping(Ce),Y,Ni.disabled,ui,tt,$.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,$.paint,x.transform.zoom,Ue,qe.layoutVertexBuffer2),Pe=!1}})(l,d,m,_);break;case"fill":(function(x,C,$,R){const D=$.paint.get("fill-color"),B=$.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const U=x.colorModeForRenderPass(),Y=$.paint.get("fill-pattern"),ne=x.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&D.constantOr(o.aO.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===ne){const re=x.depthModeForSublayer(1,x.renderPass==="opaque"?gi.ReadWrite:gi.ReadOnly);uy(x,C,$,R,re,U,!1)}if(x.renderPass==="translucent"&&$.paint.get("fill-antialias")){const re=x.depthModeForSublayer($.getPaintProperty("fill-outline-color")?2:0,gi.ReadOnly);uy(x,C,$,R,re,U,!0)}})(l,d,m,_);break;case"fill-extrusion":(function(x,C,$,R){const D=$.paint.get("fill-extrusion-opacity");if(D!==0&&x.renderPass==="translucent"){const B=new gi(x.context.gl.LEQUAL,gi.ReadWrite,x.depthRangeFor3D);if(D!==1||$.paint.get("fill-extrusion-pattern").constantOr(1))Qc(x,C,$,R,B,Ui.disabled,wr.disabled),Qc(x,C,$,R,B,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const U=x.colorModeForRenderPass();Qc(x,C,$,R,B,Ui.disabled,U)}}})(l,d,m,_);break;case"hillshade":(function(x,C,$,R){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const D=x.context,B=x.depthModeForSublayer(0,gi.ReadOnly),U=x.colorModeForRenderPass(),[Y,ne]=x.renderPass==="translucent"?x.stencilConfigForOverlap(R):[{},R];for(const re of ne){const le=C.getTile(re);le.needsHillshadePrepare!==void 0&&le.needsHillshadePrepare&&x.renderPass==="offscreen"?t1(x,le,$,B,Ui.disabled,U):x.renderPass==="translucent"&&hy(x,re,le,$,B,Y[re.overscaledZ],U)}D.viewport.set([0,0,x.width,x.height])})(l,d,m,_);break;case"raster":(function(x,C,$,R){if(x.renderPass!=="translucent"||$.paint.get("raster-opacity")===0||!R.length)return;const D=x.context,B=D.gl,U=C.getSource(),Y=x.useProgram("raster"),ne=x.colorModeForRenderPass(),[re,le]=U instanceof Bn?[{},R]:x.stencilConfigForOverlap(R),X=le[le.length-1].overscaledZ,fe=!x.options.moving;for(const Ae of le){const ce=x.depthModeForSublayer(Ae.overscaledZ-X,$.paint.get("raster-opacity")===1?gi.ReadWrite:gi.ReadOnly,B.LESS),xe=C.getTile(Ae);xe.registerFadeDuration($.paint.get("raster-fade-duration"));const Pe=C.findLoadedParent(Ae,0),Ce=i1(xe,Pe,C,$,x.transform,x.style.map.terrain);let Re,qe;const Ue=$.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;D.activeTexture.set(B.TEXTURE0),xe.texture.bind(Ue,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(B.TEXTURE1),Pe?(Pe.texture.bind(Ue,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Re=Math.pow(2,Pe.tileID.overscaledZ-xe.tileID.overscaledZ),qe=[xe.tileID.canonical.x*Re%1,xe.tileID.canonical.y*Re%1]):xe.texture.bind(Ue,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const Ve=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ae),dt=Ve?Ae:null,Vt=dt?dt.posMatrix:x.transform.calculatePosMatrix(Ae.toUnwrapped(),fe),tt=Dh(Vt,qe||[0,0],Re||1,Ce,$);U instanceof Bn?Y.draw(D,B.TRIANGLES,ce,Ui.disabled,ne,Ni.disabled,tt,Ve,$.id,U.boundsBuffer,x.quadTriangleIndexBuffer,U.boundsSegments):Y.draw(D,B.TRIANGLES,ce,re[Ae.overscaledZ],ne,Ni.disabled,tt,Ve,$.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}})(l,d,m,_);break;case"background":(function(x,C,$,R){const D=$.paint.get("background-color"),B=$.paint.get("background-opacity");if(B===0)return;const U=x.context,Y=U.gl,ne=x.transform,re=ne.tileSize,le=$.paint.get("background-pattern");if(x.isPatternMissing(le))return;const X=!le&&D.a===1&&B===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==X)return;const fe=Ui.disabled,Ae=x.depthModeForSublayer(0,X==="opaque"?gi.ReadWrite:gi.ReadOnly),ce=x.colorModeForRenderPass(),xe=x.useProgram(le?"backgroundPattern":"background"),Pe=R||ne.coveringTiles({tileSize:re,terrain:x.style.map.terrain});le&&(U.activeTexture.set(Y.TEXTURE0),x.imageManager.bind(x.context));const Ce=$.getCrossfadeParameters();for(const Re of Pe){const qe=R?Re.posMatrix:x.transform.calculatePosMatrix(Re.toUnwrapped()),Ue=le?V_(qe,B,x,le,{tileID:Re,tileSize:re},Ce):c2(qe,B,D),Ve=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Re);xe.draw(U,Y.TRIANGLES,Ae,fe,ce,Ni.disabled,Ue,Ve,$.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}})(l,0,m,_);break;case"custom":(function(x,C,$){const R=x.context,D=$.implementation;if(x.renderPass==="offscreen"){const B=D.prerender;B&&(x.setCustomLayerDefaults(),R.setColorMode(x.colorModeForRenderPass()),B.call(D,R.gl,x.transform.customLayerMatrix()),R.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),R.setColorMode(x.colorModeForRenderPass()),R.setStencilMode(Ui.disabled);const B=D.renderingMode==="3d"?new gi(x.context.gl.LEQUAL,gi.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,gi.ReadOnly);R.setDepthMode(B),D.render(R.gl,x.transform.customLayerMatrix()),R.setDirty(),x.setBaseState(),R.bindFramebuffer.set(null)}})(l,0,m)}}translatePosMatrix(l,d,m,_,x){if(!m[0]&&!m[1])return l;const C=x?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(C){const D=Math.sin(C),B=Math.cos(C);m=[m[0]*B-m[1]*D,m[0]*D+m[1]*B]}const $=[x?m[0]:Dt(d,m[0],this.transform.zoom),x?m[1]:Dt(d,m[1],this.transform.zoom),0],R=new Float32Array(16);return o.H(R,l,$),R}saveTileTexture(l){const d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const d=this.imageManager.getPattern(l.from.toString()),m=this.imageManager.getPattern(l.to.toString());return!d||!m}useProgram(l,d){this.cache=this.cache||{};const m=l+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[m]||(this.cache[m]=new Xm(this.context,jr[l],d,u2[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new nt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:d}=this.context.gl;return this.width!==l||this.height!==d}}class Kl{constructor(l,d){this.points=l,this.planes=d}static fromInvProjectionMatrix(l,d,m){const _=Math.pow(2,m),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map($=>{const R=1/($=o.af([],$,l))[3]/d*_;return o.a$($,$,[R,R,1/$[3],R])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map($=>{const R=function(Y,ne){var re=ne[0],le=ne[1],X=ne[2],fe=re*re+le*le+X*X;return fe>0&&(fe=1/Math.sqrt(fe)),Y[0]=ne[0]*fe,Y[1]=ne[1]*fe,Y[2]=ne[2]*fe,Y}([],function(Y,ne,re){var le=ne[0],X=ne[1],fe=ne[2],Ae=re[0],ce=re[1],xe=re[2];return Y[0]=X*xe-fe*ce,Y[1]=fe*Ae-le*xe,Y[2]=le*ce-X*Ae,Y}([],et([],x[$[0]],x[$[1]]),et([],x[$[2]],x[$[1]]))),D=-((B=R)[0]*(U=x[$[1]])[0]+B[1]*U[1]+B[2]*U[2]);var B,U;return R.concat(D)});return new Kl(x,C)}}class iu{constructor(l,d){this.min=l,this.max=d,this.center=function(m,_,x){return m[0]=.5*_[0],m[1]=.5*_[1],m[2]=.5*_[2],m}([],function(m,_,x){return m[0]=_[0]+x[0],m[1]=_[1]+x[1],m[2]=_[2]+x[2],m}([],this.min,this.max))}quadrant(l){const d=[l%2==0,l<2],m=Fe(this.min),_=Fe(this.max);for(let x=0;x<d.length;x++)m[x]=d[x]?this.min[x]:this.center[x],_[x]=d[x]?this.center[x]:this.max[x];return _[2]=this.max[2],new iu(m,_)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let m=!0;for(let _=0;_<l.planes.length;_++){const x=l.planes[_];let C=0;for(let $=0;$<d.length;$++)o.b0(x,d[$])>=0&&C++;if(C===0)return 0;C!==d.length&&(m=!1)}if(m)return 2;for(let _=0;_<3;_++){let x=Number.MAX_VALUE,C=-Number.MAX_VALUE;for(let $=0;$<l.points.length;$++){const R=l.points[$][_]-this.min[_];x=Math.min(x,R),C=Math.max(C,R)}if(C<0||x>this.max[_]-this.min[_])return 0}return 1}}class Bh{constructor(l=0,d=0,m=0,_=0){if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(m)||m<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=m,this.right=_}interpolate(l,d,m){return d.top!=null&&l.top!=null&&(this.top=o.z.number(l.top,d.top,m)),d.bottom!=null&&l.bottom!=null&&(this.bottom=o.z.number(l.bottom,d.bottom,m)),d.left!=null&&l.left!=null&&(this.left=o.z.number(l.left,d.left,m)),d.right!=null&&l.right!=null&&(this.right=o.z.number(l.right,d.right,m)),this}getCenter(l,d){const m=o.ac((this.left+l-this.right)/2,0,l),_=o.ac((this.top+d-this.bottom)/2,0,d);return new o.P(m,_)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Bh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const my=85.051129;class Kp{constructor(l,d,m,_,x){this.tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=m??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Bh,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const l=new Kp(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this.minElevationForCurrentTile=l.minElevationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const d=-o.b1(l,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var m=new o.A(4);return o.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}(),function(m,_,x){var C=_[0],$=_[1],R=_[2],D=_[3],B=Math.sin(x),U=Math.cos(x);m[0]=C*U+R*B,m[1]=$*U+D*B,m[2]=C*-B+R*U,m[3]=$*-B+D*U}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=o.ac(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,m){this._unmodified=!1,this._edgeInsets.interpolate(l,d,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new o.b2(0,l)];if(this._renderWorldCopies){const m=this.pointCoordinate(new o.P(0,0)),_=this.pointCoordinate(new o.P(this.width,0)),x=this.pointCoordinate(new o.P(this.width,this.height)),C=this.pointCoordinate(new o.P(0,this.height)),$=Math.floor(Math.min(m.x,_.x,x.x,C.x)),R=Math.floor(Math.max(m.x,_.x,x.x,C.x)),D=1;for(let B=$-D;B<=R+D;B++)B!==0&&d.push(new o.b2(B,l))}return d}coveringTiles(l){var d,m;let _=this.coveringZoomLevel(l);const x=_;if(l.minzoom!==void 0&&_<l.minzoom)return[];l.maxzoom!==void 0&&_>l.maxzoom&&(_=l.maxzoom);const C=this.pointCoordinate(this.getCameraPoint()),$=o.Y.fromLngLat(this.center),R=Math.pow(2,_),D=[R*C.x,R*C.y,0],B=[R*$.x,R*$.y,0],U=Kl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let Y=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Y=_);const ne=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,re=ce=>({aabb:new iu([ce*R,0,0],[(ce+1)*R,R,0]),zoom:0,x:0,y:0,wrap:ce,fullyVisible:!1}),le=[],X=[],fe=_,Ae=l.reparseOverscaled?x:_;if(this._renderWorldCopies)for(let ce=1;ce<=3;ce++)le.push(re(-ce)),le.push(re(ce));for(le.push(re(0));le.length>0;){const ce=le.pop(),xe=ce.x,Pe=ce.y;let Ce=ce.fullyVisible;if(!Ce){const dt=ce.aabb.intersects(U);if(dt===0)continue;Ce=dt===2}const Re=l.terrain?D:B,qe=ce.aabb.distanceX(Re),Ue=ce.aabb.distanceY(Re),Ve=Math.max(Math.abs(qe),Math.abs(Ue));if(ce.zoom===fe||Ve>ne+(1<<fe-ce.zoom)-2&&ce.zoom>=Y){const dt=fe-ce.zoom,Vt=D[0]-.5-(xe<<dt),tt=D[1]-.5-(Pe<<dt);X.push({tileID:new o.Q(ce.zoom===fe?Ae:ce.zoom,ce.wrap,ce.zoom,xe,Pe),distanceSq:at([B[0]-.5-xe,B[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(Vt*Vt+tt*tt)})}else for(let dt=0;dt<4;dt++){const Vt=(xe<<1)+dt%2,tt=(Pe<<1)+(dt>>1),Rt=ce.zoom+1;let Yt=ce.aabb.quadrant(dt);if(l.terrain){const ui=new o.Q(Rt,ce.wrap,Rt,Vt,tt),Nt=l.terrain.getMinMaxElevation(ui),Qt=(d=Nt.minElevation)!==null&&d!==void 0?d:this.elevation,ei=(m=Nt.maxElevation)!==null&&m!==void 0?m:this.elevation;Yt=new iu([Yt.min[0],Yt.min[1],Qt],[Yt.max[0],Yt.max[1],ei])}le.push({aabb:Yt,zoom:Rt,x:Vt,y:tt,wrap:ce.wrap,fullyVisible:Ce})}}return X.sort((ce,xe)=>ce.distanceSq-xe.distanceSq).map(ce=>ce.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=o.ac(l.lat,-85.051129,my);return new o.P(o.N(l.lng)*this.worldSize,o.O(d)*this.worldSize)}unproject(l){return new o.Y(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const d=this.elevation,m=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,_=this.pointLocation(this.centerPoint,l),x=l.getElevationForLngLatZoom(_,this.tileZoom);if(!(this.elevation-x))return;const C=m+d-x,$=Math.cos(this._pitch)*this.cameraToCenterDistance/C/o.b3(1,_.lat),R=this.scaleZoom($/this.tileSize);this._elevation=x,this._center=_,this.zoom=R}setLocationAtPoint(l,d){const m=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(l),C=new o.Y(x.x-(m.x-_.x),x.y-(m.y-_.y));this.center=this.coordinateLocation(C),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,d){return d?this.coordinatePoint(this.locationCoordinate(l),d.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,d){return this.coordinateLocation(this.pointCoordinate(l,d))}locationCoordinate(l){return o.Y.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,d){if(d){const Y=d.pointCoordinate(l);if(Y!=null)return Y}const m=[l.x,l.y,0,1],_=[l.x,l.y,1,1];o.af(m,m,this.pixelMatrixInverse),o.af(_,_,this.pixelMatrixInverse);const x=m[3],C=_[3],$=m[1]/x,R=_[1]/C,D=m[2]/x,B=_[2]/C,U=D===B?0:(0-D)/(B-D);return new o.Y(o.z.number(m[0]/x,_[0]/C,U)/this.worldSize,o.z.number($,R,U)/this.worldSize)}coordinatePoint(l,d=0,m=this.pixelMatrix){const _=[l.x*this.worldSize,l.y*this.worldSize,d,1];return o.af(_,_,m),new o.P(_[0]/_[3],_[1]/_[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new vr().extend(this.pointLocation(new o.P(0,l))).extend(this.pointLocation(new o.P(this.width,l))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new vr([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,my])}calculatePosMatrix(l,d=!1){const m=l.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[m])return _[m];const x=l.canonical,C=this.worldSize/this.zoomScale(x.z),$=x.x+Math.pow(2,x.z)*l.wrap,R=o.an(new Float64Array(16));return o.H(R,R,[$*C,x.y*C,0]),o.J(R,R,[C/o.W,C/o.W,1]),o.K(R,d?this.alignedProjMatrix:this.projMatrix,R),_[m]=new Float32Array(R),_[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(l,d){d=o.ac(+d,this.minZoom,this.maxZoom);const m={center:new o.M(l.lng,l.lat),zoom:d};let _=this.lngRange;if(!this._renderWorldCopies&&_===null){const ce=179.9999999999;_=[-ce,ce]}const x=this.tileSize*this.zoomScale(m.zoom);let C=0,$=x,R=0,D=x,B=0,U=0;const{x:Y,y:ne}=this.size;if(this.latRange){const ce=this.latRange;C=o.O(ce[1])*x,$=o.O(ce[0])*x,$-C<ne&&(B=ne/($-C))}_&&(R=o.b1(o.N(_[0])*x,0,x),D=o.b1(o.N(_[1])*x,0,x),D<R&&(D+=x),D-R<Y&&(U=Y/(D-R)));const{x:re,y:le}=this.project.call({worldSize:x},l);let X,fe;const Ae=Math.max(U||0,B||0);if(Ae){const ce=new o.P(U?(D+R)/2:re,B?($+C)/2:le);return m.center=this.unproject.call({worldSize:x},ce).wrap(),m.zoom+=this.scaleZoom(Ae),m}if(this.latRange){const ce=ne/2;le-ce<C&&(fe=C+ce),le+ce>$&&(fe=$-ce)}if(_){const ce=(R+D)/2;let xe=re;this._renderWorldCopies&&(xe=o.b1(re,ce-x/2,ce+x/2));const Pe=Y/2;xe-Pe<R&&(X=R+Pe),xe+Pe>D&&(X=D-Pe)}if(X!==void 0||fe!==void 0){const ce=new o.P(X??re,fe??le);m.center=this.unproject.call({worldSize:x},ce).wrap()}return m}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:d,zoom:m}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=m,this._unmodified=l,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.point.x,m=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b3(1,this.center.lat)*this.worldSize;let _=o.an(new Float64Array(16));o.J(_,_,[this.width/2,-this.height/2,1]),o.H(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=o.an(new Float64Array(16)),o.J(_,_,[1,-1,1]),o.H(_,_,[-1,-1,0]),o.J(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_;const x=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),C=Math.min(this.elevation,this.minElevationForCurrentTile),$=x-C*this._pixelPerMeter/Math.cos(this._pitch),R=C<0?$:x,D=Math.PI/2+this._pitch,B=this._fov*(.5+l.y/this.height),U=Math.sin(B)*R/Math.sin(o.ac(Math.PI-D-B,.01,Math.PI-.01)),Y=this.getHorizon(),ne=2*Math.atan(Y/this.cameraToCenterDistance)*(.5+l.y/(2*Y)),re=Math.sin(ne)*R/Math.sin(o.ac(Math.PI-D-ne,.01,Math.PI-.01)),le=Math.min(U,re),X=1.01*(Math.cos(Math.PI/2-this._pitch)*le+R),fe=this.height/50;_=new Float64Array(16),o.b4(_,this._fov,this.width/this.height,fe,X),_[8]=2*-l.x/this.width,_[9]=2*l.y/this.height,o.J(_,_,[1,-1,1]),o.H(_,_,[0,0,-this.cameraToCenterDistance]),o.b5(_,_,this._pitch),o.ad(_,_,this.angle),o.H(_,_,[-d,-m,0]),this.mercatorMatrix=o.J([],_,[this.worldSize,this.worldSize,this.worldSize]),o.J(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.K(new Float64Array(16),this.labelPlaneMatrix,_),o.H(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=o.ar([],_),this.pixelMatrix3D=o.K(new Float64Array(16),this.labelPlaneMatrix,_);const Ae=this.width%2/2,ce=this.height%2/2,xe=Math.cos(this.angle),Pe=Math.sin(this.angle),Ce=d-Math.round(d)+xe*Ae+Pe*ce,Re=m-Math.round(m)+xe*ce+Pe*Ae,qe=new Float64Array(_);if(o.H(qe,qe,[Ce>.5?Ce-1:Ce,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=qe,_=o.ar(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.P(0,0)),d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.af(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,l))}getCameraQueryGeometry(l){const d=this.getCameraPoint();if(l.length===1)return[l[0],d];{let m=d.x,_=d.y,x=d.x,C=d.y;for(const $ of l)m=Math.min(m,$.x),_=Math.min(_,$.y),x=Math.max(x,$.x),C=Math.max(C,$.y);return[new o.P(m,_),new o.P(x,_),new o.P(x,C),new o.P(m,C),new o.P(m,_)]}}lngLatToCameraDepth(l,d){const m=this.locationCoordinate(l),_=[m.x*this.worldSize,m.y*this.worldSize,d,1];return o.af(_,_,this.projMatrix),_[2]/_[3]}}function yy(w,l){let d,m=!1,_=null,x=null;const C=()=>{_=null,m&&(w.apply(x,d),_=setTimeout(C,l),m=!1)};return(...$)=>(m=!0,x=this,d=$,_||C(),_)}class gy{constructor(l){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let m;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(m=_)}),(m&&m[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(m=>isNaN(m))){const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:m,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=yy(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const d=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),C=Math.round(d.lng*x)/x,$=Math.round(d.lat*x)/x,R=this._map.getBearing(),D=this._map.getPitch();let B="";if(B+=l?`/${C}/${$}/${m}`:`${m}/${$}/${C}`,(R||D)&&(B+="/"+Math.round(10*R)/10),D&&(B+=`/${Math.round(D)}`),this._hashName){const U=this._hashName;let Y=!1;const ne=window.location.hash.slice(1).split("&").map(re=>{const le=re.split("=")[0];return le===U?(Y=!0,`${le}=${B}`):re}).filter(re=>re);return Y||ne.push(`${U}=${B}`),`#${ne.join("&")}`}return`#${B}`}}const ko={linearity:.3,easing:o.b6(0,0,.3,1)},s1=o.e({deceleration:2500,maxSpeed:1400},ko),n1=o.e({deceleration:20,maxSpeed:1400},ko),o1=o.e({deceleration:1e3,maxSpeed:360},ko),a1=o.e({deceleration:1e3,maxSpeed:90},ko);class l1{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=M.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)d.zoom+=x.zoomDelta||0,d.bearing+=x.bearingDelta||0,d.pitch+=x.pitchDelta||0,x.panDelta&&d.pan._add(x.panDelta),x.around&&(d.around=x.around),x.pinchAround&&(d.pinchAround=x.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const x=jh(d.pan.mag(),m,o.e({},s1,l||{}));_.offset=d.pan.mult(x.amount/d.pan.mag()),_.center=this._map.transform.center,Uh(_,x)}if(d.zoom){const x=jh(d.zoom,m,n1);_.zoom=this._map.transform.zoom+x.amount,Uh(_,x)}if(d.bearing){const x=jh(d.bearing,m,o1);_.bearing=this._map.transform.bearing+o.ac(x.amount,-179,179),Uh(_,x)}if(d.pitch){const x=jh(d.pitch,m,a1);_.pitch=this._map.transform.pitch+x.amount,Uh(_,x)}if(_.zoom||_.bearing){const x=d.pinchAround===void 0?d.around:d.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),o.e(_,{noMoveStart:!0})}}function Uh(w,l){(!w.duration||w.duration<l.duration)&&(w.duration=l.duration,w.easing=l.easing)}function jh(w,l,d){const{maxSpeed:m,linearity:_,deceleration:x}=d,C=o.ac(w*_/(l/1e3),-m,m),$=Math.abs(C)/(x*_);return{easing:d.easing,duration:1e3*$,amount:C*($/2)}}class ts extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,m,_={}){const x=A.mousePos(d.getCanvas(),m),C=d.unproject(x);super(l,o.e({point:x,lngLat:C,originalEvent:m},_)),this._defaultPrevented=!1,this.target=d}}class ru extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,m){const _=l==="touchend"?m.changedTouches:m.touches,x=A.touchPos(d.getCanvasContainer(),_),C=x.map(R=>d.unproject(R)),$=x.reduce((R,D,B,U)=>R.add(D.div(U.length)),new o.P(0,0));super(l,{points:x,point:$,lngLats:C,lngLat:d.unproject($),originalEvent:m}),this._defaultPrevented=!1}}class jn extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,m){super(l,{originalEvent:m}),this._defaultPrevented=!1}}class Ro{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new jn(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new ts(l.type,this._map,l))}mouseup(l){this._map.fire(new ts(l.type,this._map,l))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new ts(l.type,this._map,l))}dblclick(l){return this._firePreventable(new ts(l.type,this._map,l))}mouseover(l){this._map.fire(new ts(l.type,this._map,l))}mouseout(l){this._map.fire(new ts(l.type,this._map,l))}touchstart(l){return this._firePreventable(new ru(l.type,this._map,l))}touchmove(l){this._map.fire(new ru(l.type,this._map,l))}touchend(l){this._map.fire(new ru(l.type,this._map,l))}touchcancel(l){this._map.fire(new ru(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class c1{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new ts(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new ts(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ks{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(o.P.convert(l),this._map.terrain)}}class su{constructor(l,d){this._map=l,this._tr=new Ks(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(A.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const m=d;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=m,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const x=Math.min(_.x,m.x),C=Math.max(_.x,m.x),$=Math.min(_.y,m.y),R=Math.max(_.y,m.y);A.setTransform(this._box,`translate(${x}px,${$}px)`),this._box.style.width=C-x+"px",this._box.style.height=R-$+"px"}mouseupWindow(l,d){if(!this._active||l.button!==0)return;const m=this._startPos,_=d;if(this.reset(),A.suppressClick(),m.x!==_.x||m.y!==_.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:l})),{cameraAnimation:x=>x.fitScreenCoordinates(m,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new o.k(l,{originalEvent:d}))}}function _y(w,l){if(w.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${l.length}`);const d={};for(let m=0;m<w.length;m++)d[w[m].identifier]=l[m];return d}class b2{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,d,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),m.length===this.numTouches&&(this.centroid=function(_){const x=new o.P(0,0);for(const C of _)x._add(C);return x.div(_.length)}(d),this.touches=_y(m,d)))}touchmove(l,d,m){if(this.aborted||!this.centroid)return;const _=_y(m,d);for(const x in this.touches){const C=_[x];(!C||C.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(l,d,m){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class vy{constructor(l){this.singleTap=new b2(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,d,m){this.singleTap.touchstart(l,d,m)}touchmove(l,d,m){this.singleTap.touchmove(l,d,m)}touchend(l,d,m){const _=this.singleTap.touchend(l,d,m);if(_){const x=l.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(_)<30;if(x&&C||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class u1{constructor(l){this._tr=new Ks(l),this._zoomIn=new vy({numTouches:1,numTaps:2}),this._zoomOut=new vy({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,m){this._zoomIn.touchstart(l,d,m),this._zoomOut.touchstart(l,d,m)}touchmove(l,d,m){this._zoomIn.touchmove(l,d,m),this._zoomOut.touchmove(l,d,m)}touchend(l,d,m){const _=this._zoomIn.touchend(l,d,m),x=this._zoomOut.touchend(l,d,m),C=this._tr;return _?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:C.zoom+1,around:C.unproject(_)},{originalEvent:l})}):x?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:C.zoom-1,around:C.unproject(x)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pa{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const d=this._moveFunction(...l);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(l,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,d){if(!this.isEnabled())return;const m=this._lastPoint;if(!m)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const _=d.length?d[0]:d;return!this._moved&&_.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(m,_))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&A.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const il={0:1,2:2};class pt{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const d=A.mouseButton(l);this._eventButton=d}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(d,m){const _=il[m];return d.buttons===void 0||(d.buttons&_)!==_}(l,this._eventButton)}isValidEndEvent(l){return A.mouseButton(l)===this._eventButton}}class by{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}const Xl=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=function(l){l.preventDefault()}},nu=({enable:w,clickTolerance:l,bearingDegreesPerPixelMoved:d=.8})=>{const m=new pt({checkCorrectEvent:_=>A.mouseButton(_)===0&&_.ctrlKey||A.mouseButton(_)===2});return new pa({clickTolerance:l,move:(_,x)=>({bearingDelta:(x.x-_.x)*d}),moveStateManager:m,enable:w,assignEvents:Xl})},wy=({enable:w,clickTolerance:l,pitchDegreesPerPixelMoved:d=-.5})=>{const m=new pt({checkCorrectEvent:_=>A.mouseButton(_)===0&&_.ctrlKey||A.mouseButton(_)===2});return new pa({clickTolerance:l,move:(_,x)=>({pitchDelta:(x.y-_.y)*d}),moveStateManager:m,enable:w,assignEvents:Xl})};class ut{constructor(l,d){this._clickTolerance=l.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(l,d,m){return this._calculateTransform(l,d,m)}touchmove(l,d,m){if(this._active&&!(m.length<this.minTouchs()))return l.preventDefault(),this._calculateTransform(l,d,m)}touchend(l,d,m){this._calculateTransform(l,d,m),this._active&&m.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,m){m.length>0&&(this._active=!0);const _=_y(m,d),x=new o.P(0,0),C=new o.P(0,0);let $=0;for(const D in _){const B=_[D],U=this._touches[D];U&&(x._add(B),C._add(B.sub(U)),$++,_[D]=B)}if(this._touches=_,$<this.minTouchs()||!C.mag())return;const R=C.div($);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div($),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,d,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,m){if(!this._firstTwoTouches)return;l.preventDefault();const[_,x]=this._firstTwoTouches,C=Xp(m,d,_),$=Xp(m,d,x);if(!C||!$)return;const R=this._aroundCenter?null:C.add($).div(2);return this._move([C,$],R,l)}touchend(l,d,m){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,C=Xp(m,d,_),$=Xp(m,d,x);C&&$||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Xp(w,l,d){for(let m=0;m<w.length;m++)if(w[m].identifier===d)return l[m]}function h1(w,l){return Math.log(w/l)/Math.LN2}class Qp extends Vh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const m=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(h1(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:h1(this._distance,m),pinchAround:d}}}function xy(w,l){return 180*w.angleWith(l)/Math.PI}class Sy extends Vh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d,m){const _=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xy(this._vector,_),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,m=xy(l,this._startVector);return Math.abs(m)<d}}function Ty(w){return Math.abs(w.y)>Math.abs(w.x)}class d1 extends Vh{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,d,m){super.touchstart(l,d,m),this._currentTouchCount=m.length}_start(l){this._lastPoints=l,Ty(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,m){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=l[0].sub(this._lastPoints[0]),x=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,x,m.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(l,d,m){if(this._valid!==void 0)return this._valid;const _=l.mag()>=2,x=d.mag()>=2;if(!_&&!x)return;if(!_||!x)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const C=l.y>0==d.y>0;return Ty(l)&&Ty(d)&&C}}const Ql={panStep:100,bearingStep:15,pitchStep:10};class Zi{constructor(l){this._tr=new Ks(l);const d=Ql;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,m=0,_=0,x=0,C=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),x=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),x=1);break;case 38:l.shiftKey?_=1:(l.preventDefault(),C=-1);break;case 40:l.shiftKey?_=-1:(l.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(m=0,_=0),{cameraAnimation:$=>{const R=this._tr;$.easeTo({duration:300,easeId:"keyboardHandler",easing:ef,zoom:d?Math.round(R.zoom)+d*(l.shiftKey?2:1):R.zoom,bearing:R.bearing+m*this._bearingStep,pitch:R.pitch+_*this._pitchStep,offset:[-x*this._panStep,-C*this._panStep],center:R.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ef(w){return w*(2-w)}const tf=4.000244140625;class Ey{constructor(l,d){this._onTimeout=m=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)},this._map=l,this._tr=new Ks(l),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!l[this._map.cooperativeGestures._bypassKey])return;let d=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const m=M.now(),_=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,d!==0&&d%tf==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=A.mousePos(this._map.getCanvas(),l),m=this._tr;this._around=d.y>m.transform.height/2-m.transform.getHorizon()?o.M.convert(this._aroundCenter?m.center:m.unproject(d)):o.M.convert(m.center),this._aroundPoint=m.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>tf?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&R!==0&&(R=1/R);const D=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(D*R))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,m=this._startZoom,_=this._easing;let x,C=!1;if(this._type==="wheel"&&m&&_){const $=Math.min((M.now()-this._lastWheelEventTime)/200,1),R=_($);x=o.z.number(m,d,R),$<1?this._frameId||(this._frameId=!0):C=!0}else x=d,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:x-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=o.b7;if(this._prevEase){const m=this._prevEase,_=(M.now()-m.start)/m.duration,x=m.easing(_+.01)-m.easing(_),C=.27/Math.sqrt(x*x+1e-4)*.01,$=Math.sqrt(.0729-C*C);d=o.b6(C,$,.25,1)}return this._prevEase={start:M.now(),duration:l,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Iy{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class p1{constructor(l){this._tr=new Ks(l),this.reset()}reset(){this._active=!1}dblclick(l,d){return l.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class w2{constructor(){this._tap=new vy({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,d,m){if(!this._swipePoint)if(this._tapTime){const _=d[0],x=l.timeStamp-this._tapTime<500,C=this._tapPoint.dist(_)<30;x&&C?m.length>0&&(this._swipePoint=_,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(l,d,m)}touchmove(l,d,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const _=d[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,l.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(l,d,m)}touchend(l,d,m){if(this._tapTime)this._swipePoint&&m.length===0&&this.reset();else{const _=this._tap.touchend(l,d,m);_&&(this._tapTime=l.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ro{constructor(l,d,m){this._el=l,this._mousePan=d,this._touchPan=m}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gh{constructor(l,d,m){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wt{constructor(l,d,m,_){this._el=l,this._touchZoom=d,this._touchRotate=m,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class $t{constructor(l,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",l);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const m=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=m,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(l){this._onCooperativeGesture(l.touches.length===1)}wheel(l){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!l[this._bypassKey])}_onCooperativeGesture(l){this._enabled&&l&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ec=w=>w.zoom||w.drag||w.pitch||w.rotate;class My extends o.k{}function qh(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}class Xs{constructor(l,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,x)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const C=_.type==="renderFrame"?void 0:_,$={needsRenderFrame:!1},R={},D={},B=_.touches,U=B?this._getMapTouches(B):void 0,Y=U?A.touchPos(this._map.getCanvas(),U):A.mousePos(this._map.getCanvas(),_);for(const{handlerName:le,handler:X,allowed:fe}of this._handlers){if(!X.isEnabled())continue;let Ae;this._blockedByActive(D,fe,le)?X.reset():X[x||_.type]&&(Ae=X[x||_.type](_,Y,U),this.mergeHandlerResult($,R,Ae,le,C),Ae&&Ae.needsRenderFrame&&this._triggerRenderFrame()),(Ae||X.isActive())&&(D[le]=X)}const ne={};for(const le in this._previousActiveHandlers)D[le]||(ne[le]=C);this._previousActiveHandlers=D,(Object.keys(ne).length||qh($))&&(this._changes.push([$,R,ne]),this._triggerRenderFrame()),(Object.keys(D).length||qh($))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=$;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new l1(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,x,C]of this._listeners)A.addEventListener(_,x,_===document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[l,d,m]of this._listeners)A.removeEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(l){const d=this._map,m=d.getCanvasContainer();this._add("mapEvent",new Ro(d,l));const _=d.boxZoom=new su(d,l);this._add("boxZoom",_),l.interactive&&l.boxZoom&&_.enable();const x=d.cooperativeGestures=new $t(d,l.cooperativeGestures);this._add("cooperativeGestures",x),l.cooperativeGestures&&x.enable();const C=new u1(d),$=new p1(d);d.doubleClickZoom=new Iy($,C),this._add("tapZoom",C),this._add("clickZoom",$),l.interactive&&l.doubleClickZoom&&d.doubleClickZoom.enable();const R=new w2;this._add("tapDragZoom",R);const D=d.touchPitch=new d1(d);this._add("touchPitch",D),l.interactive&&l.touchPitch&&d.touchPitch.enable(l.touchPitch);const B=nu(l),U=wy(l);d.dragRotate=new Gh(l,B,U),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]),l.interactive&&l.dragRotate&&d.dragRotate.enable();const Y=(({enable:Ae,clickTolerance:ce})=>{const xe=new pt({checkCorrectEvent:Pe=>A.mouseButton(Pe)===0&&!Pe.ctrlKey});return new pa({clickTolerance:ce,move:(Pe,Ce)=>({around:Ce,panDelta:Ce.sub(Pe)}),activateOnStart:!0,moveStateManager:xe,enable:Ae,assignEvents:Xl})})(l),ne=new ut(l,d);d.dragPan=new ro(m,Y,ne),this._add("mousePan",Y),this._add("touchPan",ne,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&d.dragPan.enable(l.dragPan);const re=new Sy,le=new Qp;d.touchZoomRotate=new wt(m,le,re,R),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&d.touchZoomRotate.enable(l.touchZoomRotate);const X=d.scrollZoom=new Ey(d,()=>this._triggerRenderFrame());this._add("scrollZoom",X,["mousePan"]),l.interactive&&l.scrollZoom&&d.scrollZoom.enable(l.scrollZoom);const fe=d.keyboard=new Zi(d);this._add("keyboard",fe),l.interactive&&l.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new c1(d))}_add(l,d,m){this._handlers.push({handlerName:l,handler:d,allowed:m}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ec(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,d,m){for(const _ in l)if(_!==m&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(l){const d=[];for(const m of l)this._el.contains(m.target)&&d.push(m);return d}mergeHandlerResult(l,d,m,_,x){if(!m)return;o.e(l,m);const C={handlerName:_,originalEvent:m.originalEvent||x};m.zoomDelta!==void 0&&(d.zoom=C),m.panDelta!==void 0&&(d.drag=C),m.pitchDelta!==void 0&&(d.pitch=C),m.bearingDelta!==void 0&&(d.rotate=C)}_applyChanges(){const l={},d={},m={};for(const[_,x,C]of this._changes)_.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(_.panDelta)),_.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(l.around=_.around),_.pinchAround!==void 0&&(l.pinchAround=_.pinchAround),_.noInertia&&(l.noInertia=_.noInertia),o.e(d,x),o.e(m,C);this._updateMapTransform(l,d,m),this._changes=[]}_updateMapTransform(l,d,m){const _=this._map,x=_._getTransformForUpdate(),C=_.terrain;if(!(qh(l)||C&&this._terrainMovement))return this._fireEvents(d,m,!0);let{panDelta:$,zoomDelta:R,bearingDelta:D,pitchDelta:B,around:U,pinchAround:Y}=l;Y!==void 0&&(U=Y),_._stop(!0),U=U||_.transform.centerPoint;const ne=x.pointLocation($?U.sub($):U);D&&(x.bearing+=D),B&&(x.pitch+=B),R&&(x.zoom+=R),C?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub($)):x.setLocationAtPoint(ne,U):(this._terrainMovement=!0,this._map._elevationFreeze=!0,x.setLocationAtPoint(ne,U),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,x.recalculateZoom(_.terrain)})):x.setLocationAtPoint(ne,U),_._applyUpdatedTransform(x),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,m,!0)}_fireEvents(l,d,m){const _=ec(this._eventsInProgress),x=ec(l),C={};for(const B in l){const{originalEvent:U}=l[B];this._eventsInProgress[B]||(C[`${B}start`]=U),this._eventsInProgress[B]=l[B]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const B in C)this._fireEvent(B,C[B]);x&&this._fireEvent("move",x.originalEvent);for(const B in l){const{originalEvent:U}=l[B];this._fireEvent(B,U)}const $={};let R;for(const B in this._eventsInProgress){const{handlerName:U,originalEvent:Y}=this._eventsInProgress[B];this._handlersById[U].isActive()||(delete this._eventsInProgress[B],R=d[U]||Y,$[`${B}end`]=R)}for(const B in $)this._fireEvent(B,$[B]);const D=ec(this._eventsInProgress);if(m&&(_||x)&&!D){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!B||!B.essential&&M.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:R})),U(this._map.getBearing())&&this._map.resetNorth()):(U(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new o.k(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new My("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class f1 extends o.E{constructor(l,d){super(),this._renderFrameCallback=()=>{const m=Math.min((M.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.M(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,m){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},d),m)}panTo(l,d,m){return this.easeTo(o.e({center:l},d),m)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,m){return this.easeTo(o.e({zoom:l},d),m)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,m){return this.easeTo(o.e({bearing:l},d),m)}resetNorth(l,d){return this.rotateTo(0,o.e({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=vr.convert(l);const m=d&&d.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),m,d)}_cameraForBoxAndBearing(l,d,m,_){const x={top:0,bottom:0,right:0,left:0};if(typeof(_=o.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const dt=_.padding;_.padding={top:dt,bottom:dt,right:dt,left:dt}}_.padding=o.e(x,_.padding);const C=this.transform,$=C.padding,R=new vr(l,d),D=C.project(R.getNorthWest()),B=C.project(R.getNorthEast()),U=C.project(R.getSouthEast()),Y=C.project(R.getSouthWest()),ne=o.b8(-m),re=D.rotate(ne),le=B.rotate(ne),X=U.rotate(ne),fe=Y.rotate(ne),Ae=new o.P(Math.max(re.x,le.x,fe.x,X.x),Math.max(re.y,le.y,fe.y,X.y)),ce=new o.P(Math.min(re.x,le.x,fe.x,X.x),Math.min(re.y,le.y,fe.y,X.y)),xe=Ae.sub(ce),Pe=(C.width-($.left+$.right+_.padding.left+_.padding.right))/xe.x,Ce=(C.height-($.top+$.bottom+_.padding.top+_.padding.bottom))/xe.y;if(Ce<0||Pe<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Re=Math.min(C.scaleZoom(C.scale*Math.min(Pe,Ce)),_.maxZoom),qe=o.P.convert(_.offset),Ue=new o.P((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(o.b8(m)),Ve=qe.add(Ue).mult(C.scale/C.zoomScale(Re));return{center:C.unproject(D.add(U).div(2).sub(Ve)),zoom:Re,bearing:m}}fitBounds(l,d,m){return this._fitInternal(this.cameraForBounds(l,d),d,m)}fitScreenCoordinates(l,d,m,_,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(l)),this.transform.pointLocation(o.P.convert(d)),m,_),_,x)}_fitInternal(l,d,m){return l?(delete(d=o.e(l,d)).padding,d.linear?this.easeTo(d,m):this.flyTo(d,m)):this}jumpTo(l,d){this.stop();const m=this._getTransformForUpdate();let _=!1,x=!1,C=!1;return"zoom"in l&&m.zoom!==+l.zoom&&(_=!0,m.zoom=+l.zoom),l.center!==void 0&&(m.center=o.M.convert(l.center)),"bearing"in l&&m.bearing!==+l.bearing&&(x=!0,m.bearing=+l.bearing),"pitch"in l&&m.pitch!==+l.pitch&&(C=!0,m.pitch=+l.pitch),l.padding==null||m.isPaddingEqual(l.padding)||(m.padding=l.padding),this._applyUpdatedTransform(m),this.fire(new o.k("movestart",d)).fire(new o.k("move",d)),_&&this.fire(new o.k("zoomstart",d)).fire(new o.k("zoom",d)).fire(new o.k("zoomend",d)),x&&this.fire(new o.k("rotatestart",d)).fire(new o.k("rotate",d)).fire(new o.k("rotateend",d)),C&&this.fire(new o.k("pitchstart",d)).fire(new o.k("pitch",d)).fire(new o.k("pitchend",d)),this.fire(new o.k("moveend",d))}calculateCameraOptionsFromTo(l,d,m,_=0){const x=o.Y.fromLngLat(l,d),C=o.Y.fromLngLat(m,_),$=C.x-x.x,R=C.y-x.y,D=C.z-x.z,B=Math.hypot($,R,D);if(B===0)throw new Error("Can't calculate camera options with same From and To");const U=Math.hypot($,R),Y=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),ne=180*Math.atan2($,-R)/Math.PI;let re=180*Math.acos(U/B)/Math.PI;return re=D<0?90-re:90+re,{center:C.toLngLat(),zoom:Y,pitch:re,bearing:ne}}easeTo(l,d){var m;this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.b7},l)).animate===!1||!l.essential&&M.prefersReducedMotion)&&(l.duration=0);const _=this._getTransformForUpdate(),x=this.getZoom(),C=this.getBearing(),$=this.getPitch(),R=this.getPadding(),D="bearing"in l?this._normalizeBearing(l.bearing,C):C,B="pitch"in l?+l.pitch:$,U="padding"in l?l.padding:_.padding,Y=o.P.convert(l.offset);let ne=_.centerPoint.add(Y);const re=_.pointLocation(ne),{center:le,zoom:X}=_.getConstrained(o.M.convert(l.center||re),(m=l.zoom)!==null&&m!==void 0?m:x);this._normalizeCenter(le);const fe=_.project(re),Ae=_.project(le).sub(fe),ce=_.zoomScale(X-x);let xe,Pe;l.around&&(xe=o.M.convert(l.around),Pe=_.locationPoint(xe));const Ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||X!==x,this._rotating=this._rotating||C!==D,this._pitching=this._pitching||B!==$,this._padding=!_.isPaddingEqual(U),this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Ce),this.terrain&&this._prepareElevation(le),this._ease(Re=>{if(this._zooming&&(_.zoom=o.z.number(x,X,Re)),this._rotating&&(_.bearing=o.z.number(C,D,Re)),this._pitching&&(_.pitch=o.z.number($,B,Re)),this._padding&&(_.interpolatePadding(R,U,Re),ne=_.centerPoint.add(Y)),this.terrain&&!l.freezeElevation&&this._updateElevation(Re),xe)_.setLocationAtPoint(xe,Pe);else{const qe=_.zoomScale(_.zoom-x),Ue=X>x?Math.min(2,ce):Math.max(.5,ce),Ve=Math.pow(Ue,1-Re),dt=_.unproject(fe.add(Ae.mult(Re*Ve)).mult(qe));_.setLocationAtPoint(_.renderWorldCopies?dt.wrap():dt,ne)}this._applyUpdatedTransform(_),this._fireMoveEvents(d)},Re=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Re)},l),this}_prepareEase(l,d,m={}){this._moving=!0,d||m.moving||this.fire(new o.k("movestart",l)),this._zooming&&!m.zooming&&this.fire(new o.k("zoomstart",l)),this._rotating&&!m.rotating&&this.fire(new o.k("rotatestart",l)),this._pitching&&!m.pitching&&this.fire(new o.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&d!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(m-(d-(m*l+this._elevationStart))/(1-l)),this._elevationTarget=d}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(l){if(!this.transformCameraUpdate)return;const d=l.clone(),{center:m,zoom:_,pitch:x,bearing:C,elevation:$}=this.transformCameraUpdate(d);m&&(d.center=m),_!==void 0&&(d.zoom=_),x!==void 0&&(d.pitch=x),C!==void 0&&(d.bearing=C),$!==void 0&&(d.elevation=$),this.transform.apply(d)}_fireMoveEvents(l){this.fire(new o.k("move",l)),this._zooming&&this.fire(new o.k("zoom",l)),this._rotating&&this.fire(new o.k("rotate",l)),this._pitching&&this.fire(new o.k("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const m=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.k("zoomend",l)),_&&this.fire(new o.k("rotateend",l)),x&&this.fire(new o.k("pitchend",l)),this.fire(new o.k("moveend",l))}flyTo(l,d){var m;if(!l.essential&&M.prefersReducedMotion){const ui=o.L(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ui,d)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b7},l);const _=this._getTransformForUpdate(),x=this.getZoom(),C=this.getBearing(),$=this.getPitch(),R=this.getPadding(),D="bearing"in l?this._normalizeBearing(l.bearing,C):C,B="pitch"in l?+l.pitch:$,U="padding"in l?l.padding:_.padding,Y=o.P.convert(l.offset);let ne=_.centerPoint.add(Y);const re=_.pointLocation(ne),{center:le,zoom:X}=_.getConstrained(o.M.convert(l.center||re),(m=l.zoom)!==null&&m!==void 0?m:x);this._normalizeCenter(le);const fe=_.zoomScale(X-x),Ae=_.project(re),ce=_.project(le).sub(Ae);let xe=l.curve;const Pe=Math.max(_.width,_.height),Ce=Pe/fe,Re=ce.mag();if("minZoom"in l){const ui=o.ac(Math.min(l.minZoom,x,X),_.minZoom,_.maxZoom),Nt=Pe/_.zoomScale(ui-x);xe=Math.sqrt(Nt/Re*2)}const qe=xe*xe;function Ue(ui){const Nt=(Ce*Ce-Pe*Pe+(ui?-1:1)*qe*qe*Re*Re)/(2*(ui?Ce:Pe)*qe*Re);return Math.log(Math.sqrt(Nt*Nt+1)-Nt)}function Ve(ui){return(Math.exp(ui)-Math.exp(-ui))/2}function dt(ui){return(Math.exp(ui)+Math.exp(-ui))/2}const Vt=Ue(!1);let tt=function(ui){return dt(Vt)/dt(Vt+xe*ui)},Rt=function(ui){return Pe*((dt(Vt)*(Ve(Nt=Vt+xe*ui)/dt(Nt))-Ve(Vt))/qe)/Re;var Nt},Yt=(Ue(!0)-Vt)/xe;if(Math.abs(Re)<1e-6||!isFinite(Yt)){if(Math.abs(Pe-Ce)<1e-6)return this.easeTo(l,d);const ui=Ce<Pe?-1:1;Yt=Math.abs(Math.log(Ce/Pe))/xe,Rt=function(){return 0},tt=function(Nt){return Math.exp(ui*xe*Nt)}}return l.duration="duration"in l?+l.duration:1e3*Yt/("screenSpeed"in l?+l.screenSpeed/xe:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=C!==D,this._pitching=B!==$,this._padding=!_.isPaddingEqual(U),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(le),this._ease(ui=>{const Nt=ui*Yt,Qt=1/tt(Nt);_.zoom=ui===1?X:x+_.scaleZoom(Qt),this._rotating&&(_.bearing=o.z.number(C,D,ui)),this._pitching&&(_.pitch=o.z.number($,B,ui)),this._padding&&(_.interpolatePadding(R,U,ui),ne=_.centerPoint.add(Y)),this.terrain&&!l.freezeElevation&&this._updateElevation(ui);const ei=ui===1?le:_.unproject(Ae.add(ce.mult(Rt(Nt))).mult(Qt));_.setLocationAtPoint(_.renderWorldCopies?ei.wrap():ei,ne),this._applyUpdatedTransform(_),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,d)}if(!l){const m=this.handlers;m&&m.stop(!1)}return this}_ease(l,d,m){m.animate===!1||m.duration===0?(l(1),d()):(this._easeStart=M.now(),this._easeOptions=m,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,d){l=o.b1(l,-180,180);const m=Math.abs(l-d);return Math.abs(l-360-d)<m&&(l-=360),Math.abs(l+360-d)<m&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const m=l.lng-d.center.lng;l.lng+=m>180?-360:m<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.M.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}const so={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class m1{constructor(l=so){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const m=this._map._getUIString(`AttributionControl.${d}`);l.title=m,l.setAttribute("aria-label",m)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const x=d[_];if(x.used||x.usedForTerrain){const C=x.getSource();C.attribution&&l.indexOf(C.attribution)<0&&l.push(C.attribution)}}l=l.filter(_=>String(_).trim()),l.sort((_,x)=>_.length-x.length),l=l.filter((_,x)=>{for(let C=x+1;C<l.length;C++)if(l[C].indexOf(_)>=0)return!1;return!0});const m=l.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,l.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ou{constructor(l={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const m=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact"):m.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const d=A.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ar{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,m=d?this._queue.concat(d):this._queue;for(const _ of m)if(_.id===l)return void(_.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const m of d)if(!m.cancelled&&(m.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var xr=o.X([{name:"a_pos3d",type:"Int16",components:3}]);class y1 extends o.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,d){this.sourceCache.update(l,d),this._renderableTilesKeys=[];const m={};for(const _ of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))m[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),o.aN(_.posMatrix,0,o.W,0,o.W,0,1),this._tiles[_.key]=new ys(_,this.tileSize));for(const _ in this._tiles)m[_]||delete this._tiles[_]}freeRtt(l){for(const d in this._tiles){const m=this._tiles[d];(!l||m.tileID.equals(l)||m.tileID.isChildOf(l)||l.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const d={};for(const m of this._renderableTilesKeys){const _=this._tiles[m].tileID;if(_.canonical.equals(l.canonical)){const x=l.clone();x.posMatrix=new Float64Array(16),o.aN(x.posMatrix,0,o.W,0,o.W,0,1),d[m]=x}else if(_.canonical.isChildOf(l.canonical)){const x=l.clone();x.posMatrix=new Float64Array(16);const C=_.canonical.z-l.canonical.z,$=_.canonical.x-(_.canonical.x>>C<<C),R=_.canonical.y-(_.canonical.y>>C<<C),D=o.W>>C;o.aN(x.posMatrix,0,D,0,D,0,1),o.H(x.posMatrix,x.posMatrix,[-$*D,-R*D,0]),d[m]=x}else if(l.canonical.isChildOf(_.canonical)){const x=l.clone();x.posMatrix=new Float64Array(16);const C=l.canonical.z-_.canonical.z,$=l.canonical.x-(l.canonical.x>>C<<C),R=l.canonical.y-(l.canonical.y>>C<<C),D=o.W>>C;o.aN(x.posMatrix,0,o.W,0,o.W,0,1),o.H(x.posMatrix,x.posMatrix,[$*D,R*D,0]),o.J(x.posMatrix,x.posMatrix,[1/2**C,1/2**C,0]),d[m]=x}}return d}getSourceTile(l,d){const m=this.sourceCache._source;let _=l.overscaledZ-this.deltaZoom;if(_>m.maxzoom&&(_=m.maxzoom),_<m.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(_).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!x||!x.dem)&&d)for(;_>=m.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(l.scaledTo(_--).key);return x}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=l)}}class Hh{constructor(l,d,m){this.painter=l,this.sourceCache=new y1(d),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,d,m,_=o.W){var x;if(!(d>=0&&d<_&&m>=0&&m<_))return 0;const C=this.getTerrainData(l),$=(x=C.tile)===null||x===void 0?void 0:x.dem;if(!$)return 0;const R=function(re,le,X){var fe=le[0],Ae=le[1];return re[0]=X[0]*fe+X[4]*Ae+X[12],re[1]=X[1]*fe+X[5]*Ae+X[13],re}([],[d/_*o.W,m/_*o.W],C.u_terrain_matrix),D=[R[0]*$.dim,R[1]*$.dim],B=Math.floor(D[0]),U=Math.floor(D[1]),Y=D[0]-B,ne=D[1]-U;return $.get(B,U)*(1-Y)*(1-ne)+$.get(B+1,U)*Y*(1-ne)+$.get(B,U+1)*(1-Y)*ne+$.get(B+1,U+1)*Y*ne}getElevationForLngLatZoom(l,d){const{tileID:m,mercatorX:_,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(l,d);return this.getElevation(m,_%o.W,x%o.W,o.W)}getElevation(l,d,m,_=o.W){return this.getDEMElevation(l,d,m,_)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const _=this.painter.context,x=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new nt(_,x,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new nt(_,new o.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const d=this.sourceCache.getSourceTile(l,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new nt(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const m=d&&d+d.tileID.key+l.key;if(m&&!this._demMatrixCache[m]){const _=this.sourceCache.sourceCache._source.maxzoom;let x=l.canonical.z-d.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=_?x=l.canonical.z-_:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const C=l.canonical.x-(l.canonical.x>>x<<x),$=l.canonical.y-(l.canonical.y>>x<<x),R=o.b9(new Float64Array(16),[1/(o.W<<x),1/(o.W<<x),0]);o.H(R,R,[C*o.W,$*o.W,0]),this._demMatrixCache[l.key]={matrix:R,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(l){const d=this.painter,m=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new nt(d.context,{width:m,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new nt(d.context,{width:m,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(m,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,m,_))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,C=0;x<this._coordsTextureSize;x++)for(let $=0;$<this._coordsTextureSize;$++,C+=4)d[C+0]=255&$,d[C+1]=255&x,d[C+2]=$>>8<<4|x>>8,d[C+3]=0;const m=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new nt(l,m,l.gl.RGBA,{premultiply:!1});return _.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),m=this.painter.context,_=m.gl;m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),m.bindFramebuffer.set(null);const x=d[0]+(d[2]>>4<<8),C=d[1]+((15&d[2])<<8),$=this.coordsIndex[255-d[3]],R=$&&this.sourceCache.getTileByID($);if(!R)return null;const D=this._coordsTextureSize,B=(1<<R.tileID.canonical.z)*D;return new o.Y((R.tileID.canonical.x*D+x)/B+R.tileID.wrap,(R.tileID.canonical.y*D+C)/B,this.getElevation(R.tileID,x,C,D))}depthAtPoint(l){const d=new Uint8Array(4),m=this.painter.context,_=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),m.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.painter.context,d=new o.ba,m=new o.aX,_=this.meshSize,x=o.W/_,C=_*_;for(let U=0;U<=_;U++)for(let Y=0;Y<=_;Y++)d.emplaceBack(Y*x,U*x,0);for(let U=0;U<C;U+=_+1)for(let Y=0;Y<_;Y++)m.emplaceBack(Y+U,_+Y+U+1,_+Y+U+2),m.emplaceBack(Y+U,_+Y+U+2,Y+U+1);const $=d.length,R=$+2*(_+1);for(const U of[0,1])for(let Y=0;Y<=_;Y++)for(const ne of[0,1])d.emplaceBack(Y*x,U*o.W,ne);for(let U=0;U<2*_;U+=2)m.emplaceBack(R+U,R+U+1,R+U+3),m.emplaceBack(R+U,R+U+3,R+U+2),m.emplaceBack($+U,$+U+3,$+U+1),m.emplaceBack($+U,$+U+2,$+U+3);const D=d.length,B=D+2*(_+1);for(const U of[0,1])for(let Y=0;Y<=_;Y++)for(const ne of[0,1])d.emplaceBack(U*o.W,Y*x,ne);for(let U=0;U<2*_;U+=2)m.emplaceBack(D+U,D+U+1,D+U+3),m.emplaceBack(D+U,D+U+3,D+U+2),m.emplaceBack(B+U,B+U+3,B+U+1),m.emplaceBack(B+U,B+U+2,B+U+3);return this._mesh={indexBuffer:l.createIndexBuffer(m),vertexBuffer:l.createVertexBuffer(d,xr.members),segments:o.$.simpleSegment(0,0,d.length,m.length)},this._mesh}getMeshFrameDelta(l){return 2*Math.PI*o.bb/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,d){var m;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(l,d);return(m=this.getMinMaxElevation(_).minElevation)!==null&&m!==void 0?m:0}getMinMaxElevation(l){const d=this.getTerrainData(l).tile,m={minElevation:null,maxElevation:null};return d&&d.dem&&(m.minElevation=d.dem.min*this.exaggeration,m.maxElevation=d.dem.max*this.exaggeration),m}_getOverscaledTileIDFromLngLatZoom(l,d){const m=o.Y.fromLngLat(l.wrap()),_=(1<<d)*o.W,x=m.x*_,C=m.y*_,$=Math.floor(x/o.W),R=Math.floor(C/o.W);return{tileID:new o.Q(d,0,d,$,R),mercatorX:x,mercatorY:C}}}class rf{constructor(l,d,m){this._context=l,this._size=d,this._tileSize=m,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new nt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(m.texture),{id:l,fbo:d,texture:m,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>l.id!==d),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const rl={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ay{constructor(l,d){this.painter=l,this.terrain=d,this.pool=new rf(l.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(m=>!l._layers[m].isHidden(d)),this._coordsDescendingInv={};for(const m in l.sourceCaches){this._coordsDescendingInv[m]={};const _=l.sourceCaches[m].getVisibleCoordinates();for(const x of _){const C=this.terrain.sourceCache.getTerrainCoords(x);for(const $ in C)this._coordsDescendingInv[m][$]||(this._coordsDescendingInv[m][$]=[]),this._coordsDescendingInv[m][$].push(C[$])}}this._coordsDescendingInvStr={};for(const m of l._order){const _=l._layers[m],x=_.source;if(rl[_.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const C in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][C]=this._coordsDescendingInv[x][C].map($=>$.key).sort().join()}}for(const m of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[_][m.tileID.key];x&&x!==m.rttCoords[_]&&(m.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;const d=l.type,m=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(rl[d]&&(this._prevType&&rl[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(l.id),!_))return!0;if(rl[this._prevType]||rl[d]&&_){this._prevType=d;const x=this._stacks.length-1,C=this._stacks[x]||[];for(const $ of this._renderableTiles){if(this.pool.isFull()&&(fy(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push($),$.rtt[x]){const D=this.pool.getObjectForId($.rtt[x].id);if(D.stamp===$.rtt[x].stamp){this.pool.useObject(D);continue}}const R=this.pool.getOrCreateFreeObject();this.pool.useObject(R),this.pool.stampObject(R),$.rtt[x]={id:R.id,stamp:R.stamp},m.context.bindFramebuffer.set(R.fbo.framebuffer),m.context.clear({color:o.aO.transparent,stencil:0}),m.currentStencilSource=void 0;for(let D=0;D<C.length;D++){const B=m.style._layers[C[D]],U=B.source?this._coordsDescendingInv[B.source][$.tileID.key]:[$.tileID];m.context.viewport.set([0,0,R.fbo.width,R.fbo.height]),m._renderTileClippingMasks(B,U),m.renderLayer(m,m.style.sourceCaches[B.source],B,U),B.source&&($.rttCoords[B.source]=this._coordsDescendingInvStr[B.source][$.tileID.key])}}return fy(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),rl[d]}return!1}}const Py={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Wh=p,Cy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:so,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},sf=w=>{w.touchstart=w.dragStart,w.touchmoveWindow=w.dragMove,w.touchend=w.dragEnd},$y={showCompass:!0,showZoom:!0,visualizePitch:!1};class ky{constructor(l,d,m=!1){this.mousedown=C=>{this.startMouse(o.e({},C,{ctrlKey:!0,preventDefault:()=>C.preventDefault()}),A.mousePos(this.element,C)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=C=>{this.moveMouse(C,A.mousePos(this.element,C))},this.mouseup=C=>{this.mouseRotate.dragEnd(C),this.mousePitch&&this.mousePitch.dragEnd(C),this.offTemp()},this.touchstart=C=>{C.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,C.targetTouches)[0],this.startTouch(C,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=C=>{C.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,C.targetTouches)[0],this.moveTouch(C,this._lastPos))},this.touchend=C=>{C.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const _=l.dragRotate._mouseRotate.getClickTolerance(),x=l.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=nu({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:C,clickTolerance:$,bearingDegreesPerPixelMoved:R=.8})=>{const D=new by;return new pa({clickTolerance:$,move:(B,U)=>({bearingDelta:(U.x-B.x)*R}),moveStateManager:D,enable:C,assignEvents:sf})})({clickTolerance:_,enable:!0}),this.map=l,m&&(this.mousePitch=wy({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:C,clickTolerance:$,pitchDegreesPerPixelMoved:R=-.5})=>{const D=new by;return new pa({clickTolerance:$,move:(B,U)=>({pitchDelta:(U.y-B.y)*R}),moveStateManager:D,enable:C,assignEvents:sf})})({clickTolerance:x,enable:!0})),A.addEventListener(d,"mousedown",this.mousedown),A.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(d,"touchcancel",this.reset)}startMouse(l,d){this.mouseRotate.dragStart(l,d),this.mousePitch&&this.mousePitch.dragStart(l,d),A.disableDrag()}startTouch(l,d){this.touchRotate.dragStart(l,d),this.touchPitch&&this.touchPitch.dragStart(l,d),A.disableDrag()}moveMouse(l,d){const m=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(l,d)||{};if(_&&m.setBearing(m.getBearing()+_),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(l,d)||{};x&&m.setPitch(m.getPitch()+x)}}moveTouch(l,d){const m=this.map,{bearingDelta:_}=this.touchRotate.dragMove(l,d)||{};if(_&&m.setBearing(m.getBearing()+_),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(l,d)||{};x&&m.setPitch(m.getPitch()+x)}}off(){const l=this.element;A.removeEventListener(l,"mousedown",this.mousedown),A.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let fa;function nf(w,l,d){const m=new o.M(w.lng,w.lat);if(w=new o.M(w.lng,w.lat),l){const _=new o.M(w.lng-360,w.lat),x=new o.M(w.lng+360,w.lat),C=d.locationPoint(w).distSqr(l);d.locationPoint(_).distSqr(l)<C?w=_:d.locationPoint(x).distSqr(l)<C&&(w=x)}for(;Math.abs(w.lng-d.center.lng)>180;){const _=d.locationPoint(w);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;w.lng>d.center.lng?w.lng-=360:w.lng+=360}return w.lng!==m.lng&&d.locationPoint(w).y>d.height/2-d.getHorizon()?w:m}const Zh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function of(w,l,d){const m=w.classList;for(const _ in Zh)m.remove(`maplibregl-${d}-anchor-${_}`);m.add(`maplibregl-${d}-anchor-${l}`)}class au extends o.E{constructor(l){if(super(),this._onKeyPress=d=>{const m=d.code,_=d.charCode||d.keyCode;m!=="Space"&&m!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const m=d.originalEvent.target,_=this._element;this._popup&&(m===_||_.contains(m))&&this.togglePopup()},this._update=d=>{var m;if(!this._map)return;const _=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!_)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?nf(this._lngLat,this._flatPos,this._map.transform):(m=this._lngLat)===null||m===void 0?void 0:m.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let C="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?C="rotateX(0deg)":this._pitchAlignment==="map"&&(C=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Zh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${C} ${x}`),M.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");const d=A.createNS("http://www.w3.org/2000/svg","svg"),m=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${m}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${m}`);const x=A.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const C=A.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");const $=A.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of R){const Ae=A.createNS("http://www.w3.org/2000/svg","ellipse");Ae.setAttributeNS(null,"opacity","0.04"),Ae.setAttributeNS(null,"cx","10.5"),Ae.setAttributeNS(null,"cy","5.80029008"),Ae.setAttributeNS(null,"rx",fe.rx),Ae.setAttributeNS(null,"ry",fe.ry),$.appendChild(Ae)}const D=A.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill",this._color);const B=A.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),D.appendChild(B);const U=A.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000");const Y=A.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(Y);const ne=A.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ne.setAttributeNS(null,"fill","#FFFFFF");const re=A.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=A.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const X=A.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962"),re.appendChild(le),re.appendChild(X),C.appendChild($),C.appendChild(D),C.appendChild(U),C.appendChild(ne),C.appendChild(re),d.appendChild(C),d.setAttributeNS(null,"height",m*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),of(this._element,this._anchor,"marker"),l&&l.className)for(const d of l.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.M.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const _=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var d,m;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,x=_.terrain.depthAtPoint(this._pos),C=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,C)-x<.006)return void(this._element.style.opacity=this._opacity);const $=-this._offset.y/_.transform._pixelPerMeter,R=Math.sin(_.getPitch()*Math.PI/180)*$,D=_.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),B=_.transform.lngLatToCameraDepth(this._lngLat,C+R)-D>.006;!((m=this._popup)===null||m===void 0)&&m.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,d){return l===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const Ry={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let lu=0,sl=!1;const Oy={maxWidth:100,unit:"metric"};function af(w,l,d){const m=d&&d.maxWidth||100,_=w._container.clientHeight/2,x=w.unproject([0,_]),C=w.unproject([m,_]),$=x.distanceTo(C);if(d&&d.unit==="imperial"){const R=3.2808*$;R>5280?tc(l,m,R/5280,w._getUIString("ScaleControl.Miles")):tc(l,m,R,w._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?tc(l,m,$/1852,w._getUIString("ScaleControl.NauticalMiles")):$>=1e3?tc(l,m,$/1e3,w._getUIString("ScaleControl.Kilometers")):tc(l,m,$,w._getUIString("ScaleControl.Meters"))}function tc(w,l,d,m){const _=function(x){const C=Math.pow(10,`${Math.floor(x)}`.length-1);let $=x/C;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(R){const D=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*D)/D}($),C*$}(d);w.style.width=l*(_/d)+"px",w.innerHTML=`${_}&nbsp;${m}`}const Ly={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Dy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ny(w){if(w){if(typeof w=="number"){const l=Math.round(Math.abs(w)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,w),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-w),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(w,0),right:new o.P(-w,0)}}if(w instanceof o.P||Array.isArray(w)){const l=o.P.convert(w);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(w.center||[0,0]),top:o.P.convert(w.top||[0,0]),"top-left":o.P.convert(w["top-left"]||[0,0]),"top-right":o.P.convert(w["top-right"]||[0,0]),bottom:o.P.convert(w.bottom||[0,0]),"bottom-left":o.P.convert(w["bottom-left"]||[0,0]),"bottom-right":o.P.convert(w["bottom-right"]||[0,0]),left:o.P.convert(w.left||[0,0]),right:o.P.convert(w.right||[0,0])}}return Ny(new o.P(0,0))}const g1=p;c.AJAXError=o.be,c.Evented=o.E,c.LngLat=o.M,c.MercatorCoordinate=o.Y,c.Point=o.P,c.addProtocol=o.bf,c.config=o.a,c.removeProtocol=o.bg,c.AttributionControl=m1,c.BoxZoomHandler=su,c.CanvasSource=el,c.CooperativeGesturesHandler=$t,c.DoubleClickZoomHandler=Iy,c.DragPanHandler=ro,c.DragRotateHandler=Gh,c.EdgeInsets=Bh,c.FullscreenControl=class extends o.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var l;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=d==null?void 0:d.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=ai,c.GeolocateControl=class extends o.E{constructor(w){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{const d=new o.M(l.coords.longitude,l.coords.latitude),m=l.coords.accuracy,_=this._map.getBearing(),x=o.e({bearing:_},this.options.fitBoundsOptions),C=vr.fromLngLat(d,m);this._map.fitBounds(C,x,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const d=new o.M(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&sl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=l=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new au({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new au({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")))})}},this.options=o.e({},Ry,w)}onAdd(w){return this._map=w,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function*(l=!1){if(fa!==void 0&&!l)return fa;if(window.navigator.permissions===void 0)return fa=!!window.navigator.geolocation,fa;try{fa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{fa=!!window.navigator.geolocation}return fa})}().then(l=>this._setupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,lu=0,sl=!1}_isOutOfMapMaxBounds(w){const l=this._map.getMaxBounds(),d=w.coords;return l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const w=this._map.getBounds(),l=w.getSouthEast(),d=w.getNorthEast(),m=l.distanceTo(d),_=Math.ceil(this._accuracy/(m/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":lu--,sl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),lu++,lu>1?(w={maximumAge:6e5,timeout:0},sl=!0):(w=this.options.positionOptions,sl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.Hash=gy,c.ImageSource=Bn,c.KeyboardHandler=Zi,c.LngLatBounds=vr,c.LogoControl=ou,c.Map=class extends f1{constructor(w){if(o.bc.mark(o.bd.create),(w=o.e({},Cy,w)).minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Kp(w.minZoom,w.maxZoom,w.minPitch,w.maxPitch,w.renderWorldCopies),{bearingSnap:w.bearingSnap}),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=w.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=w.preserveDrawingBuffer,this._antialias=w.antialias,this._trackResize=w.trackResize,this._bearingSnap=w.bearingSnap,this._refreshExpiredTiles=w.refreshExpiredTiles,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=w.collectResourceTiming,this._renderTaskQueue=new ar,this._controls=[],this._mapId=o.a3(),this._locale=o.e({},Py,w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this.transformCameraUpdate=w.transformCameraUpdate,this._imageQueueHandle=pe.addThrottleControl(()=>this.isMoving()),this._requestManager=new Me(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=yy(m=>{this._trackResize&&!this._removed&&this.resize(m)._update()},50);this._resizeObserver=new ResizeObserver(m=>{l?d(m):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Xs(this,w),this._hash=w.hash&&new gy(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new m1(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new ou,w.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new o.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(w,l){if(l===void 0&&(l=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=w.onAdd(this);this._controls.push(w);const m=this._controlPositions[l];return l.indexOf("bottom")!==-1?m.insertBefore(d,m.firstChild):m.appendChild(d),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(w);return l>-1&&this._controls.splice(l,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}calculateCameraOptionsFromTo(w,l,d,m){return m==null&&this.terrain&&(m=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(w,l,d,m)}resize(w){var l;const d=this._containerDimensions(),m=d[0],_=d[1],x=this._getClampedPixelRatio(m,_);if(this._resizeCanvas(m,_,x),this.painter.resize(m,_,x),this.painter.overLimit()){const $=this.painter.context.gl;this._maxCanvasSize=[$.drawingBufferWidth,$.drawingBufferHeight];const R=this._getClampedPixelRatio(m,_);this._resizeCanvas(m,_,R),this.painter.resize(m,_,R)}this.transform.resize(m,_),(l=this._requestedCameraState)===null||l===void 0||l.resize(m,_);const C=!this._moving;return C&&(this.stop(),this.fire(new o.k("movestart",w)).fire(new o.k("move",w))),this.fire(new o.k("resize",w)),C&&this.fire(new o.k("moveend",w)),this}_getClampedPixelRatio(w,l){const{0:d,1:m}=this._maxCanvasSize,_=this.getPixelRatio(),x=w*_,C=l*_;return Math.min(x>d?d/x:1,C>m?m/C:1)*_}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(vr.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.minZoom=w,this._update(),this.getZoom()<w&&this.setZoom(w),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.maxZoom=w,this._update(),this.getZoom()>w&&this.setZoom(w),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.minPitch=w,this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(w>=this.transform.minPitch)return this.transform.maxPitch=w,this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.renderWorldCopies=w,this._update()}project(w){return this.transform.locationPoint(o.M.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.pointLocation(o.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,l,d){if(w==="mouseenter"||w==="mouseover"){let m=!1;return{layer:l,listener:d,delegates:{mousemove:x=>{const C=this.getLayer(l)?this.queryRenderedFeatures(x.point,{layers:[l]}):[];C.length?m||(m=!0,d.call(this,new ts(w,this,x.originalEvent,{features:C}))):m=!1},mouseout:()=>{m=!1}}}}if(w==="mouseleave"||w==="mouseout"){let m=!1;return{layer:l,listener:d,delegates:{mousemove:C=>{(this.getLayer(l)?this.queryRenderedFeatures(C.point,{layers:[l]}):[]).length?m=!0:m&&(m=!1,d.call(this,new ts(w,this,C.originalEvent)))},mouseout:C=>{m&&(m=!1,d.call(this,new ts(w,this,C.originalEvent)))}}}}{const m=_=>{const x=this.getLayer(l)?this.queryRenderedFeatures(_.point,{layers:[l]}):[];x.length&&(_.features=x,d.call(this,_),delete _.features)};return{layer:l,listener:d,delegates:{[w]:m}}}}on(w,l,d){if(d===void 0)return super.on(w,l);const m=this._createDelegatedListener(w,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(m);for(const _ in m.delegates)this.on(_,m.delegates[_]);return this}once(w,l,d){if(d===void 0)return super.once(w,l);const m=this._createDelegatedListener(w,l,d);for(const _ in m.delegates)this.once(_,m.delegates[_]);return this}off(w,l,d){return d===void 0?super.off(w,l):(this._delegatedListeners&&this._delegatedListeners[w]&&(m=>{const _=this._delegatedListeners[w];for(let x=0;x<_.length;x++){const C=_[x];if(C.layer===l&&C.listener===d){for(const $ in C.delegates)this.off($,C.delegates[$]);return _.splice(x,1),this}}})(),this)}queryRenderedFeatures(w,l){if(!this.style)return[];let d;const m=w instanceof o.P||Array.isArray(w),_=m?w:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(m?{}:w)||{},_ instanceof o.P||typeof _[0]=="number")d=[o.P.convert(_)];else{const x=o.P.convert(_[0]),C=o.P.convert(_[1]);d=[x,new o.P(C.x,x.y),C,new o.P(x.x,C.y),x]}return this.style.queryRenderedFeatures(d,l,this.transform)}querySourceFeatures(w,l){return this.style.querySourceFeatures(w,l)}setStyle(w,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(w,l))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const l=this._locale[w];if(l==null)throw new Error(`Missing UI string '${w}'`);return l}_updateStyle(w,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(w,l));const d=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new Zt(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,l,d):this.style.loadJSON(w,l,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,l){if(typeof w=="string"){const d=this._requestManager.transformRequest(w,_e.Style);o.h(d,new AbortController).then(m=>{this._updateDiff(m.data,l)}).catch(m=>{m&&this.fire(new o.j(m))})}else typeof w=="object"&&this._updateDiff(w,l)}_updateDiff(w,l){try{this.style.setState(w,l)&&this._update(!0)}catch(d){o.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(w,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(w,l){return this._lazyInitEmptyStyle(),this.style.addSource(w,l),this._update(!0)}isSourceLoaded(w){const l=this.style&&this.style.sourceCaches[w];if(l!==void 0)return l.loaded();this.fire(new o.j(new Error(`There is no source with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const l=this.style.sourceCaches[w.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&l.reload();for(const d in this.style._layers){const m=this.style._layers[d];m.type==="hillshade"&&m.source===w.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Hh(this.painter,l,w),this.painter.renderToTexture=new Ay(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==w.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:w})),this}getTerrain(){var w,l;return(l=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const w=this.style&&this.style.sourceCaches;for(const l in w){const d=w[l]._tiles;for(const m in d){const _=d[m];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}addImage(w,l,d={}){const{pixelRatio:m=1,sdf:_=!1,stretchX:x,stretchY:C,content:$}=d;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:D,data:B}=l,U=l;return this.style.addImage(w,{data:new o.R({width:R,height:D},new Uint8Array(B)),pixelRatio:m,stretchX:x,stretchY:C,content:$,sdf:_,version:0,userImage:U}),U.onAdd&&U.onAdd(this,w),this}}{const{width:R,height:D,data:B}=M.getImageData(l);this.style.addImage(w,{data:new o.R({width:R,height:D},B),pixelRatio:m,stretchX:x,stretchY:C,content:$,sdf:_,version:0})}}updateImage(w,l){const d=this.style.getImage(w);if(!d)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=l instanceof HTMLImageElement||o.b(l)?M.getImageData(l):l,{width:_,height:x,data:C}=m;if(_===void 0||x===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||x!==d.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const $=!(l instanceof HTMLImageElement||o.b(l));return d.data.replace(C,$),this.style.updateImage(w,d),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return pe.getImage(this._requestManager.transformRequest(w,_e.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,l){return this._lazyInitEmptyStyle(),this.style.addLayer(w,l),this._update(!0)}moveLayer(w,l){return this.style.moveLayer(w,l),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,l,d){return this.style.setLayerZoomRange(w,l,d),this._update(!0)}setFilter(w,l,d={}){return this.style.setFilter(w,l,d),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,l,d,m={}){return this.style.setPaintProperty(w,l,d,m),this._update(!0)}getPaintProperty(w,l){return this.style.getPaintProperty(w,l)}setLayoutProperty(w,l,d,m={}){return this.style.setLayoutProperty(w,l,d,m),this._update(!0)}getLayoutProperty(w,l){return this.style.getLayoutProperty(w,l)}setGlyphs(w,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,l,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,l,d,m=>{m||this._update(!0)}),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,l,d=>{d||this._update(!0)}),this}setLight(w,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(w,l){return this.style.setFeatureState(w,l),this._update()}removeFeatureState(w,l){return this.style.removeFeatureState(w,l),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,l=0;return this._container&&(w=this._container.clientWidth||400,l=this._container.clientHeight||300),[w,l]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const l=this._canvasContainer=A.create("div","maplibregl-canvas-container",w);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),m=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],m);const _=this._controlContainer=A.create("div","maplibregl-control-container",w),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{x[C]=A.create("div",`maplibregl-ctrl-${C} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,l,d){this._canvas.width=Math.floor(d*w),this._canvas.height=Math.floor(d*l),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const w={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let l=null;this._canvas.addEventListener("webglcontextcreationerror",m=>{l={requestedAttributes:w},m&&(l.statusMessage=m.statusMessage,l.type=m.type)},{once:!0});const d=this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w);if(!d){const m="Failed to initialize WebGL";throw l?(l.message=m,new Error(JSON.stringify(l))):new Error(m)}this.painter=new tu(d,this.transform),O.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){const l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,x=M.now();this.style.zoomHistory.update(_,x);const C=new o.a8(_,{now:x,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=C.crossFadingFactor();$===1&&$===this._crossFadingFactor||(d=!0,this._crossFadingFactor=$),this.style.update(C)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bc.mark(o.bd.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const m=this._sourcesDirty||this._styleDirty||this._placementDirty;return m||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||m||(this._fullyLoaded=!0,o.bc.mark(o.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),pe.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bc.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(w=>{o.bc.frame(w),this._frameRequest=null,this._render(w)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return Wh}getCameraTargetElevation(){return this.transform.elevation}},c.MapMouseEvent=ts,c.MapTouchEvent=ru,c.MapWheelEvent=jn,c.Marker=au,c.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const l=this._map.getZoom(),d=l===this._map.getMaxZoom(),m=l===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},this._rotateCompassArrow=()=>{const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,d)=>{const m=this._map._getUIString(`NavigationControl.${d}`);l.title=m,l.setAttribute("aria-label",m)},this.options=o.e({},$y,w),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ky(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,l){const d=A.create("button",w,this._container);return d.type="button",d.addEventListener("click",l),d}},c.Popup=class extends o.E{constructor(w){super(),this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const $ of this.options.className.split(" "))this._container.classList.add($);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?nf(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!l)return;const m=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationPoint(this._lngLat));let _=this.options.anchor;const x=Ny(this.options.offset);if(!_){const $=this._container.offsetWidth,R=this._container.offsetHeight;let D;D=m.y+x.bottom.y<R?["top"]:m.y>this._map.transform.height-R?["bottom"]:[],m.x<$/2?D.push("left"):m.x>this._map.transform.width-$/2&&D.push("right"),_=D.length===0?"bottom":D.join("-")}let C=m.add(x[_]);this.options.subpixelPositioning||(C=C.round()),A.setTransform(this._container,`${Zh[_]} translate(${C.x}px,${C.y}px)`),of(this._container,_,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Ly),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=o.M.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const l=document.createDocumentFragment(),d=document.createElement("body");let m;for(d.innerHTML=w;m=d.firstChild,m;)l.appendChild(m);return this.setDOMContent(l)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){this._container&&this._container.classList.add(w)}removeClassName(w){this._container&&this._container.classList.remove(w)}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Dy);w&&w.focus()}},c.RasterDEMTileSource=Vl,c.RasterTileSource=ca,c.ScaleControl=class{constructor(w){this._onMove=()=>{af(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,af(this._map,this._container,this.options)},this.options=o.e({},Oy,w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=Ey,c.Style=Zt,c.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=d1,c.TwoFingersTouchRotateHandler=Sy,c.TwoFingersTouchZoomHandler=Qp,c.TwoFingersTouchZoomRotateHandler=wt,c.VectorTileSource=Oe,c.VideoSource=Qa,c.addSourceType=(w,l)=>o._(void 0,void 0,void 0,function*(){if(Ao(w))throw new Error(`A source type called "${w}" already exists.`);((d,m)=>{ua[d]=m})(w,l)}),c.clearPrewarmedResources=function(){const w=yn;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(Cs),yn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return Rs().getRTLTextPluginStatus()},c.getVersion=function(){return g1},c.getWorkerCount=function(){return fs.workerCount},c.getWorkerUrl=function(){return o.a.WORKER_URL},c.importScriptInWorkers=function(w){return oi().broadcast("importScript",w)},c.prewarm=function(){ms().acquire(Cs)},c.setMaxParallelImageRequests=function(w){o.a.MAX_PARALLEL_IMAGE_REQUESTS=w},c.setRTLTextPlugin=function(w,l){return Rs().setRTLTextPlugin(w,l)},c.setWorkerCount=function(w){fs.workerCount=w},c.setWorkerUrl=function(w){o.a.WORKER_URL=w}});var n=i;return n})})(j9);var efe=j9.exports;const $p=Qpe(efe);function tfe(e,t,i){let r;const{map:s}=O_();Fc(e,s,g=>i(5,r=g));let{position:n="bottom-right"}=t,{compact:c=!1}=t,{customAttribution:o=void 0}=t,p=null;return Fm(()=>{r!=null&&r.loaded()&&p&&r.removeControl(p)}),e.$$set=g=>{"position"in g&&i(1,n=g.position),"compact"in g&&i(2,c=g.compact),"customAttribution"in g&&i(3,o=g.customAttribution)},e.$$.update=()=>{e.$$.dirty&62&&r&&!p&&(i(4,p=new $p.AttributionControl({compact:c,customAttribution:o})),r.addControl(p,n))},[s,n,c,o,p,r]}class ife extends Bl{constructor(t){super(),Fl(this,t,tfe,null,Ka,{position:1,compact:2,customAttribution:3})}}var rfe=sfe;function sfe(e){var t,i,r;if(e){if(Array.isArray(e)){for(t=[],i=e.length,r=0;r<i;r++){var s=e[r];s!=null&&t.push(s)}return t}if(typeof e=="object"){t={};var n=Object.keys(e);for(i=n.length,r=0;r<i;r++){var c=n[r],o=e[c];o!=null&&(t[c]=o)}return t}}}function nfe(e,t,i){let r;const{map:s}=O_();Fc(e,s,p=>i(4,r=p));let{position:n="top-left"}=t,{container:c=void 0}=t,o=null;return Fm(()=>{r!=null&&r.loaded()&&o&&r.removeControl(o)}),e.$$set=p=>{"position"in p&&i(1,n=p.position),"container"in p&&i(2,c=p.container)},e.$$.update=()=>{if(e.$$.dirty&30&&r&&!o){let p;typeof c=="string"?p=document.querySelector(c)??void 0:p=c,i(3,o=new $p.FullscreenControl({container:p})),r.addControl(o,n)}},[s,n,c,o,r]}class G9 extends Bl{constructor(t){super(),Fl(this,t,nfe,null,Ka,{position:1,container:2})}}function ofe(e,t,i){let r;const{map:s}=O_();Fc(e,s,A=>i(8,r=A));let{position:n="top-left"}=t,{positionOptions:c=void 0}=t,{fitBoundsOptions:o=void 0}=t,{trackUserLocation:p=!1}=t,{showAccuracyCircle:g=!0}=t,{showUserLocation:S=!0}=t,M=null;return Fm(()=>{r!=null&&r.loaded()&&M&&r.removeControl(M)}),e.$$set=A=>{"position"in A&&i(1,n=A.position),"positionOptions"in A&&i(2,c=A.positionOptions),"fitBoundsOptions"in A&&i(3,o=A.fitBoundsOptions),"trackUserLocation"in A&&i(4,p=A.trackUserLocation),"showAccuracyCircle"in A&&i(5,g=A.showAccuracyCircle),"showUserLocation"in A&&i(6,S=A.showUserLocation)},e.$$.update=()=>{e.$$.dirty&510&&r&&!M&&(i(7,M=new $p.GeolocateControl({positionOptions:c,fitBoundsOptions:o,trackUserLocation:p,showAccuracyCircle:g,showUserLocation:S})),r.addControl(M,n))},[s,n,c,o,p,g,S,M,r]}class q9 extends Bl{constructor(t){super(),Fl(this,t,ofe,null,Ka,{position:1,positionOptions:2,fitBoundsOptions:3,trackUserLocation:4,showAccuracyCircle:5,showUserLocation:6})}}function afe(e){let t=e.getCenter(),i=Math.round(e.getZoom()*100)/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,r),n=Math.round(t.lat*s)/s,c=Math.round(t.lng*s)/s,o=`${i}/${n}/${c}`,p=e.getBearing(),g=e.getPitch();return(p||g)&&(o+=`/${Math.round(p*10)/10}`),g&&(o+=`/${Math.round(g)}`),`#${o}`}function lfe(e){return e.replace("#","").split("/").map(parseFloat)}var Ov=pP;function pP(e,t){return e===t||e!==e&&t!==t?!0:typeof e!=typeof t||{}.toString.call(e)!={}.toString.call(t)||e!==Object(e)||!e?!1:Array.isArray(e)?GD(e,t):{}.toString.call(e)=="[object Set]"?GD(Array.from(e),Array.from(t)):{}.toString.call(e)=="[object Object]"?ufe(e,t):cfe(e,t)}function cfe(e,t){return e.toString()===t.toString()}function GD(e,t){var i=e.length;if(i!=t.length)return!1;for(var r=0;r<i;r++)if(!pP(e[r],t[r]))return!1;return!0}function ufe(e,t){var i=Object.keys(e),r=i.length;if(r!=Object.keys(t).length)return!1;for(var s=0;s<r;s++){var n=i[s];if(!(t.hasOwnProperty(n)&&pP(e[n],t[n])))return!1}return!0}function hfe(e,t,i){let r;const{map:s}=O_();Fc(e,s,S=>i(6,r=S));let{position:n="top-left"}=t,{showCompass:c=!0}=t,{showZoom:o=!0}=t,{visualizePitch:p=!1}=t,g=null;return Fm(()=>{r!=null&&r.loaded()&&g&&r.removeControl(g)}),e.$$set=S=>{"position"in S&&i(1,n=S.position),"showCompass"in S&&i(2,c=S.showCompass),"showZoom"in S&&i(3,o=S.showZoom),"visualizePitch"in S&&i(4,p=S.visualizePitch)},e.$$.update=()=>{e.$$.dirty&126&&r&&!g&&(i(5,g=new $p.NavigationControl({showCompass:c,showZoom:o,visualizePitch:p})),r.addControl(g,n))},[s,n,c,o,p,g,r]}class H9 extends Bl{constructor(t){super(),Fl(this,t,hfe,null,Ka,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function dfe(e,t,i){let r;const{map:s}=O_();Fc(e,s,g=>i(5,r=g));let{position:n="bottom-left"}=t,{maxWidth:c=void 0}=t,{unit:o="metric"}=t,p=null;return Fm(()=>{r!=null&&r.loaded()&&p&&r.removeControl(p)}),e.$$set=g=>{"position"in g&&i(1,n=g.position),"maxWidth"in g&&i(2,c=g.maxWidth),"unit"in g&&i(3,o=g.unit)},e.$$.update=()=>{e.$$.dirty&62&&r&&!p&&(i(4,p=new $p.ScaleControl({maxWidth:c,unit:o})),r.addControl(p,n))},[s,n,c,o,p,r]}class W9 extends Bl{constructor(t){super(),Fl(this,t,dfe,null,Ka,{position:1,maxWidth:2,unit:3})}}const{window:pfe}=t7,ffe=e=>({map:e[0]&8,loadedImages:e[0]&16,allImagesLoaded:e[0]&32}),qD=e=>({map:e[3],loadedImages:e[4],allImagesLoaded:e[5]});function HD(e){let t,i,r=e[2]&&WD(e);const s=e[37].default,n=JV(s,e,e[36],qD);return{c(){r&&r.c(),t=$n(),n&&n.c()},m(c,o){r&&r.m(c,o),Xo(c,t,o),n&&n.m(c,o),i=!0},p(c,o){c[2]?r?(r.p(c,o),o[0]&4&&Dr(r,1)):(r=WD(c),r.c(),Dr(r,1),r.m(t.parentNode,t)):r&&(f5(),ds(r,1,1,()=>{r=null}),m5()),n&&n.p&&(!i||o[0]&56|o[1]&32)&&XV(n,s,c,c[36],i?KV(s,c[36],o,ffe):QV(c[36]),qD)},i(c){i||(Dr(r),Dr(n,c),i=!0)},o(c){ds(r),ds(n,c),i=!1},d(c){c&&vo(t),r&&r.d(c),n&&n.d(c)}}}function WD(e){let t,i,r,s,n,c,o,p;return t=new H9({props:{position:e[6]}}),r=new q9({props:{position:e[6],fitBoundsOptions:{maxZoom:12}}}),n=new G9({props:{position:e[6]}}),o=new W9({props:{position:e[6]}}),{c(){Kn(t.$$.fragment),i=$n(),Kn(r.$$.fragment),s=$n(),Kn(n.$$.fragment),c=$n(),Kn(o.$$.fragment)},m(g,S){Rn(t,g,S),Xo(g,i,S),Rn(r,g,S),Xo(g,s,S),Rn(n,g,S),Xo(g,c,S),Rn(o,g,S),p=!0},p(g,S){const M={};S[0]&64&&(M.position=g[6]),t.$set(M);const A={};S[0]&64&&(A.position=g[6]),r.$set(A);const O={};S[0]&64&&(O.position=g[6]),n.$set(O);const z={};S[0]&64&&(z.position=g[6]),o.$set(z)},i(g){p||(Dr(t.$$.fragment,g),Dr(r.$$.fragment,g),Dr(n.$$.fragment,g),Dr(o.$$.fragment,g),p=!0)},o(g){ds(t.$$.fragment,g),ds(r.$$.fragment,g),ds(n.$$.fragment,g),ds(o.$$.fragment,g),p=!1},d(g){g&&(vo(i),vo(s),vo(c)),On(t,g),On(r,g),On(n,g),On(o,g)}}}function mfe(e){let t,i,r,s,n,c=e[3]&&e[0]&&HD(e);return{c(){t=Pn("div"),c&&c.c(),os(t,"class",i=GC(e[1])+" svelte-p00lfq"),os(t,"data-testid","map-container"),HC(t,"expand-map",!e[1])},m(o,p){Xo(o,t,p),c&&c.m(t,null),r=!0,s||(n=[bT(pfe,"hashchange",e[10]),e7(e[9].call(null,t))],s=!0)},p(o,p){o[3]&&o[0]?c?(c.p(o,p),p[0]&9&&Dr(c,1)):(c=HD(o),c.c(),Dr(c,1),c.m(t,null)):c&&(f5(),ds(c,1,1,()=>{c=null}),m5()),(!r||p[0]&2&&i!==(i=GC(o[1])+" svelte-p00lfq"))&&os(t,"class",i),(!r||p[0]&2)&&HC(t,"expand-map",!o[1])},i(o){r||(Dr(c),r=!0)},o(o){ds(c),r=!1},d(o){o&&vo(t),c&&c.d(),s=!1,Tp(n)}}}function yfe(e,t,i){let r,s,n,c,{$$slots:o={},$$scope:p}=t,{map:g=null}=t,{class:S=void 0}=t,{style:M}=t,{diffStyleUpdates:A=!1}=t,{center:O=void 0}=t,{zoom:z=void 0}=t,{pitch:V=0}=t,{bearing:W=0}=t,{bounds:ie=void 0}=t,{hash:ve=!1}=t,{loaded:pe=!1}=t,{minZoom:_e=0}=t,{maxZoom:Me=22}=t,{zoomOnDoubleClick:$e=!0}=t,{locale:Fe=void 0}=t,{interactive:Ge=!0}=t,{attributionControl:et=!0}=t,{cooperativeGestures:at=!1}=t,{preserveDrawingBuffer:ct=!1}=t,{maxBounds:nt=void 0}=t,{images:Pt=[]}=t,{standardControls:ft=!1}=t,{filterLayers:vi=void 0}=t,{transformRequest:Li=void 0}=t;const Tt=n7(),{map:Ft,loadedImages:Hi}=Kpe();Fc(e,Ft,Ke=>i(3,n=Ke)),Fc(e,Hi,Ke=>i(4,c=Ke));let Fr=new Set;async function Cr(Ke,oi=!1){if(n&&!(!n.loaded()&&!oi))if("url"in Ke){Fr.add(Ke.id);try{let Di=await n.loadImage(Ke.url);n==null||n.addImage(Ke.id,Di.data,Ke.options),c.add(Ke.id),Hi.set(c)}catch(Di){Tt("error",Di)}finally{Fr.delete(Ke.id)}}else n.addImage(Ke.id,Ke.data,Ke.options),c.add(Ke.id),Hi.set(c)}let _r,Cs,fs,Zs;function yn(Ke){return ms(),lS(Ft,n=new $p.Map(rfe({container:Ke,style:M,locale:Fe,center:O,zoom:z,pitch:V,bearing:W,minZoom:_e,maxZoom:Me,interactive:Ge,preserveDrawingBuffer:ct,maxBounds:nt,bounds:ie,attributionControl:et,transformRequest:Li,cooperativeGestures:at})),n),n.on("load",oi=>{oi.target.getContainer().setAttribute("data-testid","map"),oi.target.getCanvas().setAttribute("data-testid","map-canvas"),i(0,pe=!0),Tt("load",n)}),n.on("error",oi=>Tt("error",{...oi,map:n})),n.on("movestart",oi=>Tt("movestart",{...oi,map:n})),n.on("moveend",oi=>{if(i(11,O=oi.target.getCenter()),i(12,z=oi.target.getZoom()),i(13,ie=oi.target.getBounds()),Tt("moveend",{...oi,map:n}),ve){let Di=window.location.href.replace(/(#.+)?$/,afe(n));window.history.replaceState(window.history.state,"",Di)}}),n.on("zoomstart",oi=>Tt("zoomstart",{...oi,map:n})),n.on("zoom",oi=>{i(12,z=oi.target.getZoom()),Tt("zoom",{...oi,map:n})}),n.on("zoomend",oi=>{i(12,z=oi.target.getZoom()),Tt("zoomend",{...oi,map:n})}),n.on("style.load",()=>{if(n){const oi=n.getStyle();if(i(33,_r=oi.layers.map(Di=>Di.id)),i(34,Cs=Object.keys(oi.sources)),Zs)for(const[Di,$s]of Object.entries(Zs))n.addSource(Di,$s);if(fs)for(const Di of fs)n.addLayer(Di);for(const Di of Pt)Cr(Di,!0)}}),n.on("styledata",oi=>{if(n&&vi){const Di=n.getStyle().layers;if(Di)for(let $s of Di)vi($s)||n.setLayoutProperty($s.id,"visibility","none")}Tt("styledata",{...oi,map:n})}),{destroy(){i(0,pe=!1),n==null||n.remove(),lS(Ft,n=null,n)}}}let Kr=M;function ms(){if(ve){let Ke=lfe(window.location.hash);Ke.length>=3&&(i(12,z=Ke[0]),i(11,O=[Ke[2],Ke[1]])),Ke.length==5&&(i(16,W=Ke[3]),i(15,V=Ke[4]))}}return e.$$set=Ke=>{"map"in Ke&&i(14,g=Ke.map),"class"in Ke&&i(1,S=Ke.class),"style"in Ke&&i(17,M=Ke.style),"diffStyleUpdates"in Ke&&i(18,A=Ke.diffStyleUpdates),"center"in Ke&&i(11,O=Ke.center),"zoom"in Ke&&i(12,z=Ke.zoom),"pitch"in Ke&&i(15,V=Ke.pitch),"bearing"in Ke&&i(16,W=Ke.bearing),"bounds"in Ke&&i(13,ie=Ke.bounds),"hash"in Ke&&i(19,ve=Ke.hash),"loaded"in Ke&&i(0,pe=Ke.loaded),"minZoom"in Ke&&i(20,_e=Ke.minZoom),"maxZoom"in Ke&&i(21,Me=Ke.maxZoom),"zoomOnDoubleClick"in Ke&&i(22,$e=Ke.zoomOnDoubleClick),"locale"in Ke&&i(23,Fe=Ke.locale),"interactive"in Ke&&i(24,Ge=Ke.interactive),"attributionControl"in Ke&&i(25,et=Ke.attributionControl),"cooperativeGestures"in Ke&&i(26,at=Ke.cooperativeGestures),"preserveDrawingBuffer"in Ke&&i(27,ct=Ke.preserveDrawingBuffer),"maxBounds"in Ke&&i(28,nt=Ke.maxBounds),"images"in Ke&&i(29,Pt=Ke.images),"standardControls"in Ke&&i(2,ft=Ke.standardControls),"filterLayers"in Ke&&i(30,vi=Ke.filterLayers),"transformRequest"in Ke&&i(31,Li=Ke.transformRequest),"$$scope"in Ke&&i(36,p=Ke.$$scope)},e.$$.update=()=>{if(e.$$.dirty[0]&4&&i(6,r=typeof ft=="boolean"?void 0:ft),e.$$.dirty[0]&8&&i(14,g=n),e.$$.dirty[0]&393224|e.$$.dirty[1]&28&&n&&!Ov(M,Kr)){const Ke=n.getStyle();if(_r&&(fs=Ke.layers.filter(oi=>!_r.includes(oi.id))),Cs){const oi=Object.keys(Ke.sources).filter(Di=>!Cs.includes(Di));Zs={};for(const Di of oi)Zs[Di]=Ke.sources[Di]}i(35,Kr=M),n.setStyle(M,{diff:A}),lS(Hi,c=new Set,c),i(32,Fr=new Set)}if(e.$$.dirty[0]&536870937|e.$$.dirty[1]&2&&pe&&n!=null&&n.loaded())for(let Ke of Pt)!c.has(Ke.id)&&!Fr.has(Ke.id)&&!n.hasImage(Ke.id)&&Cr(Ke);e.$$.dirty[0]&536870928&&i(5,s=Pt.every(Ke=>c.has(Ke.id))),e.$$.dirty[0]&2056&&O&&!Ov(O,n==null?void 0:n.getCenter())&&(n==null||n.panTo(O)),e.$$.dirty[0]&4104&&z&&!Ov(z,n==null?void 0:n.getZoom())&&(n==null||n.zoomTo(z)),e.$$.dirty[0]&8200&&ie&&!Ov(ie,n==null?void 0:n.getBounds())&&(n==null||n.fitBounds(ie)),e.$$.dirty[0]&4194312&&($e?n==null||n.doubleClickZoom.enable():n==null||n.doubleClickZoom.disable())},[pe,S,ft,n,c,s,r,Ft,Hi,yn,ms,O,z,ie,g,V,W,M,A,ve,_e,Me,$e,Fe,Ge,et,at,ct,nt,Pt,vi,Li,Fr,_r,Cs,Kr,p,o]}class gfe extends Bl{constructor(t){super(),Fl(this,t,yfe,mfe,Ka,{map:14,class:1,style:17,diffStyleUpdates:18,center:11,zoom:12,pitch:15,bearing:16,bounds:13,hash:19,loaded:0,minZoom:20,maxZoom:21,zoomOnDoubleClick:22,locale:23,interactive:24,attributionControl:25,cooperativeGestures:26,preserveDrawingBuffer:27,maxBounds:28,images:29,standardControls:2,filterLayers:30,transformRequest:31},null,[-1,-1])}}var L_=Uint8Array,Z9=Uint16Array,_fe=Int32Array,vfe=new L_([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bfe=new L_([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Y9=function(e,t){for(var i=new Z9(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];for(var s=new _fe(i[30]),r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return{b:i,r:s}},J9=Y9(vfe,2),wfe=J9.b,xfe=J9.r;wfe[28]=258,xfe[258]=28;Y9(bfe,0);var Sfe=new Z9(32768);for(Oi=0;Oi<32768;++Oi)yc=(Oi&43690)>>1|(Oi&21845)<<1,yc=(yc&52428)>>2|(yc&13107)<<2,yc=(yc&61680)>>4|(yc&3855)<<4,Sfe[Oi]=((yc&65280)>>8|(yc&255)<<8)>>1;var yc,Oi,r2=new L_(288);for(Oi=0;Oi<144;++Oi)r2[Oi]=8;var Oi;for(Oi=144;Oi<256;++Oi)r2[Oi]=9;var Oi;for(Oi=256;Oi<280;++Oi)r2[Oi]=7;var Oi;for(Oi=280;Oi<288;++Oi)r2[Oi]=8;var Oi,Tfe=new L_(32);for(Oi=0;Oi<32;++Oi)Tfe[Oi]=5;var Oi,Efe=new L_(0),Ife=typeof TextDecoder<"u"&&new TextDecoder,Mfe=0;try{Ife.decode(Efe,{stream:!0}),Mfe=1}catch{}function Afe(e){let t,i,r,s,n,c,o,p,g,S;return t=new H9({props:{position:"top-left"}}),r=new q9({props:{position:"top-left",fitBoundsOptions:{maxZoom:12}}}),n=new G9({props:{position:"top-left"}}),o=new W9({}),g=new ife({props:{customAttribution:'A <strong class="text-red-500">custom</strong> attribution'}}),{c(){Kn(t.$$.fragment),i=$n(),Kn(r.$$.fragment),s=$n(),Kn(n.$$.fragment),c=$n(),Kn(o.$$.fragment),p=$n(),Kn(g.$$.fragment)},m(M,A){Rn(t,M,A),Xo(M,i,A),Rn(r,M,A),Xo(M,s,A),Rn(n,M,A),Xo(M,c,A),Rn(o,M,A),Xo(M,p,A),Rn(g,M,A),S=!0},p:Dn,i(M){S||(Dr(t.$$.fragment,M),Dr(r.$$.fragment,M),Dr(n.$$.fragment,M),Dr(o.$$.fragment,M),Dr(g.$$.fragment,M),S=!0)},o(M){ds(t.$$.fragment,M),ds(r.$$.fragment,M),ds(n.$$.fragment,M),ds(o.$$.fragment,M),ds(g.$$.fragment,M),S=!1},d(M){M&&(vo(i),vo(s),vo(c),vo(p)),On(t,M),On(r,M),On(n,M),On(o,M),On(g,M)}}}function Pfe(e){let t,i,r;function s(c){e[3](c)}let n={class:Cfe,style:e[2],center:e[1].center,zoom:e[1].zoom,attributionControl:!1,$$slots:{default:[Afe]},$$scope:{ctx:e}};return e[0]!==void 0&&(n.map=e[0]),t=new gfe({props:n}),wm.push(()=>ET(t,"map",s)),{c(){Kn(t.$$.fragment)},m(c,o){Rn(t,c,o),r=!0},p(c,[o]){const p={};o&16&&(p.$$scope={dirty:o,ctx:c}),!i&&o&1&&(i=!0,p.map=c[0],TT(()=>i=!1)),t.$set(p)},i(c){r||(Dr(t.$$.fragment,c),r=!0)},o(c){ds(t.$$.fragment,c),r=!1},d(c){On(t,c)}}}let Cfe="h-full w-full";function $fe(e,t,i){let r,s=zb(lm),n=zb(f7);qM(()=>{$p.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",!0),r.on("moveend",()=>{lm.set({center:[r.getCenter().lng,r.getCenter().lat],zoom:r.getZoom()})});const o=lm.subscribe(p=>{r.loaded()&&(r.getCenter().lng!==p.center[0]||r.getCenter().lat!==p.center[1]||r.getZoom()!==p.zoom)&&r.jumpTo({center:p.center,zoom:p.zoom})});return()=>{o()}});function c(o){r=o,i(0,r)}return[r,s,n,c]}class kfe extends Bl{constructor(t){super(),Fl(this,t,$fe,Pfe,Ka,{})}}function Rfe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ZD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,r)}return i}function YD(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ZD(Object(i),!0).forEach(function(r){Rfe(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ZD(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Ofe(e,t){if(e==null)return{};var i={},r=Object.keys(e),s,n;for(n=0;n<r.length;n++)s=r[n],!(t.indexOf(s)>=0)&&(i[s]=e[s]);return i}function Lfe(e,t){if(e==null)return{};var i=Ofe(e,t),r,s;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Dfe(e,t){return Nfe(e)||zfe(e,t)||Ffe(e,t)||Bfe()}function Nfe(e){if(Array.isArray(e))return e}function zfe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var i=[],r=!0,s=!1,n=void 0;try{for(var c=e[Symbol.iterator](),o;!(r=(o=c.next()).done)&&(i.push(o.value),!(t&&i.length===t));r=!0);}catch(p){s=!0,n=p}finally{try{!r&&c.return!=null&&c.return()}finally{if(s)throw n}}return i}}function Ffe(e,t){if(e){if(typeof e=="string")return JD(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return JD(e,t)}}function JD(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function Bfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ufe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function KD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,r)}return i}function XD(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?KD(Object(i),!0).forEach(function(r){Ufe(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):KD(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function jfe(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduceRight(function(s,n){return n(s)},r)}}function a0(e){return function t(){for(var i=this,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return s.length>=e.length?e.apply(this,s):function(){for(var c=arguments.length,o=new Array(c),p=0;p<c;p++)o[p]=arguments[p];return t.apply(i,[].concat(s,o))}}}function Xw(e){return{}.toString.call(e).includes("Object")}function Vfe(e){return!Object.keys(e).length}function o_(e){return typeof e=="function"}function Gfe(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function qfe(e,t){return Xw(t)||uh("changeType"),Object.keys(t).some(function(i){return!Gfe(e,i)})&&uh("changeField"),t}function Hfe(e){o_(e)||uh("selectorType")}function Wfe(e){o_(e)||Xw(e)||uh("handlerType"),Xw(e)&&Object.values(e).some(function(t){return!o_(t)})&&uh("handlersType")}function Zfe(e){e||uh("initialIsRequired"),Xw(e)||uh("initialType"),Vfe(e)&&uh("initialContent")}function Yfe(e,t){throw new Error(e[t]||e.default)}var Jfe={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},uh=a0(Yfe)(Jfe),Lv={changes:qfe,selector:Hfe,handler:Wfe,initial:Zfe};function Kfe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Lv.initial(e),Lv.handler(t);var i={current:e},r=a0(eme)(i,t),s=a0(Qfe)(i),n=a0(Lv.changes)(e),c=a0(Xfe)(i);function o(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(S){return S};return Lv.selector(g),g(i.current)}function p(g){jfe(r,s,n,c)(g)}return[o,p]}function Xfe(e,t){return o_(t)?t(e.current):t}function Qfe(e,t){return e.current=XD(XD({},e.current),t),t}function eme(e,t,i){return o_(t)?t(e.current):Object.keys(i).forEach(function(r){var s;return(s=t[r])===null||s===void 0?void 0:s.call(t,e.current[r])}),i}var tme={create:Kfe},ime={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function rme(e){return function t(){for(var i=this,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return s.length>=e.length?e.apply(this,s):function(){for(var c=arguments.length,o=new Array(c),p=0;p<c;p++)o[p]=arguments[p];return t.apply(i,[].concat(s,o))}}}function sme(e){return{}.toString.call(e).includes("Object")}function nme(e){return e||QD("configIsRequired"),sme(e)||QD("configType"),e.urls?(ome(),{paths:{vs:e.urls.monacoBase}}):e}function ome(){console.warn(K9.deprecation)}function ame(e,t){throw new Error(e[t]||e.default)}var K9={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},QD=rme(ame)(K9),lme={config:nme},cme=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return function(s){return i.reduceRight(function(n,c){return c(n)},s)}};function X9(e,t){return Object.keys(t).forEach(function(i){t[i]instanceof Object&&e[i]&&Object.assign(t[i],X9(e[i],t[i]))}),YD(YD({},e),t)}var ume={type:"cancelation",msg:"operation is manually canceled"};function _T(e){var t=!1,i=new Promise(function(r,s){e.then(function(n){return t?s(ume):r(n)}),e.catch(s)});return i.cancel=function(){return t=!0},i}var hme=tme.create({config:ime,isInitialized:!1,resolve:null,reject:null,monaco:null}),Q9=Dfe(hme,2),D_=Q9[0],s2=Q9[1];function dme(e){var t=lme.config(e),i=t.monaco,r=Lfe(t,["monaco"]);s2(function(s){return{config:X9(s.config,r),monaco:i}})}function pme(){var e=D_(function(t){var i=t.monaco,r=t.isInitialized,s=t.resolve;return{monaco:i,isInitialized:r,resolve:s}});if(!e.isInitialized){if(s2({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),_T(vT);if(window.monaco&&window.monaco.editor)return ej(window.monaco),e.resolve(window.monaco),_T(vT);cme(fme,yme)(gme)}return _T(vT)}function fme(e){return document.body.appendChild(e)}function mme(e){var t=document.createElement("script");return e&&(t.src=e),t}function yme(e){var t=D_(function(r){var s=r.config,n=r.reject;return{config:s,reject:n}}),i=mme("".concat(t.config.paths.vs,"/loader.js"));return i.onload=function(){return e()},i.onerror=t.reject,i}function gme(){var e=D_(function(i){var r=i.config,s=i.resolve,n=i.reject;return{config:r,resolve:s,reject:n}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(i){ej(i),e.resolve(i)},function(i){e.reject(i)})}function ej(e){D_().monaco||s2({monaco:e})}function _me(){return D_(function(e){var t=e.monaco;return t})}var vT=new Promise(function(e,t){return s2({resolve:e,reject:t})}),e5={config:dme,init:pme,__getMonacoInstance:_me};function vme(e){let t;return{c(){t=Pn("div"),os(t,"class","editor-container svelte-1rm2rxl")},m(i,r){Xo(i,t,r),e[4](t)},p:Dn,i:Dn,o:Dn,d(i){i&&vo(t),e[4](null)}}}function bme(e,t,i){let{content:r=""}=t,{language:s="javascript"}=t,n,c,o;qM(async()=>{e5.config({paths:{vs:"https://unpkg.com/monaco-editor/min/vs"}}),c=await e5.init(),i(3,n=c.editor.create(o,{value:r,language:s,theme:"vs-light"}))}),Fm(()=>{var g;(g=n.getModel())==null||g.dispose(),n.dispose()});function p(g){wm[g?"unshift":"push"](()=>{o=g,i(0,o)})}return e.$$set=g=>{"content"in g&&i(1,r=g.content),"language"in g&&i(2,s=g.language)},e.$$.update=()=>{e.$$.dirty&10&&n&&n.setValue(r)},[o,r,s,n,p]}class t5 extends Bl{constructor(t){super(),Fl(this,t,bme,vme,Ka,{content:1,language:2})}}async function tj(e){const t=`${e}/resources/styles/root.json`,i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch Esri style JSON: ${i.statusText}`);return i.json()}async function wme(e,t){const i=e.endsWith("/")?e.slice(0,-1):e;t||(t=await tj(i));const r=JSON.parse(JSON.stringify(t));if(r.sources)for(const s in r.sources){const n=r.sources[s];if(n.type==="vector"&&n.url){const c={...n};c.tiles=[`${i}/tile/{z}/{y}/{x}.pbf`],delete c.url,r.sources[s]=c}}return r.sprite&&(r.sprite=`${i}/resources/${r.sprite.replace("../","")}`),r.glyphs&&(r.glyphs=`${i}/resources/${r.glyphs.replace("../","")}`),r}function xme(e){let t,i,r,s,n,c,o,p,g,S,M,A,O,z,V,W,ie,ve,pe,_e,Me,$e,Fe,Ge,et,at,ct,nt;function Pt(Tt){e[6](Tt)}let ft={language:"json"};e[1]!==void 0&&(ft.content=e[1]),s=new t5({props:ft}),wm.push(()=>ET(s,"content",Pt)),O=new Ype({});function vi(Tt){e[8](Tt)}let Li={language:"json"};return e[2]!==void 0&&(Li.content=e[2]),pe=new t5({props:Li}),wm.push(()=>ET(pe,"content",vi)),et=new kfe({}),{c(){t=Pn("div"),i=Pn("div"),r=Pn("div"),Kn(s.$$.fragment),c=$n(),o=Pn("div"),p=Pn("input"),g=$n(),S=Pn("button"),S.textContent="Fetch",M=$n(),A=Pn("div"),Kn(O.$$.fragment),z=$n(),V=Pn("div"),V.innerHTML='<button class="btn btn-outline-white btn-md my-2">⇦</button> <button class="btn btn-outline-white btn-md my-2">⇨</button> <button class="btn btn-circle btn-sm my-2">⟳</button> <button class="btn btn-circle btn-sm my-2">≡</button>',W=$n(),ie=Pn("div"),ve=Pn("div"),Kn(pe.$$.fragment),Me=$n(),$e=Pn("div"),$e.innerHTML='<input type="text" placeholder="Enter URL" class="input input-bordered w-full mr-2"/> <button class="btn btn-outline">Fetch</button>',Fe=$n(),Ge=Pn("div"),Kn(et.$$.fragment),os(r,"class","flex-1 p-4 overflow-auto bg-gray-50"),os(p,"type","text"),os(p,"placeholder","Enter URL"),os(p,"class","input input-bordered w-full mr-2"),os(S,"class","btn btn-outline"),os(o,"class","flex items-center p-4 bg-gray-200"),os(A,"class","flex-1"),os(i,"class","flex-1 flex flex-col"),os(V,"class","flex flex-col justify-center items-center p-2 bg-gray-500 shadow z-10 md:w-16 md:flex"),os(ve,"class","flex-1 p-4 overflow-auto bg-gray-50"),os($e,"class","flex items-center p-4 bg-gray-200"),os(Ge,"class","flex-1"),os(ie,"class","flex-1 flex flex-col"),os(t,"class","flex flex-col md:flex-row h-screen")},m(Tt,Ft){Xo(Tt,t,Ft),xs(t,i),xs(i,r),Rn(s,r,null),xs(i,c),xs(i,o),xs(o,p),qC(p,e[0]),xs(o,g),xs(o,S),xs(i,M),xs(i,A),Rn(O,A,null),xs(t,z),xs(t,V),xs(t,W),xs(t,ie),xs(ie,ve),Rn(pe,ve,null),xs(ie,Me),xs(ie,$e),xs(ie,Fe),xs(ie,Ge),Rn(et,Ge,null),at=!0,ct||(nt=[bT(p,"input",e[7]),bT(S,"click",e[5])],ct=!0)},p(Tt,[Ft]){const Hi={};!n&&Ft&2&&(n=!0,Hi.content=Tt[1],TT(()=>n=!1)),s.$set(Hi),Ft&1&&p.value!==Tt[0]&&qC(p,Tt[0]);const Fr={};!_e&&Ft&4&&(_e=!0,Fr.content=Tt[2],TT(()=>_e=!1)),pe.$set(Fr)},i(Tt){at||(Dr(s.$$.fragment,Tt),Dr(O.$$.fragment,Tt),Dr(pe.$$.fragment,Tt),Dr(et.$$.fragment,Tt),at=!0)},o(Tt){ds(s.$$.fragment,Tt),ds(O.$$.fragment,Tt),ds(pe.$$.fragment,Tt),ds(et.$$.fragment,Tt),at=!1},d(Tt){Tt&&vo(t),On(s),On(O),On(pe),On(et),ct=!1,Tp(nt)}}}function Sme(e,t,i){let r,s,n="",c=Jo("");Fc(e,c,A=>i(2,s=A));let o=Jo("");Fc(e,o,A=>i(1,r=A));async function p(){if(n)try{const A=await wme(n);c.set(JSON.stringify(A,null,2)),IT.set(n);const O=await tj(n);o.set(JSON.stringify(O,null,2))}catch(A){console.error("Failed to convert style:",A),c.set(`Error: ${A.message}`)}}function g(A){r=A,o.set(r)}function S(){n=this.value,i(0,n)}function M(A){s=A,c.set(s)}return[n,r,s,c,o,p,g,S,M]}class Tme extends Bl{constructor(t){super(),Fl(this,t,Sme,xme,Ka,{})}}new Tme({target:document.getElementById("app")});export{Hpe as $,oL as A,iye as B,G0 as C,mD as D,Le as E,x6 as F,Hs as G,cge as H,Ol as I,B0 as J,Nq as K,fD as L,Xi as M,Je as N,J0e as O,mn as P,cre as Q,e_e as R,t_e as S,Z0e as T,vD as U,Ut as V,Z0 as W,s3 as X,fn as Y,rA as Z,ht as _,zl as a,Ex as a$,Ya as a0,Q0e as a1,qT as a2,O0e as a3,zQ as a4,g_ as a5,So as a6,zt as a7,jB as a8,Bt as a9,ri as aA,mh as aB,Ua as aC,Tx as aD,Bi as aE,k5 as aF,ix as aG,t0e as aH,n3 as aI,K0e as aJ,X0e as aK,Yge as aL,Jge as aM,Qge as aN,Xge as aO,Kge as aP,Ac as aQ,ci as aR,mi as aS,zn as aT,At as aU,He as aV,noe as aW,PR as aX,Ms as aY,fi as aZ,$se as a_,T6 as aa,jA as ab,E6 as ac,S6 as ad,xR as ae,P_e as af,eK as ag,N5 as ah,Xn as ai,to as aj,fp as ak,vv as al,Rge as am,cB as an,qJ as ao,ep as ap,Ip as aq,ble as ar,wA as as,dr as at,jc as au,Hx as av,m0 as aw,Wa as ax,Na as ay,_i as az,qs as b,Mye as b$,Pm as b0,Ep as b1,x_ as b2,D0e as b3,Ul as b4,Ase as b5,g3 as b6,f1e as b7,VF as b8,q0e as b9,eE as bA,cw as bB,Jz as bC,Al as bD,Pi as bE,S3 as bF,SR as bG,Lge as bH,w_e as bI,C_e as bJ,ibe as bK,D0 as bL,MT as bM,wle as bN,y5 as bO,The as bP,Fhe as bQ,$he as bR,fR as bS,M6 as bT,Qse as bU,Eye as bV,Mr as bW,nge as bX,Xhe as bY,jU as bZ,hp as b_,o_e as ba,wre as bb,kw as bc,$w as bd,F0e as be,H0e as bf,fh as bg,gge as bh,Ade as bi,oP as bj,P$ as bk,Aee as bl,mge as bm,BU as bn,Ap as bo,qye as bp,TS as bq,G0e as br,pi as bs,Mh as bt,vh as bu,Ah as bv,Dl as bw,XT as bx,hr as by,KT as bz,A0 as c,Tm as c$,eU as c0,vve as c1,bve as c2,xve as c3,xce as c4,mce as c5,QH as c6,hR as c7,RF as c8,qt as c9,wx as cA,uw as cB,Pse as cC,Y0e as cD,px as cE,VA as cF,U0 as cG,hre as cH,s_e as cI,ure as cJ,r_e as cK,Ba as cL,dge as cM,DN as cN,Ar as cO,Ko as cP,yx as cQ,Tw as cR,AZ as cS,UZ as cT,MN as cU,RN as cV,CN as cW,jZ as cX,qb as cY,Vme as cZ,iH as c_,xh as ca,A_e as cb,$ge as cc,bo as cd,zme as ce,lge as cf,I7 as cg,P7 as ch,xm as ci,aa as cj,pde as ck,mde as cl,yde as cm,xde as cn,Mde as co,t9 as cp,i9 as cq,Ide as cr,Rde as cs,Ode as ct,ON as cu,QZ as cv,bY as cw,fE as cx,Th as cy,y_ as cz,v as d,Xue as d$,yA as d0,N7 as d1,u3 as d2,dK as d3,d1e as d4,m_ as d5,aH as d6,F_e as d7,M0 as d8,OI as d9,d4 as dA,rx as dB,$A as dC,_x as dD,V0 as dE,sh as dF,Nn as dG,KW as dH,hx as dI,XW as dJ,xye as dK,rge as dL,Que as dM,Vue as dN,Ehe as dO,tN as dP,Y4 as dQ,Zge as dR,Er as dS,Vx as dT,Mge as dU,Lee as dV,kge as dW,Ege as dX,J$ as dY,xp as dZ,$c as d_,Y3 as da,tye as db,tA as dc,U4 as dd,Qw as de,sa as df,fZ as dg,dZ as dh,mve as di,yoe as dj,i_e as dk,TA as dl,p_ as dm,GA as dn,Rhe as dp,zhe as dq,DU as dr,sbe as ds,Xve as dt,Kve as du,Eo as dv,Hm as dw,R3 as dx,D3 as dy,I8 as dz,Qi as e,uZ as e$,up as e0,As as e1,sY as e2,w_ as e3,iW as e4,WZ as e5,ZZ as e6,mY as e7,Qve as e8,d_ as e9,hO as eA,ED as eB,L0 as eC,fH as eD,hA as eE,l_ as eF,eA as eG,AB as eH,yM as eI,Om as eJ,PB as eK,cae as eL,W3 as eM,a$ as eN,Tb as eO,k0e as eP,Kde as eQ,ta as eR,Oc as eS,yve as eT,OG as eU,Ja as eV,l$ as eW,nA as eX,j_e as eY,Aie as eZ,zye as e_,Sve as ea,_ve as eb,n0e as ec,Mme as ed,Yue as ee,T_e as ef,$_e as eg,ZC as eh,cbe as ei,Dhe as ej,lbe as ek,Nhe as el,age as em,Lhe as en,mbe as eo,w1e as ep,ooe as eq,lx as er,ove as es,Sh as et,wh as eu,Qf as ev,Dc as ew,bye as ex,Cye as ey,wp as ez,me as f,Coe as f$,yr as f0,V_e as f1,q_e as f2,oge as f3,_he as f4,vhe as f5,Gx as f6,O3 as f7,$3 as f8,k3 as f9,L0e as fA,Jve as fB,$M as fC,Yve as fD,Zve as fE,_K as fF,gK as fG,DJ as fH,U$ as fI,Fa as fJ,Ix as fK,Fme as fL,Nge as fM,hm as fN,lH as fO,na as fP,obe as fQ,nbe as fR,p1e as fS,tbe as fT,zr as fU,Gme as fV,h_ as fW,wD as fX,Ln as fY,x1e as fZ,lae as f_,L3 as fa,C3 as fb,U_e as fc,E_ as fd,mye as fe,Tge as ff,IN as fg,nY as fh,sae as fi,Es as fj,oae as fk,MB as fl,js as fm,Xf as fn,LE as fo,E7 as fp,oY as fq,coe as fr,rF as fs,Qv as ft,Hye as fu,Aye as fv,hh as fw,Q5 as fx,fG as fy,vp as fz,ti as g,V8 as g$,dN as g0,LW as g1,nD as g2,oD as g3,aD as g4,di as g5,zD as g6,nwe as g7,owe as g8,hwe as g9,u0 as gA,$Z as gB,qZ as gC,vY as gD,wY as gE,fae as gF,Cde as gG,XH as gH,Vz as gI,nW as gJ,Dw as gK,zA as gL,JZ as gM,HZ as gN,AN as gO,LZ as gP,dY as gQ,hge as gR,Km as gS,$N as gT,WY as gU,_w as gV,pge as gW,kN as gX,eY as gY,$i as gZ,m3 as g_,awe as ga,lwe as gb,cwe as gc,uwe as gd,A7 as ge,TD as gf,z_e as gg,Nye as gh,kZ as gi,ia as gj,Fn as gk,M0e as gl,tW as gm,IA as gn,MA as go,fx as gp,mx as gq,Ih as gr,RE as gs,Mee as gt,o0e as gu,be as gv,qY as gw,jz as gx,Sx as gy,LN as gz,Woe as h,gve as h$,m1e as h0,y1e as h1,Vee as h2,abe as h3,sA as h4,Uf as h5,jb as h6,RO as h7,g1e as h8,kq as h9,UN as hA,yJ as hB,iae as hC,Kye as hD,Vye as hE,iN as hF,rN as hG,Eae as hH,BY as hI,Bo as hJ,gJ as hK,jN as hL,YM as hM,JM as hN,SE as hO,vK as hP,za as hQ,Yz as hR,z7 as hS,T3 as hT,x_e as hU,b_e as hV,N0e as hW,yw as hX,q as hY,Gye as hZ,Gue as h_,Pge as ha,tK as hb,uD as hc,hD as hd,lD as he,dD as hf,qpe as hg,kM as hh,RM as hi,Kt as hj,_A as hk,q4 as hl,N3 as hm,khe as hn,FN as ho,w7 as hp,qme as hq,rye as hr,sye as hs,yae as ht,fge as hu,tJ as hv,RZ as hw,OZ as hx,PZ as hy,iJ as hz,Ore as i,IM as i$,op as i0,Wye as i1,Zye as i2,hS as i3,Qx as i4,Xx as i5,eP as i6,Qn as i7,tce as i8,E5 as i9,T5 as iA,$me as iB,kbe as iC,SD as iD,xD as iE,d0 as iF,jv as iG,Dge as iH,lN as iI,kW as iJ,FW as iK,gx as iL,Xye as iM,Ire as iN,zU as iO,CJ as iP,$J as iQ,pwe as iR,pD as iS,Kbe as iT,R5 as iU,$B as iV,Wve as iW,i4 as iX,cye as iY,lye as iZ,PG as i_,eo as ia,ra as ib,wye as ic,Dq as id,ux as ie,Pye as ig,wve as ih,X0 as ii,Zbe as ij,WJ as ik,HJ as il,bge as im,Cge as io,Bw as ip,Gpe as iq,MD as ir,bD as is,yD as it,B_e as iu,Gs as iv,kme as iw,fY as ix,cD as iy,S5 as iz,HI as j,bbe as j$,AG as j0,Ome as j1,T7 as j2,Age as j3,gh as j4,nae as j5,Bne as j6,Lne as j7,M_ as j8,uge as j9,Ux as jA,bh as jB,ZG as jC,jme as jD,zx as jE,Rl as jF,Tbe as jG,sP as jH,Ww as jI,xbe as jJ,Ebe as jK,HU as jL,Sbe as jM,hde as jN,rD as jO,kn as jP,DM as jQ,OM as jR,Dwe as jS,Nwe as jT,NM as jU,LM as jV,Yo as jW,Mbe as jX,An as jY,Abe as jZ,_be as j_,NA as ja,qA as jb,Mp as jc,Sye as jd,X5 as je,$0e as jf,b6 as jg,wge as jh,MF as ji,Nr as jj,J5 as jk,gr as jl,XM as jm,c$ as jn,Hue as jo,jve as jp,nx as jq,Xre as jr,Tye as js,Dse as jt,uae as ju,ID as jv,$be as jw,kD as jx,$D as jy,R0e as jz,gG as k,Uc as k$,Lr as k0,sD as k1,om as k2,ebe as k3,qH as k4,KF as k5,rbe as k6,Dme as k7,Nme as k8,Lme as k9,Pbe as kA,M7 as kB,Aae as kC,jd as kD,Ud as kE,Rwe as kF,J0 as kG,s6 as kH,Qre as kI,S_e as kJ,fA as kK,rJ as kL,eJ as kM,XZ as kN,QY as kO,D5 as kP,dx as kQ,Va as kR,FZ as kS,xY as kT,PN as kU,LD as kV,Obe as kW,DD as kX,n_ as kY,Mse as kZ,JF as k_,Qq as ka,ZY as kb,FY as kc,UY as kd,mG as ke,x5 as kf,Yoe as kg,ene as kh,jW as ki,jye as kj,Wo as kk,twe as kl,ywe as km,ch as kn,$l as ko,Yx as kp,_ge as kq,yB as kr,X8 as ks,gB as kt,woe as ku,S1e as kv,koe as kw,t_ as kx,T1e as ky,r_ as kz,_D as l,e0e as l$,G_e as l0,R7 as l1,H_e as l2,Lie as l3,Ll as l4,kwe as l5,vb as l6,Xbe as l7,XO as l8,eL as l9,Twe as lA,dne as lB,B3 as lC,Wx as lD,e_ as lE,Nc as lF,Vc as lG,wwe as lH,iwe as lI,rwe as lJ,xwe as lK,Iwe as lL,Ewe as lM,dwe as lN,gwe as lO,WB as lP,Sm as lQ,Mwe as lR,cve as lS,Iye as lT,Yye as lU,Lse as lV,rq as lW,RK as lX,oO as lY,q$ as lZ,sE as l_,wM as la,W0e as lb,B0e as lc,j0e as ld,U0e as le,V0e as lf,n_e as lg,z0e as lh,swe as li,pne as lj,EB as lk,Z8 as ll,Awe as lm,Pwe as ln,Cwe as lo,$we as lp,_we as lq,bwe as lr,vwe as ls,Ime as lt,fwe as lu,mwe as lv,Swe as lw,Wbe as lx,oE as ly,O4 as lz,D1e as m,Rae as m$,kl as m0,p0e as m1,d0e as m2,Gte as m3,C_ as m4,Vte as m5,Pme as m6,xre as m7,ece as m8,bre as m9,VL as mA,Sge as mB,k_e as mC,Y8 as mD,tae as mE,La as mF,ewe as mG,Qbe as mH,$L as mI,LL as mJ,XL as mK,hL as mL,iL as mM,rL as mN,sL as mO,TL as mP,KL as mQ,eD as mR,dL as mS,jx as mT,Ige as mU,Ibe as mV,Jbe as mW,Ybe as mX,Ame as mY,pye as mZ,_Y as m_,Rw as ma,Lw as mb,Bme as mc,Ive as md,f_ as me,Ot as mf,oR as mg,b3 as mh,Pre as mi,Cre as mj,Pue as mk,vge as ml,bL as mm,mL as mn,FJ as mo,yL as mp,kL as mq,gL as mr,Oge as ms,SL as mt,BL as mu,UL as mv,jL as mw,rK as mx,xge as my,jJ as mz,C0e as n,Oae as n0,yH as n1,E_e as n2,I_e as n3,Cme as n4,vJ as n5,_J as n6,ioe as n7,x7 as n8,M_e as n9,a0e as na,c0e as nb,zwe as nc,AD as o,yh as p,O0 as q,z1e as r,_t as s,toe as t,nr as u,gD as v,dp as w,W4 as x,I as y,bp as z};
