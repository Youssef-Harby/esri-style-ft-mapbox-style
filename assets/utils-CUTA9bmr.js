function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/symbolLayerUtils-BB_nAUIt.js","assets/index-C4hnvMrD.js","assets/index-BJXAwoda.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{a9 as a,ee as k,d7 as y,gg as m,gh as g,gi as S,_ as M,gj as C}from"./index-C4hnvMrD.js";import{M as I,f as z,m as L,y as j,b as _}from"./utils-xqc3qKSU.js";function x(o){const t=[];return b(I(o),t),t.length?new a(z(t[0])):null}function b(o,t){var e;if(!o)return;let n;n=o.type==="CIMTextSymbol"?o.symbol:o;const l=o.type==="CIMPolygonSymbol";if(n!=null&&n.symbolLayers){for(const r of n.symbolLayers)if(!(r.colorLocked||l&&(L(r)||j(r)&&r.markerPlacement&&_(r.markerPlacement))))switch(r.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":r.tintColor&&p(t,r.tintColor);break;case"CIMVectorMarker":(e=r.markerGraphics)==null||e.forEach(c=>{b(c.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":p(t,r.color);break;case"CIMHatchFill":b(r.lineSymbol,t)}}}function p(o,t){for(const n of o)if(n.join(".")===t.join("."))return;o.push(t)}new k(1e3);new a([128,128,128]);const P=new a("white");function U(o,t){if(!o)return null;let n=null;return y(o)?n=$(o):m(o)&&(n=o.type==="cim"?x(o):o.color?new a(o.color):null),n?h(n,t):null}function $(o){const t=o.symbolLayers;if(!t)return null;let n=null;return t.forEach(l=>{var e;l.type==="object"&&((e=l.resource)!=null&&e.href)||(n=l.type==="water"?l.color:l.material?l.material.color:null)}),n?new a(n):null}function h(o,t){if(t==null||o==null)return o;const n=o.toRgba();return n[3]=n[3]*t,new a(n)}function v(o,t,n){const l=o.symbolLayers;if(!l)return;const e=r=>h(t=t??r??(n!=null?P:null),n);l.forEach(r=>{var c,s;if(r.type!=="object"||!((c=r.resource)!=null&&c.href)||t)if(r.type==="water")r.color=e(r.color);else{const i=r.material!=null?r.material.color:null,u=e(i);r.material==null?r.material=new C({color:u}):r.material.color=u,n!=null&&"outline"in r&&((s=r.outline)==null?void 0:s.color)!=null&&(r.outline.color=h(r.outline.color,n))}})}function E(o,t,n){var l;(t=t??o.color)&&(o.color=h(t,n)),n!=null&&"outline"in o&&((l=o.outline)!=null&&l.color)&&(o.outline.color=h(o.outline.color,n))}function q(o,t,n){o&&(t||n!=null)&&(t&&(t=new a(t)),y(o)?v(o,t,n):m(o)&&E(o,t,n))}async function R(o,t){const n=o.symbolLayers;n&&await g(n,async l=>F(l,t))}async function F(o,t){switch(o.type){case"extrude":D(o,t);break;case"icon":case"line":case"text":O(o,t);break;case"path":V(o,t);break;case"object":await T(o,t)}}function O(o,t){const n=w(t);n!=null&&(o.size=n)}function w(o){for(const t of o)if(typeof t=="number")return t;return null}function D(o,t){o.size=typeof t[2]=="number"?t[2]:0}async function T(o,t){const{resourceSize:n,symbolSize:l}=await A(o),e=d(t,n,l);o.width=f(t[0],l[0],n[0],e),o.depth=f(t[1],l[1],n[1],e),o.height=f(t[2],l[2],n[2],e)}function V(o,t){const n=d(t,S,[o.width,void 0,o.height]);o.width=f(t[0],o.width,1,n),o.height=f(t[2],o.height,1,n)}function d(o,t,n){for(let l=0;l<3;l++){const e=o[l];switch(e){case"symbol-value":{const r=n[l];return r!=null?r/t[l]:1}case"proportional":break;default:if(e&&t[l])return e/t[l]}}return 1}async function A(o){const{computeObjectLayerResourceSize:t}=await M(()=>import("./symbolLayerUtils-BB_nAUIt.js"),__vite__mapDeps([0,1,2])),n=await t(o,10),{width:l,height:e,depth:r}=o,c=[l,r,e];let s=1;for(let i=0;i<3;i++){const u=c[i];if(u!=null){s=u/n[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=n[i]*s);return{resourceSize:n,symbolSize:c}}function f(o,t,n,l){switch(o){case"proportional":return n*l;case"symbol-value":return t??n;default:return o}}function G(o,t){const n=w(t);if(n!=null)switch(o.type){case"simple-marker":o.size=n;break;case"picture-marker":{const l=o.width/o.height;l>1?(o.width=n,o.height=n*l):(o.width=n*l,o.height=n);break}case"simple-line":o.width=n;break;case"text":o.font.size=n}}async function B(o,t){if(o&&t)return y(o)?R(o,t):void(m(o)&&G(o,t))}function J(o,t,n){if(o&&t!=null)if(y(o)){const l=o.symbolLayers;l&&l.forEach(e=>{if(e&&e.type==="object")switch(n){case"tilt":e.tilt=(e.tilt??0)+t;break;case"roll":e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}})}else m(o)&&(o.type!=="simple-marker"&&o.type!=="picture-marker"&&o.type!=="text"||(o.angle+=t))}async function K(o,t){return await o.fetchSymbol(t)||o.fetchCIMSymbol(t)}export{J as D,K as N,B as R,q as g,U as h};
